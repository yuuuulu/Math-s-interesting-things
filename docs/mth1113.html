<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Foundation Math Learning - APH101 Biostatistics And R + MTH113 Intro to Probability and Statistics+APH003 Exploring the World Through Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Foundation Math Learning</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://yuuuulu.github.io/"> 
<span class="menu-text">yuuuulu</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Homepage</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./stat_learn.html"> 
<span class="menu-text">Statistical_Learning</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Mathematical Analysis 1.html"> 
<span class="menu-text">Analysis 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Calculus.html"> 
<span class="menu-text">Calculus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mth107.html"> 
<span class="menu-text">Advanced Linear Algebra</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./mth1113.html" aria-current="page"> 
<span class="menu-text">Prob, and Stat.</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./APH203.html"> 
<span class="menu-text">Time Series</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Simple_ODEs.html"> 
<span class="menu-text">ODEs and PDEs with codes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mth106.html"> 
<span class="menu-text">ODE, PDE, and Fourier Series</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#probability-theory-content-intro" id="toc-probability-theory-content-intro" class="nav-link active" data-scroll-target="#probability-theory-content-intro">Probability theory content (Intro)</a>
  <ul class="collapse">
  <li><a href="#probability-space" id="toc-probability-space" class="nav-link" data-scroll-target="#probability-space">Probability Space</a></li>
  <li><a href="#random-variable" id="toc-random-variable" class="nav-link" data-scroll-target="#random-variable">Random variable</a></li>
  </ul></li>
  <li><a href="#distributions-see-prof.-张颢-现代数字信号处理bilibili" id="toc-distributions-see-prof.-张颢-现代数字信号处理bilibili" class="nav-link" data-scroll-target="#distributions-see-prof.-张颢-现代数字信号处理bilibili">distributions —see prof. 张颢– 现代数字信号处理bilibili</a></li>
  <li><a href="#sufficient-statistics" id="toc-sufficient-statistics" class="nav-link" data-scroll-target="#sufficient-statistics">sufficient statistics</a></li>
  <li><a href="#fisher-information-matrix" id="toc-fisher-information-matrix" class="nav-link" data-scroll-target="#fisher-information-matrix">Fisher information matrix</a></li>
  <li><a href="#rao-boundary" id="toc-rao-boundary" class="nav-link" data-scroll-target="#rao-boundary">Rao boundary</a>
  <ul class="collapse">
  <li><a href="#simple-random-sampling" id="toc-simple-random-sampling" class="nav-link" data-scroll-target="#simple-random-sampling">Simple Random Sampling</a></li>
  <li><a href="#unbiased-estimator" id="toc-unbiased-estimator" class="nav-link" data-scroll-target="#unbiased-estimator">Unbiased estimator</a></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance">Variance</a></li>
  <li><a href="#from-coin-tossing-process" id="toc-from-coin-tossing-process" class="nav-link" data-scroll-target="#from-coin-tossing-process">from Coin tossing process</a></li>
  <li><a href="#counting" id="toc-counting" class="nav-link" data-scroll-target="#counting">counting</a></li>
  <li><a href="#the-importance-of-the-unit-standard" id="toc-the-importance-of-the-unit-standard" class="nav-link" data-scroll-target="#the-importance-of-the-unit-standard">the importance of the Unit Standard</a></li>
  <li><a href="#sampling-distribution" id="toc-sampling-distribution" class="nav-link" data-scroll-target="#sampling-distribution">Sampling distribution</a>
  <ul class="collapse">
  <li><a href="#sample-mean-of-i.i.d.-normals" id="toc-sample-mean-of-i.i.d.-normals" class="nav-link" data-scroll-target="#sample-mean-of-i.i.d.-normals">Sample mean of i.i.d. normals</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a></li>
  <li><a href="#simple-simulation" id="toc-simple-simulation" class="nav-link" data-scroll-target="#simple-simulation">simple simulation</a></li>
  <li><a href="#moment-generating-functions" id="toc-moment-generating-functions" class="nav-link" data-scroll-target="#moment-generating-functions">Moment generating functions</a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition">Definition</a></li>
  <li><a href="#theorems-about-mgf" id="toc-theorems-about-mgf" class="nav-link" data-scroll-target="#theorems-about-mgf">Theorems about MGF</a></li>
  </ul></li>
  <li><a href="#distribution-transformation" id="toc-distribution-transformation" class="nav-link" data-scroll-target="#distribution-transformation">Distribution Transformation</a>
  <ul class="collapse">
  <li><a href="#universality-of-the-uniformfrom-uniform-you-can-get-everything" id="toc-universality-of-the-uniformfrom-uniform-you-can-get-everything" class="nav-link" data-scroll-target="#universality-of-the-uniformfrom-uniform-you-can-get-everything">Universality of the Uniform—From uniform you can get everything</a></li>
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution">Normal Distribution</a></li>
  <li><a href="#from.." id="toc-from.." class="nav-link" data-scroll-target="#from..">From…..</a></li>
  </ul></li>
  <li><a href="#pdf-functionss-transformationfrom-books" id="toc-pdf-functionss-transformationfrom-books" class="nav-link" data-scroll-target="#pdf-functionss-transformationfrom-books">PDF functions’s transformation(from books)</a>
  <ul class="collapse">
  <li><a href="#standard-normal-distribution" id="toc-standard-normal-distribution" class="nav-link" data-scroll-target="#standard-normal-distribution">Standard normal distribution</a></li>
  <li><a href="#chi-square-distribution" id="toc-chi-square-distribution" class="nav-link" data-scroll-target="#chi-square-distribution">Chi-square distribution</a></li>
  <li><a href="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2" id="toc-from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2" class="nav-link" data-scroll-target="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Chi-square distribution <span class="math inline">\(f(x; k) = \frac{1}{2^{k/2} \Gamma(k/2)} x^{k/2 - 1} e^{-x/2}\)</span></a></li>
  <li><a href="#student--t-distribution" id="toc-student--t-distribution" class="nav-link" data-scroll-target="#student--t-distribution">Student- t distribution</a></li>
  <li><a href="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom." id="toc-from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom." class="nav-link" data-scroll-target="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom.">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Student- t distribution <span class="math inline">\(f(t) = \frac{\Gamma \left(\frac{\nu+1}{2}\right)}{\sqrt{\nu \pi} \, \Gamma \left(\frac{\nu}{2}\right)} \left(1 + \frac{t^2}{\nu}\right)^{-\frac{\nu+1}{2}}\)</span>, where <span class="math inline">\(\Gamma\)</span> is the gamma function and <span class="math inline">\(\nu\)</span> is the degrees of freedom.</a></li>
  <li><a href="#f-distribution" id="toc-f-distribution" class="nav-link" data-scroll-target="#f-distribution">F-distribution</a></li>
  <li><a href="#we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution" id="toc-we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution" class="nav-link" data-scroll-target="#we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution">We will do some trnsformation on chi-square distribution to get F-distribution</a></li>
  <li><a href="#beta-and-gamma" id="toc-beta-and-gamma" class="nav-link" data-scroll-target="#beta-and-gamma">beta and Gamma</a></li>
  <li><a href="#why-is-the-integral-result-as-shown" id="toc-why-is-the-integral-result-as-shown" class="nav-link" data-scroll-target="#why-is-the-integral-result-as-shown">Why is the integral result as shown?</a></li>
  </ul></li>
  <li><a href="#three-main-sampling-distribution" id="toc-three-main-sampling-distribution" class="nav-link" data-scroll-target="#three-main-sampling-distribution">Three Main Sampling distribution</a>
  <ul class="collapse">
  <li><a href="#chi-square-distribution-1" id="toc-chi-square-distribution-1" class="nav-link" data-scroll-target="#chi-square-distribution-1">Chi-square distribution</a></li>
  <li><a href="#students-t-distribution" id="toc-students-t-distribution" class="nav-link" data-scroll-target="#students-t-distribution">Student’s t-distribution</a></li>
  <li><a href="#f-distribution-1" id="toc-f-distribution-1" class="nav-link" data-scroll-target="#f-distribution-1">F-distribution</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimation-of-population-characteristic" id="toc-estimation-of-population-characteristic" class="nav-link" data-scroll-target="#estimation-of-population-characteristic">Estimation of Population Characteristic</a>
  <ul class="collapse">
  <li><a href="#point-estimation" id="toc-point-estimation" class="nav-link" data-scroll-target="#point-estimation">Point Estimation</a></li>
  </ul></li>
  <li><a href="#interval-estimationconfidence-intervalci" id="toc-interval-estimationconfidence-intervalci" class="nav-link" data-scroll-target="#interval-estimationconfidence-intervalci">Interval Estimation—Confidence interval(CI)</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#definition-1" id="toc-definition-1" class="nav-link" data-scroll-target="#definition-1">Definition</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a>
  <ul class="collapse">
  <li><a href="#eg" id="toc-eg" class="nav-link" data-scroll-target="#eg">eg</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#example-of-one-sample-t-test" id="toc-example-of-one-sample-t-test" class="nav-link" data-scroll-target="#example-of-one-sample-t-test">Example of one-sample t-test</a>
  <ul class="collapse">
  <li><a href="#a" id="toc-a" class="nav-link" data-scroll-target="#a">a</a></li>
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">b</a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c">c</a></li>
  <li><a href="#d" id="toc-d" class="nav-link" data-scroll-target="#d">d</a></li>
  </ul></li>
  <li><a href="#example-of-unpaired-t-test" id="toc-example-of-unpaired-t-test" class="nav-link" data-scroll-target="#example-of-unpaired-t-test">Example of unpaired t-test</a></li>
  <li><a href="#example-of-one-sample-variance-test" id="toc-example-of-one-sample-variance-test" class="nav-link" data-scroll-target="#example-of-one-sample-variance-test">Example of one-sample Variance Test</a></li>
  <li><a href="#example-of-two-sample-variance-test" id="toc-example-of-two-sample-variance-test" class="nav-link" data-scroll-target="#example-of-two-sample-variance-test">Example of two-sample Variance Test</a></li>
  <li><a href="#anova-analysis-of-variance" id="toc-anova-analysis-of-variance" class="nav-link" data-scroll-target="#anova-analysis-of-variance">ANOVA– Analysis of Variance</a>
  <ul class="collapse">
  <li><a href="#example-of-two-way-anova" id="toc-example-of-two-way-anova" class="nav-link" data-scroll-target="#example-of-two-way-anova">Example of two-way ANOVA</a></li>
  </ul></li>
  <li><a href="#non-parametric-tests" id="toc-non-parametric-tests" class="nav-link" data-scroll-target="#non-parametric-tests">Non-parametric tests</a>
  <ul class="collapse">
  <li><a href="#application-of-testing-the-goodness-of-fit" id="toc-application-of-testing-the-goodness-of-fit" class="nav-link" data-scroll-target="#application-of-testing-the-goodness-of-fit">Application of testing the goodness of fit</a></li>
  <li><a href="#application-of-testing-for-homogeneity" id="toc-application-of-testing-for-homogeneity" class="nav-link" data-scroll-target="#application-of-testing-for-homogeneity">Application of testing for homogeneity</a></li>
  <li><a href="#application-of-testing-for-independence" id="toc-application-of-testing-for-independence" class="nav-link" data-scroll-target="#application-of-testing-for-independence">Application of testing for independence</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a>
  <ul class="collapse">
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression">Simple linear regression</a>
  <ul class="collapse">
  <li><a href="#brief-introduction" id="toc-brief-introduction" class="nav-link" data-scroll-target="#brief-introduction">Brief introduction</a></li>
  <li><a href="#maximum-likelihood-estimation-mle" id="toc-maximum-likelihood-estimation-mle" class="nav-link" data-scroll-target="#maximum-likelihood-estimation-mle">Maximum Likelihood Estimation (MLE)</a></li>
  <li><a href="#hypothesis-testing-for-estimates-with-unknown-sigma2" id="toc-hypothesis-testing-for-estimates-with-unknown-sigma2" class="nav-link" data-scroll-target="#hypothesis-testing-for-estimates-with-unknown-sigma2">Hypothesis testing for estimates with unknown <span class="math inline">\(\sigma^2\)</span></a></li>
  <li><a href="#r2the-fraction-of-variability-explained-by-the-regression" id="toc-r2the-fraction-of-variability-explained-by-the-regression" class="nav-link" data-scroll-target="#r2the-fraction-of-variability-explained-by-the-regression"><span class="math inline">\(R^2\)</span>–the fraction of variability explained by the regression</a></li>
  </ul></li>
  <li><a href="#multiple-linear-regression-mlr" id="toc-multiple-linear-regression-mlr" class="nav-link" data-scroll-target="#multiple-linear-regression-mlr">Multiple linear regression (MLR)</a>
  <ul class="collapse">
  <li><a href="#a-potential-problem-in-practice-multicollinearity" id="toc-a-potential-problem-in-practice-multicollinearity" class="nav-link" data-scroll-target="#a-potential-problem-in-practice-multicollinearity">A potential problem in practice –multicollinearity</a></li>
  <li><a href="#adjusted-r-squared" id="toc-adjusted-r-squared" class="nav-link" data-scroll-target="#adjusted-r-squared">Adjusted R-squared</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#odds" id="toc-odds" class="nav-link" data-scroll-target="#odds">Odds</a></li>
  </ul></li>
  <li><a href="#generalized-linear-models" id="toc-generalized-linear-models" class="nav-link" data-scroll-target="#generalized-linear-models">Generalized Linear Models</a>
  <ul class="collapse">
  <li><a href="#random-component" id="toc-random-component" class="nav-link" data-scroll-target="#random-component">Random Component</a></li>
  <li><a href="#exponential-family" id="toc-exponential-family" class="nav-link" data-scroll-target="#exponential-family">Exponential Family</a></li>
  <li><a href="#systematic-component-and-link-component" id="toc-systematic-component-and-link-component" class="nav-link" data-scroll-target="#systematic-component-and-link-component">Systematic Component and Link Component</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a>
  <ul class="collapse">
  <li><a href="#gaussian-noise-linear-regression" id="toc-gaussian-noise-linear-regression" class="nav-link" data-scroll-target="#gaussian-noise-linear-regression">Gaussian-noise Linear Regression</a></li>
  <li><a href="#bernoulli" id="toc-bernoulli" class="nav-link" data-scroll-target="#bernoulli">Bernoulli</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#link-function" id="toc-link-function" class="nav-link" data-scroll-target="#link-function">Link Function</a>
  <ul class="collapse">
  <li><a href="#logistic" id="toc-logistic" class="nav-link" data-scroll-target="#logistic">Logistic</a></li>
  </ul></li>
  <li><a href="#survival-analysis" id="toc-survival-analysis" class="nav-link" data-scroll-target="#survival-analysis">Survival Analysis</a>
  <ul class="collapse">
  <li><a href="#some-definations" id="toc-some-definations" class="nav-link" data-scroll-target="#some-definations">Some definations</a></li>
  <li><a href="#kaplan-meier-estimate" id="toc-kaplan-meier-estimate" class="nav-link" data-scroll-target="#kaplan-meier-estimate">Kaplan-Meier estimate</a></li>
  <li><a href="#cox-proportional-harzards-model" id="toc-cox-proportional-harzards-model" class="nav-link" data-scroll-target="#cox-proportional-harzards-model">Cox-proportional harzards model</a></li>
  </ul></li>
  <li><a href="#final-review-of-r-codes" id="toc-final-review-of-r-codes" class="nav-link" data-scroll-target="#final-review-of-r-codes">Final review of R codes</a>
  <ul class="collapse">
  <li><a href="#calculation" id="toc-calculation" class="nav-link" data-scroll-target="#calculation">Calculation</a></li>
  <li><a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors">Vectors</a></li>
  <li><a href="#rmd-knowledge" id="toc-rmd-knowledge" class="nav-link" data-scroll-target="#rmd-knowledge">Rmd knowledge</a></li>
  </ul></li>
  <li><a href="#probability-in-r" id="toc-probability-in-r" class="nav-link" data-scroll-target="#probability-in-r">Probability in R</a></li>
  <li><a href="#r-basic" id="toc-r-basic" class="nav-link" data-scroll-target="#r-basic">R basic</a></li>
  <li><a href="#data-class" id="toc-data-class" class="nav-link" data-scroll-target="#data-class">Data class</a>
  <ul class="collapse">
  <li><a href="#numeric" id="toc-numeric" class="nav-link" data-scroll-target="#numeric">Numeric</a></li>
  <li><a href="#integer" id="toc-integer" class="nav-link" data-scroll-target="#integer">Integer</a></li>
  <li><a href="#character" id="toc-character" class="nav-link" data-scroll-target="#character">Character</a></li>
  <li><a href="#logical" id="toc-logical" class="nav-link" data-scroll-target="#logical">Logical</a></li>
  <li><a href="#factor" id="toc-factor" class="nav-link" data-scroll-target="#factor">Factor</a></li>
  <li><a href="#date-and-time" id="toc-date-and-time" class="nav-link" data-scroll-target="#date-and-time">Date and time</a></li>
  <li><a href="#data-frame" id="toc-data-frame" class="nav-link" data-scroll-target="#data-frame">Data frame</a></li>
  <li><a href="#list" id="toc-list" class="nav-link" data-scroll-target="#list">List</a></li>
  <li><a href="#matrix" id="toc-matrix" class="nav-link" data-scroll-target="#matrix">Matrix</a></li>
  <li><a href="#example-1-1" id="toc-example-1-1" class="nav-link" data-scroll-target="#example-1-1">Example 1</a></li>
  </ul></li>
  <li><a href="#data-visualization-mainly-ggplot2" id="toc-data-visualization-mainly-ggplot2" class="nav-link" data-scroll-target="#data-visualization-mainly-ggplot2">Data visualization (mainly: ggplot2)</a>
  <ul class="collapse">
  <li><a href="#box-plots" id="toc-box-plots" class="nav-link" data-scroll-target="#box-plots">Box plots</a></li>
  <li><a href="#histogram-plots" id="toc-histogram-plots" class="nav-link" data-scroll-target="#histogram-plots">Histogram plots</a></li>
  <li><a href="#density-plots" id="toc-density-plots" class="nav-link" data-scroll-target="#density-plots">Density plots</a></li>
  <li><a href="#scatter-plots" id="toc-scatter-plots" class="nav-link" data-scroll-target="#scatter-plots">Scatter plots</a></li>
  <li><a href="#scatter-plots-with-regression-line" id="toc-scatter-plots-with-regression-line" class="nav-link" data-scroll-target="#scatter-plots-with-regression-line">Scatter plots with regression line</a></li>
  <li><a href="#heat-map" id="toc-heat-map" class="nav-link" data-scroll-target="#heat-map">Heat map</a></li>
  <li><a href="#faceting-make-many-panels-of-graphics-where-each-panel-represents-the-same-relationship-between-variables-but-something-changes-between-each-pane" id="toc-faceting-make-many-panels-of-graphics-where-each-panel-represents-the-same-relationship-between-variables-but-something-changes-between-each-pane" class="nav-link" data-scroll-target="#faceting-make-many-panels-of-graphics-where-each-panel-represents-the-same-relationship-between-variables-but-something-changes-between-each-pane">Faceting (make many panels of graphics where each panel represents the same relationship between variables, but something changes between each pane)</a></li>
  </ul></li>
  <li><a href="#data-manipulation" id="toc-data-manipulation" class="nav-link" data-scroll-target="#data-manipulation">Data manipulation</a>
  <ul class="collapse">
  <li><a href="#apply" id="toc-apply" class="nav-link" data-scroll-target="#apply">apply</a></li>
  <li><a href="#tibbles" id="toc-tibbles" class="nav-link" data-scroll-target="#tibbles">Tibbles</a></li>
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">%&gt;%</a></li>
  <li><a href="#select" id="toc-select" class="nav-link" data-scroll-target="#select">select</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter">filter</a></li>
  <li><a href="#slice" id="toc-slice" class="nav-link" data-scroll-target="#slice">slice</a></li>
  <li><a href="#arrange" id="toc-arrange" class="nav-link" data-scroll-target="#arrange">arrange</a></li>
  <li><a href="#mutate" id="toc-mutate" class="nav-link" data-scroll-target="#mutate">mutate</a></li>
  <li><a href="#summarise" id="toc-summarise" class="nav-link" data-scroll-target="#summarise">summarise</a></li>
  <li><a href="#group_by" id="toc-group_by" class="nav-link" data-scroll-target="#group_by">group_by</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">examples</a></li>
  <li><a href="#psthe-comparison-between-whether-to-use-or-not" id="toc-psthe-comparison-between-whether-to-use-or-not" class="nav-link" data-scroll-target="#psthe-comparison-between-whether-to-use-or-not">ps:the comparison between whether to use %&gt;% or not</a></li>
  </ul></li>
  <li><a href="#control-flow" id="toc-control-flow" class="nav-link" data-scroll-target="#control-flow">Control flow</a>
  <ul class="collapse">
  <li><a href="#while-loop" id="toc-while-loop" class="nav-link" data-scroll-target="#while-loop">while loop</a></li>
  <li><a href="#for-loop" id="toc-for-loop" class="nav-link" data-scroll-target="#for-loop">for loop</a>
  <ul class="collapse">
  <li><a href="#fibonacci-sequence" id="toc-fibonacci-sequence" class="nav-link" data-scroll-target="#fibonacci-sequence">Fibonacci sequence</a></li>
  <li><a href="#bootstrap-estimate-of-a-sampling-distribution" id="toc-bootstrap-estimate-of-a-sampling-distribution" class="nav-link" data-scroll-target="#bootstrap-estimate-of-a-sampling-distribution">bootstrap estimate of a sampling distribution</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#functions" id="toc-functions" class="nav-link" data-scroll-target="#functions">Functions</a>
  <ul class="collapse">
  <li><a href="#functions-condtruction" id="toc-functions-condtruction" class="nav-link" data-scroll-target="#functions-condtruction">Functions condtruction</a></li>
  <li><a href="#ellipses" id="toc-ellipses" class="nav-link" data-scroll-target="#ellipses">Ellipses</a></li>
  </ul></li>
  <li><a href="#data-class-1" id="toc-data-class-1" class="nav-link" data-scroll-target="#data-class-1">Data class</a></li>
  <li><a href="#lab-5-data-visualization" id="toc-lab-5-data-visualization" class="nav-link" data-scroll-target="#lab-5-data-visualization">LAB 5 –data visualization</a>
  <ul class="collapse">
  <li><a href="#ellipses-1" id="toc-ellipses-1" class="nav-link" data-scroll-target="#ellipses-1">Ellipses</a></li>
  </ul></li>
  <li><a href="#copy-of-x" id="toc-copy-of-x" class="nav-link" data-scroll-target="#copy-of-x">copy of x</a></li>
  <li><a href="#lab-10" id="toc-lab-10" class="nav-link" data-scroll-target="#lab-10">LAB 10</a>
  <ul class="collapse">
  <li><a href="#part-1" id="toc-part-1" class="nav-link" data-scroll-target="#part-1">Part 1</a></li>
  <li><a href="#part-2" id="toc-part-2" class="nav-link" data-scroll-target="#part-2">Part 2</a></li>
  </ul></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix">Confusion Matrix</a>
  <ul class="collapse">
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">example</a>
  <ul class="collapse">
  <li><a href="#lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv" id="toc-lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv" class="nav-link" data-scroll-target="#lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv">Lung Cancer Classification (https://www.kaggle.com/datasets/mysarahmadbhat/lung-cancer?select=survey+lung+cancer.csv)</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#below-is-the-further-remark" id="toc-below-is-the-further-remark" class="nav-link" data-scroll-target="#below-is-the-further-remark">Below is the further remark</a></li>
  <li><a href="#margin-of-error" id="toc-margin-of-error" class="nav-link" data-scroll-target="#margin-of-error">margin of error</a></li>
  <li><a href="#why-n-1-in-sampling-variance" id="toc-why-n-1-in-sampling-variance" class="nav-link" data-scroll-target="#why-n-1-in-sampling-variance">Why n-1 in sampling variance</a></li>
  <li><a href="#simple-random-samlple" id="toc-simple-random-samlple" class="nav-link" data-scroll-target="#simple-random-samlple">Simple random samlple</a></li>
  <li><a href="#sample-space-and-probability-measure" id="toc-sample-space-and-probability-measure" class="nav-link" data-scroll-target="#sample-space-and-probability-measure">Sample Space and Probability Measure</a></li>
  <li><a href="#interpret-the-probability" id="toc-interpret-the-probability" class="nav-link" data-scroll-target="#interpret-the-probability">interpret the probability</a></li>
  <li><a href="#moment-generating-functions-1" id="toc-moment-generating-functions-1" class="nav-link" data-scroll-target="#moment-generating-functions-1">Moment Generating Functions</a>
  <ul class="collapse">
  <li><a href="#case-1" id="toc-case-1" class="nav-link" data-scroll-target="#case-1">case 1</a></li>
  <li><a href="#case-2" id="toc-case-2" class="nav-link" data-scroll-target="#case-2">case 2</a>
  <ul class="collapse">
  <li><a href="#gamma-disteibution" id="toc-gamma-disteibution" class="nav-link" data-scroll-target="#gamma-disteibution">Gamma disteibution</a></li>
  </ul></li>
  <li><a href="#why-mgf-is-useful-to-determine-if-two-random-variables-have-the-identical-cdf-to-prove-the-addition-property-of-distributions" id="toc-why-mgf-is-useful-to-determine-if-two-random-variables-have-the-identical-cdf-to-prove-the-addition-property-of-distributions" class="nav-link" data-scroll-target="#why-mgf-is-useful-to-determine-if-two-random-variables-have-the-identical-cdf-to-prove-the-addition-property-of-distributions">why MGF is useful? – to determine if two random variables have the identical CDF / to prove the addition property of distributions</a></li>
  </ul></li>
  <li><a href="#normal-chi-squared-distribution" id="toc-normal-chi-squared-distribution" class="nav-link" data-scroll-target="#normal-chi-squared-distribution">Normal –&gt; Chi-squared distribution</a></li>
  <li><a href="#preface" id="toc-preface" class="nav-link" data-scroll-target="#preface">Preface</a></li>
  <li><a href="#把公式推导单独放一栏后" id="toc-把公式推导单独放一栏后" class="nav-link" data-scroll-target="#把公式推导单独放一栏后">把公式推导单独放一栏（后）</a></li>
  <li><a href="#error" id="toc-error" class="nav-link" data-scroll-target="#error">error?</a></li>
  <li><a href="#my-reading-during-this-course" id="toc-my-reading-during-this-course" class="nav-link" data-scroll-target="#my-reading-during-this-course">My reading during this course：</a>
  <ul class="collapse">
  <li><a href="#十堂极简概率课-中信出版-diaconis" id="toc-十堂极简概率课-中信出版-diaconis" class="nav-link" data-scroll-target="#十堂极简概率课-中信出版-diaconis">十堂极简概率课 中信出版 diaconis</a></li>
  <li><a href="#心理统计" id="toc-心理统计" class="nav-link" data-scroll-target="#心理统计">心理统计</a></li>
  <li><a href="#the-lady-tasting-tea" id="toc-the-lady-tasting-tea" class="nav-link" data-scroll-target="#the-lady-tasting-tea">The lady tasting tea</a></li>
  <li><a href="#概率论与数理统计第三版-峁诗松等老师编著" id="toc-概率论与数理统计第三版-峁诗松等老师编著" class="nav-link" data-scroll-target="#概率论与数理统计第三版-峁诗松等老师编著">概率论与数理统计（第三版） 峁诗松等老师编著</a></li>
  <li><a href="#probability." id="toc-probability." class="nav-link" data-scroll-target="#probability.">Probability….</a></li>
  </ul></li>
  <li><a href="#bivariate-data" id="toc-bivariate-data" class="nav-link" data-scroll-target="#bivariate-data">bivariate data</a></li>
  <li><a href="#linear-regression-1" id="toc-linear-regression-1" class="nav-link" data-scroll-target="#linear-regression-1">linear regression</a>
  <ul class="collapse">
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">background</a></li>
  <li><a href="#it-is-not-stable-to-predict-the-data-outside-our-data-sample" id="toc-it-is-not-stable-to-predict-the-data-outside-our-data-sample" class="nav-link" data-scroll-target="#it-is-not-stable-to-predict-the-data-outside-our-data-sample">it is not stable to predict the data outside our data sample’</a></li>
  <li><a href="#residual-plot-should-have-no-pattern" id="toc-residual-plot-should-have-no-pattern" class="nav-link" data-scroll-target="#residual-plot-should-have-no-pattern">Residual plot should have no pattern</a></li>
  </ul></li>
  <li><a href="#skew" id="toc-skew" class="nav-link" data-scroll-target="#skew">skew</a></li>
  <li><a href="#outlier-eg-of-normal-distribution" id="toc-outlier-eg-of-normal-distribution" class="nav-link" data-scroll-target="#outlier-eg-of-normal-distribution">outlier (eg of normal distribution)</a></li>
  <li><a href="#quartile" id="toc-quartile" class="nav-link" data-scroll-target="#quartile">quartile</a></li>
  <li><a href="#modified-boxplot" id="toc-modified-boxplot" class="nav-link" data-scroll-target="#modified-boxplot">modified boxplot</a></li>
  <li><a href="#measures-of-relative-standing" id="toc-measures-of-relative-standing" class="nav-link" data-scroll-target="#measures-of-relative-standing">Measures of relative standing</a>
  <ul class="collapse">
  <li><a href="#z-scores" id="toc-z-scores" class="nav-link" data-scroll-target="#z-scores">z Scores</a></li>
  </ul></li>
  <li><a href="#tutorial" id="toc-tutorial" class="nav-link" data-scroll-target="#tutorial">tutorial</a></li>
  <li><a href="#the-role-of-statistics-and-the-data-analysis-process" id="toc-the-role-of-statistics-and-the-data-analysis-process" class="nav-link" data-scroll-target="#the-role-of-statistics-and-the-data-analysis-process">The role of statistics and the Data Analysis Process</a>
  <ul class="collapse">
  <li><a href="#intro" id="toc-intro" class="nav-link" data-scroll-target="#intro">Intro</a></li>
  <li><a href="#populations-and-samples" id="toc-populations-and-samples" class="nav-link" data-scroll-target="#populations-and-samples">populations and samples</a>
  <ul class="collapse">
  <li><a href="#descriptive-stat" id="toc-descriptive-stat" class="nav-link" data-scroll-target="#descriptive-stat">descriptive stat</a></li>
  <li><a href="#inferential-stat" id="toc-inferential-stat" class="nav-link" data-scroll-target="#inferential-stat">inferential stat</a></li>
  </ul></li>
  <li><a href="#types-of-data" id="toc-types-of-data" class="nav-link" data-scroll-target="#types-of-data">Types of data</a>
  <ul class="collapse">
  <li><a href="#uni-data-set-and-bivariate-and-multivariate" id="toc-uni-data-set-and-bivariate-and-multivariate" class="nav-link" data-scroll-target="#uni-data-set-and-bivariate-and-multivariate">uni data set and bivariate and multivariate</a></li>
  <li><a href="#categorical-and-numericaldiscrete-and-continuous-with-plot-using-excel-data-analysis-or-rstudio-plot-ggplot2" id="toc-categorical-and-numericaldiscrete-and-continuous-with-plot-using-excel-data-analysis-or-rstudio-plot-ggplot2" class="nav-link" data-scroll-target="#categorical-and-numericaldiscrete-and-continuous-with-plot-using-excel-data-analysis-or-rstudio-plot-ggplot2">categorical and numerical(discrete and continuous) with plot using excel (data analysis) or rstudio plot (ggplot2)</a></li>
  </ul></li>
  <li><a href="#collect-data-sensibly" id="toc-collect-data-sensibly" class="nav-link" data-scroll-target="#collect-data-sensibly">collect data sensibly</a></li>
  </ul></li>
  <li><a href="#chapter-2" id="toc-chapter-2" class="nav-link" data-scroll-target="#chapter-2">chapter 2</a>
  <ul class="collapse">
  <li><a href="#two-types-of-studies-observational-studies-and-experiments." id="toc-two-types-of-studies-observational-studies-and-experiments." class="nav-link" data-scroll-target="#two-types-of-studies-observational-studies-and-experiments.">Two types of studies: Observational studies and Experiments.</a>
  <ul class="collapse">
  <li><a href="#observational" id="toc-observational" class="nav-link" data-scroll-target="#observational">Observational</a></li>
  <li><a href="#experiments" id="toc-experiments" class="nav-link" data-scroll-target="#experiments">Experiments</a></li>
  <li><a href="#comparison" id="toc-comparison" class="nav-link" data-scroll-target="#comparison">comparison</a></li>
  <li><a href="#confounding-vars" id="toc-confounding-vars" class="nav-link" data-scroll-target="#confounding-vars">confounding vars</a></li>
  </ul></li>
  <li><a href="#variable" id="toc-variable" class="nav-link" data-scroll-target="#variable">variable</a>
  <ul class="collapse">
  <li><a href="#response-variabley" id="toc-response-variabley" class="nav-link" data-scroll-target="#response-variabley">response variable–y</a></li>
  <li><a href="#explanotory-variablex" id="toc-explanotory-variablex" class="nav-link" data-scroll-target="#explanotory-variablex">explanotory variable–x</a></li>
  <li><a href="#experiments-and-obeservational-study" id="toc-experiments-and-obeservational-study" class="nav-link" data-scroll-target="#experiments-and-obeservational-study">experiments and obeservational study</a></li>
  <li><a href="#bias" id="toc-bias" class="nav-link" data-scroll-target="#bias">bias</a></li>
  <li><a href="#random-sampling" id="toc-random-sampling" class="nav-link" data-scroll-target="#random-sampling">random sampling</a></li>
  <li><a href="#stratified-and-cluster" id="toc-stratified-and-cluster" class="nav-link" data-scroll-target="#stratified-and-cluster">stratified and cluster</a></li>
  <li><a href="#systematic-sampling" id="toc-systematic-sampling" class="nav-link" data-scroll-target="#systematic-sampling">systematic sampling</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#random-variable-1" id="toc-random-variable-1" class="nav-link" data-scroll-target="#random-variable-1">Random Variable</a>
  <ul class="collapse">
  <li><a href="#random-variable-r.v." id="toc-random-variable-r.v." class="nav-link" data-scroll-target="#random-variable-r.v.">Random Variable (R.V.)</a>
  <ul class="collapse">
  <li><a href="#eg-1" id="toc-eg-1" class="nav-link" data-scroll-target="#eg-1">eg</a></li>
  </ul></li>
  <li><a href="#sample-space-of-multivariables" id="toc-sample-space-of-multivariables" class="nav-link" data-scroll-target="#sample-space-of-multivariables">sample space of multivariables</a></li>
  <li><a href="#probability-mass-function-and-cumulative-distribution-function-for-discrete-random-variables" id="toc-probability-mass-function-and-cumulative-distribution-function-for-discrete-random-variables" class="nav-link" data-scroll-target="#probability-mass-function-and-cumulative-distribution-function-for-discrete-random-variables">Probability Mass Function and Cumulative Distribution Function for Discrete Random Variables</a></li>
  <li><a href="#expectation-and-variance-for-discrete-random-variables" id="toc-expectation-and-variance-for-discrete-random-variables" class="nav-link" data-scroll-target="#expectation-and-variance-for-discrete-random-variables">Expectation and Variance for Discrete Random Variables</a></li>
  </ul></li>
  <li><a href="#joint-distribution-of-x-and-y" id="toc-joint-distribution-of-x-and-y" class="nav-link" data-scroll-target="#joint-distribution-of-x-and-y">joint distribution of X and Y</a></li>
  <li><a href="#marginal-probability-mass-function" id="toc-marginal-probability-mass-function" class="nav-link" data-scroll-target="#marginal-probability-mass-function">Marginal Probability Mass Function</a></li>
  <li><a href="#functions-of-multiple-random-variables" id="toc-functions-of-multiple-random-variables" class="nav-link" data-scroll-target="#functions-of-multiple-random-variables">Functions of multiple random variables</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence">independence</a>
  <ul class="collapse">
  <li><a href="#independence-expectationsmean-and-variance" id="toc-independence-expectationsmean-and-variance" class="nav-link" data-scroll-target="#independence-expectationsmean-and-variance">independence, expectations(mean) and variance</a></li>
  </ul></li>
  <li><a href="#continuous-random-variables" id="toc-continuous-random-variables" class="nav-link" data-scroll-target="#continuous-random-variables">Continuous Random Variables</a>
  <ul class="collapse">
  <li><a href="#definition.-probability-density-function-pdf" id="toc-definition.-probability-density-function-pdf" class="nav-link" data-scroll-target="#definition.-probability-density-function-pdf">Definition. Probability Density Function (pdf)</a></li>
  <li><a href="#discrete-and-continuous" id="toc-discrete-and-continuous" class="nav-link" data-scroll-target="#discrete-and-continuous">discrete and continuous</a></li>
  </ul></li>
  <li><a href="#covariance" id="toc-covariance" class="nav-link" data-scroll-target="#covariance">Covariance</a>
  <ul class="collapse">
  <li><a href="#wait-for-reviewing.." id="toc-wait-for-reviewing.." class="nav-link" data-scroll-target="#wait-for-reviewing..">wait for reviewing…..</a></li>
  </ul></li>
  <li><a href="#descrete-distributions" id="toc-descrete-distributions" class="nav-link" data-scroll-target="#descrete-distributions">Descrete distributions</a>
  <ul class="collapse">
  <li><a href="#bernoulli-is-composed-by-binomial" id="toc-bernoulli-is-composed-by-binomial" class="nav-link" data-scroll-target="#bernoulli-is-composed-by-binomial">Bernoulli is composed by binomial</a></li>
  <li><a href="#hypergeometric-distribution-could-be-approximated-by-binomial-when-samples-are-large" id="toc-hypergeometric-distribution-could-be-approximated-by-binomial-when-samples-are-large" class="nav-link" data-scroll-target="#hypergeometric-distribution-could-be-approximated-by-binomial-when-samples-are-large">Hypergeometric distribution could be approximated by Binomial when samples are large</a></li>
  <li><a href="#poisson-distribution-as-the-limit-of-binomial-distribution-when-the-number-of-trials-is-large-and-the-probabiliy-of-success-of-each-trial-is-inverse-proportional-to-the-number-of-trials" id="toc-poisson-distribution-as-the-limit-of-binomial-distribution-when-the-number-of-trials-is-large-and-the-probabiliy-of-success-of-each-trial-is-inverse-proportional-to-the-number-of-trials" class="nav-link" data-scroll-target="#poisson-distribution-as-the-limit-of-binomial-distribution-when-the-number-of-trials-is-large-and-the-probabiliy-of-success-of-each-trial-is-inverse-proportional-to-the-number-of-trials">Poisson distribution as the limit of Binomial distribution when the number of trials is large and the probabiliy of success of each trial is inverse-proportional to the number of trials</a>
  <ul class="collapse">
  <li><a href="#the-occurrences-must-be-uniformly-distributed-over-the-interval-being-used" id="toc-the-occurrences-must-be-uniformly-distributed-over-the-interval-being-used" class="nav-link" data-scroll-target="#the-occurrences-must-be-uniformly-distributed-over-the-interval-being-used">???The occurrences must be uniformly distributed over the interval being used</a></li>
  </ul></li>
  <li><a href="#geometric-distribution" id="toc-geometric-distribution" class="nav-link" data-scroll-target="#geometric-distribution">Geometric distribution</a>
  <ul class="collapse">
  <li><a href="#the-irrelevance-of-past-events-to-the-probability-of-future-independent-events" id="toc-the-irrelevance-of-past-events-to-the-probability-of-future-independent-events" class="nav-link" data-scroll-target="#the-irrelevance-of-past-events-to-the-probability-of-future-independent-events">The irrelevance of past events to the probability of future independent events</a></li>
  </ul></li>
  <li><a href="#addition" id="toc-addition" class="nav-link" data-scroll-target="#addition">Addition</a></li>
  </ul></li>
  <li><a href="#normal-distribution-1" id="toc-normal-distribution-1" class="nav-link" data-scroll-target="#normal-distribution-1">Normal distribution</a>
  <ul class="collapse">
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">interpretation:</a></li>
  <li><a href="#sampling-distributions-and-estimators" id="toc-sampling-distributions-and-estimators" class="nav-link" data-scroll-target="#sampling-distributions-and-estimators">Sampling distributions and Estimators</a></li>
  <li><a href="#unbiased-estimators-and-biased-estimators" id="toc-unbiased-estimators-and-biased-estimators" class="nav-link" data-scroll-target="#unbiased-estimators-and-biased-estimators">Unbiased estimators and biased estimators</a></li>
  </ul></li>
  <li><a href="#the-central-limit-thm" id="toc-the-central-limit-thm" class="nav-link" data-scroll-target="#the-central-limit-thm">The Central Limit Thm</a>
  <ul class="collapse">
  <li><a href="#optional-correction-for-a-finite-population" id="toc-optional-correction-for-a-finite-population" class="nav-link" data-scroll-target="#optional-correction-for-a-finite-population">Optional: Correction for a finite population</a></li>
  <li><a href="#using-the-normal-distribution-as-an-approximation-to-the-binomial-distribution" id="toc-using-the-normal-distribution-as-an-approximation-to-the-binomial-distribution" class="nav-link" data-scroll-target="#using-the-normal-distribution-as-an-approximation-to-the-binomial-distribution">Using the Normal distribution as an approximation to the binomial distribution</a></li>
  <li><a href="#to-hypothesis-testing" id="toc-to-hypothesis-testing" class="nav-link" data-scroll-target="#to-hypothesis-testing">to hypothesis testing</a></li>
  <li><a href="#normal-distribution-2" id="toc-normal-distribution-2" class="nav-link" data-scroll-target="#normal-distribution-2">Normal distribution</a>
  <ul class="collapse">
  <li><a href="#assessing-normality" id="toc-assessing-normality" class="nav-link" data-scroll-target="#assessing-normality">Assessing Normality</a></li>
  </ul></li>
  <li><a href="#inferences-from-2-samples-introduces-the-differences-between-two-populaton-means-using-matched-pairs-but-correlaition-and-regression-analyze-the-association-between-the-2-variables-and-if-such-an-association-exists-we-wnat-to-describe-it-with-an-equation-that-can-be-used-for-predictions" id="toc-inferences-from-2-samples-introduces-the-differences-between-two-populaton-means-using-matched-pairs-but-correlaition-and-regression-analyze-the-association-between-the-2-variables-and-if-such-an-association-exists-we-wnat-to-describe-it-with-an-equation-that-can-be-used-for-predictions" class="nav-link" data-scroll-target="#inferences-from-2-samples-introduces-the-differences-between-two-populaton-means-using-matched-pairs-but-correlaition-and-regression-analyze-the-association-between-the-2-variables-and-if-such-an-association-exists-we-wnat-to-describe-it-with-an-equation-that-can-be-used-for-predictions"><img src="images/clipboard-2929822579.png" class="img-fluid">inferences from 2 samples introduces the differences between two populaton means using matched pairs but correlaition and regression analyze the association between the 2 variables and if such an association exists we wnat to describe it with an equation that can be used for predictions</a></li>
  </ul></li>
  <li><a href="#point-estimation-and-confident-interval" id="toc-point-estimation-and-confident-interval" class="nav-link" data-scroll-target="#point-estimation-and-confident-interval">point estimation and confident interval</a></li>
  <li><a href="#acknowledgements" id="toc-acknowledgements" class="nav-link" data-scroll-target="#acknowledgements">Acknowledgements</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">APH101 Biostatistics And R + MTH113 Intro to Probability and Statistics+APH003 Exploring the World Through Data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="probability-theory-content-intro" class="level1">
<h1>Probability theory content (Intro)</h1>
<section id="probability-space" class="level2">
<h2 class="anchored" data-anchor-id="probability-space">Probability Space</h2>
<p>randomness</p>
<p>random event: a subset A of a sample space.</p>
<p>directly observable event (closed under the intersection) <span class="math inline">\(\to\)</span> algebraic extension (finite union, complement) <span class="math inline">\(\to\)</span> continuously extension</p>
<p>e.g.&nbsp;Borel set (analogy to rational number) to the measurable set (analogy to the real number). The approximate of Borel set to the measurable set is related to outer regularity (inner regularity).</p>
</section>
<section id="random-variable" class="level2">
<h2 class="anchored" data-anchor-id="random-variable">Random variable</h2>
<p>Given <span class="math inline">\((\Omega, \mathbb{F},\mathbb{P})\)</span>, <span class="math inline">\(\mathbb{F}\)</span>-measurable mapping: X: <span class="math inline">\(\mathbb{\Omega} \to \mathbb{R}\)</span> is called a random variable (r.v.).</p>
<p>(it is a function defined on the sample space)</p>
<p>Here, for <span class="math inline">\(\mathbb{F}\)</span>-measurable, it means <span class="math inline">\(\forall a \in\mathbb{R}\)</span>, {<span class="math inline">\({\omega \in \Omega|X(\omega) \leq a}\)</span>}<span class="math inline">\(\in \mathbb{F}\)</span></p>
<p>The probability is defined on the subset of the sample space. When we calculate the probability of the random variable given a certain value, we are calculating the probability of this subset of the sample space and here the subset is mapped from the random variable to the value observed.</p>
<ul>
<li><p>Discrete r.v.</p></li>
<li><p>continuous r.v.</p></li>
<li><p>remark (not be silly): do not calculate the expectation of a discrete r.v. by calculate its integral!</p></li>
</ul>
<p>P(X=x) = P(<span class="math inline">\({\omega \in \Omega|X(\omega)=x}\)</span>} –remark: the two p on two sides’ meanings are not the same.</p>
</section>
</section>
<section id="distributions-see-prof.-张颢-现代数字信号处理bilibili" class="level1">
<h1>distributions —see prof. 张颢– 现代数字信号处理bilibili</h1>
</section>
<section id="sufficient-statistics" class="level1">
<h1>sufficient statistics</h1>
</section>
<section id="fisher-information-matrix" class="level1">
<h1>Fisher information matrix</h1>
</section>
<section id="rao-boundary" class="level1">
<h1>Rao boundary</h1>
<section id="simple-random-sampling" class="level2">
<h2 class="anchored" data-anchor-id="simple-random-sampling">Simple Random Sampling</h2>
<p>We can get information about the population by taking a sample from it. The sample should be representative of the population.</p>
<p>A simple random sample of size n is a sample selected from a population in such a way that every possible sample of size n has the same chance of being selected and without replacement.</p>
</section>
<section id="unbiased-estimator" class="level2">
<h2 class="anchored" data-anchor-id="unbiased-estimator">Unbiased estimator</h2>
<p>An estimator is a statistic used to estimate a population parameter. An estimator is unbiased if the expected value of the estimator equals the population parameter.</p>
<p><span class="math inline">\(E(\hat \theta) = \theta\)</span></p>
<p>where <span class="math inline">\(\hat \theta\)</span> is the estimator and <span class="math inline">\(\theta\)</span> is the population parameter.</p>
<p>eg.</p>
<p><span class="math display">\[
\mathbb{E}[\hat{p}]=\mathbb{E}\left[\frac{X_1+X_2+\cdots+X_n}{n}\right]=\frac{1}{n}\left(\mathbb{E}\left[X_1\right]+\cdots+\mathbb{E}\left[X_n\right]\right)=p
\]</span></p>
</section>
<section id="variance" class="level2">
<h2 class="anchored" data-anchor-id="variance">Variance</h2>
<p><span class="math display">\[
\operatorname{Var}[X]=\mathbb{E}\left[X^2\right]-(\mathbb{E}[X])^2
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}\left[\hat{p}^2\right] &amp; =\mathbb{E}\left[\left(\frac{X_1+X_2+\cdots+X_n}{n}\right)^2\right] \\
&amp; =\frac{1}{n^2} \mathbb{E}\left[X_1^2+\cdots+X_n^2+2\left(X_1 X_2+X_1 X_3+\cdots+X_{n-1} X_n\right)\right] \\
&amp; =\frac{1}{n^2}\left(n \mathbb{E}\left[X_1^2\right]+2\binom{n}{2} \mathbb{E}\left[X_1 X_2\right]\right) \\
&amp; =\frac{1}{n} \mathbb{E}\left[X_1^2\right]+\frac{n-1}{n} \mathbb{E}\left[X_1 X_2\right]
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\mathbb{E}\left[\hat{p}^2\right]=\frac{1}{n} \mathbb{E}\left[X_1^2\right]+\frac{n-1}{n} \mathbb{E}\left[X_1 X_2\right]
\]</span></p>
<p>Since <span class="math inline">\(X_1\)</span> is 0 or <span class="math inline">\(1, X_1=X_1^2\)</span>. Then <span class="math inline">\(\mathbb{E}\left[X_1^2\right]=\mathbb{E}\left[X_1\right]=p\)</span>.</p>
<p>Notice: <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are not independent.</p>
<p><span class="math display">\[
\mathbb{E}\left[X_1 X_2\right]=\mathbb{P}\left[X_1=1, X_2=1\right]=\mathbb{P}\left[X_1=1\right] \mathbb{P}\left[X_2=1 \mid X_1=1\right]
\]</span></p>
<p><span class="math display">\[
\mathbb{P}\left[X_1=1\right]=p, \quad \mathbb{P}\left[X_2=1 \mid X_1=1\right]=\frac{N p-1}{N-1}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\operatorname{Var}[\hat{p}] &amp; =\mathbb{E}\left[\hat{p}^2\right]-(\mathbb{E}[\hat{p}])^2 \\
&amp; =\frac{1}{n} p+\frac{n-1}{n} p\left(\frac{N p-1}{N-1}\right)-p^2 \\
&amp; =\left(\frac{1}{n}-\frac{n-1}{n} \frac{1}{N-1}\right) p+\left(\frac{n-1}{n} \frac{N}{N-1}-1\right) p^2 \\
&amp; =\frac{N-n}{n(N-1)} p+\frac{n-N}{n(N-1)} p^2 \\
&amp; =\frac{p(1-p)}{n} \frac{N-n}{N-1}=\frac{p(1-p)}{n}\left(1-\frac{n-1}{N-1}\right)
\end{aligned}
\]</span> When N is much bigger than n, it is <span class="math inline">\(\frac{p(1-p)}{n}\)</span>, which is like we sample n things with replacement (independently).</p>
</section>
<section id="from-coin-tossing-process" class="level2">
<h2 class="anchored" data-anchor-id="from-coin-tossing-process">from Coin tossing process</h2>
</section>
<section id="counting" class="level2">
<h2 class="anchored" data-anchor-id="counting">counting</h2>
</section>
<section id="the-importance-of-the-unit-standard" class="level2">
<h2 class="anchored" data-anchor-id="the-importance-of-the-unit-standard">the importance of the Unit Standard</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>rcon <span class="ot">&lt;-</span> <span class="cf">function</span>(n,p,h){</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  x<span class="ot">&lt;-</span> <span class="fu">rgeom</span>(n,p) <span class="do">## x~W_k</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  y<span class="ot">&lt;-</span> p<span class="sc">*</span>x  <span class="co">#x/ (1/p)--W_k/E[W_K]=p*W_k</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(y,<span class="fu">seq</span>(<span class="dv">0</span>,<span class="fu">max</span>(y)<span class="sc">+</span><span class="dv">1</span>,h),<span class="at">prob=</span><span class="cn">TRUE</span>) </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rcon</span>(<span class="dv">10000</span>,<span class="fl">0.0000001</span>,<span class="fl">0.5</span>) <span class="co"># p→0, the transformed distribution approximates a continuous distribution over continuous time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">rgeom</span>(<span class="dv">100000</span>, <span class="fl">0.0001</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制直方图</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(data), <span class="fu">aes</span>(<span class="at">x =</span> data)) <span class="sc">+</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">fill =</span> <span class="st">"green"</span>, <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(data), <span class="at">by =</span> <span class="dv">1000</span>)) <span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"data"</span>, <span class="at">y =</span> <span class="st">"density"</span>, <span class="at">title =</span> <span class="st">"density (normalized)"</span>) <span class="sc">+</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="sampling-distribution" class="level2">
<h2 class="anchored" data-anchor-id="sampling-distribution">Sampling distribution</h2>
<p>The sampling distribution of a statistic is the probability distribution of that statistic based on a random sample.</p>
<section id="sample-mean-of-i.i.d.-normals" class="level3">
<h3 class="anchored" data-anchor-id="sample-mean-of-i.i.d.-normals">Sample mean of i.i.d. normals</h3>
<p>Sample mean follows a normal distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>.</p>
</section>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<p>Below codes explains the central limit theorem (CLT) and the sampling distribution of the sample proportion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>population_size <span class="ot">&lt;-</span> <span class="dv">12141897</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.54</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>p_hat_values <span class="ot">&lt;-</span> <span class="fu">replicate</span>(num_simulations, {</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate sampling from the population</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,population_size <span class="sc">*</span> p), <span class="fu">rep</span>(<span class="dv">0</span>,population_size<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))),sample_size, <span class="at">replace =</span><span class="cn">FALSE</span>) <span class="co"># replicate(num_simulations, {...})：这个函数会重复执行大括号中的代码num_simulations次，并将每次的结果存储在一个向量中； rep创建一个包含population_size * p个1和population_size * (1-p)个0的向量，模拟总体。</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sample) <span class="co">#calculate the p_hat for each sample</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">p =</span> p_hat_values), <span class="fu">aes</span>(<span class="at">x=</span>p))<span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">fill =</span><span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span><span class="st">" "</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"p_hat"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(histogram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="simple-simulation" class="level2">
<h2 class="anchored" data-anchor-id="simple-simulation">simple simulation</h2>
<p>The relative frequency will converge to the theoretical value (0.6) as the number of trials increases.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">10000</span>, <span class="dv">1</span>, <span class="fl">0.6</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(x) <span class="co"># cumulative sum</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> y <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) <span class="co"># relative frequency--the total number of successes divided by the total number of trials</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(z,<span class="at">main=</span><span class="st">"convergence of relatve frequence"</span>,<span class="at">xlab=</span><span class="st">"time"</span>,<span class="at">ylab=</span><span class="st">"relative frequence"</span>,<span class="at">col=</span><span class="st">"blue"</span>,<span class="at">type=</span><span class="st">"l"</span>)<span class="co"># type="l" means line plot</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">0.6</span>,<span class="at">col=</span><span class="st">"red"</span>) <span class="co"># theoretical value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="moment-generating-functions" class="level2">
<h2 class="anchored" data-anchor-id="moment-generating-functions">Moment generating functions</h2>
<p>Moment generating function (MGF) and characteristic function are powerful functions that describe the underlying features of a random variable.</p>
<section id="definition" class="level3">
<h3 class="anchored" data-anchor-id="definition">Definition</h3>
<p><span class="math inline">\(M_x(t) = \mathbb E (e^{tx})\)</span></p>
</section>
<section id="theorems-about-mgf" class="level3">
<h3 class="anchored" data-anchor-id="theorems-about-mgf">Theorems about MGF</h3>
<ol type="1">
<li>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are random variables with the same MGF, which is finite on <span class="math inline">\(\left[-t_0, t_0\right]\)</span> for some <span class="math inline">\(t_0&gt;0\)</span>, then <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have the same distribution.</li>
</ol>
<p><strong>MGFs can be used as a tool to determine if two random variables have the identical CDF.</strong></p>
<ol start="2" type="1">
<li>Let <span class="math inline">\(X_1, \cdots, X_n\)</span> be independent random variables, with MGFs <span class="math inline">\(M_{X_1}, \cdots, M_{X_n}\)</span>. Then the MGF of their sum is given by <span class="math display">\[
M_{X_1+\cdots+X_n}(t)=M_{X_1}(t) \cdots M_{X_n}(t)
\]</span></li>
</ol>
<section id="example-of-gamma-and-exponential-mgf" class="level4">
<h4 class="anchored" data-anchor-id="example-of-gamma-and-exponential-mgf">Example of Gamma and Exponential MGF</h4>
<p>A gamma distribution with shape <span class="math inline">\(r=1\)</span> is an exponential distribution. If <span class="math inline">\(X \sim \operatorname{Gamma}\left(r_X, \lambda\right)\)</span> and <span class="math inline">\(Y \sim \operatorname{Gamma}\left(r_Y, \lambda\right)\)</span> are independent, then we have <span class="math inline">\(X+Y \sim \operatorname{Gamma}\left(r_X+r_Y, \lambda\right)\)</span>. As a special case, if <span class="math inline">\(X_1, X_2, \cdots, X_n\)</span> are i.i.d. with <span class="math inline">\(\operatorname{Exp}(\lambda)\)</span> distribution, then <span class="math inline">\(X_1+X_2+\cdots+X_n\)</span> has <span class="math inline">\(\operatorname{Gamma}(n, \lambda)\)</span> distribution.</p>
<p>Suppose <span class="math inline">\(X \sim \operatorname{Exp}(\lambda)\)</span>, for <span class="math inline">\(\lambda&gt;0\)</span>. Then <span class="math display">\[
M_X(t)=\mathbb{E}\left[e^{t X}\right]=\int_0^{\infty} e^{t x} \lambda e^{-\lambda x} d x=\lambda \int_0^{\infty} e^{(t-\lambda) x} d x
\]</span></p>
<p>Similar to Gamma MGF, the integral of Exponential MGF converges only for <span class="math inline">\(t&lt;\lambda\)</span>. For <span class="math inline">\(t&lt;\lambda\)</span>, we can integrate: <span class="math display">\[
M_X(t)=\lambda\left[\frac{e^{(t-\lambda) x}}{t-\lambda}\right]_0^{\infty}=\frac{\lambda}{\lambda-t}
\]</span></p>
<p>Since the Gamma MGF is <span class="math inline">\(M_X(t)=\frac{\lambda^r}{(\lambda-t)^r}\)</span> for any <span class="math inline">\(t&lt;\lambda\)</span> For shape <span class="math inline">\(r=1\)</span>, Exponential MGF = Gamma MGF.</p>
</section>
</section>
</section>
<section id="distribution-transformation" class="level2">
<h2 class="anchored" data-anchor-id="distribution-transformation">Distribution Transformation</h2>
<section id="universality-of-the-uniformfrom-uniform-you-can-get-everything" class="level3">
<h3 class="anchored" data-anchor-id="universality-of-the-uniformfrom-uniform-you-can-get-everything">Universality of the Uniform—From uniform you can get everything</h3>
<p>Let u~unif(0,1), F be a CDF(assume F is strictly increased, continuous). Then there comes a theorem: <span class="math display">\[
x = F^{-1}(u)
\]</span> Then <span class="math display">\[
X \sim F
\]</span> (Proof: <span class="math display">\[
P(X\leq x)=P(F^{-1}(u)\leq x)=P(F(F^{-1}(u))\leq F(x))=P(u\leq F(x))=F(x)
\]</span>)</p>
<p>You can convert from the random uniforms to whatever you want to simulate. One example is the simulation of Logistic distribution: F(X)=<span class="math inline">\(e^x\)</span>/(<span class="math inline">\(1+e^x\)</span>)</p>
<p>u~unif(0,1), <span class="math display">\[
X = F^{-1}(u)=log(u/1-u)
\]</span>&nbsp;and X~F</p>
<p>Another example is that we could try to use uniform to simulate normal distribution:</p>
<p>The Box-Muller transform generates pairs of independent standard normally distributed (zero mean, unit variance) random numbers, given a source of uniformly distributed random numbers.</p>
<p>Given two independent random variables <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> that are uniformly distributed on the interval (0, 1), we can generate two independent standard normal random variables <span class="math inline">\(Z_0\)</span> and <span class="math inline">\(Z_1\)</span> using the following formulas:</p>
<p><span class="math display">\[
Z_0 = \sqrt{-2 \ln U_1} \cos(2 \pi U_2)
\]</span></p>
<p><span class="math display">\[
Z_1 = \sqrt{-2 \ln U_1} \sin(2 \pi U_2)
\]</span></p>
<p>Inversely, the example could be: let <span class="math inline">\(Z_0\)</span> and <span class="math inline">\(Z_1\)</span> be standard normal random variables with the following values: <span class="math inline">\(Z_0\)</span> = 0.5 and <span class="math inline">\(Z_1\)</span> = -1.0.</p>
<ol type="1">
<li><p><strong>Compute CDF values</strong>:</p>
<p>For standard normal distribution, the CDF <span class="math display">\[ \Phi(z) \]</span> is given by:</p>
<p><span class="math display">\[
\Phi(z) = \frac{1}{2} \left[ 1 + \text{erf} \left( \frac{z}{\sqrt{2}} \right) \right]
\]</span></p>
<p>(ps:<span class="math display">\[
\text{erf}(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} \, dt
\]</span>)</p>
<ul>
<li><p>For <span class="math display">\[ Z_0 = 0.5 \]</span>:</p>
<p><span class="math display">\[
\Phi(0.5) = \frac{1}{2} \left[ 1 + \text{erf} \left( \frac{0.5}{\sqrt{2}} \right) \right]
\]</span></p></li>
<li><p>For <span class="math display">\[ Z_1 = -1.0 \]</span>:</p>
<p><span class="math display">\[
\Phi(-1.0) = \frac{1}{2} \left[ 1 + \text{erf} \left( \frac{-1.0}{\sqrt{2}} \right) \right]
\]</span></p></li>
</ul></li>
<li><p><strong>Compute Uniform values</strong>:</p>
<p>Since the CDF values <span class="math display">\[ \Phi(Z_0) \]</span> and <span class="math display">\[ \Phi(Z_1) \]</span> are in the range [0, 1], we can directly use them as uniform random variables <span class="math inline">\(U_0\)</span> and <span class="math inline">\(U_1\)</span>.</p>
<ul>
<li><span class="math display">\[U_0 = \Phi(0.5)\]</span></li>
<li><span class="math display">\[U_1 = \Phi(-1.0)\]</span></li>
</ul></li>
<li><p><strong>Result</strong>:</p>
<ul>
<li>Using the error function values:
<ul>
<li><span class="math display">\[ \Phi(0.5) \approx 0.6915 \]</span></li>
<li><span class="math display">\[ \Phi(-1.0) \approx 0.1587 \]</span></li>
</ul></li>
</ul>
<p>Thus, the corresponding uniform distribution values are:</p>
<ul>
<li><span class="math display">\[ U_0 \approx 0.6915 \]</span></li>
<li><span class="math display">\[ U_1 \approx 0.1587 \]</span></li>
</ul></li>
</ol>
<p>Another example is that we can create a function that has good quality as F in the theorem, for example, <span class="math display">\[
u=F(x)=1-e^{-x}          (x&gt;0)
\]</span> then we can simulate X~F:X=-ln(1-u)~F</p>
<p>Also, if <span class="math display">\[
X \sim F
\]</span></p>
<p>Then, <span class="math display">\[
F(x) \sim unif(0,1)
\]</span> e.g.&nbsp;let X~F, if<span class="math display">\[
F(x_0)=1/3\]</span> then <span class="math display">\[P(F(X)\leq 1/3)=P(X\leq x_0)=F(x_0)=1/3 \]</span> which follows the uniform distribution(0,1) because 1/3 generates 1/3. (Uniform distribution: Probability(CDF) is proportional to length)</p>
</section>
<section id="normal-distribution" class="level3">
<h3 class="anchored" data-anchor-id="normal-distribution">Normal Distribution</h3>
<section id="from-standard-normal-distribution-to-normal-distribution" class="level4">
<h4 class="anchored" data-anchor-id="from-standard-normal-distribution-to-normal-distribution">From Standard Normal Distribution to Normal Distribution</h4>
<p><span class="math inline">\(f(z)=ce^{-z^2/2}\)</span> is a function with good qualities such as symmetric……..</p>
<p>To generate normalization constant c using CDF=1, instead of using impossible integral methods to compute it we should try to find the area under it. In that case, we transfer the integral shape to the double integral’s multiplication then we get c: <span class="math display">\[
\int_{-\infty}^{\infty}\exp(-z^2/2) dz=\int_{-\infty}^{\infty}\exp(-z^2/2) dz=\int_{-\infty}^{\infty}\exp(-x^2/2)dx\int_{-\infty}^{\infty}\exp(-y^2/2)dy
\]</span> <span class="math display">\[
=\int_{0}^{\infty}\exp(-r^2/2)r dr\int_{0}^{2π} d\theta\ =\sqrt2\pi\
\]</span> So <span class="math display">\[
c=1/\sqrt2\pi\
\]</span> …….</p>
</section>
</section>
<section id="from.." class="level3">
<h3 class="anchored" data-anchor-id="from..">From…..</h3>
<p>111</p>
<section id="exponential-distribution" class="level4">
<h4 class="anchored" data-anchor-id="exponential-distribution">Exponential distribution</h4>
<p>the only one parameter is the rate parameter. The probability density function (pdf) of an exponential distribution with rate parameter (&gt; 0) is given by:</p>
<p><span class="math display">\[
f_X(x) =
\begin{cases}
\lambda e^{-\lambda x} &amp; \text{for } x \geq 0, \\
0 &amp; \text{for } x &lt; 0.
\end{cases}
\]</span> The cumulative distribution function (cdf) of an exponential distribution with rate parameter (&gt; 0) is given by:</p>
<p><span class="math display">\[
F_X(x) =
\begin{cases}
1 - e^{-\lambda x} &amp; \text{for } x \geq 0, \\
0 &amp; \text{for } x &lt; 0.
\end{cases}
\]</span> 2.Let Y~x, then Y ~Expo(1)</p>
<p>proof: since <span class="math display">\[
P(Y\leq y)=P(X\leq y/\lambda)=1-e^{-y}
\]</span> (just plot it into x) and we could check that E[X]=Var[X]=1, so X=Y/<span class="math inline">\(\lambda\)</span> has E[x]=1/<span class="math inline">\(\lambda\)</span>, Var[x]=1/<span class="math inline">\(\lambda^2\)</span></p>
<p>e.g.&nbsp;Memoryless Property(This property implies that the remaining lifetime distribution does not depend on how much time has already elapsed.)(The exponential distribution is the only continuous distribution that has the memoryless property):<span class="math display">\[ P(X\geq s+t|X\geq s)=P(X\geq t)\]</span> which is actually satisfied by the exponential and we could prove it(though it intuitively makes sence): Here <span class="math display">\[
P(X\geq s)=1-P(X\leq s)=e^{-\lambda s}
\]</span> <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{P(X \geq s+t \text { and } X \geq s)}{P(X \geq s)}
\]</span></p>
<p>Since <span class="math inline">\(X \geq s+t\)</span> implies <span class="math inline">\(X \geq s\)</span>, we can simplify the numerator: <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{P(X \geq s+t)}{P(X \geq s)}
\]</span></p>
<p>Now, substitute the survival function for the exponential distribution: <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{e^{-\lambda(s+t)}}{e^{-\lambda s}}
\]</span></p>
<p>Simplify the expression: <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{e^{-\lambda s} \cdot e^{-\lambda t}}{e^{-\lambda s}}=e^{-\lambda t}
\]</span></p>
<p>Notice that <span class="math inline">\(e^{-\lambda t}=P(X \geq t)\)</span> : <span class="math display">\[
P(X \geq s+t \mid X \geq s)=P(X \geq t)
\]</span> usefulness of it: <span class="math display">\[
X\sim Expo(\lambda),E(X|X&gt;a)=a+E(X-a|X&gt;a)=a+1/\lambda
\]</span></p>
<p>e.g.2The hazard rate (or failure rate) for an exponential distribution is constant over time. For an exponential random variable <span class="math inline">\(X\)</span> with rate parameter <span class="math inline">\(\lambda\)</span>, the hazard rate is: <span class="math display">\[
h(t)=\frac{f_X(t)}{1-F_X(t)}=\lambda .
\]</span></p>
<p>A constant hazard rate implies that the event is equally likely to occur at any point in time, which is a reasonable assumption for many processes, such as the lifetime of certain electronic components or the occurrence of certain types of random failures.</p>
<p>e.g.3 The exponential distribution is closely related to the Poisson process, which is a process that models the occurrence of events happening independently at a constant average rate. If the times between consecutive events in a Poisson process are independent and identically distributed, then these interarrival times follow an exponential distribution. This relationship makes the exponential distribution a natural choice in contexts where events occur randomly over time, such as phone calls arriving at a switchboard or buses arriving at a bus stop.</p>
</section>
<section id="ga" class="level4">
<h4 class="anchored" data-anchor-id="ga">Ga</h4>
<p>If r.v.X~N(0,1), then <span class="math inline">\(X^2\)</span>~<span class="math inline">\(Ga\)</span>(1/2,1/2)</p>
<p>Proof: If r.v. (X N(0,1)), then (X^2 (, ))</p>
<p>Let (X) be a random variable such that (X N(0,1)).</p>
<p>The probability density function (pdf) of (X) is: <span class="math display">\[
f_X(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}, \quad -\infty &lt; x &lt; \infty.
\]</span></p>
<p>First, we find the pdf of (Y = X^2).</p>
<p>The cumulative distribution function (CDF) of (Y) is given by: <span class="math display">\[
F_Y(y) = P(Y \leq y) = P(X^2 \leq y).
\]</span></p>
<p>Since (X^2 ), we only consider (y ): <span class="math display">\[
F_Y(y) = P(-\sqrt{y} \leq X \leq \sqrt{y}).
\]</span></p>
<p>Using the CDF of the normal distribution, we have: <span class="math display">\[
F_Y(y) = \int_{-\sqrt{y}}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \, dx.
\]</span></p>
<p>The pdf of (Y) is the derivative of the CDF: <span class="math display">\[
f_Y(y) = \frac{d}{dy} F_Y(y).
\]</span></p>
<p><span class="math display">\[
F_Y(y) = 2 \int_{0}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \, dx.
\]</span></p>
<p><span class="math display">\[
F_Y(y) = 2 \int_{0}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{-u} \frac{du}{\sqrt{2u}} = \frac{2}{\sqrt{2\pi}} \int_{0}^{\sqrt{y}} e^{-u} \frac{du}{\sqrt{2u}}.
\]</span></p>
<p>Thus, <span class="math display">\[
f_Y(y) = \frac{d}{dy} \left( \frac{2}{\sqrt{2\pi}} \int_{0}^{\sqrt{y}} e^{-u} \frac{du}{\sqrt{2u}} \right).
\]</span></p>
<p>Differentiating with respect to y gives: <span class="math display">\[
f_Y(y) = \frac{1}{\sqrt{2\pi}} \cdot e^{-\frac{y}{2}} \cdot y^{-\frac{1}{2}}.
\]</span></p>
<p>Simplifying, we get: <span class="math display">\[
f_Y(y) = \frac{1}{\sqrt{2\pi}} y^{-\frac{1}{2}} e^{-\frac{y}{2}}.
\]</span></p>
<p><span class="math display">\[
Y = X^2 \sim \text{Ga}\left(\frac{1}{2}, \frac{1}{2}\right).
\]</span></p>
</section>
<section id="chi-square" class="level4">
<h4 class="anchored" data-anchor-id="chi-square">Chi-square</h4>
<p>Chi-square is a</p>
<p>1.Let ( <span class="math inline">\(Z_1\)</span>, <span class="math inline">\(Z_2\)</span>, , <span class="math inline">\(Z_i\)</span> ) are independent standard normal random variables(i.e.&nbsp;Z~N(0,1)), then the random variable ( X ) defined by</p>
<p><span class="math display">\[
X = Z_1^2 + Z_2^2 + \cdots + Z_i^2
\]</span> (<span class="math inline">\(Z_j\)</span>~iid.N(0,1))</p>
<p>follows a chi-square distribution with ( i ) degrees of freedom. So chi-square of 1 is the same thing as Gamma of (1/2,1/2) so chi-square of n is Gamma(n/2,1/2)</p>
<p>2.If <span class="math display">\[
Z_i = \frac{x_i - \mu}{\sigma}
\]</span> The sum of squared standardized deviations is:</p>
<p><span class="math display">\[
\sum_{i=1}^n Z_i^2 = \sum_{i=1}^n \left( \frac{x_i - \mu}{\sigma} \right)^2 = \frac{1}{\sigma^2} \sum_{i=1}^n (x_i - \mu)^2
\]</span></p>
<p>Let <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> be samples of <span class="math inline">\(N\left(\mu, \sigma^2\right)\)</span> , <span class="math inline">\(\mu\)</span> is a known constant, find the distribution of statistics: <span class="math display">\[
T=\sum_{i=1}^n\left(x_i-\mu\right)^2
\]</span></p>
<p>sol: <span class="math inline">\(y_i=\left(x_i-\mu\right) / \sigma, i=1,2, \cdots, n\)</span>, 则 <span class="math inline">\(y_1, y_2, \cdots, y_n\)</span> are iid r.v. of <span class="math inline">\(N(0,1)\)</span>,so<span class="math display">\[
\frac{T}{\sigma^2}=\sum_{i=1}^n\left(\frac{x_i-\mu}{\sigma}\right)^2=\sum_{i=1}^n y_i^2 \sim \chi^2(n),
\]</span> (i.e.<span class="math display">\[
\sum_{i=1}^n Z_i^2 {\sigma^2}\sim \chi^2(n)\]</span>)</p>
<p>Besides, <span class="math inline">\(T\)</span>’s PDF is <span class="math display">\[
p(t)=\frac{1}{\left(2 \sigma^2\right)^{n / 2} \Gamma(n / 2)} \mathrm{e}^{-\frac{1}{2 \sigma^2} t^{\frac{n}{2}}-1}, \quad t&gt;0,
\]</span></p>
<p>which is Gamma distribution <span class="math inline">\(G a\left(\frac{n}{2}, \frac{1}{2 \sigma^2}\right) \cdot\)</span></p>
<p>3.chi-square is uesful because of theorems below:let <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> are samples from <span class="math inline">\(N\left(\mu, \sigma^2\right)\)</span> , whose sample mean and sample variance are<span class="math display">\[
\bar{x}=\frac{1}{n} \sum_{i=1}^n x_i \text { and } s^2=\frac{1}{n-1} \sum_{i=1}^n\left(x_i-\bar{x}\right)^2,
\]</span></p>
<p>then we can get: (1) <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(s^2\)</span> are independent; (2) <span class="math inline">\(\bar{x} \sim N\left(\mu, \sigma^2 / n\right)\)</span>; (3) <span class="math inline">\(\frac{(n-1) s^2}{\sigma^2} \sim \chi^2(n-1)\)</span>.</p>
<p>Proof: <span class="math display">\[
p\left(x_1, x_2, \cdots, x_n\right)=\left(2 \pi \sigma^2\right)^{-n / 2} \mathrm{e}^{-\sum_{i=1}^n \frac{\left(x_i-\mu\right)^2}{2 \sigma^2}}=\left(2 \pi \sigma^2\right)^{-n / 2} \exp \left\{-\frac{\sum_{i=1}^n x_i^2-2 n \bar{x} \mu+n \mu^2}{2 \sigma^2}\right\}
\]</span></p>
<p>denote<span class="math inline">\(\boldsymbol{X}=\left(x_1, x_2, \cdots, x_n\right)^{\mathrm{T}}\)</span>, then we create an <span class="math inline">\(n\)</span>-dimension orthogonal <span class="math inline">\(\boldsymbol{A}\)</span> and every element in the first row is <span class="math inline">\(1 / \sqrt{n}\)</span>, such as <span class="math display">\[
A=\left(\begin{array}{ccccc}
\frac{1}{\sqrt{n}} &amp; \frac{1}{\sqrt{n}} &amp; \frac{1}{\sqrt{n}} &amp; \cdots &amp; \frac{1}{\sqrt{n}} \\
\frac{1}{\sqrt{2 \cdot 1}} &amp; -\frac{1}{\sqrt{2 \cdot 1}} &amp; 0 &amp; \cdots &amp; 0 \\
\frac{1}{\sqrt{3 \cdot 2}} &amp; \frac{1}{\sqrt{3 \cdot 2}} &amp; -\frac{2}{\sqrt{3 \cdot 2}} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; &amp; \vdots \\
\frac{1}{\sqrt{n(n-1)}} &amp; \frac{1}{\sqrt{n(n-1)}} &amp; \frac{1}{\sqrt{n(n-1)}} &amp; \cdots &amp; -\frac{n-1}{\sqrt{n(n-1)}}
\end{array}\right),
\]</span> 令 <span class="math inline">\(\boldsymbol{Y}=\left(y_1, y_2, \cdots, y_n\right)^{\mathrm{T}}=\boldsymbol{A} \boldsymbol{X}\)</span>, <span class="math inline">\(|Jacobi|=1\)</span>, and we can find thatt<span class="math display">\[
\begin{gathered}
\bar{x}=\frac{1}{\sqrt{n}} y_1, \\
\sum_{i=1}^n y_i^2=\boldsymbol{Y}^{\mathrm{T}} \boldsymbol{Y}=\boldsymbol{X}^{\mathrm{T}} \boldsymbol{A}^{\mathrm{T}} \boldsymbol{A} \boldsymbol{X}=\sum_{i=1}^n x_i^2,
\end{gathered}
\]</span></p>
<p>so<span class="math inline">\(y_1, y_2, \cdots, y_n\)</span> ’s joint density function is <span class="math display">\[
\begin{aligned}
p\left(y_1, y_2, \cdots, y_n\right) &amp; =\left(2 \pi \sigma^2\right)^{-n / 2} \exp \left\{-\frac{\sum_{i=1}^n y_i^2-2 \sqrt{n} y_1 \mu+n \mu^2}{2 \sigma^2}\right\} \\
&amp; =\left(2 \pi \sigma^2\right)^{-n / 2} \exp \left\{-\frac{\sum_{i=2}^n y_i^2+\left(y_1-\sqrt{n} \mu\right)^2}{2 \sigma^2}\right\}
\end{aligned}
\]</span></p>
<p>So, <span class="math inline">\(\boldsymbol{Y}=\left(y_1, y_2, \cdots, y_n\right)^{\mathrm{T}}\)</span> independently distributed as normal distribution and their variances are all equal to<span class="math inline">\(\sigma^2\)</span>, but their means are not all the same because <span class="math inline">\(y_2, \cdots, y_n\)</span> ’s means are <span class="math inline">\(0, y_1\)</span>’s is <span class="math inline">\(\sqrt{n} \mu\)</span>, which ends our proof of (2). <span class="math display">\[
(n-1) s^2=\sum_{i=1}^n\left(x_i-\bar{x}\right)^2=\sum_{i=1}^n x_i^2-(\sqrt{n} \bar{x})^2=\sum_{i=1}^n y_i^2-y_1^2=\sum_{i=2}^n y_i^2,
\]</span></p>
<p>This proves conclusion (1). Since <span class="math inline">\(y_2, \cdots, y_n\)</span> are independently and identically distributed as <span class="math inline">\(N\left(0, \sigma^2\right)\)</span>, we have: <span class="math display">\[
\frac{(n-1) s^2}{\sigma^2}=\sum_{i=2}^n\left(\frac{y_i}{\sigma}\right)^2 \sim \chi^2(n-1) .
\]</span></p>
<p>Theorem is proved. (similar to the proof above this maybe easier to understand:<span class="math inline">\(\begin{aligned} &amp; i z\left(Y_1, Y_2, \cdots, Y_2\right)^{\top}=A\left(X_1, \cdots, x_n\right)^{\top} \\ &amp; \text { then } \sum_{i=1}^n Y_i^2=\left(Y_1, \cdots, Y_n\right)\left(Y_1, \cdots, Y_n\right)^{\top} \\ &amp; =\left[A\left(x_1, \cdots, x_n\right)^{\top}\right]^{\top}\left[A\left(x_1, \cdots, X_n\right)^{\top}\right] \\ &amp; =\left(x_1, \cdots, x_n\right) A^{\top} A\left(x_1, \cdots, x_n\right)^{\top} \\ &amp; =\left(x_1, \cdots, x_n\right) E\left(x_1, \cdots, x_n\right)^{\top}=\sum_{i=1}^n x_i^2 \\ &amp; \end{aligned}\)</span>) <span class="math inline">\(\begin{aligned} &amp; \text { besides } Y_1=\frac{1}{\sqrt{n}} x_1+\cdots+\frac{1}{\sqrt{n}} x_n=\frac{1}{\sqrt{n}} \sum_{i=1}^n X_i \\ &amp; \text { and } Y_1=\sqrt{n} \cdot \frac{1}{n} \sum_{i=1}^n X_i=\sqrt{n} \bar{X}, \text { then } \bar{x}=\frac{1}{\sqrt{n}} y_i \\ &amp; B S^2=\frac{1}{n-1} \sum_{i=1}^n\left(x_i-\bar{x}\right)^2=\frac{1}{n-1}\left[\sum_{i=1}^n x_i^2-n \bar{x}^2\right] \\ &amp; =\frac{1}{n-1}\left[\sum_{i=1}^n Y_i^2-Y_1^2\right]=\frac{1}{n-1} \sum_{i=2}^n Y_i^2 \\ &amp; 2 \oplus L=(\sqrt{2 \pi} \sigma)^{-n} \exp \left[-\frac{1}{2 \sigma^2} \sum_{i=1}^n\left(x_i-\mu\right)^2\right] \text {. } \\ &amp; =(\sqrt{2 \pi} \sigma)^{-n} \exp \left[-\frac{1}{2 \sigma^2}\left(\sum_{i=1}^n x_i^2-2 \mu n \bar{x}+\mu^2 n\right]\right. \\ &amp; =(\sqrt{2 \pi} \sigma)^{-n} \exp \left[-\frac{1}{2 \sigma^2}\left(\sum_{1=1}^n y_i{ }^2-2 \mu n \frac{1}{\sqrt{n}} Y_1+n \mu^2\right]\right. \\ &amp; \end{aligned}\)</span> <span class="math display">\[=(\sqrt2\pi\sigma)^{-1}exp[-1/2\sigma^2(Y_1-\sqrt nu)^2]×(\sqrt2\pi\sigma)^{-1}exp[-1/2\sigma^2{Y_2}^2]*...*(\sqrt2\pi\sigma)^{-1}exp[-1/2\sigma^2{Y_n}^2]
\]</span></p>
<p>So L is <span class="math inline">\(Y_1\)</span>…<span class="math inline">\(Y_n\)</span>’s joint density function and so they are independent. Besides, we have proved that its mean is <span class="math inline">\(1/\sqrt n\)</span><span class="math inline">\(Y_1\)</span> and <span class="math inline">\(S^2\)</span>=<span class="math inline">\(1/n-1 \Sigma{i=2}Y_i^2\)</span>, so the normal distribution’s mean and variance are independent.</p>
<p>When the random variable <span class="math inline">\(\chi^2 \sim \chi^2(n)\)</span>, for a given <span class="math inline">\(\alpha\)</span> (where <span class="math inline">\(0&lt;\)</span> <span class="math inline">\(\alpha&lt;1\)</span> ), the value <span class="math inline">\(\chi_{1-\alpha}^2(n)\)</span> satisfying the probability equation <span class="math inline">\(P\left(\chi^2 \leqslant \chi_{1-\alpha}^2(n)\right)=1-\)</span> <span class="math inline">\(\alpha\)</span> is called the <span class="math inline">\(1-\alpha\)</span> quantile of the <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(n\)</span> degrees of freedom.</p>
<p>Suppose the random variables <span class="math inline">\(X_1 \sim \chi^2(m)\)</span> and <span class="math inline">\(X_2 \sim \chi^2(n)\)</span>, and <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are independent. Then the distribution of <span class="math inline">\(F=\frac{X_1 / m}{X_2 / n}\)</span> is called the <span class="math inline">\(\mathrm{F}\)</span> distribution with <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> degrees of freedom, denoted as <span class="math inline">\(F \sim F(m, n)\)</span>. Here, <span class="math inline">\(m\)</span> is called the numerator degrees of freedom and <span class="math inline">\(n\)</span> the denominator degrees of freedom. We derive the density function of the <span class="math inline">\(\mathrm{F}\)</span> distribution in two steps. First, we derive the density function of <span class="math inline">\(Z=\frac{X_1}{X_2}\)</span>. Let <span class="math inline">\(p_1(x)\)</span> and <span class="math inline">\(p_2(x)\)</span> be the density functions of <span class="math inline">\(\chi^2(m)\)</span> and <span class="math inline">\(\chi^2(n)\)</span> respectively. According to the formula for the distribution of the quotient of independent random variables, the density function of <span class="math inline">\(Z\)</span> is: <span class="math display">\[
\begin{gathered}
p_Z(z)=\int_0^{\infty} x_2 p_1\left(z x_2\right) p_2\left(x_2\right) \mathrm{d} x_2 \\
=\frac{z^{\frac{m}{2}-1}}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right) 2^{\frac{m+n}{2}}} \int_0^{\infty} x_2^{\frac{n}{2}-1} e^{-\frac{x_2}{2}(1+z)} \mathrm{d} x_2 .
\end{gathered}
\]</span></p>
<p>Using the transformation <span class="math inline">\(u=\frac{x_2}{2}(1+z)\)</span>, we get: <span class="math display">\[
p_Z(z)=\frac{z^{\frac{m}{2}-1}(1+z)^{-\frac{m+n}{2}}}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)} \int_0^{\infty} u^{\frac{n}{2}-1} e^{-u} \mathrm{~d} u
\]</span></p>
<p>The final integral is the gamma function <span class="math inline">\(\Gamma\left(\frac{n}{2}\right)\)</span>, so: <span class="math display">\[
p_Z(z)=\frac{\Gamma\left(\frac{m+n}{2}\right)}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)} z^{\frac{m}{2}-1}(1+z)^{-\frac{m+n}{2}}, \quad z \geq 0 .
\]</span></p>
<p>Second, we derive the density function of <span class="math inline">\(F=\frac{n}{m} Z\)</span>. Let the value of <span class="math inline">\(F\)</span> be <span class="math inline">\(y\)</span>. For <span class="math inline">\(y \geq 0\)</span>, we have: <span class="math display">\[
\begin{aligned}
p_F(y) &amp; =p_Z\left(\frac{m}{n} y\right) \cdot \frac{m}{n}=\frac{\Gamma\left(\frac{m+n}{2}\right)}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)}\left(\frac{m}{n} y\right)^{\frac{m}{2}-1}\left(1+\frac{m}{n} y\right)^{-\frac{m+n}{2}} \cdot \frac{m}{n} \\
&amp; =\frac{\Gamma\left(\frac{m+n}{2}\right)}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)}\left(\frac{m}{n}\right)\left(\frac{m}{n} y\right)^{\downarrow \frac{2}{2}-1}\left(1+\frac{m}{n} y\right)^{-\frac{m+n}{2}}
\end{aligned}
\]</span></p>
<p>When the random variable <span class="math inline">\(F \sim F(m, n)\)</span>, for a given <span class="math inline">\(\alpha\)</span> (where <span class="math inline">\(0&lt;\alpha&lt;1\)</span> ), the value <span class="math inline">\(F_{1-\alpha}(m, n)\)</span> satisfying the probability equation <span class="math inline">\(P\left(F \leqslant F_{1-\alpha}(m, n)\right)=1-\alpha\)</span> is called the <span class="math inline">\(1-\alpha\)</span> quantile of the <span class="math inline">\(\mathrm{F}\)</span> distribution with <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> degrees of freedom. By the construction of the <span class="math inline">\(\mathrm{F}\)</span> distribution, if <span class="math inline">\(F \sim F(m, n)\)</span>, then <span class="math inline">\(1 / F \sim F(n, m)\)</span>. Therefore, for a given <span class="math inline">\(\alpha\)</span> (where <span class="math inline">\(0&lt;\alpha&lt;1\)</span> ), <span class="math display">\[
\alpha=P\left(\frac{1}{F} \leqslant F_\alpha(n, m)\right)=P\left(F \geqslant \frac{1}{F_\alpha(n, m)}\right) .
\]</span></p>
<p>Thus, <span class="math display">\[
P\left(F \leqslant \frac{1}{F_\alpha(n, m)}\right)=1-\alpha
\]</span></p>
<p>This implies <span class="math display">\[
F_\alpha(n, m)=\frac{1}{F_{1-\alpha}(m, n)} .
\]</span></p>
<p>Corollary Suppose <span class="math inline">\(x_1, x_2, \cdots, x_m\)</span> is a sample from <span class="math inline">\(N\left(\mu_1, \sigma_1^2\right)\)</span> and <span class="math inline">\(y_1, y_2, \cdots, y_n\)</span> is a sample from <span class="math inline">\(N\left(\mu_2, \sigma_2^2\right)\)</span>, and these two samples are independent. Let: <span class="math display">\[
s_x^2=\frac{1}{m-1} \sum_{i=1}^m\left(x_i-\bar{x}\right)^2, \quad s_y^2=\frac{1}{n-1} \sum_{i=1}^n\left(y_i-\bar{y}\right)^2,
\]</span> where <span class="math display">\[
\bar{x}=\frac{1}{m} \sum_{i=1}^m x_i, \quad \bar{y}=\frac{1}{n} \sum_{i=1}^n y_i
\]</span> then <span class="math display">\[
F=\frac{s_x^2 / \sigma_1^2}{s_y^2 / \sigma_2^2} \sim F(m-1, n-1) .
\]</span></p>
<p>In particular, if <span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span>, then <span class="math inline">\(F=\frac{s_x}{s_y^2} \sim F(m-1, n-1)\)</span>. Proof: Since the two samples are independent, <span class="math inline">\(s_x^2\)</span> and <span class="math inline">\(s_y^2\)</span> are independent. According to a Theorem , we have <span class="math display">\[
\frac{(m-1) s_x^2}{\sigma_1^2} \sim \chi^2(m-1), \quad \frac{(n-1) s_y^2}{\sigma_2^2} \sim \chi^2(n-1) .
\]</span></p>
<p>By the definition of the <span class="math inline">\(\mathrm{F}\)</span> distribution, <span class="math inline">\(F \sim F(m-1, n-1)\)</span>. Corollary: Suppose <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> is a sample from a normal distribution <span class="math inline">\(N\left(\mu, \sigma^2\right)\)</span>, and let <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(s^2\)</span> denote the sample mean and sample variance of the sample, respectively. Then <span class="math display">\[
t=\frac{\sqrt{n}(\bar{x}-\mu)}{s} \sim t(n-1) .
\]</span></p>
<p>Proof: From a Theorem we obtain <span class="math display">\[
\frac{\bar{x}-\mu}{\sigma / \sqrt{n}} \sim N(0,1)
\]</span></p>
<p>Then, <span class="math display">\[
\frac{\sqrt{n}(\bar{x}-\mu)}{s}=\frac{\frac{\bar{x}-\mu}{\sigma / \sqrt{n}}}{\sqrt{\frac{(n-1) s^2 / \sigma^2}{n-1}}}
\]</span></p>
<p>Since the numerator is a standard normal variable and the denominator’s square root contains a <span class="math inline">\(\chi^2\)</span> variable with <span class="math inline">\(n-1\)</span> degrees of freedom divided by its degrees of freedom, and they are independent, by the definition of the <span class="math inline">\(t\)</span> distribution, <span class="math inline">\(t \sim t(n-1)\)</span>. The proof is complete.</p>
<p>Corollary: In the notation of Corollary , assume <span class="math inline">\(\sigma_1^2=\sigma_2^2=\sigma^2\)</span>, and let <span class="math display">\[
s_w^2=\frac{(m-1) s_x^2+(n-1) s_y^2}{m+n-2}=\frac{\sum_{i=1}^m\left(x_i-\bar{x}\right)^2+\sum_{i=1}^n\left(y_i-\bar{y}\right)^2}{m+n-2}
\]</span></p>
<p>Then <span class="math display">\[
\frac{(\bar{x}-\bar{y})-\left(\mu_1-\mu_2\right)}{s_w \sqrt{\frac{1}{m}+\frac{1}{n}}} \sim t(m+n-2)
\]</span></p>
<p>Proof: Since <span class="math inline">\(\bar{x} \sim N\left(\mu_1, \frac{\sigma^2}{m}\right), \bar{y} \sim N\left(\mu_2, \frac{\sigma^2}{n}\right)\)</span>, and <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> are independent, we have</p>
<p><span class="math display">\[
\bar{x}-\bar{y} \sim N\left(\mu_1-\mu_2,\left(\frac{1}{m}+\frac{1}{n}\right) \sigma^2\right) .
\]</span></p>
<p>Thus, <span class="math display">\[
\frac{(\bar{x}-\bar{y})-\left(\mu_1-\mu_2\right)}{\sigma \sqrt{\frac{1}{m}+\frac{1}{n}}} \sim N(0,1) .
\]</span></p>
<p>By a Theorem , we know that <span class="math inline">\(\frac{(m-1) s_x^2}{\sigma^2} \sim \chi^2(m-1)\)</span> and <span class="math inline">\(\frac{(n-1) s_y^2}{\sigma^2} \sim \chi^2(n-1)\)</span>, and they are independent. By additivity, we have <span class="math display">\[
\frac{(m+n-2) s_w^2}{\sigma^2}=\frac{(m-1) s_x^2+(n-1) s_y^2}{\sigma^2} \sim \chi^2(m+n-2) .
\]</span></p>
<p>Since <span class="math inline">\(\bar{x}-\bar{y}\)</span> and <span class="math inline">\(s_w^2\)</span> are independent, by the definition of the <span class="math inline">\(\mathrm{t}\)</span> distribution, we get the desired result. <span class="math inline">\(\square\)</span></p>
<p>One interesting example shows the relationship of above distributions used charismatically to solve problems: r.v.: <span class="math inline">\(X_1 ， X_2 ， X_3 ， X_4\)</span> indpendently identically distribute(iid) as <span class="math inline">\(N\left(0 . \sigma^2\right)\)</span>. <span class="math inline">\(Z=\left(x_1^2+x_2^2\right) /\left(x_1^2+x_2^2+x_3^2+x_4^2\right)\)</span> prove: <span class="math inline">\(Z \sim U(0.1)\)</span>. <span class="math display">\[
\begin{aligned}
&amp; \text { Solution: } Let Y=\frac{X_3^2+X_4^2}{X_1^2+X_2^2}=\frac{\left[\left(\frac{X_3}{\sigma}\right)^2+\left(\frac{X_4}{\sigma}\right)^2\right] / 2}{\left[\left(\frac{X_1}{\sigma}\right)^2+\left(\frac{X_2}{\sigma}\right)^2\right] / 2} \sim F(2,2) . \\
&amp; \text { i.e.  } f_Y(y)=\frac{1}{(1+y)^2},  y&gt;0 \\
&amp; \text { then } P(Z \leq z)=P\left(\frac{1}{1+Y} \leq z\right)=P\left(Y \geqslant \frac{1}{z}-1\right) \\
&amp; =\int_{\frac{1}{z}-1}^{+\infty} \frac{1}{(1+y)^2} d y=z \quad \text { H } 0&lt;z&lt;1 . \\
&amp; \therefore Z \sim U(0.1)
\end{aligned}
\]</span> (ps:$</p>
<span class="math display">\[\begin{aligned} &amp; f(x)=\frac{\Gamma\left(\frac{n_1+n_2}{2}\right)}{\Gamma\left(\frac{n_2}{2}\right) \Gamma\left(\frac{n_1}{2}\right)}\left(\frac{n_1}{n_2}\right)\left(\frac{n_1}{n_2} x\right)^{\frac{n_1}{2}-1}\left(1+\frac{n_1}{n_2} x\right)^{\frac{-1}{2}\left(n_1+n_2\right)} . \\ &amp; \text { of these } x&gt;0 \text {. and } E(x)=\frac{n_2}{n_2-2} \text {, when } n_2&gt;2 \text {. } \\ &amp; \operatorname{Var}(X)=\frac{2 n_2^2\left(n_1+n_2-2\right)}{n_1\left(n_2-2\right)^2\left(n_2-4\right)} \text {when $n_2&gt;4$. } \\ &amp; \end{aligned}\]</span>
<p><br>
</p>
</section>
</section>
</section>
<section id="pdf-functionss-transformationfrom-books" class="level2">
<h2 class="anchored" data-anchor-id="pdf-functionss-transformationfrom-books">PDF functions’s transformation(from books)</h2>
<section id="standard-normal-distribution" class="level3">
<h3 class="anchored" data-anchor-id="standard-normal-distribution">Standard normal distribution</h3>
<p>Pdf : <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span><br>
</p>
<ul>
<li>The calculation of the Gaussian integral is to transform the integral into the double integral and then use the polar coordinate</li>
</ul>
<section id="similar-question" class="level4">
<h4 class="anchored" data-anchor-id="similar-question">similar question</h4>
<p>the calculation of the n-dimensional ball (in the second picture that I summarized before), which follows the idea of using the double integral to calculate Gaussian integral and the idea of iterative method. Then I feel how charismatic “a multiple integral in a high-dimensional space can be transformed into an iterated integral where each integral is just a definite integral on an interval” that you said is!</p>
<p>The definition of an N-dimensional sphere with the radius 1 is:</p>
<p><span class="math display">\[
B^n = \{ (x_1, x_2, \cdots, x_n) \in \mathbb{R}^n \mid x_1^2 + \cdots + x_n^2 \leq 1 \}
\]</span>(Denote <span class="math inline">\(V_n(r)\)</span> as the volume of N-dimensional sphere with radius r)</p>
<p>Derivation of the recursive formula for the volume of an N-dimensional sphere:</p>
<p><span class="math display">\[
V_n(1) = \int_{B^n} dx_1 \cdots dx_n
\]</span></p>
<p>By using the recurrence relation: <span class="math display">\[
V_n(1) = \int_{-1}^{1} V_{n-1}(\sqrt{1-x_1^2}) dx_1
\]</span></p>
<p>Further elaboration: <span class="math display">\[
= \int_{-1}^{1} \int_{-\sqrt{1-x_1^2}}^{\sqrt{1-x_1^2}} V_{n-2}(\sqrt{1-x_1^2-x_2^2}) dx_1 dx_2
\]</span></p>
<p>In polar coordinates: <span class="math display">\[
= \int_{0}^{2\pi} \int_{0}^{1} V_{n-2}(\sqrt{1-r^2}) r dr d\theta
\]</span></p>
<p>Let <span class="math inline">\(y = 1 - r^2\)</span>and $dy = -2rdr <span class="math inline">\(:\)</span>$ = <em>{0}^{2} </em>{0}^{1} y^{} V_{n-2}(1) dy d $$</p>
<p>The calculation shows: <span class="math display">\[
= 2\pi \left[ \frac{1}{2} V_{n-2}(1) \cdot \frac{y^{\frac{n}{2}}}{\frac{n}{2}} \right]_{0}^{1}
= \frac{2\pi}{n} V_{n-2}(1)
\]</span></p>
<p>Therefore, the recurrence relation is obtained: <span class="math display">\[
V_n(1) = \frac{2\pi}{n} V_{n-2}(1)
\]</span></p>
<p>Consider the even and odd dimensions respectively:</p>
<p>For an even dimension <span class="math inline">\(n = 2k\)</span>: <span class="math display">\[
V_{2k}(1) = \frac{\pi^k}{k! }
\]</span></p>
<p><span class="math display">\[
V_{2k}(R) = \frac{\pi^kR^{2n}}{k! }
\]</span></p>
<p>For odd-numbered dimensions <span class="math inline">\(n = 2k+1\)</span>: <span class="math display">\[
V_{2k+1}(1) = \frac{2^{k+1}\pi^k}{(2k+1)(2k-1)\cdots 3\cdot 1}
\]</span></p>
<p><span class="math display">\[
V_{2k+1}(R) = \frac{2^{k+1}\pi^kR^{2n+1}}{(2k+1)(2k-1)\cdots 3\cdot 1}
\]</span></p>
<p>Generally, the volume of an N-dimensional sphere with radius R is: <span class="math display">\[
V_n(R) = \frac{\pi^{\frac{n}{2}} R^n}{\Gamma\left(\frac{n}{2} + 1\right)}
\]</span></p>
<ul>
<li>asymptotic behavior when <span class="math inline">\(n \to \infty\)</span></li>
</ul>
<p>When the dimension <span class="math inline">\(n\)</span>approaches infinity, the volume of the n-dimensional unit sphere satisfies: <span class="math display">\[
\lim_{n \to \infty} V_n(R) = 0
\]</span></p>
<p>This indicates that in high-dimensional space, the volume of the sphere is concentrated near the spherical surface, and the interior of the sphere becomes “sparse”.–A topology problem</p>
</section>
</section>
<section id="chi-square-distribution" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-distribution">Chi-square distribution</h3>
</section>
<section id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2" class="level3">
<h3 class="anchored" data-anchor-id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Chi-square distribution <span class="math inline">\(f(x; k) = \frac{1}{2^{k/2} \Gamma(k/2)} x^{k/2 - 1} e^{-x/2}\)</span></h3>
<p>Assuming that <span class="math inline">\(Z \sim N(0, 1)\)</span><br>
<span class="math inline">\(W=Z^2\)</span><br>
So we can deduce the pdf for the variable W <span class="math display">\[
\begin{align}
f_W(w)&amp;=Pr(Z^2=w)\\
&amp; =f_Z(\sqrt{w}) \left| \frac{d(\sqrt{w})}{dw} \right| + f_Z(-\sqrt{w}) \left| \frac{d(-\sqrt{w})}{dw} \right|\\
&amp;=2 \cdot \frac{1}{\sqrt{2\pi}} e^{-w / 2} \cdot \frac{1}{2\sqrt{w}} = \frac{1}{\sqrt{2\pi w}} e^{-w / 2}\\
\end{align}
\]</span></p>
<p><span class="math inline">\(\Gamma(z) = \int_0^\infty t^{z-1} e^{-t} \, dt\)</span><br>
<span class="math inline">\(\Gamma(1/2)\)</span>=<span class="math inline">\(\sqrt(\pi)\)</span>,we can know that <span class="math inline">\(W\sim \chi^2(1)\)</span><br>
</p>
<p>Now, we can introduce the variable Y.<br>
<span class="math inline">\(Y=\sum_{i=1}^k Z_i^2\)</span> (<span class="math inline">\(Z_i\)</span> is independent of each other)<br>
We want to get the mgf of Y <span class="math display">\[
\begin{align}
M_Y(t)&amp;=E[e^{tY}]\\
&amp; =E[e^{tZ_1^2}e^{tZ_2^2}...e^{tZ_k^2}]\\
&amp; =E[e^{tZ_1^2}]E[e^{tZ_2^2}]...E[e^{tZ_k^2}] \\
&amp; = \prod_{i=1}^k M_{Z_i^2}(t)\\
&amp;=(1-2t)^{-r1/2}(1-2t)^{-r2/2}...(1-2t)^{-rk/2}\\
&amp; =(1-2t)^{-\sum_{i=1}^kri/2}\\
\end{align}
\]</span> Because the mgf of Chi-square function is <span class="math inline">\((1-2t)^{-r/2}\)</span><br>
r is the degree of freedom of this chi-square function<br>
So <span class="math inline">\(Y\sim \chi^2(r1+r2+...+rk)\)</span><br>
r1,r2…rk represents the degree of freedom of every single sample<br>
Here, df=1 for every sample</p>
</section>
<section id="student--t-distribution" class="level3">
<h3 class="anchored" data-anchor-id="student--t-distribution">Student- t distribution</h3>
</section>
<section id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom." class="level3">
<h3 class="anchored" data-anchor-id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom.">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Student- t distribution <span class="math inline">\(f(t) = \frac{\Gamma \left(\frac{\nu+1}{2}\right)}{\sqrt{\nu \pi} \, \Gamma \left(\frac{\nu}{2}\right)} \left(1 + \frac{t^2}{\nu}\right)^{-\frac{\nu+1}{2}}\)</span>, where <span class="math inline">\(\Gamma\)</span> is the gamma function and <span class="math inline">\(\nu\)</span> is the degrees of freedom.</h3>
<p>Given two independent variables Z and V (<span class="math inline">\(Z \sim N(0, 1)\)</span> &amp; <span class="math inline">\(V\sim \chi^2(\nu)\)</span>), then we construct a new variable <span class="math inline">\(T=\frac{Z}{\sqrt(V/\nu)}\)</span>.<br>
The joint pdf is <span class="math display">\[
g(z,v)=\frac{1}{\sqrt{2\pi}} e^{-\frac{z^2}{2}}\frac{1}{2^{\nu/2} \Gamma(\nu/2)} v^{\nu/2 - 1} e^{-v/2}
\]</span> Cdf of T is given by <span class="math display">\[
\begin{align}
F(t) &amp; =Pr(\frac{Z}{\sqrt(V/\nu)}\leq t)\\
&amp; =Pr(Z\leq {\sqrt(V/\nu)}t)\\
&amp; =\int_{0}^{\infty} \int_{-\infty}^{\sqrt(V/\nu)t} g(z,v) \, dz \, dv
\end{align}
\]</span> Simplify F(t) <span class="math display">\[
F(t)=\frac{1}{\sqrt{\pi}\Gamma(\nu/2)}\int_{0}^{\infty}[\int_{-\infty}^{\sqrt(V/\nu)t} \frac{e^{-z^2/2}}{2^\frac{\nu+1}{2}}dz]v^{\frac{\nu}{2}-1}e^{-\frac{v}{2}}dv
\]</span></p>
<p>To get pdf, we will differentiate F(t) <span class="math display">\[
\begin{align}
f(t) &amp;=F'(t)=\frac{1}{\sqrt{\pi}\Gamma(\nu/2)}\int_{0}^{\infty} \frac{e^{-(v/2)(t^2/\nu)}}{2^{\frac{\nu+1}{2}}}\sqrt\frac{v}{\nu}v^{\nu/2-1}e^{-\frac{v}{2}}dv\\
&amp;=\frac{1}{\sqrt{\pi\nu}\Gamma(\nu/2)}\int_{0}^{\infty}\frac{v^{(\nu+1)/2-1}}{2^{(\nu+1)/2}}e^{-(\nu/2)(1+t^2/\nu)}dv
\end{align}
\]</span> We need to make the change of variables: <span class="math inline">\(y=(1+t^2/\nu)v\)</span><br>
And we need to change dv: <span class="math inline">\(\frac{dv}{dy}=\frac{1}{1+t^2/\nu}\)</span></p>
<p><span class="math display">\[
\begin{align}
f(t)&amp;=\frac{\Gamma[(\nu+1)/2]}{\sqrt{\pi\nu}\Gamma(\nu/2)}[\frac{1}{(1+t^2/\nu)^{(\nu+1)/2}}]\int_{0}^{\infty}\frac{y^{(\nu+1)/2-1}}{\Gamma[(\nu+1)/2]2^{(\nu+1)/2}}e^{-y/2}dy
\end{align}
\]</span> This part <span class="math inline">\(\int_{0}^{\infty}\frac{y^{(\nu+1)/2-1}}{\Gamma[(\nu+1)/2]2^{(\nu+1)/2}}e^{-y/2}dy\)</span> is equal to 1, because this part is the whole area under the chi-square distribution with <span class="math inline">\(\nu+1\)</span> degrees of freedom. So, the pdf for T can be written as follows <span class="math display">\[
f(t)=\frac{\Gamma[(\nu+1)/2]}{\sqrt{\pi\nu}\Gamma(\nu/2)}\frac{1}{(1+t^2/\nu)^{(\nu+1)/2}}
\]</span></p>
</section>
<section id="f-distribution" class="level3">
<h3 class="anchored" data-anchor-id="f-distribution">F-distribution</h3>
</section>
<section id="we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution" class="level3">
<h3 class="anchored" data-anchor-id="we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution">We will do some trnsformation on chi-square distribution to get F-distribution</h3>
<p>Assuming that we have two independent random variables <span class="math display">\[
X \sim \chi^2(n_1) \quad and\quad  Y \sim \chi^2(n_2)\
\]</span> Now,we will define a new variable F <span class="math display">\[
F = \frac{(X / n_1)}{(Y / n_2)}
\]</span> This looks a little complex, so let’s do some simplification.</p>
<p><span class="math display">\[
U = \frac{X}{n_1} \quad \text{and} \quad V = \frac{Y}{n_2}\
\]</span></p>
<p>So, <span class="math inline">\(F = \frac{U}{V}\)</span>.<br>
Because, X and Y are independent of each other. Obviously, U and V are also independent of each other.<br>
</p>
<p><span class="math display">\[
f_{U,V}(u,v) = f_U(u) f_V(v)
\]</span> <span class="math display">\[
f_U(u) = \frac{(n_1 u)^{n_1/2 - 1} e^{-n_1 u/2}}{2^{n_1/2} \Gamma(n_1/2)}
\]</span> <span class="math display">\[
f_V(v) = \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)}
\]</span> To find the joint density function of F &amp; V, we use Jacobian transformation <span class="math display">\[
J =\left| \frac{\partial(U,V)}{\partial(F,V)} \right| = \left| \begin{matrix}
\frac{\partial U}{\partial F} &amp; \frac{\partial U}{\partial V} \\
\frac{\partial V}{\partial F} &amp; \frac{\partial V}{\partial V}
\end{matrix} \right| = \left| \begin{matrix}
V &amp; F \\
0 &amp; 1
\end{matrix} \right| = V
\]</span> <span class="math display">\[
f_{F,V}(f,v) = f_{U,V}(u,v) \left| \frac{\partial(u,v)}{\partial(f,v)} \right|= f_{U,V}(u,v)v
\]</span> Then, we substitute<span class="math inline">\(f_U(u)\)</span> and <span class="math inline">\(f_V(v)\)</span> into <span class="math inline">\(f_{F,V}(f,v)\)</span> <span class="math display">\[
f_{F,V}(f,v) = \frac{(n_1 u)^{n_1/2 - 1} e^{-n_1 u/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v
\]</span> Use the condition u=fv <span class="math display">\[
\begin{align}
f_{F,V}(f,v) &amp;= \frac{(n_1 fv)^{n_1/2 - 1} e^{-n_1 fv/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v\\
&amp; =\frac{(n_1 f v)^{n_1/2 - 1} e^{-n_1 f v/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v\\
&amp; = \frac{n_1^{n_1/2-1} f^{n_1/2 - 1} v^{n_1/2 - 1} e^{-n_1 f v/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{n_2^{n_2/2-1} v^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v\\
&amp; = \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1} v^{(n_1 + n_2)/2 - 1} e^{-(n_1 f + n_2) v/2}}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)}
\end{align}
\]</span> We will integrate this density function with respect to V <span class="math display">\[
\begin{align}
f_F(f) &amp;= \int_0^\infty f_{F,V}(f,v) dv\\
&amp;= \int_0^\infty \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1} v^{(n_1 + n_2)/2 - 1} e^{-(n_1 f + n_2) v/2}}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)} dv\\
\end{align}
\]</span> Let’s do some substitutions to make it look simpler <span class="math display">\[
\begin{align}
c = \frac{n_1 f + n_2}{2}
\end{align}
\]</span> This is the definition of Gamma function <span class="math display">\[
\int_0^\infty v^{(n_1 + n_2)/2 - 1} e^{-c v} dv = \frac{\Gamma((n_1 + n_2)/2)}{c^{(n_1 + n_2)/2}}
\]</span></p>
<p>Then <span class="math display">\[
f_F(f) = \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1}}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)} \cdot \frac{\Gamma((n_1 + n_2)/2)}{\left(\frac{n_1 f + n_2}{2}\right)^{(n_1 + n_2)/2}}
\]</span> Let’s rewrite it in an approximate F-distribution pdf form <span class="math display">\[
f_F(f) = \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1} \Gamma((n_1 + n_2)/2)}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)} \cdot \left(\frac{2}{n_1 f + n_2}\right)^{(n_1 + n_2)/2}
\]</span></p>
</section>
<section id="beta-and-gamma" class="level3">
<h3 class="anchored" data-anchor-id="beta-and-gamma">beta and Gamma</h3>
<p>When considering the product of two Gamma functions <span class="math display">\[(\Gamma(a) \Gamma(b))\]</span>, we can write it as two independent integrals:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \left( \int_0^\infty t^{a-1} e^{-t} \, dt \right) \left( \int_0^\infty s^{b-1} e^{-s} \, ds \right)
\]</span></p>
<p>To convert this product into a double integral, we can use a change of variables. Consider using polar coordinates in the two independent integrals, which allows us to use certain integration techniques to simplify them. First, we transform the integration region from Cartesian coordinates to polar coordinates:</p>
<p><span class="math display">\[
t = r \cos \theta, \quad s = r \sin \theta
\]</span></p>
<p>The Jacobian determinant is <span class="math display">\[r\]</span>, so the integral can be rewritten as:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \int_0^\infty \int_0^\infty t^{a-1} e^{-t} s^{b-1} e^{-s} \, dt \, ds
\]</span></p>
<p>Using the polar coordinate transformation, the integral becomes:</p>
<p><span class="math display">\[
= \int_0^\frac{\pi}{2} \int_0^\infty (r \cos \theta)^{a-1} e^{-r \cos \theta} (r \sin \theta)^{b-1} e^{-r \sin \theta} r \, dr \, d\theta
\]</span></p>
<p>Separating all <span class="math display">\[r\]</span> and <span class="math display">\[\theta\]</span> related terms:</p>
<p><span class="math display">\[
= \int_0^\frac{\pi}{2} (\cos \theta)^{a-1} (\sin \theta)^{b-1} \, d\theta \int_0^\infty r^{a+b-1} e^{-r(\cos \theta + \sin \theta)} \, dr
\]</span></p>
<p>First, compute the <span class="math display">\[r\]</span> integral part:</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r(\cos \theta + \sin \theta)} \, dr = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}}
\]</span></p>
<p>Next, compute the <span class="math display">\[\theta\]</span> integral part:</p>
<p><span class="math display">\[
\int_0^\frac{\pi}{2} (\cos \theta)^{a-1} (\sin \theta)^{b-1} \, d\theta = B(a, b)
\]</span></p>
<p>where <span class="math display">\[B(a, b)\]</span> is the Beta function, defined as:</p>
<p><span class="math display">\[
B(a, b) = \int_0^1 t^{a-1} (1-t)^{b-1} \, dt
\]</span></p>
<p>Therefore, we get:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}} \cdot B(a, b)
\]</span></p>
<p>Since <span class="math display">\[\cos \theta + \sin \theta = 1\]</span> (in polar coordinates), we have:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \Gamma(a+b) B(a, b)
\]</span></p>
<p>Thus, the double integral form of the Gamma function product directly comes from the polar transformation and the application of the Beta function. This is an important mathematical technique used to simplify complex integrals and functional relationships.</p>
</section>
<section id="why-is-the-integral-result-as-shown" class="level3">
<h3 class="anchored" data-anchor-id="why-is-the-integral-result-as-shown">Why is the integral result as shown?</h3>
<p>The given integral,</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr,
\]</span></p>
<p>can be evaluated using the definition of the Gamma function. The Gamma function <span class="math display">\[\Gamma(z)\]</span> is defined as:</p>
<p><span class="math display">\[
\Gamma(z) = \int_0^\infty t^{z-1} e^{-t} \, dt.
\]</span></p>
<p>To see why the integral can be expressed in terms of the Gamma function, let’s rewrite the integral in a form that matches the Gamma function’s definition. The integral has the form:</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr.
\]</span></p>
<p>Let’s set <span class="math display">\[t = r (\cos \theta + \sin \theta)\]</span>, then <span class="math display">\[r = \frac{t}{\cos \theta + \sin \theta}\]</span> and <span class="math display">\[dr = \frac{dt}{\cos \theta + \sin \theta}\]</span>. Substituting these into the integral gives:</p>
<p><span class="math display">\[
\int_0^\infty \left( \frac{t}{\cos \theta + \sin \theta} \right)^{a+b-1} e^{-t} \cdot \frac{dt}{\cos \theta + \sin \theta}.
\]</span></p>
<p>Simplifying inside the integral:</p>
<p><span class="math display">\[
\int_0^\infty \frac{t^{a+b-1}}{(\cos \theta + \sin \theta)^{a+b}} e^{-t} \, dt.
\]</span></p>
<p>Since <span class="math display">\[(\cos \theta + \sin \theta)^{a+b}\]</span> is a constant with respect to <span class="math display">\[t\]</span>, it can be factored out of the integral:</p>
<p><span class="math display">\[
\frac{1}{(\cos \theta + \sin \theta)^{a+b}} \int_0^\infty t^{a+b-1} e^{-t} \, dt.
\]</span></p>
<p>The integral</p>
<p><span class="math display">\[
\int_0^\infty t^{a+b-1} e^{-t} \, dt
\]</span></p>
<p>is recognized as the Gamma function <span class="math display">\[\Gamma(a+b)\]</span>. Thus, we have:</p>
<p><span class="math display">\[
\frac{1}{(\cos \theta + \sin \theta)^{a+b}} \Gamma(a+b).
\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}}.
\]</span></p>
<p>This demonstrates why the integral is evaluated as shown:</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}}.
\]</span> (method 2 for integral calculation: x=uv,y=u(1-v) J=-u)</p>
</section>
</section>
<section id="three-main-sampling-distribution" class="level2">
<h2 class="anchored" data-anchor-id="three-main-sampling-distribution">Three Main Sampling distribution</h2>
<section id="chi-square-distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-distribution-1">Chi-square distribution</h3>
<p>Suppose <span class="math inline">\(X_1, \cdots, X_n \stackrel{\text { i.i.d. }}{\sim} \mathcal{N}(0,1)\)</span>.the distribution of the statistic <span class="math display">\[
X_1^2+\cdots+X_n^2
\]</span> is called a chi-square distribution with <span class="math inline">\(n\)</span> degrees of freedom, denoted by <span class="math inline">\(\chi^2(n)\)</span>.</p>
<p>Besides, random variable <span class="math inline">\(X_i^2 \sim \operatorname{Gamma}\left(\frac{1}{2}, \frac{1}{2}\right)\)</span> corresponds to the chi-squared distribution with 1 degree of freedom, denoted as <span class="math inline">\(\chi_1^2\)</span>.</p>
<p>This is derived by the MGF:</p>
<p>Since <span class="math display">\[
M_{X_1^2+\cdots+X_n^2}(t)=M_{X_1^2}(t) \times \cdots \times M_{X_n^2}(t)= \begin{cases}\infty &amp; t \geq \frac{1}{2} \\ (1-2 t)^{-\frac{n}{2}} &amp; t&lt;\frac{1}{2}\end{cases}
\]</span></p>
<p>This is the MGF of the <span class="math inline">\(\operatorname{Gamma}\left(\frac{n}{2}, \frac{1}{2}\right)\)</span> distribution, so <span class="math inline">\(X_1^2+\cdots+X_n^2 \sim \operatorname{Gamma}\left(\frac{n}{2}, \frac{1}{2}\right)\)</span>. This is called the chi-squared distribution with <span class="math inline">\(\mathbf{n}\)</span> degree of freedom, denoted <span class="math inline">\(\chi_n^2\)</span>.</p>
<section id="properties" class="level4">
<h4 class="anchored" data-anchor-id="properties">Properties</h4>
<ul>
<li><p>If <span class="math inline">\(W_1, \ldots, W_n\)</span> are independent <span class="math inline">\(\chi^2\)</span> random variables with, respectively, <span class="math inline">\(v_1, \cdots, v_n\)</span> degrees of freedom, then the random variable <span class="math inline">\(W_1+\cdots+W_n\)</span> follows a <span class="math inline">\(\chi^2\)</span>-distribution with <span class="math inline">\(v_1+\cdots+v_n\)</span> degree of freedom.</p></li>
<li><p>The random variable <span class="math inline">\(\frac{(\bar{X}-\mu)^2}{\sigma^2 / n}\)</span> follows a <span class="math inline">\(\chi^2\)</span>-distribution with 1 degree of freedom when <span class="math inline">\(X\)</span> follows a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.</p></li>
</ul>
</section>
<section id="code-to-plot-examples-of-chi-square-distribution" class="level4">
<h4 class="anchored" data-anchor-id="code-to-plot-examples-of-chi-square-distribution">Code to plot examples of Chi-square distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the density for different degrees of freedom</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">4</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>df8 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">8</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>df12 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">12</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>chi_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, df4, df8, df12)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chi_data, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df4, <span class="at">color =</span> <span class="st">"df=4"</span>)) <span class="sc">+</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df8, <span class="at">color =</span> <span class="st">"df=8"</span>)) <span class="sc">+</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df12, <span class="at">color =</span> <span class="st">"df=12"</span>)) <span class="sc">+</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Chi-Square Distribution"</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Degrees of Freedom"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"df=4"</span> <span class="ot">=</span> <span class="st">"blue"</span>,<span class="st">"df=8"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"df=12"</span> <span class="ot">=</span> <span class="st">"green"</span>)) <span class="sc">+</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="application" class="level4">
<h4 class="anchored" data-anchor-id="application">Application</h4>
<p>Chi-square distribution is primarily used in testing:</p>
<ul>
<li><p>Goodness-of-fit</p></li>
<li><p>Independence in contingency tables</p></li>
</ul>
</section>
</section>
<section id="students-t-distribution" class="level3">
<h3 class="anchored" data-anchor-id="students-t-distribution">Student’s t-distribution</h3>
<section id="construction" class="level4">
<h4 class="anchored" data-anchor-id="construction">Construction</h4>
<p>The statistic <span class="math inline">\(T=\frac{\bar{X}-\mu}{S / \sqrt{n}}\)</span> follows a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(v=n-1\)</span> degrees of freedom when <span class="math inline">\(X_1, \cdots, X_n\)</span> are i.i.d. normal RVs.</p>
<p><span class="math display">\[
\bar{X} \sim \mathcal{N}\left(\mu, \frac{\sigma^2}{n}\right) \quad \frac{\bar{X}-\mu}{\sigma / \sqrt{n}} \sim \mathcal{N}(0,1) \quad \frac{(n-1) s^2}{\sigma^2} \sim \chi_{n-1}^2
\]</span></p>
<p>If we know the population variance <span class="math inline">\(\sigma^2\)</span>, we can easily do inference using the statistic <span class="math inline">\(\frac{\bar{X}-\mu}{\sigma / \sqrt{n}}\)</span>. However, <span class="math inline">\(\sigma^2\)</span> is usually unknown in practice.</p>
<p><span class="math display">\[
\bar{X} \sim \mathcal{N}\left(\mu, \frac{\sigma^2}{n}\right) \quad \frac{\bar{X}-\mu}{\sigma / \sqrt{n}} \sim \mathcal{N}(0,1) \quad \frac{(n-1) s^2}{\sigma^2} \sim \chi_{n-1}^2
\]</span></p>
<p>We can construct the <span class="math inline">\(t\)</span>-statistic using the sample variance <span class="math inline">\(S^2\)</span> : <span class="math display">\[
T=\frac{\frac{\bar{X}-\mu}{\sigma / \sqrt{n}}}{\sqrt{\frac{(n-1) s^2}{\sigma^2} /(n-1)}}=\frac{\bar{X}-\mu}{S / \sqrt{n}}
\]</span></p>
<p>Notice the sample mean <span class="math inline">\(\bar{X}\)</span> and the sample variance <span class="math inline">\(S^2\)</span> are independent (the proof is beyond the scope of this course). So the <span class="math inline">\(T\)</span> is now a ratio of a standard normal variable and the square root of a <span class="math inline">\(\chi^2 \mathrm{RV}\)</span> divided by its degrees of freedom. This is the definition of a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
</section>
<section id="properties-1" class="level4">
<h4 class="anchored" data-anchor-id="properties-1">Properties</h4>
<p>The <span class="math inline">\(t\)</span>-distribution is primarily used in contexts where the underlying population is assumed to be normally distributed, especially when the sample size is small. Used extensively in problems that deal with inference about population mean <span class="math inline">\(\mu\)</span> when population variance <span class="math inline">\(\sigma^2\)</span> is unknown; problems where one is trying to determine if means from two samples are significantly different when population variances <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are unknown.</p>
</section>
<section id="code-to-plot-examples-of-t-distribution" class="level4">
<h4 class="anchored" data-anchor-id="code-to-plot-examples-of-t-distribution">Code to plot examples of t-distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the density for different degrees of freedom</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>df_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">30</span>)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>distributions <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df_values, <span class="cf">function</span>(df) <span class="fu">dt</span>(x, <span class="at">df =</span> df))</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the data</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>df_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df_values)) {</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  df_data[<span class="fu">paste0</span>(<span class="st">"df"</span>, df_values[i])] <span class="ot">&lt;-</span> distributions[[i]]</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the densities</span></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df1, <span class="at">color =</span> <span class="st">"df=1"</span>)) <span class="sc">+</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df2, <span class="at">color =</span> <span class="st">"df=2"</span>)) <span class="sc">+</span></span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df3, <span class="at">color =</span> <span class="st">"df=3"</span>)) <span class="sc">+</span></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df5, <span class="at">color =</span> <span class="st">"df=5"</span>)) <span class="sc">+</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df10, <span class="at">color =</span> <span class="st">"df=10"</span>)) <span class="sc">+</span></span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df30, <span class="at">color =</span> <span class="st">"df=30"</span>)) <span class="sc">+</span></span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(x), <span class="at">color =</span> <span class="st">"Standard Normal"</span>)) <span class="sc">+</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Distribution"</span>, </span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"df=1"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"df=2"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"df=3"</span> <span class="ot">=</span> <span class="st">"red"</span>, </span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"df=5"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"df=10"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"df=30"</span> <span class="ot">=</span> <span class="st">"green"</span>, </span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Standard Normal"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density of the t-distribution compared to the standard normal distribution"</span>,</span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="f-distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="f-distribution-1">F-distribution</h3>
<p>Let <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> be two independent RVs following <span class="math inline">\(\chi^2\)</span> distributions with <span class="math inline">\(\nu_1\)</span> and <span class="math inline">\(\nu_2\)</span> degrees of freedom, respectively. Then the distribution of the random variable <span class="math inline">\(F=\frac{U / \nu_1}{V / \nu_2}\)</span> is known as <span class="math inline">\(F\)</span>-distribution.</p>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example</h4>
<p>If <span class="math inline">\(S_1^2\)</span> and <span class="math inline">\(S_2^2\)</span> are the variances of independent RVs of size <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> taken from normal populations with variances <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> respectively, then <span class="math display">\[
F=\frac{S_1^2 / \sigma_1^2}{S_2^2 / \sigma_2^2}=\frac{\sigma_2^2 S_1^2}{\sigma_1^2 S_2^2}
\]</span> follows an <span class="math inline">\(F\)</span>-distribution with <span class="math inline">\(\nu_1=n_1-1\)</span> and <span class="math inline">\(\nu_2=n_2-1\)</span> degrees of freedom.</p>
</section>
<section id="code-to-plot-examples-of-f-distribution" class="level4">
<h4 class="anchored" data-anchor-id="code-to-plot-examples-of-f-distribution">Code to plot examples of F-distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the density for different degrees of freedom</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>df1_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>df2_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>distributions <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df1_values), <span class="cf">function</span>(i) <span class="fu">df</span>(x, <span class="at">df1 =</span> df1_values[i], <span class="at">df2 =</span> df2_values[i]))</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the data</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>df_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df1_values)) {</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  df_data[<span class="fu">paste0</span>(<span class="st">"df1"</span>, df1_values[i], <span class="st">"_df2"</span>, df2_values[i])] <span class="ot">&lt;-</span> distributions[[i]]</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the densities</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df11_df21, <span class="at">color =</span> <span class="st">"d1=1, d2=1"</span>)) <span class="sc">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df12_df21, <span class="at">color =</span> <span class="st">"d1=2, d2=1"</span>)) <span class="sc">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df15_df22, <span class="at">color =</span> <span class="st">"d1=5, d2=2"</span>)) <span class="sc">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df110_df21, <span class="at">color =</span> <span class="st">"d1=10, d2=1"</span>)) <span class="sc">+</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df1100_df2100, <span class="at">color =</span> <span class="st">"d1=100, d2=100"</span>)) <span class="sc">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">""</span>, </span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"d1=1, d2=1"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"d1=2, d2=1"</span> <span class="ot">=</span> <span class="st">"black"</span>, </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"d1=5, d2=2"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"d1=10, d2=1"</span> <span class="ot">=</span> <span class="st">"green"</span>, </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"d1=100, d2=100"</span> <span class="ot">=</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"F-distribution with different degrees of freedom"</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="application-1" class="level4">
<h4 class="anchored" data-anchor-id="application-1">Application</h4>
<p>Analysis of variance (ANOVA)</p>
</section>
</section>
</section>
</section>
<section id="estimation-of-population-characteristic" class="level1">
<h1>Estimation of Population Characteristic</h1>
<section id="point-estimation" class="level2">
<h2 class="anchored" data-anchor-id="point-estimation">Point Estimation</h2>
<p>A point estimate of a population characteristic is a single number that is based on sample data and represents a plausible value of the characteristic.</p>
</section>
</section>
<section id="interval-estimationconfidence-intervalci" class="level1">
<h1>Interval Estimation—Confidence interval(CI)</h1>
<p>An interval estimate of a parameter <span class="math inline">\(\theta\)</span> is an interval of the form <span class="math inline">\(\hat{\theta}_L&lt;\theta&lt;\hat{\theta}_U\)</span>, where <span class="math inline">\(\hat{\theta}_L\)</span> and <span class="math inline">\(\hat{\theta}_U\)</span> depend on the value of <span class="math inline">\(\hat{\theta}\)</span> for a particular sample and also on the sampling distribution of <span class="math inline">\(\hat{\Theta}\)</span>.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<ul>
<li><p>If we were to construct a 95% confidence interval for some population characteristics (population proportion p or population mean <span class="math inline">\(\mu\)</span>), we would be using a method that is successful 95% of the time.</p></li>
<li><p>This is also about the question relevant to “How to choose a sample size”</p></li>
</ul>
</section>
<section id="definition-1" class="level2">
<h2 class="anchored" data-anchor-id="definition-1">Definition</h2>
<p>A <span class="math inline">\(100(1-\alpha) \%\)</span> confidence interval is an interval of the form <span class="math inline">\(\hat{\theta}_L&lt;\theta&lt;\hat{\theta}_U\)</span>, where <span class="math inline">\(\hat{\theta}_L\)</span> and <span class="math inline">\(\hat{\theta}_U\)</span> are respectively values of <span class="math inline">\(\widehat{\Theta}_L\)</span> and <span class="math inline">\(\widehat{\Theta}_U\)</span> obtained for a particular sample, based on <span class="math display">\[
P\left(\widehat{\Theta}_L&lt;\theta&lt;\widehat{\Theta}_U\right)=1-\alpha \quad ; \quad 0&lt;\alpha&lt;1
\]</span> in the estimation of population parameter <span class="math inline">\(\theta\)</span>.</p>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<p>For confidence level of 95% CI for any normal distribution: About 95% of the values are within 1.96 standard deviations of the mean. (Recall the concept of Z-scores)</p>
<p>That is, if <span class="math inline">\(\text{Estimate}± (Z \times \sigma)\)</span> was used to generate an interval estimate over and over again with different samples, in the long run 95% of the resulting intervals would include the actual value of the characteristic being estimated.</p>
<ul>
<li>The confidence level 95% refers to the method used to construct the interval rather than to any particular interval, such as the one we obtained.</li>
</ul>
<section id="eg" class="level3">
<h3 class="anchored" data-anchor-id="eg">eg</h3>
<section id="proportion" class="level4">
<h4 class="anchored" data-anchor-id="proportion">Proportion</h4>
<ul>
<li>check to make sure that the three necessary conditions are met:</li>
</ul>
<p><span class="math inline">\(n\hat p \ge 10, n(1-\hat p) \ge 10\)</span></p>
<p><span class="math inline">\(\frac {\hat p -p }{\sigma/\sqrt n} = 1.96\)</span>)</p>
<ul>
<li>sample size question</li>
</ul>
<p>Using sample proportion with 95% confidence interval, and we want ME no more than 5%, we may be interested in solving n from the following equation:</p>
<p>0.05=1.96 <span class="math inline">\(\sqrt {\frac {\hat p(1-\hat p) }{ n}}\)</span></p>
</section>
<section id="ci-on-mean" class="level4">
<h4 class="anchored" data-anchor-id="ci-on-mean">CI on Mean</h4>
<p>Here, <span class="math inline">\(\bar x\)</span> is the sample mean from a simple random sample.</p>
<p><span class="math inline">\(\mu\)</span> is the population mean which we are interested in estimating.</p>
<section id="ci-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics" class="level5">
<h5 class="anchored" data-anchor-id="ci-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics">CI on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\sigma\)</span> known n <span class="math inline">\(\ge 30\)</span> or the population is normal — Use z-statistics</h5>
<p>CI: <span class="math inline">\(\bar x \pm z_{\alpha/2} \frac {\sigma}{\sqrt n}\)</span>, for example, 95% CI is <span class="math inline">\(\bar x \pm 1.96 \frac {\sigma}{\sqrt n}\)</span></p>
</section>
<section id="one-side-confidence-bound-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics" class="level5">
<h5 class="anchored" data-anchor-id="one-side-confidence-bound-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics">One-side Confidence Bound on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\sigma\)</span> known n <span class="math inline">\(\ge 30\)</span> or the population is normal — Use z-statistics</h5>
<p>Upper one-side bound: <span class="math inline">\(\mu &lt;\bar x + z_{\alpha} \frac {\sigma}{\sqrt n}\)</span></p>
<p>Lower one-side bound: <span class="math inline">\(\mu &gt;\bar x - z_{\alpha} \frac {\sigma}{\sqrt n}\)</span></p>
<p>For example, 95% Confidence bound on <span class="math inline">\(\mu\)</span> is <span class="math inline">\(\bar x \pm 1.645 \frac {\sigma}{\sqrt n}\)</span></p>
</section>
<section id="ci-on-mu-with-sigma-unknown-and-the-population-is-normal-use-t-statistics-use-s-as-the-estimate-for-σ-t-statistics-with-df-n-1" class="level5">
<h5 class="anchored" data-anchor-id="ci-on-mu-with-sigma-unknown-and-the-population-is-normal-use-t-statistics-use-s-as-the-estimate-for-σ-t-statistics-with-df-n-1">CI on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\sigma\)</span> unknown and the population is normal — Use t-statistics (use s as the estimate for σ (t-statistics with df = n-1))</h5>
<p>CI: <span class="math inline">\(\bar x \pm t_{\alpha/2} \frac {s}{\sqrt n}\)</span>, for example, 95% CI is <span class="math inline">\(\bar x \pm t_{0.025} \frac {s}{\sqrt n}\)</span> and df = n-1</p>
<p>Remark: The distribution of t is more spread out than the standard normal distribution but when n <span class="math inline">\(\ge 30\)</span>, t and z are very close to each other.</p>
</section>
<section id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-known" class="level5">
<h5 class="anchored" data-anchor-id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-known">CI for <span class="math inline">\(\mu_1 - \mu_2\)</span>, both <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are known</h5>
<p>CI of <span class="math inline">\(\mu_1-\mu_2\)</span>: <span class="math inline">\((\bar x_1 - \bar x_2) \pm z_{\alpha/2} \sqrt {\frac {\sigma_1^2}{n_1} + \frac {\sigma_2^2}{n_2}}\)</span></p>
</section>
<section id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-unknown-but-assumed-equal" class="level5">
<h5 class="anchored" data-anchor-id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-unknown-but-assumed-equal">CI for <span class="math inline">\(\mu_1 - \mu_2\)</span>, both <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are unknown but assumed equal</h5>
<p>CI of <span class="math inline">\(\mu_1-\mu_2\)</span>: <span class="math inline">\((\bar x_1 - \bar x_2) \pm t_{\alpha/2} s_p \sqrt {\frac {1}{n_1} + \frac {1}{n_2}}\)</span> with df = <span class="math inline">\(n_1+n_2-2\)</span> where <span class="math inline">\(s_p = \sqrt {\frac {(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1+n_2-2}}\)</span></p>
</section>
<section id="ci-for-paired-observations" class="level5">
<h5 class="anchored" data-anchor-id="ci-for-paired-observations">CI for paired observations</h5>
<p>Previous, we have two independent samples, now we have two dependent samples. We can use the difference between the two samples to construct a confidence interval.</p>
<p>CI of <span class="math inline">\(\mu_d\)</span>: <span class="math inline">\(\bar d \pm t_{\alpha/2} \frac {s_d}{\sqrt n}\)</span> with df = n-1 where <span class="math inline">\(s_d\)</span> is the sample standard deviation of the differences <span class="math inline">\(d_i = x_{1i} - x_{2i}\)</span> and <span class="math inline">\(\bar d\)</span> is the sample mean of the differences.</p>
</section>
<section id="estimating-sigma" class="level5">
<h5 class="anchored" data-anchor-id="estimating-sigma">Estimating <span class="math inline">\(\sigma\)</span></h5>
<p>a <span class="math inline">\(100(1-\alpha)\%\)</span> CI for <span class="math inline">\(\sigma^2\)</span> is <span class="math inline">\(\left(\frac{(n-1) S^2}{\chi_{\alpha / 2, n-1}^2}, \frac{(n-1) S^2}{\chi_{1-\alpha / 2, n-1}^2}\right)\)</span></p>
<p>where <span class="math inline">\(S^2\)</span> is the sample variance and <span class="math inline">\(\chi_{\alpha / 2, n-1}^2\)</span> and <span class="math inline">\(\chi_{1-\alpha / 2, n-1}^2\)</span> are the critical values of the chi-square distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
</section>
<section id="estimating-sigma_12-sigma_22" class="level5">
<h5 class="anchored" data-anchor-id="estimating-sigma_12-sigma_22">Estimating <span class="math inline">\(\sigma_1^2/ \sigma_2^2\)</span></h5>
<p>A <span class="math inline">\(100(1-\alpha)\%\)</span> CI for <span class="math inline">\(\frac{\sigma_1^2}{\sigma_2^2}\)</span> using F-statistics with <span class="math inline">\(f_{1-\alpha/2}(n_1-1,n_2-1)=1/f_{\alpha/2}(n_1-1,n_2-1)\)</span> is <span class="math display">\[
\frac{s_1^2}{s_2^2} \frac{1}{f_{\alpha / 2}\left(n_1-1, n_2-1\right)}&lt;\frac{\sigma_1^2}{\sigma_2^2}&lt;\frac{s_1^2}{s_2^2} f_{\alpha / 2}\left(n_2-1, n_1-1\right)
\]</span> where <span class="math inline">\(f_{\alpha / 2}\left(v_1, v_2\right)\)</span> is an <span class="math inline">\(F\)</span>-value with <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span> degrees of freedom, leaving an area of <span class="math inline">\(\alpha / 2\)</span> to the right, and <span class="math inline">\(f_{\alpha / 2}\left(v_2, v_1\right)\)</span> is a similar <span class="math inline">\(F\)</span>-value with <span class="math inline">\(v_2\)</span> and <span class="math inline">\(v_1\)</span> degrees of freedom.</p>
</section>
</section>
</section>
</section>
</section>
<section id="hypothesis-testing" class="level1">
<h1>Hypothesis Testing</h1>
<p><img src="images/clipboard-2219722049.png" class="img-fluid"></p>
<ul>
<li>z-test</li>
</ul>
<p>Suppose <span class="math inline">\(X_1, \cdots, X_n \xrightarrow[\sim]{\text { iid }} \mathcal{N}\left(\mu, \sigma^2\right)\)</span>, where <span class="math inline">\(\mu\)</span> is unknown and where <span class="math inline">\(\sigma^2=\sigma_0^2\)</span> is known.</p>
<p>Suppose we wish to test <span class="math inline">\(H_0: \mu=\mu_0\)</span> against <span class="math inline">\(H_1: \mu&gt;\mu_0\)</span>. Then we can use the test statistic <span class="math display">\[
Z=\frac{\bar{X}-\mu_0}{\sigma_0 / \sqrt{n}}
\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true then <span class="math inline">\(Z \sim \mathcal{N}(0,1)\)</span>. Let <span class="math display">\[
z_{\mathrm{obs}}=\frac{\bar{x}-\mu_0}{\sigma_0 / \sqrt{n}}
\]</span></p>
<p>A large value of <span class="math inline">\(z_{\text {obs }}\)</span> casts doubt on the validity of <span class="math inline">\(H_0\)</span> and indicates a departure from <span class="math inline">\(H_0\)</span> in the direction of <span class="math inline">\(H_1\)</span>. So the <span class="math inline">\(p\)</span>-value for testing <span class="math inline">\(H_0\)</span> against <span class="math inline">\(H_1\)</span> is <span class="math display">\[
\begin{aligned}
p &amp; =P\left(Z \geq Z_{\mathrm{obs}} \mid H_0\right) \\
&amp; =P\left(\mathcal{N}(0,1) \geq Z_{\mathrm{obs}}\right) \\
&amp; =1-\Phi\left(Z_{\mathrm{obs}}\right)
\end{aligned}
\]</span></p>
<p>The z-test of <span class="math inline">\(H_0: \mu=\mu_0\)</span> against the alternative <span class="math inline">\(H_1: \mu&lt;\mu_0\)</span> is similar but this time a small, i.e.&nbsp;very negative, value of <span class="math inline">\(Z_{\text {obs }}\)</span> casts doubt on <span class="math inline">\(H_0\)</span>. So the <span class="math inline">\(p\)</span>-value is <span class="math display">\[
\begin{aligned}
p &amp; =P\left(Z \leq Z_{\mathrm{obs}} \mid H_0\right) \\
&amp; =P\left(\mathcal{N}(0,1) \leq Z_{\mathrm{obs}}\right) \\
&amp; =\Phi\left(Z_{\mathrm{obs}}\right)
\end{aligned}
\]</span></p>
<p>Finally, consider testing <span class="math inline">\(H_0: \mu=\mu_0\)</span> against the alternative <span class="math inline">\(H_1: \mu \neq\)</span> <span class="math inline">\(\mu_0\)</span>. Let <span class="math inline">\(z_0=\left|z_{\text {obs }}\right|\)</span>. A large value of <span class="math inline">\(z_0\)</span> indicates a departure from <span class="math inline">\(H_0\)</span>, so the <span class="math inline">\(p\)</span>-value is <span class="math display">\[
\begin{aligned}
p &amp; =P\left(|Z| \geq z_0 \mid H_0\right) \\
&amp; =P\left(\mathcal{N}(0,1) \geq z_0\right)+P\left(\mathcal{N}(0,1) \leq-z_0\right) \\
&amp; =2\left(1-\phi\left(z_0\right)\right)
\end{aligned}
\]</span></p>
<ul>
<li>t-test</li>
</ul>
<p>We can use the test statistic <span class="math display">\[
T=\frac{\bar{X}-\mu_0}{S / \sqrt{n}}
\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true then <span class="math inline">\(T \sim t_{n-1}\)</span>. Let <span class="math inline">\(t_{\mathrm{obs}}=t(x)=\frac{\bar{x}-\mu_0}{s / \sqrt{n}}\)</span> and <span class="math inline">\(t_0=\left|t_{\mathrm{obs}}\right|\)</span>. Similarly, we have <span class="math inline">\(\square\)</span> the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(P\left(t_{n-1} \geq t_{\mathrm{obs}}\right)\)</span> - the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(P\left(t_{n-1} \leq t_{\text {obs }}\right)\)</span> the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(2 P\left(t_{n-1} \geq t_0\right)\)</span></p>
<section id="example-of-one-sample-t-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-one-sample-t-test">Example of one-sample t-test</h2>
<p>A marine biologist is studying a species of fish known to have an average length of 20 cm in ocean populations. A new population in a freshwater lake is being analyzed to determine if the environmental differences have altered the fish’s average length. The biologist measures the lengths of 10 randomly selected fish, yielding the following data:</p>
<p>22, 23, 21, 24, 22, 20, 25, 19, 23, 22</p>
<p>Assuming the data satisfy the assumption of normality, please address the following using a significance level of 0.1:</p>
<section id="a" class="level3">
<h3 class="anchored" data-anchor-id="a">a</h3>
<ul>
<li><p>null hypothesis: The mean length of fish is 20 cm (<span class="math inline">\(H_0: \mu = 20\)</span>).</p></li>
<li><p>alternative hypothesis: The mean length of fish is not 20 cm (<span class="math inline">\(H_1: \mu \ne 20\)</span>).</p></li>
</ul>
</section>
<section id="b" class="level3">
<h3 class="anchored" data-anchor-id="b">b</h3>
<p>Since the data is supposed to be normally distributed, the sampling distribution of the sample mean follows t-distribution. The t-test statistic is calculated as follows:</p>
<p><span class="math display">\[t = \frac{\bar x - \mu}{s / \sqrt n}\]</span></p>
<p>The t-test statistic is calculated as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data2_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">22</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(data2_4)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(data2_4)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (x_bar <span class="sc">-</span> <span class="dv">20</span>) <span class="sc">/</span> (s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(data2_4)))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.705882</code></pre>
</div>
</div>
<p>The t-test statistic is 3.705882…</p>
</section>
<section id="c" class="level3">
<h3 class="anchored" data-anchor-id="c">c</h3>
<p>Using pt() function, the p-value is calculated as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span>t, <span class="at">df =</span> <span class="dv">9</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>p_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004875954</code></pre>
</div>
</div>
<p>The p-value is approximately 0.1. Since the p-value is less than 0.1, we reject the null hypothesis.</p>
<p>Therefore, there is sufficient evidence to conclude that the population mean is not equal to 20 which means the environmental differences have altered the fish’s average length.</p>
</section>
<section id="d" class="level3">
<h3 class="anchored" data-anchor-id="d">d</h3>
<p>Using qt() function to find the critical value for a two-tailed test with 90% confidence level:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>t_critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="at">df =</span> <span class="dv">9</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>t_critical</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.833113</code></pre>
</div>
</div>
<p>The critical value for a two-tailed test with 90% confidence level is about 1.833113.</p>
<p>Since the t-test statistic 3.705882 is greater than the critical value 1.833113, which is in the critical region. Therefore, we reject the null hypothesis.</p>
<p>Also, we could use confidence interval to verify the result. The 90% confidence interval for the population mean is calculated as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ci_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(x_bar <span class="sc">-</span> t_critical <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>), x_bar <span class="sc">+</span> t_critical <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>))</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ci_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.06124 23.13876</code></pre>
</div>
</div>
<p>So the 90% confidence interval for the population mean is about (21.1, 23.2).</p>
<p>The confidence interval does not contain the hypothesized value 20. Therefore, we reject the null hypothesis.</p>
<p>Therefore, there is sufficient evidence to conclude that the population mean is not equal to 20 which means the environmental differences have altered the fish’s average length.</p>
</section>
</section>
<section id="example-of-unpaired-t-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-unpaired-t-test">Example of unpaired t-test</h2>
<p>Suppose <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are unknown but assumed equal. We want to test the null hypothesis <span class="math inline">\(H_0: \mu_1 = \mu_2\)</span> against the alternative hypothesis <span class="math inline">\(H_1: \mu_1 \ne \mu_2\)</span>. The test statistic is given by</p>
<p><span class="math display">\[
t = \frac{\bar x_1 - \bar x_2}{s_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}
\]</span></p>
<p>where <span class="math inline">\(s_p\)</span> is the pooled sample standard deviation, given by</p>
<p><span class="math display">\[
s_p = \sqrt{\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}}
\]</span></p>
<p><img src="images/clipboard-3291557304.png" class="img-fluid"></p>
</section>
<section id="example-of-one-sample-variance-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-one-sample-variance-test">Example of one-sample Variance Test</h2>
<p><span class="math inline">\(\chi^2\)</span>-test for variance. Suppose <span class="math inline">\(X_1, \cdots, X_n\)</span> are i.i.d. normal random variables with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. We want to test the null hypothesis <span class="math inline">\(H_0: \sigma^2 = \sigma_0^2\)</span> against the alternative hypothesis <span class="math inline">\(H_1: \sigma^2 \ne \sigma_0^2\)</span>. The test statistic is given by</p>
<p><span class="math display">\[
\chi^2 = \frac{(n - 1)s^2}{\sigma^2}
\]</span></p>
</section>
<section id="example-of-two-sample-variance-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-two-sample-variance-test">Example of two-sample Variance Test</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 22%">
<col style="width: 20%">
<col style="width: 36%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\(H_0\)</span></th>
<th style="text-align: left;">Test Statistic</th>
<th style="text-align: left;"><span class="math inline">\(H_1\)</span></th>
<th style="text-align: left;">Rejection Region</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f=\frac{s_1^2}{s_2^2}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2&lt;\sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f&lt;f_\alpha\left(\nu_1, \nu_2\right)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2&gt;\sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f&gt;f_{1-\alpha}\left(\nu_1, \nu_2\right)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2 \neq \sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f&lt;f_{\alpha / 2}\left(\nu_1, \nu_2\right)\)</span> or <span class="math inline">\(f&gt;f_{1-\alpha / 2}\left(\nu_1, \nu_2\right)\)</span></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\nu_1=n_1-1\)</span> and <span class="math inline">\(\nu_2=n_2-1\)</span> are two degree of freedom.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
F=\frac{\frac{\left(n_1-1\right) S_1^2}{\sigma_1^2} /\left(n_1-1\right)}{\frac{\left(n_2-1\right) S_2^2}{\sigma_2^2} /\left(n_2-1\right)}=\frac{\sigma_2^2 S_1^2}{\sigma_1^2 S_2^2}
\]</span></p>
<p>If <span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span>, we have <span class="math display">\[
F=\frac{S_1^2}{S_2^2} \sim F_{n_1-1, n_2-1}
\]</span></p>
</section>
<section id="anova-analysis-of-variance" class="level2">
<h2 class="anchored" data-anchor-id="anova-analysis-of-variance">ANOVA– Analysis of Variance</h2>
<ul>
<li>one-way ANOVA</li>
</ul>
<p>we need to test the null hypothesis that the group population means are all the same against the alternative that at least one group population mean differs from the others. That is,</p>
<p><span class="math inline">\(H_0: \mu_1=\mu_2=\cdots=\mu_k\)</span> against <span class="math inline">\(H_1: \text { at least one } \mu_i \text { differs from the others.}\)</span></p>
<p>ANOVA Table</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Mean Sq</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">p value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: right;">m-1</td>
<td style="text-align: right;">11.84 (SS between)</td>
<td style="text-align: right;">2.9587 (MSB)</td>
<td style="text-align: right;">8.074 (MSB/MSW)</td>
<td style="text-align: right;"><span class="math inline">\(5.38 \mathrm{e}-05\)</span> (p-value)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Error</td>
<td style="text-align: right;">n-m</td>
<td style="text-align: right;">16.49 (SS Within)</td>
<td style="text-align: right;">0.3664 (MSW)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">n-1</td>
<td style="text-align: right;">28.33 (SS Total)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p>Source means “the source of the variation in the data.” the possible sources for a one-factor study are Factor, Residuals, and Total.</p>
<p>Factor means “the variability due to the factor of interest.” In the drug example, the factor was the different drug. In the learning example on the previous page, the factor was the method of learning. Sometimes the row heading is labeled as Between.</p>
<p>Error (or Residuals) means “the variability within the groups” or “unexplained random error.” Sometimes the row heading is labeled as Within.</p>
<p>Total means “the total variation in the data from the grand mean”.</p>
<p>DF means “the degrees of freedom in the source.”</p>
<p>Sum Sq means “the sum of squares due to the source.”</p>
<p>Mean Sq means “the mean sum of squares due to the source.”</p>
<p>F value means “the F-statistic.”</p>
<p>P value means “the P-value.”</p>
<p>SS(Total)=SS(Between)+SS(Within), where</p>
<p>SS(Between) is the sum of squares between the group means and the grand mean. As the name suggests, it quantifies the variability between the groups of interest.</p>
<p>SS(Within) is the sum of squares between the data and the group means. It quantifies the variability within the groups of interest.</p>
<p>SS(Total) is the sum of squares between the n data points and the grand mean. As the name suggests, it quantifies the total variability in the observed data.</p>
<ul>
<li>two-way ANOVA</li>
</ul>
<p>We can extend the idea of a one-way ANOVA, which tests the effects of one factor on a response variable, to a two-way ANOVA which tests the effects of two factors and their interaction on a response variable.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 39%">
<col style="width: 15%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: left;">DF</th>
<th style="text-align: left;">Sum Sq</th>
<th style="text-align: left;">MSW</th>
<th style="text-align: left;">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cells</td>
<td style="text-align: left;"><span class="math inline">\(a b-1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{i=1}^a \sum_{j=1}^b n\left(\bar{X}_{i j}-\bar{X}_{\ldots . .}\right)^2\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: left;">a-1</td>
<td style="text-align: left;">bn <span class="math inline">\(\sum_{i=1}^a\left(\bar{X}_{i . .}-\bar{X}_{\ldots .}\right)^2\)</span></td>
<td style="text-align: left;">SS(A)</td>
<td style="text-align: left;">MS(Error</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: left;">b-1</td>
<td style="text-align: left;">an <span class="math inline">\(\sum_{j=1}^b\left(\bar{X}_{. j .}-\bar{X}_{\ldots .}\right)^2\)</span></td>
<td style="text-align: left;">SS(B)</td>
<td style="text-align: left;">MS(B)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\mathrm{A} \times \mathrm{B}\)</span></td>
<td style="text-align: left;"><span class="math inline">\((a-1)(b-1)\)</span></td>
<td style="text-align: left;">SS(Cells)-SS(A)-SS(B)</td>
<td style="text-align: left;">SS(AB)</td>
<td style="text-align: left;">MS(Error</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">DF(A <span class="math inline">\(\times\)</span> B)</td>
<td style="text-align: left;">MS(Error</td>
</tr>
<tr class="even">
<td style="text-align: left;">Error</td>
<td style="text-align: left;"><span class="math inline">\(a b(n-1)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{i=1}^a \sum_{j=1}^b \sum_{l=1}^n\left(X_{i j l}-\bar{X}_{i j} .\right)^2\)</span></td>
<td style="text-align: left;">SS(Error)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;"><span class="math inline">\(a b n-1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{i=1}^a \sum_{j=1}^b n\left(X_{i j l}-\bar{X}_{\ldots .}\right)^2\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<ul>
<li><p><span class="math inline">\(F=\frac{\mathrm{MS}(\mathrm{A})}{\mathrm{MS}(\text { Error })}\)</span>, for <span class="math inline">\(H_0\)</span> : no effect of factor A on response variable,</p></li>
<li><p><span class="math inline">\(F=\frac{\mathrm{MS}(\mathrm{B})}{\mathrm{MS}(\text { Error) }}\)</span>, for <span class="math inline">\(H_0\)</span> : no effect of factor B on response variable,</p></li>
<li><p><span class="math inline">\(F=\frac{\mathrm{MS}(\mathrm{A} \times \mathrm{B})}{\mathrm{MS}(\text { Error })}\)</span>, for <span class="math inline">\(H_0\)</span> : no effect of interaction on response variable.</p></li>
</ul>
<p>We reject any <span class="math inline">\(H_0\)</span> if <span class="math inline">\(F \geq F_{\text {critical }}\)</span>; otherwise, we do not reject <span class="math inline">\(H_0\)</span>.</p>
<section id="example-of-two-way-anova" class="level3">
<h3 class="anchored" data-anchor-id="example-of-two-way-anova">Example of two-way ANOVA</h3>
<p>Two-way ANOVA. In this question, we will use the built-in R data set ToothGrowth to perform two-way ANOVA test. ToothGrowth includes information from a study on the effects of vitamin C on tooth growth in Guinea pigs. The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC). Assuming the data satisfy the assumptions of normality and equal variance, please address the following using a significance level of 0.05</p>
<section id="a-1" class="level4">
<h4 class="anchored" data-anchor-id="a-1">a</h4>
<ul>
<li><p>The effects of vitamin C on tooth growth in guinea pigs:</p></li>
<li><p>null hypothesis: <span class="math inline">\(H_0\)</span>: mean tooth growth for all doses of vitamin C are equal</p></li>
<li><p>alternative hypothesis: <span class="math inline">\(H_1\)</span>: at least one of the means of all doses of vitamin C is different from the others</p></li>
<li><p>The effects of delivery method on tooth growth in guinea pigs:</p></li>
<li><p>null hypothesis: <span class="math inline">\(H_0\)</span>: mean tooth growth for the delivery method of orange juice and ascorbic acid are equal.</p></li>
<li><p>alternative hypothesis <span class="math inline">\(H_1\)</span>: mean tooth growth for the delivery method of orange juice and ascorbic acid are different.</p></li>
<li><p>The interaction effects of the dose of vitamin C and delivery method on tooth growth in guinea pigs:</p></li>
<li><p>null hypothesis: <span class="math inline">\(H_0:\)</span> there is no interaction between the dose of vitamin C and delivery method on tooth growth in guinea pigs, meaning that the relationship between vitamin C and tooth growth is the same for both delivery methods (similarly, the relationship between delivery method and tooth growth is the same for all doses of vitamin C).</p></li>
<li><p>alternative hypothesis: <span class="math inline">\(H_1\)</span>: there is an interaction between the dose vitamin C and delivery method on tooth growth in guinea pigs, meaning that the relationship between vitamin C and tooth growth is different for both delivery methods (similarly, the relationship between delivery method and tooth growth depends on the dose of vitamin C).</p></li>
</ul>
</section>
<section id="b-1" class="level4">
<h4 class="anchored" data-anchor-id="b-1">b</h4>
<p>We can plot the relationship one by one using two plots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ToothGrowth)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ToothGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   len supp dose
1  4.2   VC  0.5
2 11.5   VC  0.5
3  7.3   VC  0.5
4  5.8   VC  0.5
5  6.4   VC  0.5
6 10.0   VC  0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># potential effects of vitamin C on tooth growth.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(dose), <span class="at">y =</span> len)) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dose (mg/day)"</span>, <span class="at">y =</span> <span class="st">"Tooth Growth (len)"</span>, <span class="at">title =</span> <span class="st">"Tooth Growth by Dose of vitamin C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># potential effects of delivery method on tooth growth.</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> supp, <span class="at">y =</span> len)) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Delivery Method"</span>, <span class="at">y =</span> <span class="st">"Tooth Growth (len)"</span>, <span class="at">title =</span> <span class="st">"Tooth Growth by Delivery Method"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>or just one:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="co"># potential effects of vitamin C and delivery method. </span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># OJ represents orange juice and VC represents ascorbic acid.</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(dose), <span class="at">y =</span> len, <span class="at">fill =</span> supp)) <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dose (mg/day)"</span>, <span class="at">y =</span> <span class="st">"Tooth Growth (len)"</span>, <span class="at">title =</span> <span class="st">"Tooth Growth by Dose and Delivery Method"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="c-1" class="level4">
<h4 class="anchored" data-anchor-id="c-1">c</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform two-way ANOVA</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
supp         1  205.4   205.4  12.317 0.000894 ***
dose         1 2224.3  2224.3 133.415  &lt; 2e-16 ***
supp:dose    1   88.9    88.9   5.333 0.024631 *  
Residuals   56  933.6    16.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Since all p-values are less than 0.05, we reject all null hypotheses. Therefore, there is sufficient evidence to conclude that the dose of vitamin C, delivery method, and their interaction have significant effects on tooth growth in guinea pigs.</p>
</section>
<section id="d-1" class="level4">
<h4 class="anchored" data-anchor-id="d-1">d</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(anova_result<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">"QQ-plot of residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22 50</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="non-parametric-tests" class="level2">
<h2 class="anchored" data-anchor-id="non-parametric-tests">Non-parametric tests</h2>
<section id="application-of-testing-the-goodness-of-fit" class="level3">
<h3 class="anchored" data-anchor-id="application-of-testing-the-goodness-of-fit">Application of testing the goodness of fit</h3>
<p>Testing whether there is a “good fit” between the observed data and the assumed probability model amounts to testing:</p>
<section id="construction-of-test-statistics-with-an-example-of-2-categories" class="level4">
<h4 class="anchored" data-anchor-id="construction-of-test-statistics-with-an-example-of-2-categories">Construction of test statistics with an example of 2 categories</h4>
<p>Population is 60% female and 40% male. Then, if a sample of 100 students yields 53 females and 47 males, can we conclude that the sample is (random and) representative of the population? That is, how “good” do the data “fit” the assumed probability model of 60% female and 40% male?</p>
<p>Here, let <span class="math inline">\(Y_1\)</span> denote the number of females selected, <span class="math inline">\(Y_1 \sim B(n,p_1)\)</span> and let <span class="math inline">\(Y_2\)</span> denote males selected, <span class="math inline">\(Y_2 = (n-Y_1)\sim B(n,p_2)=B(n,1-p_1)\)</span>.</p>
<p>for samples satisfying the general rule of thumb (the expected number of successes must be at least 5 and the expected number of failures must be at least 5), we can use the normal approximation to the binomial distribution. The test statistic is given by</p>
<p><span class="math display">\[
Z = \frac{Y_1 - np_1}{\sqrt{np_1(1-p_1)}}\sim N(0,1)
\]</span></p>
<p>which is at least approximately normally distributed.</p>
<p>and <span class="math display">\[
Z^2 =Q_1= \frac{(Y_1 - np_1)^2}{np_1(1-p_1)}\sim \chi^2(1)
\]</span></p>
<p>which is an approximate chi-square distribution with one degree of freedom.</p>
<p>Now we can multiply <span class="math inline">\(Q_1\)</span> by 1 = <span class="math inline">\((1-p_1)+p_1\)</span> to get</p>
<p><span class="math display">\[
Q_1 = \frac{(Y_1 - np_1)^2(1-p_1)}{np_1(1-p_1)} + \frac{(Y_1 - np_1)^2p_1}{np_1(1-p_1)}\sim \chi^2(1)
\]</span></p>
<p>Since <span class="math inline">\(Y_1=n-Y_2\)</span> and <span class="math inline">\(p_1=1-p_2\)</span>, after simplifying, we have</p>
<p><span class="math display">\[
Q_1 = \frac{(Y_1-np_1)^2}{np_1} + \frac{(-(Y_2-np_2))^2}{np_2}\sim \chi^2(1)
\]</span></p>
<p>which is <span class="math inline">\(Q_1=\sum_{i=1}^2 \frac{\left(Y_i-n p_i\right)^2}{n p_i}=\sum_{i=1}^2 \frac{(\text { Observed }- \text { Expected })^2}{\text { Expected }}\sim \chi^2(1)\)</span></p>
<p>Hence, it is observed that if the observed counts are very different from the expected counts, then the test statistic will be large. So we reject the null hypothesis if <span class="math inline">\(Q_1\)</span> is large and how large is large is determined by the critical value of the chi-square distribution with one degree of freedom.</p>
<p>The statistics <span class="math inline">\(Q_1\)</span> is called the chi-square goodness of fit statistic.</p>
<p>Going back to the example,</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>:<span class="math inline">\(p_F = 0.6\)</span></p></li>
<li><p><span class="math inline">\(H_1\)</span>:<span class="math inline">\(p_F \ne 0.6\)</span></p></li>
</ul>
<p>we can calculate the test statistic using a significant level of <span class="math inline">\(\alpha = 0.05\)</span> (<span class="math inline">\(\chi^2_{0.05,1}=3.84\)</span>)as follows:</p>
<p><span class="math display">\[
Q_1 = \frac{(53-60)^2}{60} + \frac{(47-40)^2}{40} = 2.04
\]</span></p>
<p>Since <span class="math inline">\(Q_1=2.04&lt;3.84\)</span>, we do not reject the null hypothesis. Therefore, we conclude that the sample is (random and) representative of the population.</p>
<p><strong>This can be extended to k categories</strong></p>
</section>
<section id="construction-of-test-statistics-with-an-example-of-k-categories" class="level4">
<h4 class="anchored" data-anchor-id="construction-of-test-statistics-with-an-example-of-k-categories">Construction of test statistics with an example of k categories</h4>
<p>For categories more than 2, i.e.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Categories</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;"><span class="math inline">\(\cdots\)</span></th>
<th style="text-align: left;"><span class="math inline">\(k-1\)</span></th>
<th style="text-align: left;"><span class="math inline">\(k\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed</td>
<td style="text-align: left;"><span class="math inline">\(Y_1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Y_2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\cdots\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Y_{k-1}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n-Y_1-Y_2-\cdots-Y_{k-1}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Expected</td>
<td style="text-align: left;"><span class="math inline">\(n p_1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n p_2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\cdots\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n p_{k-1}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n p_k\)</span></td>
</tr>
</tbody>
</table>
<p>Karl Pearson showed that the chi-square statistic <span class="math inline">\(Q_{k-1}\)</span> defined as: <span class="math display">\[
Q_{k-1}=\sum_{i=1}^k \frac{\left(Y_i-n p_i\right)^2}{n p_i}
\]</span> follows approximately a chi-square random variable with <span class="math inline">\(k-1\)</span> degrees of freedom. Let’s try it out on an example.</p>
<ul>
<li>Example:</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Categories</th>
<th style="text-align: left;">Brown</th>
<th style="text-align: left;">Yellow</th>
<th style="text-align: left;">Orange</th>
<th style="text-align: left;">Green</th>
<th style="text-align: left;">Coffee</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed <span class="math inline">\(y_i\)</span></td>
<td style="text-align: left;">224</td>
<td style="text-align: left;">119</td>
<td style="text-align: left;">130</td>
<td style="text-align: left;">48</td>
<td style="text-align: left;">59</td>
<td style="text-align: left;">580</td>
</tr>
<tr class="even">
<td style="text-align: left;">Assumed <span class="math inline">\(H_0\left(p_i\right)\)</span></td>
<td style="text-align: left;">0.4</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Expected <span class="math inline">\(n p_i\)</span></td>
<td style="text-align: left;">232</td>
<td style="text-align: left;">116</td>
<td style="text-align: left;">116</td>
<td style="text-align: left;">58</td>
<td style="text-align: left;">58</td>
<td style="text-align: left;">580</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(Q_4=\frac{(224-232)^2}{232}+\frac{(119-116)^2}{116}+\frac{(130-116)^2}{116}+\frac{(48-58)^2}{58}+\frac{(59-58)^2}{58}=3.784\)</span></p>
<p>Because there are <span class="math inline">\(k=5\)</span> categories, we have to compare our chisquare statistic <span class="math inline">\(Q_4\)</span> to a chi-square distribution with <span class="math inline">\(k-1=5-1=4\)</span> degrees of freedom: <span class="math display">\[
Q_4=3.784&lt;\chi_{4,0.05}^2=9.488
\]</span> we fail to reject the null hypothesis.</p>
</section>
</section>
<section id="application-of-testing-for-homogeneity" class="level3">
<h3 class="anchored" data-anchor-id="application-of-testing-for-homogeneity">Application of testing for homogeneity</h3>
<p>This is to look at a method for testing whether two or more multinomial distributions are equal.</p>
<ul>
<li>Example:</li>
</ul>
<p>Test the hypothesis that the acceptances of males and females are ditributed equally among the four schools,</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">(Acceptances)</th>
<th style="text-align: left;">Bus</th>
<th style="text-align: left;">Eng</th>
<th style="text-align: left;">L Arts</th>
<th style="text-align: left;">Sci</th>
<th style="text-align: left;">(FIXED) Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">240 (20%)</td>
<td style="text-align: left;">480 (40%)</td>
<td style="text-align: left;">120 (10%)</td>
<td style="text-align: left;">360 (30%)</td>
<td style="text-align: left;">1200</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">240 (30%)</td>
<td style="text-align: left;">80 (10%)</td>
<td style="text-align: left;">320 (40%)</td>
<td style="text-align: left;">160 (20%)</td>
<td style="text-align: left;">800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">480 (24%)</td>
<td style="text-align: left;">560 (28%)</td>
<td style="text-align: left;">440 (22%)</td>
<td style="text-align: left;">520 (26%)</td>
<td style="text-align: left;">2000</td>
</tr>
</tbody>
</table>
<p>Here,</p>
<p><span class="math inline">\(H_0: p_{M B}=p_{F B}, p_{M E}=p_{F E}, p_{M L}=p_{F L}\)</span>, and <span class="math inline">\(p_{M S}=p_{F S}\)</span></p>
<p><span class="math inline">\(H_1: p_{M B} \neq p_{F B}\)</span> or <span class="math inline">\(p_{M E} \neq p_{F E}\)</span> or <span class="math inline">\(p_{M L} \neq p_{F L}\)</span>, or <span class="math inline">\(p_{M S} \neq p_{F S}\)</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(p_{M j}\)</span> is the proportion of males accepted into school <span class="math inline">\(j=B, E, L, S\)</span>.</p></li>
<li><p><span class="math inline">\(p_{F j}\)</span> is the proportion of females accepted into school <span class="math inline">\(j=B, E, L, S\)</span>.</p></li>
</ul>
<p>In conducting such a hypothesis test, we’re comparing the proportions of two multinomial distributions.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#(Acc)</th>
<th style="text-align: left;">Bus ( <span class="math inline">\(j=1\)</span> )</th>
<th style="text-align: left;">Eng ( <span class="math inline">\(j=2\)</span> )</th>
<th style="text-align: left;">L Arts ( <span class="math inline">\(j=3\)</span> )</th>
<th style="text-align: left;">Sci <span class="math inline">\((j=4)\)</span></th>
<th style="text-align: left;">(FIXED) Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mathrm{M}(i=1)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{11}\left(\hat{p}_{11}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{12}\left(\hat{p}_{12}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{13}\left(\hat{p}_{13}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{14}\left(\hat{p}_{14}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_1=\sum_{j=1}^k y_{1 j}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">F <span class="math inline">\((i=2)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{21}\left(\hat{p}_{21}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{22}\left(\hat{p}_{22}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{23}\left(\hat{p}_{23}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{24}\left(\hat{p}_{24}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_2=\sum_{j=1}^k y_{2 j}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;"><span class="math inline">\(y_{11}+y_{21}\left(\hat{p}_1\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{12}+y_{22}\left(\hat{p}_2\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{13}+y_{23}\left(\hat{p}_3\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{14}+y_{24}\left(\hat{p}_4\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_1+n_2\)</span></td>
</tr>
</tbody>
</table>
<p>The chi-square test statistic for testing the equality of two multinomial distributions: <span class="math display">\[
Q=\sum_{i=1}^2 \sum_{j=1}^k \frac{\left(y_{i j}-n_i \hat{p}_j\right)^2}{n_i \hat{p}_j}
\]</span> follows an approximate chi-square distribution with <span class="math inline">\(k-1\)</span> degrees of freedom. Reject the null hypothesis of equal proportions if <span class="math inline">\(Q\)</span> is large (since if male and female distributed nearly equally, the expected number of each should be <span class="math inline">\(n_i\hat p_j\)</span>): <span class="math display">\[
Q \geq \chi_{\alpha, k-1}^2
\]</span></p>
<p>(omit the derive of the above Q)</p>
<p>Generally,</p>
<p><span class="math display">\[
Q=\sum_{i=1}^h \sum_{j=1}^k \frac{\left(y_{i j}-n_i \hat{p}_j\right)^2}{n_i \hat{p}_j}\sim \chi^2_{(h-1)(k-1)}
\]</span></p>
<section id="further-example" class="level4">
<h4 class="anchored" data-anchor-id="further-example">Further example</h4>
<p>The head of a surgery department at a university medical center was concerned that surgical residents in training applied unnecessary blood transfusions at a different rate than the more experienced attending physicians. Therefore, he ordered a study of the 49 Attending Physicians and 71 Residents in Training with privileges at the hospital. For each of the 120 surgeons, the number of blood transfusions prescribed unnecessarily in a one-year period was recorded. Based on the number recorded, a surgeon was identified as either prescribing unnecessary blood transfusions Frequently, Occasionally, Rarely, or Never. Here’s a summary table (or “contingency table”) of the resulting data:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Physician</th>
<th style="text-align: left;">Frequent</th>
<th style="text-align: left;">Occasionally</th>
<th style="text-align: left;">Rarely</th>
<th style="text-align: left;">Never</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attending</td>
<td style="text-align: left;">6.942</td>
<td style="text-align: left;">12.658</td>
<td style="text-align: left;">22.05</td>
<td style="text-align: left;">7.35</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Resident</td>
<td style="text-align: left;">10.058</td>
<td style="text-align: left;">18.342</td>
<td style="text-align: left;">31.95</td>
<td style="text-align: left;">10.65</td>
<td style="text-align: left;">71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">31</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">120</td>
</tr>
</tbody>
</table>
<p>Here,</p>
<p><span class="math inline">\(H_0: p_{R F}=p_{A F}, p_{R O}=p_{A O}, p_{R R}=p_{A R}\)</span>, and <span class="math inline">\(p_{R N}=p_{A N}\)</span></p>
<p><span class="math inline">\(H_1: p_{R F} \neq p_{A F}\)</span> or <span class="math inline">\(p_{R O} \neq p_{A O}\)</span> or <span class="math inline">\(p_{R R} \neq p_{A R}\)</span>, or <span class="math inline">\(p_{R N} \neq p_{A N}\)</span></p>
<p>We should also calculate the expected counts under the null hypothesis. The expected counts are calculated as follows:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Physician</th>
<th style="text-align: left;">Frequent</th>
<th style="text-align: left;">Occasionally</th>
<th style="text-align: left;">Rarely</th>
<th style="text-align: left;">Never</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attending</td>
<td style="text-align: left;">6.942</td>
<td style="text-align: left;">12.658</td>
<td style="text-align: left;">22.05</td>
<td style="text-align: left;">7.35</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Resident</td>
<td style="text-align: left;">10.058</td>
<td style="text-align: left;">18.342</td>
<td style="text-align: left;">31.95</td>
<td style="text-align: left;">10.65</td>
<td style="text-align: left;">71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">31</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">120</td>
</tr>
</tbody>
</table>
<p>where, for example, <span class="math inline">\(6.942=\frac{17}{120} \times 49\)</span> and <span class="math inline">\(10.058=\frac{17}{120} \times 71\)</span>. Now that we have the observed and expected counts, calculating the chisquare statistic is a straightforward exercise: <span class="math display">\[
Q=\frac{(2-6.942)^2}{6.942}+\cdots+\frac{(5-10.65)^2}{10.65}=31.88
\]</span></p>
<p>The chi-square test tells us to reject the null hypothesis, at the 0.05 level, if <span class="math inline">\(Q\)</span> is greater than a chi-square random variable with 3 degrees of freedom, that is, if <span class="math inline">\(Q=31.88&gt;7.815\)</span>, we reject the null hypothesis.</p>
</section>
</section>
<section id="application-of-testing-for-independence" class="level3">
<h3 class="anchored" data-anchor-id="application-of-testing-for-independence">Application of testing for independence</h3>
<p>This is to look at whether two or more categorical variables are independent.</p>
<p>(previously,the the sampling scheme involves: Taking two random (and therefore independent) samples with n1 and n2 fixed in advance and observing into which of the k categories the first random samples fall, and observing into which of the k categories the second random samples fall. )</p>
<p>lets consider a different example to illustrate an alternative sampling scheme. Suppose 395 people are randomly selected, and are “cross-classified” into one of eight cells, depending into which age category they fall and whether or not they support legalizing marijuana:</p>
<p>(the sampling scheme involves: Taking one random sample of size n, with n fixed in advance, and then “cross-classifying” each subject into one and only one of the mutually exclusive and exhaustive <span class="math inline">\(A_i\cap B_j\)</span> cells.)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Marijuana Support</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable B (Age)</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Variable A</td>
<td style="text-align: left;">OBSERVED</td>
<td style="text-align: left;"><span class="math inline">\((18-24) B_1\)</span></td>
<td style="text-align: left;">(25-34) <span class="math inline">\(B_1 2\)</span></td>
<td style="text-align: left;">(35-49) <span class="math inline">\(B_3\)</span></td>
<td style="text-align: left;"><span class="math inline">\((50-64) B_4\)</span></td>
<td style="text-align: left;">Total</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(YES) <span class="math inline">\(A_1\)</span></td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">46</td>
<td style="text-align: left;">41</td>
<td style="text-align: left;">201</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">(NO) <span class="math inline">\(A_2\)</span></td>
<td style="text-align: left;">40</td>
<td style="text-align: left;">44</td>
<td style="text-align: left;">53</td>
<td style="text-align: left;">57</td>
<td style="text-align: left;">194</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Total</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">99</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;"><span class="math inline">\(n=395\)</span></td>
</tr>
</tbody>
</table>
<p>Here,</p>
<p>H0 : Variable A is independent of variable B, that is <span class="math inline">\(P(A_i\cap B_j)=PA_i \times B_j\)</span> for all i and j</p>
<p>H1: Variable A is not independent of variable B.</p>
<p>Generally,</p>
<p>Suppose we have <span class="math inline">\(k\)</span> (column) levels of Variable B indexed by the letter <span class="math inline">\(j\)</span>, and <span class="math inline">\(h\)</span> (row) levels of Variable <span class="math inline">\(A\)</span> indexed by the letter <span class="math inline">\(i\)</span>. Then, we can summarize the data and probability model in tabular format, as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Variable B</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Variable A</td>
<td style="text-align: center;"><span class="math inline">\(B_1(j=1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B_2(j=2)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B_3(j=3)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B_4(j=4)\)</span></td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(A_1(i=1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{11}\left(p_{11}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{12}\left(p_{12}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{13}\left(p_{13}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{14}\left(p_{14}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{1 .}\right)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(A_2(i=2)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{21}\left(p_{21}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{22}\left(p_{22}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{23}\left(p_{23}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{24}\left(p_{24}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{2 .}\right)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Total</td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.1}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.2}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.3}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.4}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(p_{i j}=Y_{i j} / n, p_i .=\sum_{j=1}^k p_{i j}\)</span>, and <span class="math inline">\(p_{. j}=\sum_{i=1}^h p_{i j}\)</span></p>
<p><span class="math inline">\(Q=\sum_{j=1}^k \sum_{i=1}^h \frac{\left(y_{i j}-\frac{y_i \cdot y_{\cdot j}}{n}\right)^2}{\frac{y_i \cdot y_{\cdot j}}{n}}\sim \chi^2_{(h-1)(k-1)}\)</span></p>
<section id="are-chi-square-statistic-for-homogeneity-and-the-chi-square-statistic-for-independence-equivalent" class="level4">
<h4 class="anchored" data-anchor-id="are-chi-square-statistic-for-homogeneity-and-the-chi-square-statistic-for-independence-equivalent">Are chi-square statistic for homogeneity and the chi-square statistic for independence equivalent?</h4>
<p>Although their chi-square statistics are equivalent, the two tests are not equivalent since their sampling experiment designs are different.</p>
<p>Here’s the table of expected counts:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Bicycle Riding Interest</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable B (Age)</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Variable A</td>
<td style="text-align: left;">EXPECTED</td>
<td style="text-align: left;">18-24</td>
<td style="text-align: left;">25-34</td>
<td style="text-align: left;">35-49</td>
<td style="text-align: left;">50-64</td>
<td style="text-align: left;">Total</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">50.886</td>
<td style="text-align: left;">49.868</td>
<td style="text-align: left;">50.377</td>
<td style="text-align: left;">49.868</td>
<td style="text-align: left;">201</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">49.114</td>
<td style="text-align: left;">48.132</td>
<td style="text-align: left;">48.623</td>
<td style="text-align: left;">48.132</td>
<td style="text-align: left;">194</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Total</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">99</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">395</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
Q=\frac{(60-50.886)^2}{50.886}+\cdots+\frac{(57-48.132)^2}{48.132}=8.006
\]</span></p>
<p>The chi-square test tells us to reject the null hypothesis, at the 0.05 level, since <span class="math inline">\(Q\)</span> is greater than a chi-square random variable with 3 degrees of freedom, that is, <span class="math inline">\(Q=8.006&gt;7.815\)</span>.</p>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">Summary</h4>
<p>Parametric tests make assumptions that aspects of the data follow some sort of theoretical probability distribution. Non-parametric tests or distribution free methods do not, and are used when the distributional assumptions for a parametric test are not met. While this is an advantage, it often comes at a cost of power (in the sense they are less likely to be able to detect a difference when a true difference exists).</p>
<p>Most non-parametric tests are just hypothesis tests; there is no estimation of a confidence interval.</p>
<p>Most non-parametric methods are based on ranking the values of a variable in ascending order and then calculating a test statistic based on the sums of these ranks.</p>
<p>Non-parametric tests include:</p>
<ul>
<li><p>Two-sample independent t-test - Wilcoxon rank-sum test or Mann-Whitney U test</p></li>
<li><p>Paired t-test - Wilcoxon signed-rank test</p></li>
<li><p>One-way ANOVA - Kruskal-Wallace Test</p></li>
<li><p>Normality tests - Shapiro-Wilk test and Kolmogorov-Smirnov test</p></li>
</ul>
</section>
</section>
</section>
</section>
<section id="linear-regression" class="level1">
<h1>Linear Regression</h1>
<section id="simple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="simple-linear-regression">Simple linear regression</h2>
<section id="brief-introduction" class="level3">
<h3 class="anchored" data-anchor-id="brief-introduction">Brief introduction</h3>
<p>Some people think simple methods is bad and like complicated methods , but actually simple is very good–SLR works very well in lots of situations.</p>
<p>SLR is used to answer:</p>
<p>is there a relationship between..</p>
<p>How strong the relationship is</p>
<p>which variable contribute to this relationship</p>
<p>How accurate could we predict the response variable</p>
<p>Is the relationship linear?</p>
<p>Is there a synergy among independent variables?</p>
<p>This is a model with two random variables, X and Y, where we are trying to predict Y from X. Here are the model’s assumptions:</p>
<ul>
<li><p>The distribution of X is arbitrary, possibly is even non-random;</p></li>
<li><p>If X=x, then <span class="math inline">\(Y = \beta_0+\beta_1x+\epsilon\)</span> for some constants <span class="math inline">\(\beta_0, \beta_1\)</span> and some random noise variable <span class="math inline">\(\epsilon\)</span></p></li>
<li><p><span class="math inline">\(\epsilon\)</span> has mean 0, a constant variance <span class="math inline">\(\sigma^2\)</span>, and is uncorrelated with X and uncorrelated across observations Cov<span class="math inline">\((\epsilon_i, \epsilon_j)=0\)</span> for <span class="math inline">\(i \ne j\)</span></p></li>
</ul>
<p>Using Least Squares, we can estimate <span class="math inline">\(\hat \beta_0\)</span> and <span class="math inline">\(\hat \beta_1\)</span>, which are unbiased estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<ul>
<li>Gaussian-Noise Simple Linear Regression Model</li>
</ul>
<p>Now we further assume that the distribution of <span class="math inline">\(\epsilon\)</span> is normal, i.e.&nbsp;<span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span>, independent of X.</p>
<p>They tell us, exactly, the probability distribution for Y given X, and so will let us get exact distributions for predictions and for other inferential statistics.</p>
</section>
<section id="maximum-likelihood-estimation-mle" class="level3">
<h3 class="anchored" data-anchor-id="maximum-likelihood-estimation-mle">Maximum Likelihood Estimation (MLE)</h3>
<section id="introduction-to-mle" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-mle">Introduction to MLE</h4>
<p>Likelihood is a fundamental concept in statistics that measures how well a particular set of parameters (e.g., the mean of a distribution) explains observed data. Think of it as a “score” that tells you which parameter values make your data most plausible.</p>
<p>Compared to probability, which answers: “What’s the chance of seeing this data if we assume specific parameters?” , likelihood answers: “Given this data, how plausible are these parameters?”</p>
<p>If the parameters are <span class="math inline">\(b_0, b_1, s^2\)</span> (reserving the Greek letters for their true values), then <span class="math inline">\(Y \mid X=x \sim N\left(b_0+b_1 x, s^2\right)\)</span>, and <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(Y_j\)</span> are independent given <span class="math inline">\(X_i\)</span> and <span class="math inline">\(X_j\)</span>, so the overall likelihood is <span class="math display">\[
\prod_{i=1}^n \frac{1}{\sqrt{2 \pi s^2}} e^{-\frac{\left(y_i-\left(b_0+b_i x_i\right)\right)^2}{2 s^2}}
\]</span></p>
<p>As usual, we work with the log-likelihood, which gives us the same information but replaces products with sums: <span class="math display">\[
L\left(b_0, b_1, s^2\right)=-\frac{n}{2} \ln \left(2 \pi s^2\right)-\frac{1}{2 s^2} \sum_{i=1}^n\left(y_i-\left(b_0+b_1 x_i\right)\right)^2
\]</span></p>
<p>maximize it:</p>
<p><span class="math inline">\(\begin{aligned} \frac{\partial L}{\partial b_0} &amp; =-\frac{1}{2 s^2} \sum_{i=1}^n 2\left(y_i-\left(b_0+b_1 x_i\right)\right)(-1) \\ \frac{\partial L}{\partial b_1} &amp; =-\frac{1}{2 s^2} \sum_{i=1}^n 2\left(y_i-\left(b_0+b_1 x_i\right)\right)\left(-x_i\right)\end{aligned}\)</span></p>
</section>
<section id="same-result-of-mle-as-least-squares-in-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="same-result-of-mle-as-least-squares-in-linear-regression">Same result of MLE as least squares in linear regression</h4>
<p>Notice that when we set these derivatives to zero, all the multiplicative constants - in particular, the prefactor of <span class="math inline">\(1 / 2 s^2\)</span> - go away. We are left with <span class="math display">\[
\begin{aligned}
\sum_{i=1}^n\left(y_i-\left(\hat{\beta_0}+\hat{\beta_1} x_i\right)\right) &amp; =0 \\
\sum_{i=1}^n\left(y_i-\left(\hat{\beta_0}+\hat{\beta_0} x_i\right)\right) x_i &amp; =0
\end{aligned}
\]</span></p>
<p>These are, up to a factor of <span class="math inline">\(1 / n\)</span>, exactly the equations we got from the method of least squares. That means that the least squares solution is the maximum likelihood estimate under the Gaussian noise model.</p>
<p>Maximum likelihood estimates of the regression curve coincide with least-squares estimates when the noise around the curve is additive, Gaussian, of constant variance, and both independent of <span class="math inline">\(X\)</span> and of other noise terms. If any of those assumptions fail, maximum likelihood and least squares estimates can diverge.</p>
</section>
</section>
<section id="hypothesis-testing-for-estimates-with-unknown-sigma2" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing-for-estimates-with-unknown-sigma2">Hypothesis testing for estimates with unknown <span class="math inline">\(\sigma^2\)</span></h3>
<section id="residual-sum-of-squares-rss-and-t-statistics-construction-in-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="residual-sum-of-squares-rss-and-t-statistics-construction-in-linear-regression">Residual sum of squares (RSS) and t-statistics construction in linear regression</h4>
<p>It can be shown that (the proof is beyond the scope of this course) <span class="math display">\[
\frac{R S S}{\sigma^2}=\frac{(n-2) \hat{\sigma}^2}{\sigma^2} \sim \chi_{n-2}^2
\]</span></p>
<p>This allows us to construct a <span class="math inline">\(t\)</span>-value <span class="math display">\[
t=\frac{\hat{\beta}-\beta}{s_{\hat{\beta}}} \sim t_{n-2}
\]</span></p>
<p>Under the normality assumption of the error terms, the estimator of the slope coefficient will itself be normally distributed with mean <span class="math inline">\(\beta_i\)</span> and variance <span class="math inline">\(\operatorname{Var}\left[\beta_i\right]\)</span> For <span class="math inline">\(\hat{\beta_1}\)</span>, its mean is <span class="math inline">\(\beta_1\)</span> and its variance is <span class="math inline">\(\sigma^2 / \sum\left(x_i-\bar{x}\right)^2\)</span>. When <span class="math inline">\(\sigma^2\)</span> is known, we know <span class="math display">\[
\frac{\hat{\beta}_1-\beta_1}{\frac{\sigma}{\sqrt{\sum_{i=1}^n\left(x_i-\bar{x}\right)^2}}}
\]</span> follows standard normal distribution. However, in practice, <span class="math inline">\(\sigma^2\)</span> is often unknown. We then divide this standard normal distributed term by <span class="math display">\[
\sqrt{\frac{(n-2) \hat{\sigma}^2}{(n-2) \sigma^2}}=\frac{\hat{\sigma}}{\sigma}
\]</span></p>
<p>Therefore, when we write <span class="math display">\[
s_{\hat{\beta_1}}=\frac{\hat{\sigma}}{\sqrt{\sum_{i=1}^n\left(x_i-\bar{x}\right)^2}}
\]</span> we construct a <span class="math inline">\(t\)</span>-statistic for <span class="math inline">\(\hat{\beta_1}\)</span> with degrees of freedom <span class="math inline">\(n-2\)</span>. This then allows us to construct a <span class="math inline">\(100(1-\alpha) \%\)</span> confidence interval for <span class="math inline">\(\beta_1\)</span> : <span class="math display">\[
\hat{\beta_1} \pm t_{n-2, \alpha / 2} \times \boldsymbol{s}_{\hat{\beta_1}}
\]</span></p>
<p>We can also do similar calculation to get the <span class="math inline">\(t\)</span>-statistic and confidence interval for <span class="math inline">\(\beta_0\)</span>.</p>
</section>
<section id="hyphothesis-testing" class="level4">
<h4 class="anchored" data-anchor-id="hyphothesis-testing">Hyphothesis Testing</h4>
<p><span class="math display">\[
t =\hat {\beta}-\beta / s_{\hat{\beta_1}} \sim t_{n-2}
\]</span> <span class="math inline">\(H_0: \beta_i =0\)</span></p>
<p><span class="math inline">\(H_1: \beta_i \ne 0\)</span></p>
</section>
<section id="codes-of-linear-regression-with-ci" class="level4">
<h4 class="anchored" data-anchor-id="codes-of-linear-regression-with-ci">Codes of linear regression with CI</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>lmodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Petal.Width, <span class="at">data=</span>iris)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Petal.Length ~ Petal.Width, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.33542 -0.30347 -0.02955  0.25776  1.39453 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.08356    0.07297   14.85   &lt;2e-16 ***
Petal.Width  2.22994    0.05140   43.39   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4782 on 148 degrees of freedom
Multiple R-squared:  0.9271,    Adjusted R-squared:  0.9266 
F-statistic:  1882 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %   97.5 %
(Intercept) 0.9393664 1.227750
Petal.Width 2.1283752 2.331506</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>conf_interval <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmodel, <span class="at">data=</span>iris, <span class="at">interval=</span><span class="st">'confidence'</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width, iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Petal.Width'</span>, <span class="at">ylab=</span><span class="st">'Petal.Length'</span>,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">'Simple Linear Regression'</span>)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lmodel, <span class="at">col=</span><span class="st">'lightblue'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(iris<span class="sc">$</span>Petal.Width, conf_interval[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using ggplot2</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Petal.Width, <span class="at">y=</span>Petal.Length)) <span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>stats<span class="sc">::</span>lm, <span class="at">se=</span>T, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-regression-and-anova" class="level4">
<h4 class="anchored" data-anchor-id="linear-regression-and-anova">Linear Regression and ANOVA</h4>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fev_dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'fev_dat.txt'</span>, <span class="at">header=</span>T)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>fev_dat_subset <span class="ot">&lt;-</span> fev_dat[fev_dat<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> fev_dat<span class="sc">$</span>age <span class="sc">&lt;=</span> <span class="dv">10</span>,]</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fev_dat_subset, <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>FEV)) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>stats<span class="sc">::</span>lm, <span class="at">se=</span>T, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(FEV <span class="sc">~</span> age, <span class="at">data=</span>fev_dat_subset))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(FEV <span class="sc">~</span> age, <span class="at">data=</span>fev_dat_subset))</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(FEV <span class="sc">~</span> age, <span class="at">data=</span>fev_dat_subset))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="r2the-fraction-of-variability-explained-by-the-regression" class="level3">
<h3 class="anchored" data-anchor-id="r2the-fraction-of-variability-explained-by-the-regression"><span class="math inline">\(R^2\)</span>–the fraction of variability explained by the regression</h3>
<p><span class="math display">\[
R^2 =1-\frac{SSR}{SSTO}
\]</span></p>
</section>
</section>
<section id="multiple-linear-regression-mlr" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression-mlr">Multiple linear regression (MLR)</h2>
<p><span class="math inline">\(y=X\beta+\epsilon\)</span>, where y is a n × 1 row vector, X is a n × (k + 1) matrix, and β is a (k + 1) × 1 column vector for all n observations.</p>
<section id="a-potential-problem-in-practice-multicollinearity" class="level3">
<h3 class="anchored" data-anchor-id="a-potential-problem-in-practice-multicollinearity">A potential problem in practice –multicollinearity</h3>
<p>When multicollinearity exists, any of the following pitfalls can be exacerbated:</p>
<ul>
<li><p>The estimated regression coefficient of any one variable depends on which other predictors are included in the model</p></li>
<li><p>The precision of the estimated regression coefficients decreases as more predictors are added to the model</p></li>
<li><p>The marginal contribution of any one predictor variable in reducing the error sum of squares depends on which other predictors are already in the model</p></li>
<li><p>Typothesis tests for βj = 0 may yield different conclusions depending on which predictors are in the model</p></li>
</ul>
<section id="perfect-multicollinearity" class="level4">
<h4 class="anchored" data-anchor-id="perfect-multicollinearity">Perfect multicollinearity</h4>
<p>Perfect multicollinearity refers to a situation where the predictive variables have an exact linear relationship. When there is perfect collinearity, the design matrix X has less than full rank, and therefore the moment matrix X′X cannot be inverted. In this situation, the parameter estimates of the regression are not well-defined, as the system of equations has infinitely many solutions.</p>
</section>
<section id="imperfect-multicollinearity" class="level4">
<h4 class="anchored" data-anchor-id="imperfect-multicollinearity">Imperfect multicollinearity</h4>
<p>Imperfect multicollinearity refers to a situation where the predictive variables have a nearly exact linear relationship.</p>
<p><span class="math inline">\(R^2=r^2\)</span> where r is the Pearson correlation coefficient.</p>
</section>
</section>
<section id="adjusted-r-squared" class="level3">
<h3 class="anchored" data-anchor-id="adjusted-r-squared">Adjusted R-squared</h3>
<p>Adjusted R-squared is a modified version of R-squared that adjusts for the number of predictors in a model. It provides a more accurate measure of the model’s explanatory power, penalizing for the addition of irrelevant predictors. This helps in comparing models with different numbers of predictors.</p>
</section>
</section>
</section>
<section id="logistic-regression" class="level1">
<h1>Logistic Regression</h1>
<p>This is a regression of categorical outcome.</p>
<p>In regression analysis with a categorical outcome, such as predicting a binary variable (yes or no), simple linear regression is not ideal. This is because:</p>
<ul>
<li><p>The predicted values may fall outside the range of 0 to 1, which is not meaningful for probabilities.</p></li>
<li><p>Small changes in the predictors can lead to relatively small fluctuations in the predicted probabilities near the 0.5 mark (natural threshold), which is actually where decision-making is most critical.</p></li>
</ul>
<p>So we need S-curve to satisfy above things.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x)), <span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"f(x)"</span>,</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Logistic Function: f(x) = 1 / (1 + exp(-x))"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>An example of a not well-predicted logistic model (since stock is not easy to predict)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Smarket)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>glm.fits <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    Direction <span class="sc">~</span> Lag1 <span class="sc">+</span> Lag2 <span class="sc">+</span> Lag3 <span class="sc">+</span> Lag4 <span class="sc">+</span> Lag5 <span class="sc">+</span> Volume,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Smarket, <span class="at">family =</span> binomial</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.fits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + 
    Volume, family = binomial, data = Smarket)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -0.126000   0.240736  -0.523    0.601
Lag1        -0.073074   0.050167  -1.457    0.145
Lag2        -0.042301   0.050086  -0.845    0.398
Lag3         0.011085   0.049939   0.222    0.824
Lag4         0.009359   0.049974   0.187    0.851
Lag5         0.010313   0.049511   0.208    0.835
Volume       0.135441   0.158360   0.855    0.392

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1731.2  on 1249  degrees of freedom
Residual deviance: 1727.6  on 1243  degrees of freedom
AIC: 1741.6

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>glm.probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.fits, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>glm.probs[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
0.5070841 0.4814679 0.4811388 0.5152224 0.5107812 0.5069565 0.4926509 0.5092292 
        9        10 
0.5176135 0.4888378 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>glm.pred <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Down"</span>, <span class="dv">1250</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>glm.pred[glm.probs <span class="sc">&gt;</span> .<span class="dv">5</span>] <span class="ot">=</span> <span class="st">"Up"</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(glm.pred, Direction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Direction
glm.pred Down  Up
    Down  145 141
    Up    457 507</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">507</span> <span class="sc">+</span> <span class="dv">145</span>) <span class="sc">/</span> <span class="dv">1250</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(glm.pred <span class="sc">==</span> Direction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5216</code></pre>
</div>
</div>
<section id="odds" class="level2">
<h2 class="anchored" data-anchor-id="odds">Odds</h2>
<p>Odds are another way of quantifying the probability of an event, commonly used in gambling (and logistic regression).</p>
<p>For some event <span class="math inline">\(E\)</span>, <span class="math display">\[
\operatorname{odds}(E)=\frac{P(E)}{P\left(E^c\right)}=\frac{P(E)}{1-P(E)}
\]</span></p>
<p>The odds ratio (OR) is the ratio of the odds of an event occurring in one group to the odds of it occuring in another group. If the event in each of the groups are <span class="math inline">\(p_1\)</span> (first group) and <span class="math inline">\(p_2\)</span> (second group), then the odds ratio is: <span class="math display">\[
\mathrm{OR}=\frac{p_1 /\left(1-p_1\right)}{p_2 /\left(1-p_2\right)}
\]</span></p>
</section>
</section>
<section id="generalized-linear-models" class="level1">
<h1>Generalized Linear Models</h1>
<p>Under the hood, we’re still using a linear model <span class="math inline">\(\left(\beta_0+\beta_1 x\right)\)</span>, but now it’s embedded in a function that ensures valid probabilities. This is the essence of logistic regression - a generalized linear model (GLM) designed for binary outcomes.</p>
<p>Given predictor <span class="math inline">\(X\)</span> and d an outcom <span class="math inline">\(Y\)</span>, a GLM is defined by three components: - A random component, that specifies a distribution for <span class="math inline">\(Y \mid X\)</span> - A systematic component, that relates a parameter <span class="math inline">\(\eta\)</span> to the predictor <span class="math inline">\(X\)</span> <span class="math display">\[
\eta=\beta_0+\beta_1 X_1+\cdots+\beta_k X_k
\]</span> - A link function, that connects the random and systematic component</p>
<section id="random-component" class="level2">
<h2 class="anchored" data-anchor-id="random-component">Random Component</h2>
<p>The random component specifies a distribution for the outcome variable (conditional on <span class="math inline">\(X\)</span> ). In the case of linear regression, we assume that <span class="math inline">\(Y \mid X \sim \mathcal{N}\left(\mu, \sigma^2\right)\)</span>, for some mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. In the case of logistic regression, we assume that <span class="math inline">\(Y \mid X \sim \operatorname{Bern}(p)\)</span> for some probability <span class="math inline">\(p\)</span>.</p>
<p>In a generalized model, we are allowed to assume that <span class="math inline">\(Y \mid X\)</span> has a probability density function or probability mass function of the form <span class="math display">\[
f(y ; \theta, \phi)=\exp \left(\frac{y \theta-b(\theta)}{a(\phi)}+c(y, \phi)\right)
\]</span></p>
<p>Here <span class="math inline">\(\theta, \phi\)</span> are parameters, and <span class="math inline">\(a, b, c\)</span> are functions. Any density of the above form is called an exponential family density. The parameter <span class="math inline">\(\theta\)</span> is called the natural parameter, and the parameter <span class="math inline">\(\phi\)</span> the dispersion parameter.</p>
</section>
<section id="exponential-family" class="level2">
<h2 class="anchored" data-anchor-id="exponential-family">Exponential Family</h2>
<p>Exponential families include many of the most common distributions. For example: - Exponential <span class="math display">\[
f(y ; \lambda)=\lambda e^{-\lambda y}=\exp (-y \lambda+\ln \lambda)
\]</span> where <span class="math inline">\(\theta=-\lambda, \phi=1, b(\theta)=\ln \lambda, a(\phi)=1\)</span>, and <span class="math inline">\(c(y, \phi)=0\)</span> - Poisson <span class="math display">\[
f(y ; \lambda)=\frac{e^{-\lambda} \lambda^y}{y!}=\exp (y \ln \lambda-\lambda-\ln (y!))
\]</span> where <span class="math inline">\(\theta=\ln \lambda, \phi=1, b(\theta)=e^\theta=\lambda, a(\phi)=1\)</span>, and <span class="math inline">\(c(y, \phi)=-\lambda-\ln (y!)\)</span></p>
</section>
<section id="systematic-component-and-link-component" class="level2">
<h2 class="anchored" data-anchor-id="systematic-component-and-link-component">Systematic Component and Link Component</h2>
<p>The systematic component relates a parameter <span class="math inline">\(\eta\)</span> to the predictors <span class="math inline">\(X\)</span>. In a GLM, this is always done via <span class="math display">\[
\eta=X \beta=\beta_0+\beta_1 X_1+\cdots+\beta_k X_k
\]</span></p>
<p>We will denote the expectation of the distribution in random component as <span class="math inline">\(\mu\)</span>, i.e., <span class="math inline">\(\mathbb{E}[Y \mid X]=\mu\)</span>. It will be our goal to estimate <span class="math inline">\(\mu\)</span>. Finally, the link component connects the random and systematic components, via a link function <span class="math inline">\(g\)</span>. In particular, this link function provides a connection between <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\eta\)</span>, as in <span class="math display">\[
g(\mu)=\eta \quad \text { or } \quad \mu=g^{-1}(\eta)
\]</span></p>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<section id="gaussian-noise-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="gaussian-noise-linear-regression">Gaussian-noise Linear Regression</h3>
<ul>
<li>Random Component: <span class="math inline">\(Y \mid X \sim \mathcal{N}\left(\mu, \sigma^2\right)\)</span> and <span class="math inline">\(\mathbb{E}[Y \mid X]=\mu\)</span></li>
<li>Systematic Component: <span class="math inline">\(\eta=X \beta\)</span></li>
<li>Link Component: <span class="math inline">\(g(\mu)=\mu\)</span>, so that <span class="math inline">\(\mu=\eta=X \beta\)</span></li>
</ul>
</section>
<section id="bernoulli" class="level3">
<h3 class="anchored" data-anchor-id="bernoulli">Bernoulli</h3>
<p>Suppose that <span class="math inline">\(Y \in\{0,1\}\)</span>, and we model the distribution of <span class="math inline">\(Y \mid X\)</span> as Bernoulli with success probability <span class="math inline">\(p\)</span>. Then the probability mass function (not a density, since <span class="math inline">\(Y\)</span> is discrete) is <span class="math display">\[
f(y)=p^y(1-p)^{1-y}
\]</span></p>
<p>We can rewrite to fit the exponential family form as <span class="math display">\[
\begin{aligned}
f(y) &amp; =\exp (y \log p+(1-y) \log (1-p)) \\
&amp; =\exp (y \log (p /(1-p))+\log (1-p))
\end{aligned}
\]</span></p>
<p><span class="math display">\[
f(y ; \theta, \phi)=\exp \left(\frac{y \theta-b(\theta)}{a(\phi)}+c(y, \phi)\right)
\]</span></p>
<p>Here we would identify <span class="math inline">\(\theta=\log (p /(1-p))\)</span> as the natural parameter. Note that the mean here is <span class="math inline">\(\mu=p\)</span>, and using the inverse of the above relationship, we can directly write the mean <span class="math inline">\(p\)</span> as a function of <span class="math inline">\(\theta\)</span>, as in <span class="math inline">\(p=e^\theta /\left(1+e^\theta\right)\)</span>. Hence <span class="math inline">\(b(\theta)=\log (1-p)=-\log \left(1+e^\theta\right)\)</span>. There is no dispersion parameter, so we can set <span class="math inline">\(a(\phi)=1\)</span>. Also, <span class="math inline">\(c(y, \phi)=0\)</span>.</p>
</section>
</section>
</section>
<section id="link-function" class="level1">
<h1>Link Function</h1>
<p><span class="math display">\[
g(\mu)=\Phi^{-1}(\mu)
\]</span> where <span class="math inline">\(\Phi\)</span> is the standard normal CDF.</p>
<section id="logistic" class="level3">
<h3 class="anchored" data-anchor-id="logistic">Logistic</h3>
<p>The three GLM criteria give us:</p>
<ul>
<li><p><span class="math inline">\(y_i \sim \operatorname{Bern}\left(p_i\right)\)</span></p></li>
<li><p><span class="math inline">\(\eta=\beta_0+\beta_1 X_1+\cdots+\beta_k X_k\)</span></p></li>
<li><p><span class="math inline">\(\operatorname{logit}(p)=\log \frac{p}{1-p}=\eta\)</span></p></li>
</ul>
<p>From which we know, <span class="math display">\[
p_i=\frac{\exp \left(\beta_0+\beta_1 x_{i 1}+\cdots+\beta_k X_{i k}\right)}{1+\exp \left(\beta_0+\beta_1 x_{i 1}+\cdots+\beta_k X_{i k}\right)}
\]</span></p>
</section>
</section>
<section id="survival-analysis" class="level1">
<h1>Survival Analysis</h1>
<p>Survival analysis is used to analyze data in which the time until the event is of interest. The response is often referred to as a failure time, survival time, or event time.</p>
<section id="some-definations" class="level2">
<h2 class="anchored" data-anchor-id="some-definations">Some definations</h2>
<p>Hazard ratios; ratios of hazard functions between different groups (e.g., exposed vs.&nbsp;unexposed) while adjusting for confounders.</p>
<p>censoring - which occurs when the survival time is only partially known</p>
<ul>
<li><p>Fixed type I censoring occurs when a study is designed to end after C years of follow-up. In this case, everyone who does not have an event observed during the course of the study is censored at C years.</p></li>
<li><p>In random type I censoring, the study is designed to end after C years, but censored subjects do not all have the same censoring time. This is the main type of right-censoring we will be concerned with.</p></li>
<li><p>In type II censoring, a study ends when there is a pre-specified number of events.</p></li>
</ul>
</section>
<section id="kaplan-meier-estimate" class="level2">
<h2 class="anchored" data-anchor-id="kaplan-meier-estimate">Kaplan-Meier estimate</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(BrainCancer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sex"       "diagnosis" "loc"       "ki"        "gtv"       "stereo"   
[7] "status"    "time"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(BrainCancer)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>status
 0  1 
53 35 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>fit.surv <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.surv, <span class="at">xlab =</span> <span class="st">"Months"</span>,</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Estimated Probability of Survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cox-proportional-harzards-model" class="level2">
<h2 class="anchored" data-anchor-id="cox-proportional-harzards-model">Cox-proportional harzards model</h2>
<p>S(t) = P(T&gt;t)=1-F(t)</p>
<p><span class="math inline">\(h(t)=\lim _{\Delta t \rightarrow 0} \frac{P(t&lt;T \leq t+\Delta t \mid T&gt;t)}{\Delta t}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fit.all <span class="ot">&lt;-</span> <span class="fu">coxph</span>(</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex <span class="sc">+</span> diagnosis <span class="sc">+</span> loc <span class="sc">+</span> ki <span class="sc">+</span> gtv <span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>   stereo)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>fit.all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, status) ~ sex + diagnosis + loc + 
    ki + gtv + stereo)

                       coef exp(coef) se(coef)      z        p
sexMale             0.18375   1.20171  0.36036  0.510  0.61012
diagnosisLG glioma  0.91502   2.49683  0.63816  1.434  0.15161
diagnosisHG glioma  2.15457   8.62414  0.45052  4.782 1.73e-06
diagnosisOther      0.88570   2.42467  0.65787  1.346  0.17821
locSupratentorial   0.44119   1.55456  0.70367  0.627  0.53066
ki                 -0.05496   0.94653  0.01831 -3.001  0.00269
gtv                 0.03429   1.03489  0.02233  1.536  0.12466
stereoSRT           0.17778   1.19456  0.60158  0.296  0.76760

Likelihood ratio test=41.37  on 8 df, p=1.776e-06
n= 87, number of events= 35 
   (1 observation deleted due to missingness)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>modaldata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">diagnosis =</span> <span class="fu">levels</span>(diagnosis),</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">sex =</span> <span class="fu">rep</span>(<span class="st">"Female"</span>, <span class="dv">4</span>),</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">loc =</span> <span class="fu">rep</span>(<span class="st">"Supratentorial"</span>, <span class="dv">4</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ki =</span> <span class="fu">rep</span>(<span class="fu">mean</span>(ki), <span class="dv">4</span>),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">gtv =</span> <span class="fu">rep</span>(<span class="fu">mean</span>(gtv), <span class="dv">4</span>),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">stereo =</span> <span class="fu">rep</span>(<span class="st">"SRT"</span>, <span class="dv">4</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>survplots <span class="ot">&lt;-</span> <span class="fu">survfit</span>(fit.all, <span class="at">newdata =</span> modaldata)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(survplots, <span class="at">xlab =</span> <span class="st">"Months"</span>,</span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="fu">levels</span>(diagnosis), <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="final-review-of-r-codes" class="level1">
<h1>Final review of R codes</h1>
<section id="calculation" class="level2">
<h2 class="anchored" data-anchor-id="calculation">Calculation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">exp</span>(<span class="dv">1</span>)) <span class="co">#  base `e` is the default (log(e) is not defined)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="vectors" class="level2">
<h2 class="anchored" data-anchor-id="vectors">Vectors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%*%</span>x <span class="co"># scalar ("inner") product (but default in R as an 1*1 matrix)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "a" "b" "a" "b"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>), <span class="at">each =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 2 2 4 4 4 8 8 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span><span class="dv">1</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num [1:4] 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:11] -5 -4 -3 -2 -1 0 1 2 3 4 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="co"># c(1,2,3,4) and 1:4 are the same in.R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>, <span class="at">length.out=</span><span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.0 1.4 1.8 2.2 2.6 3.0 3.4 3.8 4.2 4.6 5.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vac&lt;-c((1,2,3),(3,4,5)) is wrong, but the below is true</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>vec1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>vec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>vec3 <span class="ot">&lt;-</span> <span class="fu">c</span>(vec1, vec2)</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>vec3[<span class="dv">1</span>] <span class="sc">==</span> vec1[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>vec3[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>];vec3[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4 5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>vec3[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># everything but the first element</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3 4 5 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>vec3[<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 3 5 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(<span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 5 4 3 2 1 0 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">11</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> x <span class="sc">+</span> y </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11 13 13 15 15 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x * y </span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)<span class="sc">*</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)<span class="sc">%*%</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]    8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####Application</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sample(var(x)) and population variance</span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sample variance using R's var() function</span></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>sample_variance <span class="ot">&lt;-</span><span class="fu">var</span>(x)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>sample_variance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>population_variance <span class="ot">&lt;-</span> sample_variance <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>population_variance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
</section>
<section id="rmd-knowledge" class="level2">
<h2 class="anchored" data-anchor-id="rmd-knowledge">Rmd knowledge</h2>
<p>{r, echo = FALSE} –Hidden Code</p>
<p>{r, eval = FALSE} –Do not run this code</p>
<p>{r, message = FALSE} –Do not show the message</p>
<p>{r, warning = FALSE} –Do not show the warning</p>
<p>{r,results=‘hide’} –Do not show the results</p>
</section>
</section>
<section id="probability-in-r" class="level1">
<h1>Probability in R</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="dv">0</span>) <span class="co"># density at 0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3989423</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>) <span class="co"># cumulative probability at -1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1586553</code></pre>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F) <span class="co"># cumulative probability at -1, upper tail</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8413447</code></pre>
</div>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="dv">0</span>) <span class="co"># quantile at 0 (with the cumulative probability of 0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -Inf</code></pre>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.645</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9500151</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.95</span>) <span class="co"># norm quantile at 0.95 (with the cumulative probability of 0.95)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.644854</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.96</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9750021</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'mosaic':
  method                           from   
  fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
The 'mosaic' package masks several functions from core packages in order to add 
additional features.  The original behavior of these functions should not be affected by this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mosaic'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    count, do, tally</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    mean</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:car':

    deltaMethod, logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    stat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
    quantile, sd, t.test, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    max, mean, min, prod, range, sample, sum</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">'norm'</span>,<span class="at">mean=</span><span class="dv">10</span>,<span class="at">sd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">'binom'</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span>.<span class="dv">2</span>) <span class="co"># x-axis is the number of success from 1-10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>)) <span class="co"># the probability it is less than or equal to 3 of Poison(2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8571235</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8571235</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>) <span class="sc">==</span> <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>)) <span class="co"># this inequivalance is because the floating point precision</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#xpnorm(-1)  # P(Z ≤ -1) = 0.1586553 -package mosaic</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="co">#xpnorm(-1, lower.tail = FALSE)  # P(Z ≥ 1.5) = 0.0668072</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="r-basic" class="level1">
<h1>R basic</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Good"</span>, <span class="st">"afternoon"</span>, <span class="st">"ladies"</span>, <span class="st">"and"</span>, <span class="st">"gentlemen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Good afternoon ladies and gentlemen"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Good"</span>, <span class="st">"afternoon"</span>, <span class="st">"ladies"</span>, <span class="st">"and"</span>, <span class="st">"gentlemen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Goodafternoonladiesandgentlemen"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 12 13 14 15 16 17 18 19 20 21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">which</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>vowels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>,<span class="st">'e'</span>,<span class="st">'i'</span>,<span class="st">'o'</span>,<span class="st">'u'</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">is.element</span>(letters, vowels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  5  9 15 21</code></pre>
</div>
</div>
</section>
<section id="data-class" class="level1">
<h1>Data class</h1>
<section id="numeric" class="level2">
<h2 class="anchored" data-anchor-id="numeric">Numeric</h2>
</section>
<section id="integer" class="level2">
<h2 class="anchored" data-anchor-id="integer">Integer</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">42</span>L</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
</section>
<section id="character" class="level2">
<h2 class="anchored" data-anchor-id="character">Character</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="st">"123"</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "character"</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(x)</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] "numeric"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="logical" class="level2">
<h2 class="anchored" data-anchor-id="logical">Logical</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that logical elements are NOT in quotes.</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>, <span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.logical</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TRUE = 1 and FALSE = 0. sum() and mean() work on logical vectors</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remember:</span></span>
<span id="cb156-4"><a href="#cb156-4" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">|</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="factor" class="level2">
<h2 class="anchored" data-anchor-id="factor">Factor</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'B'</span>,<span class="st">'B'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'C'</span>)</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">factor</span>(y)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 3 levels "A","B","C": 2 2 1 1 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 2 1 1 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A" "B" "C"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">factor</span>(z,                       <span class="co"># vector of data levels to convert </span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'B'</span>,<span class="st">'A'</span>,<span class="st">'C'</span>),   <span class="co"># Order of the levels</span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"B Group"</span>, <span class="st">"A Group"</span>, <span class="st">"C Group"</span>)) <span class="co"># Pretty labels to use</span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] B Group B Group A Group A Group C Group
Levels: B Group A Group C Group</code></pre>
</div>
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="do">#####Application</span></span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="do">### eg of use in the plot's x-axis name lable</span></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">factor</span>(iris<span class="sc">$</span>Species,</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'versicolor'</span>,<span class="st">'setosa'</span>,<span class="st">'virginica'</span>),</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Versicolor'</span>,<span class="st">'Setosa'</span>,<span class="st">'Virginica'</span>))</span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot(Sepal.Length ~ Species, data=iris)</span></span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a><span class="do">### another eg</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a><span class="co">#age_category &lt;- ifelse(ages &gt;= 18, "Adult", "Minor")</span></span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a><span class="co">#age_factor &lt;- factor(age_category, levels = c("Minor", "Adult"))</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a><span class="co">#age_factor</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a><span class="do">### transform a continuous numerical vector into a factor</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a><span class="fu">cut</span>(x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="fl">5.0</span>, <span class="fl">7.5</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] (0,2.5]  (0,2.5]  (2.5,5]  (2.5,5]  (2.5,5]  (5,7.5]  (5,7.5]  (7.5,10]
 [9] (7.5,10] (7.5,10]
Levels: (0,2.5] (2.5,5] (5,7.5] (7.5,10]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>x<span class="ot">&lt;-</span><span class="fu">cut</span>(x, <span class="at">breaks=</span><span class="dv">3</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">'Low'</span>,<span class="st">'Medium'</span>,<span class="st">'High'</span>))</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 3 levels "Low","Medium",..: 1 1 1 1 2 2 2 3 3 3</code></pre>
</div>
</div>
</section>
<section id="date-and-time" class="level2">
<h2 class="anchored" data-anchor-id="date-and-time">Date and time</h2>
<p>The following symbols can be used with the <code>format()</code> function to print dates.</p>
<ul>
<li>%d day as a number (0-31) 01-31</li>
<li>%a abbreviated weekday Mon</li>
<li>%A unabbreviated weekday Monday</li>
<li>%m month (00-12) 00-12</li>
<li>%b abbreviated month Jan</li>
<li>%B unabbreviated month January</li>
<li>%y 2-digit year 07</li>
<li>%Y 4-digit year 2007</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>mydates <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2023-04-07"</span>, <span class="st">"2023-01-01"</span>))</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>mydates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-04-07" "2023-01-01"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> mydates[<span class="dv">1</span>] <span class="sc">-</span> mydates[<span class="dv">2</span>]; days</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 96 days</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(today, <span class="at">format=</span><span class="st">"%B %d %Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "October 12 2025"</code></pre>
</div>
</div>
</section>
<section id="data-frame" class="level2">
<h2 class="anchored" data-anchor-id="data-frame">Data frame</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>Data_Frame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Tr =</span><span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>),</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Pu =</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">21</span>,<span class="dv">32</span>),</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Dur=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">222</span>,<span class="dv">1</span>))</span>
<span id="cb180-4"><a href="#cb180-4" aria-hidden="true" tabindex="-1"></a>Data_Frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tr Pu Dur
1  1 11  22
2  2 21 222
3  3 32   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Data_Frame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Tr                  Pu             Dur        
 Length:3           Min.   :11.00   Min.   :  1.00  
 Class :character   1st Qu.:16.00   1st Qu.: 11.50  
 Mode  :character   Median :21.00   Median : 22.00  
                    Mean   :21.33   Mean   : 81.67  
                    3rd Qu.:26.50   3rd Qu.:122.00  
                    Max.   :32.00   Max.   :222.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="do">### table and data frame</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mpg<span class="sc">$</span>class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   2seater    compact    midsize    minivan     pickup subcompact        suv 
         5         47         41         11         33         35         62 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(mpg<span class="sc">$</span>class))</span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Var1 Freq
1    2seater    5
2    compact   47
3    midsize   41
4    minivan   11
5     pickup   33
6 subcompact   35
7        suv   62</code></pre>
</div>
</div>
</section>
<section id="list" class="level2">
<h2 class="anchored" data-anchor-id="list">List</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List ---Can hold vectors, strings, matrices, models, list of other list, lists upon lists!</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">letters=</span><span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>),</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">numbers=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,<span class="at">ncol=</span><span class="dv">5</span>))</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mylist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "a" "b" "c"

$numbers
[1] 1 2 3

[[3]]
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    6   11   16   21
[2,]    2    7   12   17   22
[3,]    3    8   13   18   23
[4,]    4    9   14   19   24
[5,]    5   10   15   20   25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can reference data using $ (if the elements are named), or using [], or [[]]</span></span>
<span id="cb190-2"><a href="#cb190-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-3"><a href="#cb190-3" aria-hidden="true" tabindex="-1"></a>mylist[<span class="dv">1</span>] <span class="co"># list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a>mylist[<span class="st">"letters"</span>] <span class="co"># list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="dv">1</span>]] <span class="co"># vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>mylist<span class="sc">$</span>letters <span class="sc">==</span> mylist[[<span class="st">"letters"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="dv">3</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    6
[2,]    2    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mylist[[<span class="dv">3</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "matrix" "array" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>); <span class="dv">2</span> <span class="sc">%in%</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="co"># eg of using list</span></span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.9</span>, <span class="fl">5.6</span>, <span class="fl">4.2</span>, <span class="fl">4.8</span>, <span class="fl">4.5</span>, <span class="fl">5.3</span>, <span class="fl">5.2</span>)   <span class="co"># some toy data</span></span>
<span id="cb204-3"><a href="#cb204-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative=</span><span class="st">'less'</span>, <span class="at">mu=</span><span class="dv">5</span>)   <span class="co"># do a t-test</span></span>
<span id="cb204-4"><a href="#cb204-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(results)    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 10
 $ statistic  : Named num -0.314
  ..- attr(*, "names")= chr "t"
 $ parameter  : Named num 7
  ..- attr(*, "names")= chr "df"
 $ p.value    : num 0.381
 $ conf.int   : num [1:2] -Inf 5.25
  ..- attr(*, "conf.level")= num 0.95
 $ estimate   : Named num 4.95
  ..- attr(*, "names")= chr "mean of x"
 $ null.value : Named num 5
  ..- attr(*, "names")= chr "mean"
 $ stderr     : num 0.159
 $ alternative: chr "less"
 $ method     : chr "One Sample t-test"
 $ data.name  : chr "x"
 - attr(*, "class")= chr "htest"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3813385</code></pre>
</div>
</div>
</section>
<section id="matrix" class="level2">
<h2 class="anchored" data-anchor-id="matrix">Matrix</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrices</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">9</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">=</span> <span class="fu">matrix</span>(n,<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb208-5"><a href="#cb208-5" aria-hidden="true" tabindex="-1"></a>mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">diag</span>(n)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use %*% as the product of matrices</span></span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Eigenvalue and Eigenvector</span></span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">13</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">11</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">8</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A)</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-10"><a href="#cb210-10" aria-hidden="true" tabindex="-1"></a>(values <span class="ot">&lt;-</span> ev<span class="sc">$</span>values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17  8  7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>(vectors <span class="ot">&lt;-</span> ev<span class="sc">$</span>vectors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]      [,3]
[1,]  0.7453560  0.6666667 0.0000000
[2,] -0.5962848  0.6666667 0.4472136
[3,]  0.2981424 -0.3333333 0.8944272</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data selection --row then column</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a>mat[<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a>mat[<span class="dv">1</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a>mat[,<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mat[<span class="dv">1</span>, ]) <span class="co"># Note that the class of the returned object is no longer a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
</div>
</section>
<section id="example-1-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1-1">Example 1</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>db_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">drugs =</span> <span class="fu">list</span>(</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">general_information =</span> <span class="fu">data.frame</span>(</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">drugbank_id =</span> <span class="fu">c</span>(<span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>),</span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Aspirin"</span>, <span class="st">"Ibuprofen"</span>, <span class="st">"Paracetamol"</span>, <span class="st">"Insulin"</span>, <span class="st">"Morphine"</span>),</span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"small molecule"</span>, <span class="st">"small molecule"</span>, <span class="st">"small molecule"</span>, <span class="st">"biotech"</span>, <span class="st">"small molecule"</span>),</span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">created =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2020-01-01"</span>, <span class="st">"2020-02-01"</span>, <span class="st">"2020-03-01"</span>, <span class="st">"2020-04-01"</span>, <span class="st">"2020-05-01"</span>)),</span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb222-10"><a href="#cb222-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">drug_classification =</span> <span class="fu">data.frame</span>(</span>
<span id="cb222-11"><a href="#cb222-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">drugbank_id =</span> <span class="fu">c</span>(<span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>),</span>
<span id="cb222-12"><a href="#cb222-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">classification =</span> <span class="fu">c</span>(<span class="st">"Analgesic"</span>, <span class="st">"Anti-inflammatory"</span>, <span class="st">"Analgesic"</span>, <span class="st">"Hormone"</span>, <span class="st">"Analgesic"</span>),</span>
<span id="cb222-13"><a href="#cb222-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb222-14"><a href="#cb222-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb222-15"><a href="#cb222-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">experimental_properties =</span> <span class="fu">data.frame</span>(</span>
<span id="cb222-16"><a href="#cb222-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">drugbank_id =</span> <span class="fu">c</span>(<span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>, <span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>),</span>
<span id="cb222-17"><a href="#cb222-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">kind =</span> <span class="fu">c</span>(<span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>),</span>
<span id="cb222-18"><a href="#cb222-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="fu">c</span>(<span class="st">"1.2"</span>, <span class="st">"1.5"</span>, <span class="st">"0.8"</span>, <span class="st">"2.1"</span>, <span class="st">"1.8"</span>, <span class="st">"180.1"</span>, <span class="st">"206.3"</span>, <span class="st">"151.2"</span>, <span class="st">"5800.0"</span>, <span class="st">"281.5"</span>),</span>
<span id="cb222-19"><a href="#cb222-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb222-20"><a href="#cb222-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb222-21"><a href="#cb222-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb222-22"><a href="#cb222-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb222-23"><a href="#cb222-23" aria-hidden="true" tabindex="-1"></a>db_data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$drugs
$drugs$general_information
  drugbank_id        name           type    created
1       DB001     Aspirin small molecule 2020-01-01
2       DB002   Ibuprofen small molecule 2020-02-01
3       DB003 Paracetamol small molecule 2020-03-01
4       DB004     Insulin        biotech 2020-04-01
5       DB005    Morphine small molecule 2020-05-01

$drugs$drug_classification
  drugbank_id    classification
1       DB001         Analgesic
2       DB002 Anti-inflammatory
3       DB003         Analgesic
4       DB004           Hormone
5       DB005         Analgesic

$drugs$experimental_properties
   drugbank_id             kind  value
1        DB001             logP    1.2
2        DB002             logP    1.5
3        DB003             logP    0.8
4        DB004             logP    2.1
5        DB005             logP    1.8
6        DB001 Molecular Weight  180.1
7        DB002 Molecular Weight  206.3
8        DB003 Molecular Weight  151.2
9        DB004 Molecular Weight 5800.0
10       DB005 Molecular Weight  281.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>general_information <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>general_information</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(general_information)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id        name           type    created
1       DB001     Aspirin small molecule 2020-01-01
2       DB002   Ibuprofen small molecule 2020-02-01
3       DB003 Paracetamol small molecule 2020-03-01
4       DB004     Insulin        biotech 2020-04-01
5       DB005    Morphine small molecule 2020-05-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 20. Number of drugs in the general_information dataframe</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>general_information <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>general_information</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(general_information)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 21. Filter drugs of type "biotech"</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>general_information[general_information<span class="sc">$</span>type <span class="sc">==</span> <span class="st">'biotech'</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id    name    type    created
4       DB004 Insulin biotech 2020-04-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 22. Sort by the created column and display the first 5 rows</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a>general_information<span class="sc">$</span>created <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(general_information<span class="sc">$</span>created)</span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a>sorted_df <span class="ot">&lt;-</span> general_information[<span class="fu">order</span>(general_information<span class="sc">$</span>created), ]</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sorted_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id        name           type    created
1       DB001     Aspirin small molecule 2020-01-01
2       DB002   Ibuprofen small molecule 2020-02-01
3       DB003 Paracetamol small molecule 2020-03-01
4       DB004     Insulin        biotech 2020-04-01
5       DB005    Morphine small molecule 2020-05-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 23. Subset with specific columns and display the first 5 rows</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>subset_df <span class="ot">&lt;-</span> general_information[, <span class="fu">c</span>(<span class="st">"drugbank_id"</span>, <span class="st">"name"</span>)]</span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id        name
1       DB001     Aspirin
2       DB002   Ibuprofen
3       DB003 Paracetamol
4       DB004     Insulin
5       DB005    Morphine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 24. Merge dataframes and count rows</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>drug_classification <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>drug_classification</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(general_information, drug_classification, <span class="at">by =</span> <span class="st">"drugbank_id"</span>)</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(merged_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 25. Count unique experimental properties (kind)</span></span>
<span id="cb236-2"><a href="#cb236-2" aria-hidden="true" tabindex="-1"></a>experimental_properties <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>experimental_properties</span>
<span id="cb236-3"><a href="#cb236-3" aria-hidden="true" tabindex="-1"></a>unique_kinds <span class="ot">&lt;-</span> <span class="fu">unique</span>(experimental_properties<span class="sc">$</span>kind)</span>
<span id="cb236-4"><a href="#cb236-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(unique_kinds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 26. Filter for kind "logP" and count rows</span></span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>logP_df <span class="ot">&lt;-</span> experimental_properties[experimental_properties<span class="sc">$</span>kind <span class="sc">==</span> <span class="st">"logP"</span>, ]</span>
<span id="cb238-3"><a href="#cb238-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(logP_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 27. Convert value column to numeric and calculate mean</span></span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>logP_df<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logP_df<span class="sc">$</span>value)</span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(logP_df<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb242"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 28. Calculate summary statistics for logP values</span></span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logP_df<span class="sc">$</span>value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.80    1.20    1.50    1.48    1.80    2.10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(logP_df<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5069517</code></pre>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 29. Create a histogram of molecular weight values</span></span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a>molecular_weight <span class="ot">&lt;-</span> experimental_properties[experimental_properties<span class="sc">$</span>kind <span class="sc">==</span> <span class="st">"Molecular Weight"</span>, ]</span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a>molecular_weight<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(molecular_weight<span class="sc">$</span>value)</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="co"># clean based on 3 sigma rule</span></span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>molecular_weight_clean <span class="ot">&lt;-</span> molecular_weight[</span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(molecular_weight<span class="sc">$</span>value <span class="sc">-</span> <span class="fu">mean</span>(molecular_weight<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sd</span>(molecular_weight<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(molecular_weight_clean<span class="sc">$</span>value, <span class="at">main =</span> <span class="st">"Histogram of Molecular Weight"</span>, <span class="at">xlab =</span> <span class="st">"Molecular Weight"</span>, <span class="at">ylab =</span> <span class="st">"Frequency"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>,<span class="at">breaks =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 30. Filter for kind "Water Solubility" and count unique values</span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>water_solubility_df <span class="ot">&lt;-</span> experimental_properties[experimental_properties<span class="sc">$</span>kind <span class="sc">==</span> <span class="st">"Water Solubility"</span>, ]</span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(water_solubility_df<span class="sc">$</span>value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
</section>
<section id="data-visualization-mainly-ggplot2" class="level1">
<h1>Data visualization (mainly: ggplot2)</h1>
<section id="box-plots" class="level2">
<h2 class="anchored" data-anchor-id="box-plots">Box plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>class, <span class="at">y=</span>hwy)) <span class="sc">+</span> </span>
<span id="cb250-2"><a href="#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb250-3"><a href="#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">45</span>, <span class="at">by=</span><span class="dv">5</span>))  <span class="co">#---diy scale in y-axis </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(mpg, aes(x=class, y=hwy)) + geom_boxplot() +scale_y_continuous(breaks = seq(10, 45, by=5), minor_breaks = NULL)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="histogram-plots" class="level2">
<h2 class="anchored" data-anchor-id="histogram-plots">Histogram plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data=</span>iris)</span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data=</span>iris), <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mpg, <span class="at">package=</span><span class="st">'ggplot2'</span>)</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="fu">aes</span>(<span class="at">x=</span>class)) <span class="sc">+</span></span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-36-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By default, the geom_bar() just counts the number of cases and displays how many observations were in each factor level. If we have a data frame that we have already summarized, geom_col will allow us to set the height of the bar by a y column.</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mpg<span class="sc">$</span>class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   2seater    compact    midsize    minivan     pickup subcompact        suv 
         5         47         41         11         33         35         62 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(mpg<span class="sc">$</span>class))</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Var1 Freq
1    2seater    5
2    compact   47
3    midsize   41
4    minivan   11
5     pickup   33
6 subcompact   35
7        suv   62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb259"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Var1, Freq)) <span class="sc">+</span></span>
<span id="cb259-2"><a href="#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-36-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x=</span>hwy)) <span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-36-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="density-plots" class="level2">
<h2 class="anchored" data-anchor-id="density-plots">Density plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>hwy, <span class="at">y=</span><span class="fu">after_stat</span>(density))) <span class="sc">+</span> </span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">8</span>, <span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histogram of Highway MPG density"</span>)</span>
<span id="cb261-4"><a href="#cb261-4" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>hwy)) <span class="sc">+</span> </span>
<span id="cb261-5"><a href="#cb261-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">'red'</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb261-6"><a href="#cb261-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Density Plot of Highway MPG"</span>)</span>
<span id="cb261-7"><a href="#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb264"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb264-1"><a href="#cb264-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>mutiple plots in one figure</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Species,<span class="at">color=</span>Species), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot"</span>) <span class="sc">+</span></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sepal Length"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"area"</span>,<span class="at">color=</span><span class="st">"line"</span>)  <span class="co"># fill is the area,color is the line or dot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatter-plots" class="level2">
<h2 class="anchored" data-anchor-id="scatter-plots">Scatter plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">factor</span>(mtcars<span class="sc">$</span>cyl) </span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>wt, <span class="at">y=</span>mpg, <span class="at">col=</span>cyl)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Weight vs Miles per Gallon'</span>) <span class="sc">+</span></span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Weight in tons (2000 lbs)"</span>, <span class="at">y=</span><span class="st">"Miles per Gallon (US)"</span> ) <span class="sc">+</span></span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Cylinders"</span>) <span class="sc">+</span> <span class="co"># color is dot or line</span></span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'blue'</span>, <span class="st">'darkmagenta'</span>, <span class="st">'aquamarine'</span>)) <span class="co"># diy color</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="scatter-plots-with-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="scatter-plots-with-regression-line">Scatter plots with regression line</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb267"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Petal.Length,<span class="at">color=</span>Species))<span class="sc">+</span></span>
<span id="cb267-2"><a href="#cb267-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span><span class="co"># Anything set inside an aes() command will be of the form attribute=Column_Name and will change based on the data. Anything set outside an aes() command will be in the form attribute=value and will be fixed.</span></span>
<span id="cb267-3"><a href="#cb267-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>) <span class="co">#By default, geom_smooth(method="lm") fits a linear regression line for each Species separately because Species are mapped to colors, and geom_smooth automatically draws a line for each category.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb269"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Petal.Length)) <span class="sc">+</span></span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Species,<span class="at">shape=</span>Species))<span class="sc">+</span></span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-40-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Zooming in/out--Danger!  This removes the data points first!</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(trees, aes(x=Girth, y=Volume)) + </span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point() +</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_smooth(method='lm') +</span></span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xlim( 8, 19 ) + ylim(0, 60)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x=</span>flipper_length_mm, <span class="at">y=</span>body_mass_g)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>bill_depth_mm, <span class="at">shape=</span>species), <span class="at">na.rm=</span>T) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">na.rm=</span>T, <span class="at">se=</span>F) <span class="sc">+</span> <span class="fu">scale_color_gradient2</span>(<span class="at">low=</span><span class="st">'yellow'</span>, <span class="at">mid=</span><span class="st">'green'</span>, <span class="at">high=</span><span class="st">'blue'</span>, <span class="at">midpoint =</span> <span class="dv">17</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Flipper length (millimeters)'</span>, <span class="at">y=</span><span class="st">'Body mass (grams)'</span>, <span class="at">color=</span><span class="st">'Bill depth (millimeters)'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="heat-map" class="level2">
<h2 class="anchored" data-anchor-id="heat-map">Heat map</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data</span></span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>mine.table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample.name =</span> <span class="fu">rep</span>(<span class="fu">paste0</span>(<span class="st">"Sample"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="at">each =</span> <span class="dv">3</span>),</span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Class1"</span>, <span class="st">"Class2"</span>, <span class="st">"Class3"</span>), <span class="at">times =</span> <span class="dv">5</span>),</span>
<span id="cb274-5"><a href="#cb274-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Abundance =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>, <span class="fl">0.4</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.7</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">1.0</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>, <span class="fl">1.4</span>, <span class="fl">1.5</span>),</span>
<span id="cb274-6"><a href="#cb274-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Depth =</span> <span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>, <span class="fl">0.6</span>,<span class="fl">0.6</span>,<span class="fl">0.6</span>, <span class="fl">0.7</span>,<span class="fl">0.7</span>,<span class="fl">0.7</span>, <span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>, <span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>)</span>
<span id="cb274-7"><a href="#cb274-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb274-8"><a href="#cb274-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mine.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sample.name  Class Abundance Depth
1      Sample1 Class1       0.1   0.5
2      Sample1 Class2       0.2   0.5
3      Sample1 Class3       0.3   0.5
4      Sample2 Class1       0.4   0.6
5      Sample2 Class2       0.5   0.6
6      Sample2 Class3       0.6   0.6
7      Sample3 Class1       0.7   0.7
8      Sample3 Class2       0.8   0.7
9      Sample3 Class3       0.9   0.7
10     Sample4 Class1       1.0   0.8
11     Sample4 Class2       1.1   0.8
12     Sample4 Class3       1.2   0.8
13     Sample5 Class1       1.3   0.9
14     Sample5 Class2       1.4   0.9
15     Sample5 Class3       1.5   0.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mine.table, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sample.name, <span class="at">y =</span> Class, <span class="at">fill =</span> Abundance)) <span class="sc">+</span> </span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="co"># create the heatmap with tiles+</span></span>
<span id="cb276-3"><a href="#cb276-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(<span class="fu">factor</span>(mine.table<span class="sc">$</span>Class)))) <span class="sc">+</span>  <span class="co"># reverse the order of the y-axis --class1 to class 3 (if not have this:class 3 to class 1)</span></span>
<span id="cb276-4"><a href="#cb276-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"blue"</span>) <span class="sc">+</span>  <span class="co"># color</span></span>
<span id="cb276-5"><a href="#cb276-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># control the theme of the plot</span></span>
<span id="cb276-6"><a href="#cb276-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span>  <span class="co"># Rotate the X-axis label for better display</span></span>
<span id="cb276-7"><a href="#cb276-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Name"</span>,  <span class="co"># x-axis label</span></span>
<span id="cb276-8"><a href="#cb276-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Class"</span>,  <span class="co"># y-axis label</span></span>
<span id="cb276-9"><a href="#cb276-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Abundance"</span>)<span class="sc">+</span> <span class="co"># fill legend label by "Abundance"</span></span>
<span id="cb276-10"><a href="#cb276-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">ggtitle</span>(<span class="st">"Heatmap of Abundance by Sample and Class"</span>)<span class="sc">+</span> <span class="co"># add title</span></span>
<span id="cb276-11"><a href="#cb276-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Abundance, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="co"># add text labels to the tiles</span></span>
<span id="cb276-12"><a href="#cb276-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-13"><a href="#cb276-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb276-14"><a href="#cb276-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mine.heatmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Create heat map using facet_grid to show the data in different panels by depth</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mine.table, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sample.name, <span class="at">y =</span> Class, <span class="at">fill =</span> Abundance)) <span class="sc">+</span> </span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> <span class="co"># create the heatmap with tiles+</span></span>
<span id="cb277-3"><a href="#cb277-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span> Depth,<span class="at">switch =</span> <span class="st">'x'</span>, <span class="at">scales=</span><span class="st">'free'</span>, <span class="at">space=</span><span class="st">'free'</span>)<span class="sc">+</span> <span class="co"># facet_grid to show the data in different panels by depth</span></span>
<span id="cb277-4"><a href="#cb277-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> <span class="fu">rev</span>(<span class="fu">levels</span>(<span class="fu">factor</span>(mine.table<span class="sc">$</span>Class)))) <span class="sc">+</span>  <span class="co"># reverse the order of the y-axis --class1 to class 3 (if not have this:class 3 to class 1)</span></span>
<span id="cb277-5"><a href="#cb277-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"#FFFFFF"</span>, <span class="at">high=</span><span class="st">"#012345"</span>)<span class="sc">+</span>  <span class="co"># color</span></span>
<span id="cb277-6"><a href="#cb277-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span>  <span class="co"># control the theme of the plot</span></span>
<span id="cb277-7"><a href="#cb277-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span>  <span class="co"># Rotate the X-axis label for better display</span></span>
<span id="cb277-8"><a href="#cb277-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sample Name"</span>,  <span class="co"># x-axis label</span></span>
<span id="cb277-9"><a href="#cb277-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Class"</span>,  <span class="co"># y-axis label</span></span>
<span id="cb277-10"><a href="#cb277-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Abundance"</span>)<span class="sc">+</span> <span class="co"># fill legend label by "Abundance"</span></span>
<span id="cb277-11"><a href="#cb277-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">ggtitle</span>(<span class="st">"Heatmap of Abundance by Sample and Class"</span>)<span class="sc">+</span> <span class="co"># add title</span></span>
<span id="cb277-12"><a href="#cb277-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Abundance, <span class="dv">2</span>)), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="co"># add text labels to the tiles</span></span>
<span id="cb277-13"><a href="#cb277-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb277-14"><a href="#cb277-14" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb277-15"><a href="#cb277-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-16"><a href="#cb277-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb277-17"><a href="#cb277-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mine.heatmap)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="faceting-make-many-panels-of-graphics-where-each-panel-represents-the-same-relationship-between-variables-but-something-changes-between-each-pane" class="level2">
<h2 class="anchored" data-anchor-id="faceting-make-many-panels-of-graphics-where-each-panel-represents-the-same-relationship-between-variables-but-something-changes-between-each-pane">Faceting (make many panels of graphics where each panel represents the same relationship between variables, but something changes between each pane)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width)) <span class="sc">+</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Species) <span class="co">#or facet_grid(Species~.)--Categorical variables of species will be vertical</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Another example</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    rename</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    expand</code></pre>
</div>
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tips, <span class="at">package=</span><span class="st">'reshape'</span>)</span>
<span id="cb283-2"><a href="#cb283-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tips, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  total_bill  tip    sex smoker day   time size
1      16.99 1.01 Female     No Sun Dinner    2
2      10.34 1.66   Male     No Sun Dinner    3
3      21.01 3.50   Male     No Sun Dinner    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tips, <span class="fu">aes</span>(<span class="at">x =</span> total_bill, <span class="at">y =</span> tip <span class="sc">/</span> total_bill)) <span class="sc">+</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>( smoker <span class="sc">~</span> day )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'free_y' means the scale of different panels are adjusted by themselves</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tips, <span class="fu">aes</span>(<span class="at">x =</span> total_bill, <span class="at">y =</span> tip <span class="sc">/</span> total_bill)) <span class="sc">+</span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> day, <span class="at">scales=</span><span class="st">'free_y'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log scales ---a wrapper of  scale_y_continuous() function , trans_new() function</span></span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(ACS, aes(x=Age, y=Income)) + geom_point() +</span></span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_y_log10(breaks=c(1, 10, 100),</span></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="co">#            minor=c(1:10,</span></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                 seq(10, 100, by=10 ),</span></span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                seq(100, 1000, by=100))) +</span></span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  ylab('Income (1000s of dollars)')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Multi-plot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ChickWeight, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>weight, <span class="at">colour=</span>Diet, <span class="at">group=</span>Chick)) <span class="sc">+</span></span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb288-3"><a href="#cb288-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Growth curve for individual chicks"</span>)</span>
<span id="cb288-4"><a href="#cb288-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Second plot</span></span>
<span id="cb288-5"><a href="#cb288-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ChickWeight, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb288-6"><a href="#cb288-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb288-7"><a href="#cb288-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">alpha=</span>.<span class="dv">2</span>, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb288-8"><a href="#cb288-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Fitted growth curve per diet"</span>)</span>
<span id="cb288-9"><a href="#cb288-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Third plot </span></span>
<span id="cb288-10"><a href="#cb288-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">21</span>), <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb288-11"><a href="#cb288-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb288-12"><a href="#cb288-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Final weight, by diet"</span>)</span>
<span id="cb288-13"><a href="#cb288-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-14"><a href="#cb288-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-15"><a href="#cb288-15" aria-hidden="true" tabindex="-1"></a><span class="co"># to realize:</span></span>
<span id="cb288-16"><a href="#cb288-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 plot2 plot2</span></span>
<span id="cb288-17"><a href="#cb288-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 plot2 plot2</span></span>
<span id="cb288-18"><a href="#cb288-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 plot3 plot3</span></span>
<span id="cb288-19"><a href="#cb288-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb288-20"><a href="#cb288-20" aria-hidden="true" tabindex="-1"></a>my.layout <span class="ot">=</span> <span class="fu">cbind</span>( <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>) ) <span class="co"># each c represents a column in a matrix and 1,2,3 represents p1,p2,p3</span></span>
<span id="cb288-21"><a href="#cb288-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: plyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>You have loaded plyr after dplyr - this is likely to cause problems.
If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
library(plyr); library(dplyr)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:reshape':

    rename, round_any</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mosaic':

    count</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize</code></pre>
</div>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>Rmisc<span class="sc">::</span><span class="fu">multiplot</span>( p1, p2, p3, <span class="at">layout=</span>my.layout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR library(ggpubr) https://rpkgs.datanovia.com/ggpubr/). </span></span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggpubr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plyr':

    mutate</code></pre>
</div>
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot (bp)</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>bxp <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(ToothGrowth, <span class="at">x =</span> <span class="st">"dose"</span>, <span class="at">y =</span> <span class="st">"len"</span>,</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"dose"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>)</span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dot plot (dp)</span></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">ggdotplot</span>(ToothGrowth, <span class="at">x =</span> <span class="st">"dose"</span>, <span class="at">y =</span> <span class="st">"len"</span>,</span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"dose"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>, <span class="at">binwidth =</span> <span class="dv">1</span>)</span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mtcars)</span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>cyl)</span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">ggbarplot</span>(mtcars, <span class="at">x =</span> <span class="st">"name"</span>, <span class="at">y =</span> <span class="st">"mpg"</span>,</span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"cyl"</span>,               <span class="co"># change fill color by cyl</span></span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"white"</span>,            <span class="co"># Set bar border colors to white</span></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"jco"</span>,            <span class="co"># jco journal color palett. see ?ggpar</span></span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">sort.val =</span> <span class="st">"asc"</span>,           <span class="co"># Sort the value in ascending order</span></span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">sort.by.groups =</span> <span class="cn">TRUE</span>,      <span class="co"># Sort inside each group</span></span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">x.text.angle =</span> <span class="dv">90</span>           <span class="co"># Rotate vertically x axis texts</span></span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span> <span class="fu">font</span>(<span class="st">"x.text"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb302-17"><a href="#cb302-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plots (sp)</span></span>
<span id="cb302-18"><a href="#cb302-18" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(mtcars, <span class="at">x =</span> <span class="st">"wt"</span>, <span class="at">y =</span> <span class="st">"mpg"</span>,</span>
<span id="cb302-19"><a href="#cb302-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">add =</span> <span class="st">"reg.line"</span>,               <span class="co"># Add regression line</span></span>
<span id="cb302-20"><a href="#cb302-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">conf.int =</span> <span class="cn">TRUE</span>,                <span class="co"># Add confidence interval</span></span>
<span id="cb302-21"><a href="#cb302-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"cyl"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>, <span class="co"># Color by groups "cyl"</span></span>
<span id="cb302-22"><a href="#cb302-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape =</span> <span class="st">"cyl"</span>                   <span class="co"># Change point shape by groups "cyl"</span></span>
<span id="cb302-23"><a href="#cb302-23" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">+</span> </span>
<span id="cb302-24"><a href="#cb302-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(<span class="fu">aes</span>(<span class="at">color =</span> cyl), <span class="at">label.x =</span> <span class="dv">3</span>)       <span class="co"># Add correlation coefficient</span></span>
<span id="cb302-25"><a href="#cb302-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-26"><a href="#cb302-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(bxp, dp, bp <span class="sc">+</span> <span class="fu">rremove</span>(<span class="st">"x.text"</span>),</span>
<span id="cb302-27"><a href="#cb302-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb302-28"><a href="#cb302-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Themes</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rmisc::multiplot( p1 + theme_bw(),          # Black and white</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                   p1 + theme_minimal(),   </span></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                   p1 + theme_dark(),        </span></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                   p1 + theme_light(),</span></span>
<span id="cb303-6"><a href="#cb303-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                   cols=2 )</span></span>
<span id="cb303-7"><a href="#cb303-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb303-8"><a href="#cb303-8" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave('p1.png', width=6, height=3, dpi=350)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-manipulation" class="level1">
<h1>Data manipulation</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.4     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1
✔ readr     2.1.5     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ plyr::arrange()      masks dplyr::arrange()
✖ gridExtra::combine() masks dplyr::combine()
✖ purrr::compact()     masks plyr::compact()
✖ plyr::count()        masks mosaic::count(), dplyr::count()
✖ purrr::cross()       masks mosaic::cross()
✖ plyr::desc()         masks dplyr::desc()
✖ mosaic::do()         masks dplyr::do()
✖ tidyr::expand()      masks reshape::expand(), Matrix::expand()
✖ plyr::failwith()     masks dplyr::failwith()
✖ dplyr::filter()      masks stats::filter()
✖ plyr::id()           masks dplyr::id()
✖ dplyr::lag()         masks stats::lag()
✖ ggpubr::mutate()     masks plyr::mutate(), dplyr::mutate()
✖ tidyr::pack()        masks Matrix::pack()
✖ dplyr::recode()      masks car::recode()
✖ plyr::rename()       masks reshape::rename(), dplyr::rename()
✖ purrr::some()        masks car::some()
✖ lubridate::stamp()   masks reshape::stamp()
✖ mosaic::stat()       masks ggplot2::stat()
✖ plyr::summarise()    masks dplyr::summarise()
✖ plyr::summarize()    masks dplyr::summarize()
✖ mosaic::tally()      masks dplyr::tally()
✖ tidyr::unpack()      masks Matrix::unpack()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<section id="apply" class="level2">
<h2 class="anchored" data-anchor-id="apply">apply</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply</span></span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize each column by calculating the mean.</span></span>
<span id="cb306-3"><a href="#cb306-3" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(iris[,<span class="sc">-</span><span class="dv">5</span>],        <span class="co"># what object do we want to apply the function to</span></span>
<span id="cb306-4"><a href="#cb306-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">MARGIN=</span><span class="dv">1</span>,    <span class="co"># rows = 1, columns = 2, (same order as [rows, cols]</span></span>
<span id="cb306-5"><a href="#cb306-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN=</span>mean     <span class="co"># what function do we want to apply     </span></span>
<span id="cb306-6"><a href="#cb306-6" aria-hidden="true" tabindex="-1"></a>     ) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2.550 2.375 2.350 2.350 2.550 2.850 2.425 2.525 2.225 2.400</code></pre>
</div>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span> <span class="fu">apply</span>( </span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>  iris[,<span class="sc">-</span><span class="dv">5</span>],        <span class="co"># what object do we want to apply the function to</span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">MARGIN=</span><span class="dv">2</span>,    <span class="co"># rows = 1, columns = 2, (same order as [rows, cols]</span></span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN=</span>mean     <span class="co"># what function do we want to apply</span></span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">rbind</span>(iris[,<span class="sc">-</span><span class="dv">5</span>], average)</span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width
1          5.1         3.5          1.4         0.2
2          4.9         3.0          1.4         0.2
3          4.7         3.2          1.3         0.2</code></pre>
</div>
</div>
<p>There are several variants of the apply() function, and the most frequently used ones are lapply() and sapply(). These two functions apply a given function to each element of a list or vector and returns a corresponding list or vector of results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lapply</span></span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">beta =</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">logic =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb310-3"><a href="#cb310-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
 [1]  1  2  3  4  5  6  7  8  9 10

$beta
[1]  0.04978707  0.13533528  0.36787944  1.00000000  2.71828183  7.38905610
[7] 20.08553692

$logic
[1]  TRUE FALSE FALSE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x, quantile, <span class="at">probs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="co"># list </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
 25%  50%  75% 
3.25 5.50 7.75 

$beta
      25%       50%       75% 
0.2516074 1.0000000 5.0536690 

$logic
25% 50% 75% 
0.0 0.5 1.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x, quantile, <span class="at">probs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="co"># matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       a      beta logic
25% 3.25 0.2516074   0.0
50% 5.50 1.0000000   0.5
75% 7.75 5.0536690   1.0</code></pre>
</div>
</div>
</section>
<section id="tibbles" class="level2">
<h2 class="anchored" data-anchor-id="tibbles">Tibbles</h2>
<p>A tibble, or tbl_df, is a modern reimagining of the data.frame, keeping what time has proven to be effective, and throwing out what is not. Tibbles are data.frames that are lazy and surly: they do less (i.e.&nbsp;they don t change variable names or types, and don t do partial matching) and complain more (e.g.&nbsp;when a variable does not exist). This forces you to confront problems earlier, typically leading to cleaner, more expressive code. Tibbles also have an enhanced print() method which makes them easier to use with large datasets containing complex objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">b =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">c =</span> <span class="fu">Sys.Date</span>() <span class="sc">-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  a b          c
1 1 a 2025-10-11
2 2 b 2025-10-10
3 3 c 2025-10-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
      a b     c         
  &lt;int&gt; &lt;chr&gt; &lt;date&gt;    
1     1 a     2025-10-11
2     2 b     2025-10-10
3     3 c     2025-10-09</code></pre>
</div>
</div>
</section>
<section id="section" class="level2">
<h2 class="anchored" data-anchor-id="section">%&gt;%</h2>
<p>The pipe operator %&gt;% is used to pass the result of one function to the next function in a chain, making the code more readable and concise. For example, if we wanted to start with x, and first apply function f(), then g(), and then h(), the usual R command would be h(g(f(x))) which is hard to read because you have to start reading at the innermost set of parentheses. Using the pipe command %&gt;%, this sequence of operations becomes x %&gt;% f() %&gt;% g() %&gt;% h().</p>
</section>
<section id="select" class="level2">
<h2 class="anchored" data-anchor-id="select">select</h2>
<div class="sourceCode" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct usage of select() within a pipeline</span></span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">ends_with</span>(<span class="st">'color'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter">filter</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb321"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb321-1"><a href="#cb321-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb321-2"><a href="#cb321-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb321-3"><a href="#cb321-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where species is "Droid" and mass is greater than or equal to 100</span></span>
<span id="cb321-4"><a href="#cb321-4" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Droid"</span>, mass <span class="sc">&lt;</span> <span class="dv">100</span>)</span>
<span id="cb321-5"><a href="#cb321-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(filtered_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name  height  mass hair_color skin_color  eye_color birth_year sex   gender   
  &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
1 C-3PO    167    75 &lt;NA&gt;       gold        yellow           112 none  masculine
2 R2-D2     96    32 &lt;NA&gt;       white, blue red               33 none  masculine
3 R5-D4     97    32 &lt;NA&gt;       white, red  red               NA none  masculine
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="slice" class="level2">
<h2 class="anchored" data-anchor-id="slice">slice</h2>
<p>This function is used to select rows by their position in the data frame. It can be used to select specific rows or a range of rows.</p>
<p>filter rows based on row number:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb323"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
2 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
3 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
</section>
<section id="arrange" class="level2">
<h2 class="anchored" data-anchor-id="arrange">arrange</h2>
<p>This function is used to sort the rows of a data frame by one or more columns. The default sorting of the number in the dataset is in ascending order, but you can use the <code>desc()</code> function to sort in descending order.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(name)) <span class="co">#The default sorting is in ascending order</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Zam Wes…    168    55 blonde     fair, gre… yellow            NA fema… femin…
 2 Yoda         66    17 white      green      brown            896 male  mascu…
 3 Yarael …    264    NA none       white      yellow            NA male  mascu…
 4 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…
 5 Wicket …     88    20 brown      brown      brown              8 male  mascu…
 6 Wedge A…    170    77 brown      fair       hazel             21 male  mascu…
 7 Watto       137    NA black      blue, grey yellow            NA male  mascu…
 8 Wat Tam…    193    48 none       green, gr… unknown           NA male  mascu…
 9 Tion Me…    206    80 none       grey       black             NA male  mascu…
10 Taun We     213    NA none       grey       black             NA fema… femin…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(height)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Yarael P…    264    NA none       white      yellow            NA male  mascu…
2 Tarfful      234   136 brown      brown      blue              NA male  mascu…
3 Lama Su      229    88 none       grey       black             NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Trt =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"Med"</span>, <span class="st">"High"</span>, <span class="st">"Low"</span>),        </span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Med"</span>, <span class="st">"High"</span>)), <span class="co"># level</span></span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">9</span>),      </span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)) </span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Trt, <span class="fu">desc</span>(y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Trt y z
1  Low 9 2
2  Med 3 1
3 High 9 1
4 High 8 1</code></pre>
</div>
</div>
</section>
<section id="mutate" class="level2">
<h2 class="anchored" data-anchor-id="mutate">mutate</h2>
<p>This function is used to create new columns or modify existing columns in a data frame. It allows you to perform calculations and transformations on the data.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb331-1"><a href="#cb331-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select using the old columns</span></span>
<span id="cb331-2"><a href="#cb331-2" aria-hidden="true" tabindex="-1"></a>starwars<span class="sc">$</span>bmi <span class="ot">=</span> starwars<span class="sc">$</span>mass <span class="sc">/</span> ((starwars<span class="sc">$</span>height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb331-3"><a href="#cb331-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, bmi) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb331-4"><a href="#cb331-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-5"><a href="#cb331-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate avoids all the starwars$</span></span>
<span id="cb331-6"><a href="#cb331-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-7"><a href="#cb331-7" aria-hidden="true" tabindex="-1"></a>starwars<span class="sc">$</span>bmi <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb331-8"><a href="#cb331-8" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb331-9"><a href="#cb331-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bmi =</span> mass <span class="sc">/</span> ((height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb331-10"><a href="#cb331-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, bmi) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb331-11"><a href="#cb331-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-12"><a href="#cb331-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate_at() and mutate_if() allow us to apply a function to a particular column and save the output.</span></span>
<span id="cb331-13"><a href="#cb331-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-14"><a href="#cb331-14" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span> </span>
<span id="cb331-15"><a href="#cb331-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">square_height =</span> (height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb331-16"><a href="#cb331-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> mass <span class="sc">/</span> square_height) <span class="sc">%&gt;%</span></span>
<span id="cb331-17"><a href="#cb331-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, square_height, bmi)</span>
<span id="cb331-18"><a href="#cb331-18" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb331-19"><a href="#cb331-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-20"><a href="#cb331-20" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">0</span>) <span class="co"># here, is.numeric is the condition</span></span>
<span id="cb331-21"><a href="#cb331-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-22"><a href="#cb331-22" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, round, <span class="at">digits=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="co"># column 2 3</span></span>
<span id="cb331-23"><a href="#cb331-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-24"><a href="#cb331-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the transformation to columns 2 and 3 for rows 1 to 3</span></span>
<span id="cb331-25"><a href="#cb331-25" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> subset <span class="sc">%&gt;%</span> </span>
<span id="cb331-26"><a href="#cb331-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">round</span>(., <span class="at">digits =</span> <span class="dv">0</span>), .))</span>
<span id="cb331-27"><a href="#cb331-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb331-28"><a href="#cb331-28" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">avg.example =</span> <span class="fu">select</span>(., square_height<span class="sc">:</span>bmi) <span class="sc">%&gt;%</span> <span class="fu">rowMeans</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="summarise" class="level2">
<h2 class="anchored" data-anchor-id="summarise">summarise</h2>
<p>This function is used to create a summary table. It reduces the data frame to a single row containing summary statistics.</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean.height=</span><span class="fu">mean</span>(height, <span class="at">na.rm=</span>T), <span class="at">sd.height=</span><span class="fu">sd</span>(height, <span class="at">na.rm=</span>T))</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the same statistic to each column</span></span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(height<span class="sc">:</span>mass) <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(<span class="fu">list</span>(<span class="at">min=</span>min, <span class="at">max=</span>max), <span class="at">na.rm=</span>T)</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">summarise_if</span>(is.numeric, <span class="fu">list</span>(<span class="at">min=</span>min, <span class="at">max=</span>max), <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="group_by" class="level2">
<h2 class="anchored" data-anchor-id="group_by">group_by</h2>
<p>This function is used to group the data frame by one or more columns. It is often used in combination with <code>summarise()</code> to calculate summary statistics for each group.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(penguins<span class="sc">$</span>sex, penguins<span class="sc">$</span>species)</span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span>           </span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb333-9"><a href="#cb333-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean.flipper =</span> <span class="fu">mean</span>(flipper_length_mm),</span>
<span id="cb333-10"><a href="#cb333-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd.flipper =</span> <span class="fu">sd</span>(flipper_length_mm),</span>
<span id="cb333-11"><a href="#cb333-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups=</span><span class="st">'keep'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb333-12"><a href="#cb333-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb333-13"><a href="#cb333-13" aria-hidden="true" tabindex="-1"></a>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">examples</h2>
<p>Find the flight with the longest departure delay among flights from the same origin and destination (use <code>filter()</code>). Relocate the origin, destination, and departure delay to the first three columns and sort by origin and dest.</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb334-3"><a href="#cb334-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin, dest) <span class="sc">%&gt;%</span> </span>
<span id="cb334-4"><a href="#cb334-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dep_delay <span class="sc">==</span> <span class="fu">max</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb334-5"><a href="#cb334-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(origin, dest, dep_delay) <span class="sc">%&gt;%</span> </span>
<span id="cb334-6"><a href="#cb334-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(origin, dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Find the flight with the longest departure delay among flights from the same origin and destination (use <code>top_n()</code> or <code>slice_max()</code>). Relocate the origin, destination, and departure delay to the first three columns and sort by origin and dest.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin, dest) <span class="sc">%&gt;%</span> </span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">1</span>, dep_delay) <span class="sc">%&gt;%</span>  <span class="co"># or using slice_max(dep_delay) %&gt;% </span></span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(origin, dest, dep_delay) <span class="sc">%&gt;%</span> </span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(origin, dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>How do departure delays vary at different times of the day? Summarize the averaged departure delays by hours and create an new column named as <code>dep_delay_level</code> which <code>cut()</code> the averaged departure delays into three levels (low, median, and high).</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour) <span class="sc">%&gt;%</span> </span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dep_delay_level =</span> <span class="fu">cut</span>(avg_dep_delay, <span class="at">breaks=</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">'low'</span>, <span class="st">'median'</span>, <span class="st">'high'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>How do departure delays vary at different times of the day? Illustrate your answer with a <code>geom_smooth()</code> plot.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb337-1"><a href="#cb337-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb337-2"><a href="#cb337-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour) <span class="sc">%&gt;%</span> </span>
<span id="cb337-3"><a href="#cb337-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb337-4"><a href="#cb337-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hour, <span class="at">y =</span> avg_dep_delay)) <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ways to deleter the blanks</span></span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">student_id =</span> <span class="st">`</span><span class="at">Student ID</span><span class="st">`</span>,</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_name =</span> <span class="st">`</span><span class="at">Full Name</span><span class="st">`</span></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb339"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb339-1"><a href="#cb339-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-2"><a href="#cb339-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb339-3"><a href="#cb339-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(</span>
<span id="cb339-4"><a href="#cb339-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# A comment I want to skip</span></span>
<span id="cb339-5"><a href="#cb339-5" aria-hidden="true" tabindex="-1"></a><span class="st">  x,y,z</span></span>
<span id="cb339-6"><a href="#cb339-6" aria-hidden="true" tabindex="-1"></a><span class="st">  1,2,3"</span>,</span>
<span id="cb339-7"><a href="#cb339-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="st">"#"</span></span>
<span id="cb339-8"><a href="#cb339-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>grade.book <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">name=</span><span class="st">'Alison'</span>,  <span class="at">HW.1=</span><span class="dv">8</span>, <span class="at">HW.2=</span><span class="dv">5</span>, <span class="at">HW.3=</span><span class="dv">8</span>, <span class="at">HW.4=</span><span class="dv">4</span>),</span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">name=</span><span class="st">'Brandon'</span>, <span class="at">HW.1=</span><span class="dv">5</span>, <span class="at">HW.2=</span><span class="dv">3</span>, <span class="at">HW.3=</span><span class="dv">6</span>, <span class="at">HW.4=</span><span class="dv">9</span>),</span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">name=</span><span class="st">'Charles'</span>, <span class="at">HW.1=</span><span class="dv">9</span>, <span class="at">HW.2=</span><span class="dv">7</span>, <span class="at">HW.3=</span><span class="dv">9</span>, <span class="at">HW.4=</span><span class="dv">10</span>))</span>
<span id="cb340-6"><a href="#cb340-6" aria-hidden="true" tabindex="-1"></a>grade.book</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     name HW.1 HW.2 HW.3 HW.4
1  Alison    8    5    8    4
2 Brandon    5    3    6    9
3 Charles    9    7    9   10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>tidy.scores <span class="ot">&lt;-</span> grade.book <span class="sc">%&gt;%</span></span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb342-3"><a href="#cb342-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"HW"</span>),</span>
<span id="cb342-4"><a href="#cb342-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Homework"</span>,</span>
<span id="cb342-5"><a href="#cb342-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Score"</span></span>
<span id="cb342-6"><a href="#cb342-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb342-7"><a href="#cb342-7" aria-hidden="true" tabindex="-1"></a>tidy.scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   name    Homework Score
   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;
 1 Alison  HW.1         8
 2 Alison  HW.2         5
 3 Alison  HW.3         8
 4 Alison  HW.4         4
 5 Brandon HW.1         5
 6 Brandon HW.2         3
 7 Brandon HW.3         6
 8 Brandon HW.4         9
 9 Charles HW.1         9
10 Charles HW.2         7
11 Charles HW.3         9
12 Charles HW.4        10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>tidy.scores <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Homework, <span class="at">values_from=</span>Score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  name     HW.1  HW.2  HW.3  HW.4
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Alison      8     5     8     4
2 Brandon     5     3     6     9
3 Charles     9     7     9    10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table joins</span></span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb346-3"><a href="#cb346-3" aria-hidden="true" tabindex="-1"></a>Fish.Data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb346-4"><a href="#cb346-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lake_ID =</span> <span class="fu">c</span>(<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'C'</span>), </span>
<span id="cb346-5"><a href="#cb346-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fish.Weight=</span><span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean=</span><span class="dv">260</span>, <span class="at">sd=</span><span class="dv">25</span>) ) <span class="co"># make up some data</span></span>
<span id="cb346-6"><a href="#cb346-6" aria-hidden="true" tabindex="-1"></a>Fish.Data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Lake_ID Fish.Weight
  &lt;chr&gt;         &lt;dbl&gt;
1 A              264.
2 A              261.
3 B              280.
4 B              263.
5 C              257.
6 C              302.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>Lake.Data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lake_ID =</span> <span class="fu">c</span>(<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>),   </span>
<span id="cb348-3"><a href="#cb348-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lake_Name =</span> <span class="fu">c</span>(<span class="st">'Lake Elaine'</span>, <span class="st">'Mormon Lake'</span>, <span class="st">'Lake Mary'</span>),   </span>
<span id="cb348-4"><a href="#cb348-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pH=</span><span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">6.3</span>, <span class="fl">6.1</span>),</span>
<span id="cb348-5"><a href="#cb348-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">area =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">210</span>, <span class="dv">240</span>),</span>
<span id="cb348-6"><a href="#cb348-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_depth =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">38</span>))</span>
<span id="cb348-7"><a href="#cb348-7" aria-hidden="true" tabindex="-1"></a>Lake.Data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Lake_ID Lake_Name      pH  area avg_depth
  &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 B       Lake Elaine   6.5    40         8
2 C       Mormon Lake   6.3   210        10
3 D       Lake Mary     6.1   240        38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(Fish.Data, Lake.Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Lake_ID)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  Lake_ID Fish.Weight Lake_Name      pH  area avg_depth
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 A              264. &lt;NA&gt;         NA      NA        NA
2 A              261. &lt;NA&gt;         NA      NA        NA
3 B              280. Lake Elaine   6.5    40         8
4 B              263. Lake Elaine   6.5    40         8
5 C              257. Mormon Lake   6.3   210        10
6 C              302. Mormon Lake   6.3   210        10
7 D               NA  Lake Mary     6.1   240        38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(Fish.Data, Lake.Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Lake_ID)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Lake_ID Fish.Weight Lake_Name      pH  area avg_depth
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 A              264. &lt;NA&gt;         NA      NA        NA
2 A              261. &lt;NA&gt;         NA      NA        NA
3 B              280. Lake Elaine   6.5    40         8
4 B              263. Lake Elaine   6.5    40         8
5 C              257. Mormon Lake   6.3   210        10
6 C              302. Mormon Lake   6.3   210        10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(Fish.Data, Lake.Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Lake_ID)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  Lake_ID Fish.Weight Lake_Name      pH  area avg_depth
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 B              280. Lake Elaine   6.5    40         8
2 B              263. Lake Elaine   6.5    40         8
3 C              257. Mormon Lake   6.3   210        10
4 C              302. Mormon Lake   6.3   210        10</code></pre>
</div>
</div>
<div class="sourceCode" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">week =</span> <span class="fu">parse_number</span>(week)</span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>how many data points are in the data set</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a>gender_year <span class="ot">&lt;-</span> Survey <span class="sc">%&gt;%</span> </span>
<span id="cb360-2"><a href="#cb360-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb360-3"><a href="#cb360-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb360-4"><a href="#cb360-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb360-5"><a href="#cb360-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">nu=</span>n)</span>
<span id="cb360-6"><a href="#cb360-6" aria-hidden="true" tabindex="-1"></a>gender_year</span>
<span id="cb360-7"><a href="#cb360-7" aria-hidden="true" tabindex="-1"></a>gender_year <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Year, <span class="at">values_from =</span> nu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a>who2 <span class="sc">%&gt;%</span> </span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>who2 <span class="ot">&lt;-</span> who2 <span class="sc">%&gt;%</span> </span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">!</span>(country<span class="sc">:</span>year), </span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>), </span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"count"</span></span>
<span id="cb361-9"><a href="#cb361-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb361-10"><a href="#cb361-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(count))</span>
<span id="cb361-11"><a href="#cb361-11" aria-hidden="true" tabindex="-1"></a>who2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(feb14_VX, airports, <span class="at">by=</span><span class="fu">c</span>(<span class="st">'dest'</span><span class="ot">=</span><span class="st">'faa'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>drug_prop <span class="ot">&lt;-</span> drug_prop <span class="sc">%&gt;%</span> </span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">'Carboxylic acids and derivatives'</span>) </span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>drug_prop <span class="sc">%&gt;%</span> </span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(logP, logS, water_solubility) <span class="sc">%&gt;%</span> </span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs.panels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="psthe-comparison-between-whether-to-use-or-not" class="level2">
<h2 class="anchored" data-anchor-id="psthe-comparison-between-whether-to-use-or-not">ps:the comparison between whether to use %&gt;% or not</h2>
<div class="sourceCode" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% </span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span>           </span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sum.Sq.Cells =</span> (flipper_length_mm <span class="sc">-</span> <span class="fu">mean</span>(flipper_length_mm))<span class="sc">^</span><span class="dv">2</span>)  <span class="sc">%&gt;%</span>  </span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sex, species, flipper_length_mm, Sum.Sq.Cells) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a><span class="co"># not use %&gt;% </span></span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(</span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">mutate</span>(<span class="fu">group_by</span>(<span class="fu">filter</span>(penguins, <span class="sc">!</span><span class="fu">is.na</span>(sex)), sex, species),</span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">Sum.Sq.Cells =</span> (flipper_length_mm <span class="sc">-</span> <span class="fu">mean</span>(flipper_length_mm))<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a>       sex, species, flipper_length_mm, Sum.Sq.Cells))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(nycflights13<span class="sc">::</span>flights)</span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the order of group_by and summarize matters</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">%&gt;%</span> </span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_dep_delay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="control-flow" class="level1">
<h1>Control flow</h1>
<section id="while-loop" class="level2">
<h2 class="anchored" data-anchor-id="while-loop">while loop</h2>
<div class="sourceCode" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (x <span class="sc">&lt;</span> <span class="dv">10</span>) {</span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(x)</span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="for-loop" class="level2">
<h2 class="anchored" data-anchor-id="for-loop">for loop</h2>
<section id="fibonacci-sequence" class="level3">
<h3 class="anchored" data-anchor-id="fibonacci-sequence">Fibonacci sequence</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">10</span>)        </span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>F[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>             </span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>F[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span>              </span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'F = '</span>, F, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>F =  0 1 0 0 0 0 0 0 0 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( n <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span> ){</span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>  F[n] <span class="ot">&lt;-</span> F[n<span class="dv">-1</span>] <span class="sc">+</span> F[n<span class="dv">-2</span>]</span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">'F = '</span>, F, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)    </span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>F =  0 1 1 0 0 0 0 0 0 0 
F =  0 1 1 2 0 0 0 0 0 0 
F =  0 1 1 2 3 0 0 0 0 0 
F =  0 1 1 2 3 5 0 0 0 0 
F =  0 1 1 2 3 5 8 0 0 0 
F =  0 1 1 2 3 5 8 13 0 0 
F =  0 1 1 2 3 5 8 13 21 0 
F =  0 1 1 2 3 5 8 13 21 34 </code></pre>
</div>
</div>
</section>
<section id="bootstrap-estimate-of-a-sampling-distribution" class="level3">
<h3 class="anchored" data-anchor-id="bootstrap-estimate-of-a-sampling-distribution">bootstrap estimate of a sampling distribution</h3>
<ul>
<li>bootstrap estimate of a sampling distribution</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>SampDist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a>  SampDist <span class="ot">&lt;-</span> trees <span class="sc">%&gt;%</span> </span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">replace =</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">xbar=</span><span class="fu">mean</span>(Height)) <span class="sc">%&gt;%</span> </span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>(SampDist)</span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SampDist,<span class="fu">aes</span>(<span class="at">x=</span>xbar)) <span class="sc">+</span></span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="functions" class="level1">
<h1>Functions</h1>
<section id="functions-condtruction" class="level2">
<h2 class="anchored" data-anchor-id="functions-condtruction">Functions condtruction</h2>
<p>copy of x</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a>example.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb373-3"><a href="#cb373-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb373-4"><a href="#cb373-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (k <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb373-5"><a href="#cb373-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(x)</span>
<span id="cb373-6"><a href="#cb373-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb373-7"><a href="#cb373-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb373-8"><a href="#cb373-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb373-9"><a href="#cb373-9" aria-hidden="true" tabindex="-1"></a><span class="fu">example.func</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a>x <span class="co"># x is changed inside the function but not outsied the function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 1 5 4 2</code></pre>
</div>
</div>
</section>
<section id="ellipses" class="level2">
<h2 class="anchored" data-anchor-id="ellipses">Ellipses</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a function that draws the regression line and confidence interval</span></span>
<span id="cb377-2"><a href="#cb377-2" aria-hidden="true" tabindex="-1"></a><span class="co"># notice it doesn't return anything, all it does is draw a plot</span></span>
<span id="cb377-3"><a href="#cb377-3" aria-hidden="true" tabindex="-1"></a>show.lm <span class="ot">&lt;-</span> <span class="cf">function</span>(m, <span class="at">interval.type=</span><span class="st">'confidence'</span>, <span class="at">fill.col=</span><span class="st">'light grey'</span>, ...){</span>
<span id="cb377-4"><a href="#cb377-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> m<span class="sc">$</span>model[,<span class="dv">2</span>]       <span class="co"># extract the predictor variable</span></span>
<span id="cb377-5"><a href="#cb377-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> m<span class="sc">$</span>model[,<span class="dv">1</span>]       <span class="co"># extract the response</span></span>
<span id="cb377-6"><a href="#cb377-6" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">interval=</span>interval.type)</span>
<span id="cb377-7"><a href="#cb377-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x, y, ...)</span>
<span id="cb377-8"><a href="#cb377-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>( <span class="fu">c</span>(x,<span class="fu">rev</span>(x)),                         <span class="co"># draw the ribbon defined</span></span>
<span id="cb377-9"><a href="#cb377-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(pred[,<span class="st">'lwr'</span>], <span class="fu">rev</span>(pred[,<span class="st">'upr'</span>])),  <span class="co"># by lwr and upr - polygon</span></span>
<span id="cb377-10"><a href="#cb377-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col=</span><span class="st">'light grey'</span>)                    <span class="co"># fills in the region defined by            </span></span>
<span id="cb377-11"><a href="#cb377-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, pred[, <span class="st">'fit'</span>])                       <span class="co"># a set of vertices, need to reverse            </span></span>
<span id="cb377-12"><a href="#cb377-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x, y)                                  <span class="co"># the uppers to make a nice figure</span></span>
<span id="cb377-13"><a href="#cb377-13" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="data-class-1" class="level1">
<h1>Data class</h1>
<div class="sourceCode" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span>(<span class="st">"R is the statistical analysis language"</span>)</span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(df, <span class="at">split =</span> <span class="st">" "</span>)</span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(df, <span class="at">split =</span> <span class="st">""</span>)</span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="st">"all16i5need6is4a9long8vacation"</span></span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>?strsplit</span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(df,<span class="at">split =</span> <span class="st">"[0-9]+"</span>)</span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Good"</span>, <span class="st">"afternoon"</span>, <span class="st">"ladies"</span>, <span class="st">"and"</span>, <span class="st">"gentlemen"</span>)</span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Good"</span>, <span class="st">"afternoon"</span>, <span class="st">"ladies"</span>, <span class="st">"and"</span>, <span class="st">"gentlemen"</span>)</span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="sc">!=</span> <span class="dv">10</span></span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)</span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">which</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)]</span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>vowels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>,<span class="st">'e'</span>,<span class="st">'i'</span>,<span class="st">'o'</span>,<span class="st">'u'</span>)</span>
<span id="cb378-14"><a href="#cb378-14" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">is.element</span>(letters, vowels))</span>
<span id="cb378-15"><a href="#cb378-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-16"><a href="#cb378-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that logical elements are NOT in quotes.</span></span>
<span id="cb378-17"><a href="#cb378-17" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>, <span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>)</span>
<span id="cb378-18"><a href="#cb378-18" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(z)</span>
<span id="cb378-19"><a href="#cb378-19" aria-hidden="true" tabindex="-1"></a><span class="fu">as.logical</span>(z)</span>
<span id="cb378-20"><a href="#cb378-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-21"><a href="#cb378-21" aria-hidden="true" tabindex="-1"></a><span class="co"># TRUE = 1 and FALSE = 0. sum() and mean() work on logical vectors</span></span>
<span id="cb378-22"><a href="#cb378-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-23"><a href="#cb378-23" aria-hidden="true" tabindex="-1"></a><span class="co"># remember:</span></span>
<span id="cb378-24"><a href="#cb378-24" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="cn">TRUE</span></span>
<span id="cb378-25"><a href="#cb378-25" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="cn">FALSE</span></span>
<span id="cb378-26"><a href="#cb378-26" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">|</span> <span class="cn">FALSE</span></span>
<span id="cb378-27"><a href="#cb378-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-28"><a href="#cb378-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-29"><a href="#cb378-29" aria-hidden="true" tabindex="-1"></a><span class="do">## Factor</span></span>
<span id="cb378-30"><a href="#cb378-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-31"><a href="#cb378-31" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'B'</span>,<span class="st">'B'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'C'</span>)</span>
<span id="cb378-32"><a href="#cb378-32" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">factor</span>(y)</span>
<span id="cb378-33"><a href="#cb378-33" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(z)</span>
<span id="cb378-34"><a href="#cb378-34" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(z)</span>
<span id="cb378-35"><a href="#cb378-35" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(z)</span>
<span id="cb378-36"><a href="#cb378-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-37"><a href="#cb378-37" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">factor</span>(z,                       <span class="co"># vector of data levels to convert </span></span>
<span id="cb378-38"><a href="#cb378-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'B'</span>,<span class="st">'A'</span>,<span class="st">'C'</span>),   <span class="co"># Order of the levels</span></span>
<span id="cb378-39"><a href="#cb378-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"B Group"</span>, <span class="st">"A Group"</span>, <span class="st">"C Group"</span>)) <span class="co"># Pretty labels to use</span></span>
<span id="cb378-40"><a href="#cb378-40" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb378-41"><a href="#cb378-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-42"><a href="#cb378-42" aria-hidden="true" tabindex="-1"></a><span class="do">### eg of use in the plot's x-axis name lable</span></span>
<span id="cb378-43"><a href="#cb378-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-44"><a href="#cb378-44" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">factor</span>(iris<span class="sc">$</span>Species,</span>
<span id="cb378-45"><a href="#cb378-45" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'versicolor'</span>,<span class="st">'setosa'</span>,<span class="st">'virginica'</span>),</span>
<span id="cb378-46"><a href="#cb378-46" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Versicolor'</span>,<span class="st">'Setosa'</span>,<span class="st">'Virginica'</span>))</span>
<span id="cb378-47"><a href="#cb378-47" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot(Sepal.Length ~ Species, data=iris)</span></span>
<span id="cb378-48"><a href="#cb378-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-49"><a href="#cb378-49" aria-hidden="true" tabindex="-1"></a><span class="do">### another eg</span></span>
<span id="cb378-50"><a href="#cb378-50" aria-hidden="true" tabindex="-1"></a><span class="co">#age_category &lt;- ifelse(ages &gt;= 18, "Adult", "Minor")</span></span>
<span id="cb378-51"><a href="#cb378-51" aria-hidden="true" tabindex="-1"></a><span class="co">#age_factor &lt;- factor(age_category, levels = c("Minor", "Adult"))</span></span>
<span id="cb378-52"><a href="#cb378-52" aria-hidden="true" tabindex="-1"></a><span class="co">#age_factor</span></span>
<span id="cb378-53"><a href="#cb378-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-54"><a href="#cb378-54" aria-hidden="true" tabindex="-1"></a><span class="co"># transform a conituous numerical vector and transform it into a factor</span></span>
<span id="cb378-55"><a href="#cb378-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-56"><a href="#cb378-56" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb378-57"><a href="#cb378-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-58"><a href="#cb378-58" aria-hidden="true" tabindex="-1"></a><span class="co"># cut(x,breaks=3)</span></span>
<span id="cb378-59"><a href="#cb378-59" aria-hidden="true" tabindex="-1"></a><span class="fu">cut</span>(x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="fl">5.0</span>, <span class="fl">7.5</span>, <span class="dv">10</span>))</span>
<span id="cb378-60"><a href="#cb378-60" aria-hidden="true" tabindex="-1"></a><span class="fu">cut</span>(x, <span class="at">breaks=</span><span class="dv">3</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">'Low'</span>,<span class="st">'Medium'</span>,<span class="st">'High'</span>))</span>
<span id="cb378-61"><a href="#cb378-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-62"><a href="#cb378-62" aria-hidden="true" tabindex="-1"></a><span class="co"># dates</span></span>
<span id="cb378-63"><a href="#cb378-63" aria-hidden="true" tabindex="-1"></a>mydates <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2023-04-07"</span>, <span class="st">"2023-01-01"</span>))</span>
<span id="cb378-64"><a href="#cb378-64" aria-hidden="true" tabindex="-1"></a>mydates</span>
<span id="cb378-65"><a href="#cb378-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-66"><a href="#cb378-66" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> mydates[<span class="dv">1</span>] <span class="sc">-</span> mydates[<span class="dv">2</span>]; days</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The following symbols can be used with the <code>format()</code> function to print dates.</p>
<ul>
<li>%d day as a number (0-31) 01-31</li>
<li>%a abbreviated weekday Mon</li>
<li>%A unabbreviated weekday Monday</li>
<li>%m month (00-12) 00-12</li>
<li>%b abbreviated month Jan</li>
<li>%B unabbreviated month January</li>
<li>%y 2-digit year 07</li>
<li>%Y 4-digit year 2007</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb379"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb379-1"><a href="#cb379-1" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb379-2"><a href="#cb379-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(today, <span class="at">format=</span><span class="st">"%B %d %Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "October 12 2025"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or library(lubridate)</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a><span class="co">#x = c("2014-02-4 05:02:00","2016/09/24 14:02:00") </span></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ymd_hms(x)</span></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a><span class="co"># POSIXct</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrices</span></span>
<span id="cb382-2"><a href="#cb382-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb382-3"><a href="#cb382-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">9</span></span>
<span id="cb382-4"><a href="#cb382-4" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">=</span> <span class="fu">matrix</span>(n,<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb382-5"><a href="#cb382-5" aria-hidden="true" tabindex="-1"></a>mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">diag</span>(n)</span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use %*% as the product of matrices</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Eigenvalue and Eigenvector</span></span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">13</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">11</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">8</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb384-8"><a href="#cb384-8" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A)</span>
<span id="cb384-9"><a href="#cb384-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-10"><a href="#cb384-10" aria-hidden="true" tabindex="-1"></a>(values <span class="ot">&lt;-</span> ev<span class="sc">$</span>values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17  8  7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a>(vectors <span class="ot">&lt;-</span> ev<span class="sc">$</span>vectors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]      [,3]
[1,]  0.7453560  0.6666667 0.0000000
[2,] -0.5962848  0.6666667 0.4472136
[3,]  0.2981424 -0.3333333 0.8944272</code></pre>
</div>
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data selection --row then column</span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a>mat[<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb390"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb390-1"><a href="#cb390-1" aria-hidden="true" tabindex="-1"></a>mat[<span class="dv">1</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>mat[,<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mat[<span class="dv">1</span>, ]) <span class="co"># Note that the class of the returned object is no longer a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frames</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>Data_Frame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Tr =</span><span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>),</span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Pu =</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">21</span>,<span class="dv">32</span>),</span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Dur=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">222</span>,<span class="dv">1</span>))</span>
<span id="cb396-6"><a href="#cb396-6" aria-hidden="true" tabindex="-1"></a>Data_Frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tr Pu Dur
1  1 11  22
2  2 21 222
3  3 32   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Data_Frame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Tr                  Pu             Dur        
 Length:3           Min.   :11.00   Min.   :  1.00  
 Class :character   1st Qu.:16.00   1st Qu.: 11.50  
 Mode  :character   Median :21.00   Median : 22.00  
                    Mean   :21.33   Mean   : 81.67  
                    3rd Qu.:26.50   3rd Qu.:122.00  
                    Max.   :32.00   Max.   :222.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List ---Can hold vectors, strings, matrices, models, list of other list, lists upon lists!</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">letters=</span><span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>),</span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">numbers=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,<span class="at">ncol=</span><span class="dv">5</span>))</span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mylist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "a" "b" "c"

$numbers
[1] 1 2 3

[[3]]
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    6   11   16   21
[2,]    2    7   12   17   22
[3,]    3    8   13   18   23
[4,]    4    9   14   19   24
[5,]    5   10   15   20   25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can reference data using $ (if the elements are named), or using [], or [[]]</span></span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb402-3"><a href="#cb402-3" aria-hidden="true" tabindex="-1"></a>mylist[<span class="dv">1</span>] <span class="co"># list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>mylist[<span class="st">"letters"</span>] <span class="co"># list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="dv">1</span>]] <span class="co"># vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb408"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb408-1"><a href="#cb408-1" aria-hidden="true" tabindex="-1"></a>mylist<span class="sc">$</span>letters <span class="sc">==</span> mylist[[<span class="st">"letters"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="dv">3</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    6
[2,]    2    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mylist[[<span class="dv">3</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "matrix" "array" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>); <span class="dv">2</span> <span class="sc">%in%</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># eg of Matrices data frames</span></span>
<span id="cb416-2"><a href="#cb416-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.9</span>, <span class="fl">5.6</span>, <span class="fl">4.2</span>, <span class="fl">4.8</span>, <span class="fl">4.5</span>, <span class="fl">5.3</span>, <span class="fl">5.2</span>)   <span class="co"># some toy data</span></span>
<span id="cb416-3"><a href="#cb416-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative=</span><span class="st">'less'</span>, <span class="at">mu=</span><span class="dv">5</span>)   <span class="co"># do a t-test</span></span>
<span id="cb416-4"><a href="#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(results)    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 10
 $ statistic  : Named num -0.314
  ..- attr(*, "names")= chr "t"
 $ parameter  : Named num 7
  ..- attr(*, "names")= chr "df"
 $ p.value    : num 0.381
 $ conf.int   : num [1:2] -Inf 5.25
  ..- attr(*, "conf.level")= num 0.95
 $ estimate   : Named num 4.95
  ..- attr(*, "names")= chr "mean of x"
 $ null.value : Named num 5
  ..- attr(*, "names")= chr "mean"
 $ stderr     : num 0.159
 $ alternative: chr "less"
 $ method     : chr "One Sample t-test"
 $ data.name  : chr "x"
 - attr(*, "class")= chr "htest"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb418"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb418-1"><a href="#cb418-1" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3813385</code></pre>
</div>
</div>
<p>Practice of Lab 5</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb420"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb420-1"><a href="#cb420-1" aria-hidden="true" tabindex="-1"></a>db_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb420-2"><a href="#cb420-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">drugs =</span> <span class="fu">list</span>(</span>
<span id="cb420-3"><a href="#cb420-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">general_information =</span> <span class="fu">data.frame</span>(</span>
<span id="cb420-4"><a href="#cb420-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">drugbank_id =</span> <span class="fu">c</span>(<span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>),</span>
<span id="cb420-5"><a href="#cb420-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Aspirin"</span>, <span class="st">"Ibuprofen"</span>, <span class="st">"Paracetamol"</span>, <span class="st">"Insulin"</span>, <span class="st">"Morphine"</span>),</span>
<span id="cb420-6"><a href="#cb420-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"small molecule"</span>, <span class="st">"small molecule"</span>, <span class="st">"small molecule"</span>, <span class="st">"biotech"</span>, <span class="st">"small molecule"</span>),</span>
<span id="cb420-7"><a href="#cb420-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">created =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2020-01-01"</span>, <span class="st">"2020-02-01"</span>, <span class="st">"2020-03-01"</span>, <span class="st">"2020-04-01"</span>, <span class="st">"2020-05-01"</span>)),</span>
<span id="cb420-8"><a href="#cb420-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb420-9"><a href="#cb420-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb420-10"><a href="#cb420-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">drug_classification =</span> <span class="fu">data.frame</span>(</span>
<span id="cb420-11"><a href="#cb420-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">drugbank_id =</span> <span class="fu">c</span>(<span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>),</span>
<span id="cb420-12"><a href="#cb420-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">classification =</span> <span class="fu">c</span>(<span class="st">"Analgesic"</span>, <span class="st">"Anti-inflammatory"</span>, <span class="st">"Analgesic"</span>, <span class="st">"Hormone"</span>, <span class="st">"Analgesic"</span>),</span>
<span id="cb420-13"><a href="#cb420-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb420-14"><a href="#cb420-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb420-15"><a href="#cb420-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">experimental_properties =</span> <span class="fu">data.frame</span>(</span>
<span id="cb420-16"><a href="#cb420-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">drugbank_id =</span> <span class="fu">c</span>(<span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>, <span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>),</span>
<span id="cb420-17"><a href="#cb420-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">kind =</span> <span class="fu">c</span>(<span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>),</span>
<span id="cb420-18"><a href="#cb420-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="fu">c</span>(<span class="st">"1.2"</span>, <span class="st">"1.5"</span>, <span class="st">"0.8"</span>, <span class="st">"2.1"</span>, <span class="st">"1.8"</span>, <span class="st">"180.1"</span>, <span class="st">"206.3"</span>, <span class="st">"151.2"</span>, <span class="st">"5800.0"</span>, <span class="st">"281.5"</span>),</span>
<span id="cb420-19"><a href="#cb420-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb420-20"><a href="#cb420-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb420-21"><a href="#cb420-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb420-22"><a href="#cb420-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb420-23"><a href="#cb420-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-24"><a href="#cb420-24" aria-hidden="true" tabindex="-1"></a>general_information <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>general_information</span>
<span id="cb420-25"><a href="#cb420-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb420-26"><a href="#cb420-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(general_information)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id        name           type    created
1       DB001     Aspirin small molecule 2020-01-01
2       DB002   Ibuprofen small molecule 2020-02-01
3       DB003 Paracetamol small molecule 2020-03-01
4       DB004     Insulin        biotech 2020-04-01
5       DB005    Morphine small molecule 2020-05-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 20. Number of drugs in the general_information dataframe</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a>general_information <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>general_information</span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(general_information)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb424"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb424-1"><a href="#cb424-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 21. Filter drugs of type "biotech"</span></span>
<span id="cb424-2"><a href="#cb424-2" aria-hidden="true" tabindex="-1"></a>general_information[general_information<span class="sc">$</span>type <span class="sc">==</span> <span class="st">'biotech'</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id    name    type    created
4       DB004 Insulin biotech 2020-04-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 22. Sort by the created column and display the first 5 rows</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a>general_information<span class="sc">$</span>created <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(general_information<span class="sc">$</span>created)</span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a>sorted_df <span class="ot">&lt;-</span> general_information[<span class="fu">order</span>(general_information<span class="sc">$</span>created), ]</span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sorted_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id        name           type    created
1       DB001     Aspirin small molecule 2020-01-01
2       DB002   Ibuprofen small molecule 2020-02-01
3       DB003 Paracetamol small molecule 2020-03-01
4       DB004     Insulin        biotech 2020-04-01
5       DB005    Morphine small molecule 2020-05-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 23. Subset with specific columns and display the first 5 rows</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a>subset_df <span class="ot">&lt;-</span> general_information[, <span class="fu">c</span>(<span class="st">"drugbank_id"</span>, <span class="st">"name"</span>)]</span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id        name
1       DB001     Aspirin
2       DB002   Ibuprofen
3       DB003 Paracetamol
4       DB004     Insulin
5       DB005    Morphine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 24. Merge dataframes and count rows</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a>drug_classification <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>drug_classification</span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(general_information, drug_classification, <span class="at">by =</span> <span class="st">"drugbank_id"</span>)</span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(merged_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 25. Count unique experimental properties (kind)</span></span>
<span id="cb432-2"><a href="#cb432-2" aria-hidden="true" tabindex="-1"></a>experimental_properties <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>experimental_properties</span>
<span id="cb432-3"><a href="#cb432-3" aria-hidden="true" tabindex="-1"></a>unique_kinds <span class="ot">&lt;-</span> <span class="fu">unique</span>(experimental_properties<span class="sc">$</span>kind)</span>
<span id="cb432-4"><a href="#cb432-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(unique_kinds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb434"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb434-1"><a href="#cb434-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 26. Filter for kind "logP" and count rows</span></span>
<span id="cb434-2"><a href="#cb434-2" aria-hidden="true" tabindex="-1"></a>logP_df <span class="ot">&lt;-</span> experimental_properties[experimental_properties<span class="sc">$</span>kind <span class="sc">==</span> <span class="st">"logP"</span>, ]</span>
<span id="cb434-3"><a href="#cb434-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(logP_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb436"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb436-1"><a href="#cb436-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 27. Convert value column to numeric and calculate mean</span></span>
<span id="cb436-2"><a href="#cb436-2" aria-hidden="true" tabindex="-1"></a>logP_df<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logP_df<span class="sc">$</span>value)</span>
<span id="cb436-3"><a href="#cb436-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(logP_df<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb438"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb438-1"><a href="#cb438-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 28. Calculate summary statistics for logP values</span></span>
<span id="cb438-2"><a href="#cb438-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logP_df<span class="sc">$</span>value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.80    1.20    1.50    1.48    1.80    2.10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb440"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb440-1"><a href="#cb440-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(logP_df<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5069517</code></pre>
</div>
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 29. Create a histogram of molecular weight values</span></span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a>molecular_weight <span class="ot">&lt;-</span> experimental_properties[experimental_properties<span class="sc">$</span>kind <span class="sc">==</span> <span class="st">"Molecular Weight"</span>, ]</span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a>molecular_weight<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(molecular_weight<span class="sc">$</span>value)</span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true" tabindex="-1"></a><span class="co"># clean based on 3 sigma rule</span></span>
<span id="cb442-5"><a href="#cb442-5" aria-hidden="true" tabindex="-1"></a>molecular_weight_clean <span class="ot">&lt;-</span> molecular_weight[</span>
<span id="cb442-6"><a href="#cb442-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(molecular_weight<span class="sc">$</span>value <span class="sc">-</span> <span class="fu">mean</span>(molecular_weight<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sd</span>(molecular_weight<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb442-7"><a href="#cb442-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(molecular_weight_clean<span class="sc">$</span>value, <span class="at">main =</span> <span class="st">"Histogram of Molecular Weight"</span>, <span class="at">xlab =</span> <span class="st">"Molecular Weight"</span>, <span class="at">ylab =</span> <span class="st">"Frequency"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>,<span class="at">breaks =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb443"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb443-1"><a href="#cb443-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 30. Filter for kind "Water Solubility" and count unique values</span></span>
<span id="cb443-2"><a href="#cb443-2" aria-hidden="true" tabindex="-1"></a>water_solubility_df <span class="ot">&lt;-</span> experimental_properties[experimental_properties<span class="sc">$</span>kind <span class="sc">==</span> <span class="st">"Water Solubility"</span>, ]</span>
<span id="cb443-3"><a href="#cb443-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(water_solubility_df<span class="sc">$</span>value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="lab-5-data-visualization" class="level1">
<h1>LAB 5 –data visualization</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data=</span>iris)</span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data=</span>iris), <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mpg, <span class="at">package=</span><span class="st">'ggplot2'</span>)</span>
<span id="cb448-2"><a href="#cb448-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="fu">aes</span>(<span class="at">x=</span>class)) <span class="sc">+</span></span>
<span id="cb448-3"><a href="#cb448-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mpg<span class="sc">$</span>class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   2seater    compact    midsize    minivan     pickup subcompact        suv 
         5         47         41         11         33         35         62 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(mpg<span class="sc">$</span>class))</span>
<span id="cb451-2"><a href="#cb451-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Var1 Freq
1    2seater    5
2    compact   47
3    midsize   41
4    minivan   11
5     pickup   33
6 subcompact   35
7        suv   62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb453"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb453-1"><a href="#cb453-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By default, the geom_bar() just counts the number of cases and displays how many observations were in each factor level. If we have a data frame that we have already summarized, geom_col will allow us to set the height of the bar by a y column.</span></span>
<span id="cb453-2"><a href="#cb453-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-3"><a href="#cb453-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Var1, Freq)) <span class="sc">+</span></span>
<span id="cb453-4"><a href="#cb453-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x=</span>hwy)) <span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb455"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb455-1"><a href="#cb455-1" aria-hidden="true" tabindex="-1"></a><span class="co"># density instead of the count </span></span>
<span id="cb455-2"><a href="#cb455-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb455-3"><a href="#cb455-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>hwy, <span class="at">y=</span><span class="fu">after_stat</span>(density))) <span class="sc">+</span> </span>
<span id="cb455-4"><a href="#cb455-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">8</span>, <span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb455-5"><a href="#cb455-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histogram of Highway MPG density"</span>)</span>
<span id="cb455-6"><a href="#cb455-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>hwy)) <span class="sc">+</span> </span>
<span id="cb455-7"><a href="#cb455-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">'red'</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb455-8"><a href="#cb455-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Density Plot of Highway MPG"</span>)</span>
<span id="cb455-9"><a href="#cb455-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb455-10"><a href="#cb455-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Scatterplots</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Petal.Length,<span class="at">color=</span>Species))<span class="sc">+</span></span>
<span id="cb456-3"><a href="#cb456-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span><span class="co"># Anything set inside an aes() command will be of the form attribute=Column_Name and will change based on the data. Anything set outside an aes() command will be in the form attribute=value and will be fixed.</span></span>
<span id="cb456-4"><a href="#cb456-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-8.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Petal.Length)) <span class="sc">+</span></span>
<span id="cb458-2"><a href="#cb458-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Species,<span class="at">shape=</span>Species))<span class="sc">+</span></span>
<span id="cb458-3"><a href="#cb458-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-9.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">fill =</span> Species), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot"</span>) <span class="sc">+</span></span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sepal Length"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-10.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Species,<span class="at">color=</span>Species), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot"</span>) <span class="sc">+</span></span>
<span id="cb461-4"><a href="#cb461-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sepal Length"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb461-5"><a href="#cb461-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Revise the name"</span>,<span class="at">color=</span><span class="st">"Revise the name"</span>)  <span class="co"># fill is the area,color is the line or dot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-11.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">factor</span>(mtcars<span class="sc">$</span>cyl) </span>
<span id="cb462-2"><a href="#cb462-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-3"><a href="#cb462-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>wt, <span class="at">y=</span>mpg, <span class="at">col=</span>cyl)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb462-4"><a href="#cb462-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Weight vs Miles per Gallon'</span>) <span class="sc">+</span></span>
<span id="cb462-5"><a href="#cb462-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Weight in tons (2000 lbs)"</span>, <span class="at">y=</span><span class="st">"Miles per Gallon (US)"</span> ) <span class="sc">+</span></span>
<span id="cb462-6"><a href="#cb462-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Cylinders"</span>) <span class="sc">+</span> <span class="co"># color is dot or line</span></span>
<span id="cb462-7"><a href="#cb462-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'blue'</span>, <span class="st">'darkmagenta'</span>, <span class="st">'aquamarine'</span>)) <span class="co"># diy color</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-12.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rainbow</span>(<span class="dv">3</span>);<span class="fu">rainbow</span>(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#FF0000" "#00FF00" "#0000FF"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#FF0000" "#FFFF00" "#00FF00" "#00FFFF" "#0000FF" "#FF00FF"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)   <span class="co"># these two packages have some decent </span></span>
<span id="cb466-2"><a href="#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grDevices)    <span class="co"># color palettes functions.</span></span>
<span id="cb466-3"><a href="#cb466-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MDplot) <span class="co">#Ramachandran plots is often used to show the sampling of the 𝜙/𝜓protein backbone dihedral angles in order to assign propensities of secondary structure elements to the protein of interest</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS

Attaching package: 'MASS'

The following object is masked from 'package:dplyr':

    select

The following object is masked from 'package:ISLR2':

    Boston

Loading required package: RColorBrewer
Loading required package: gplots

Attaching package: 'gplots'

The following object is masked from 'package:stats':

    lowess

Loading required package: gtools

Attaching package: 'gtools'

The following object is masked from 'package:mosaic':

    logit

The following object is masked from 'package:car':

    logit</code></pre>
</div>
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a>exp_data <span class="ot">&lt;-</span> <span class="fu">load_ramachandran</span>(<span class="fu">system.file</span>( <span class="st">"extdata/ramachandran_example_GROMACS.txt.gz"</span>,<span class="at">package =</span> <span class="st">"MDplot"</span> ), <span class="at">mdEngine =</span> <span class="st">"GROMACS"</span>)</span>
<span id="cb468-2"><a href="#cb468-2" aria-hidden="true" tabindex="-1"></a>exp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(exp_data)</span>
<span id="cb468-3"><a href="#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(exp_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'phi'</span>, <span class="st">'psi'</span>)</span>
<span id="cb468-4"><a href="#cb468-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(exp_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        phi      psi
1 -73.75620 115.6350
2  65.97530 -57.9671
3 -56.51010 130.7000
4 -34.58640 158.7300
5  -3.98544 -79.4994
6 -71.90600 -79.6882</code></pre>
</div>
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(exp_data, aes(x=phi, y=psi) ) + geom_bin_2d(bins=100)</span></span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exp_data, <span class="fu">aes</span>(<span class="at">x=</span>phi, <span class="at">y=</span>psi) ) <span class="sc">+</span> <span class="fu">geom_hex</span>(<span class="at">bins=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-13.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb471"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb471-1"><a href="#cb471-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exp_data, <span class="fu">aes</span>(<span class="at">x=</span>phi, <span class="at">y=</span>psi) ) <span class="sc">+</span> <span class="fu">geom_hex</span>(<span class="at">bins=</span><span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb471-2"><a href="#cb471-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_continuous</span>(<span class="at">type =</span> <span class="st">"viridis"</span>) <span class="co"># scale_fill_gradient(low = "blue", high = "red")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-14.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exp_data, <span class="fu">aes</span>(<span class="at">x=</span>phi, <span class="at">y=</span>psi) ) <span class="sc">+</span> <span class="fu">geom_hex</span>(<span class="at">bins=</span><span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb472-2"><a href="#cb472-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">mid=</span><span class="st">'purple'</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">midpoint=</span><span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-15.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(exp_data, aes(x=phi, y=psi) ) + geom_hex(bins=100) +</span></span>
<span id="cb473-2"><a href="#cb473-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_gradientn(colours = terrain.colors(5))</span></span>
<span id="cb473-3"><a href="#cb473-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb473-4"><a href="#cb473-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exp_data, <span class="fu">aes</span>(<span class="at">x=</span>phi, <span class="at">y=</span>psi) ) <span class="sc">+</span> <span class="fu">geom_density_2d_filled</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-16.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb474"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusting axes</span></span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>class, <span class="at">y=</span>hwy)) <span class="sc">+</span> </span>
<span id="cb474-4"><a href="#cb474-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb474-5"><a href="#cb474-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">45</span>, <span class="at">by=</span><span class="dv">5</span>))  <span class="co">#---diy scale in y-axis </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-62-17.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb475"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb475-1"><a href="#cb475-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(mpg, aes(x=class, y=hwy)) + geom_boxplot() +scale_y_continuous(breaks = seq(10, 45, by=5), minor_breaks = NULL)</span></span>
<span id="cb475-2"><a href="#cb475-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb475-3"><a href="#cb475-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Zooming in/out--Danger!  This removes the data points first!</span></span>
<span id="cb475-4"><a href="#cb475-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(trees, aes(x=Girth, y=Volume)) + </span></span>
<span id="cb475-5"><a href="#cb475-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point() +</span></span>
<span id="cb475-6"><a href="#cb475-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_smooth(method='lm') +</span></span>
<span id="cb475-7"><a href="#cb475-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xlim( 8, 19 ) + ylim(0, 60)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Example (https://github.com/jcoliver/learn-r/blob/gh-pages/data/mine-microbe-class-data.csv)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a>mine.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Site =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Depth =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">25</span>, <span class="dv">25</span>),</span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample.name =</span> <span class="fu">c</span>(<span class="st">'1-S'</span>, <span class="st">'2-S'</span>, <span class="st">'3-S'</span>, <span class="st">'1-M'</span>, <span class="st">'2-M'</span>, <span class="st">'3-M'</span>, <span class="st">'2-B'</span>, <span class="st">'3-B'</span>),</span>
<span id="cb476-5"><a href="#cb476-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actinobacteria =</span> <span class="fu">c</span>(<span class="dv">373871</span>, <span class="dv">332856</span>, <span class="dv">326695</span>, <span class="dv">409809</span>, <span class="dv">319778</span>, <span class="dv">445572</span>, <span class="dv">128251</span>, <span class="dv">96304</span>),</span>
<span id="cb476-6"><a href="#cb476-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cytophagia =</span> <span class="fu">c</span>(<span class="dv">8052</span>, <span class="dv">28561</span>, <span class="dv">10468</span>, <span class="dv">4481</span>, <span class="dv">15885</span>, <span class="dv">7302</span>, <span class="dv">4732</span>, <span class="dv">5566</span>),</span>
<span id="cb476-7"><a href="#cb476-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Flavobacteriia =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5230</span>, <span class="dv">6218</span>, <span class="dv">5917</span>, <span class="dv">6353</span>),</span>
<span id="cb476-8"><a href="#cb476-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sphingobacteriia =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10013</span>, <span class="dv">4918</span>, <span class="dv">0</span>, <span class="dv">8274</span>, <span class="dv">8284</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb476-9"><a href="#cb476-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nitrospira =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4609</span>, <span class="dv">0</span>),</span>
<span id="cb476-10"><a href="#cb476-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Planctomycetia =</span> <span class="fu">c</span>(<span class="dv">4553</span>, <span class="dv">10008</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">56836</span>, <span class="dv">67380</span>),</span>
<span id="cb476-11"><a href="#cb476-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Alphaproteobacteria =</span> <span class="fu">c</span>(<span class="dv">143534</span>, <span class="dv">70575</span>, <span class="dv">105890</span>, <span class="dv">110746</span>, <span class="dv">52504</span>, <span class="dv">45000</span>, <span class="dv">133851</span>, <span class="dv">95580</span>),</span>
<span id="cb476-12"><a href="#cb476-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Betaproteobacteria =</span> <span class="fu">c</span>(<span class="dv">124454</span>, <span class="dv">170161</span>, <span class="dv">187673</span>, <span class="dv">87245</span>, <span class="dv">146073</span>, <span class="dv">91711</span>, <span class="dv">90204</span>, <span class="dv">85707</span>),</span>
<span id="cb476-13"><a href="#cb476-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Deltaproteobacteria =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4260</span>, <span class="dv">0</span>),</span>
<span id="cb476-14"><a href="#cb476-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gammaproteobacteria =</span> <span class="fu">c</span>(<span class="dv">8426</span>, <span class="dv">9005</span>, <span class="dv">12935</span>, <span class="dv">7025</span>, <span class="dv">110825</span>, <span class="dv">69452</span>, <span class="dv">31956</span>, <span class="dv">165572</span>)</span>
<span id="cb476-15"><a href="#cb476-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Check the structure of the data frame.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   8 obs. of  13 variables:
 $ Site               : num  1 2 3 1 2 3 2 3
 $ Depth              : num  0.5 0.5 0.5 3.5 3.5 3.5 25 25
 $ Sample.name        : chr  "1-S" "2-S" "3-S" "1-M" ...
 $ Actinobacteria     : num  373871 332856 326695 409809 319778 ...
 $ Cytophagia         : num  8052 28561 10468 4481 15885 ...
 $ Flavobacteriia     : num  0 0 0 0 5230 ...
 $ Sphingobacteriia   : num  0 10013 4918 0 8274 ...
 $ Nitrospira         : num  0 0 0 0 0 ...
 $ Planctomycetia     : num  4553 10008 0 0 0 ...
 $ Alphaproteobacteria: num  143534 70575 105890 110746 52504 ...
 $ Betaproteobacteria : num  124454 170161 187673 87245 146073 ...
 $ Deltaproteobacteria: num  0 0 0 0 0 0 4260 0
 $ Gammaproteobacteria: num  8426 9005 12935 7025 110825 ...</code></pre>
</div>
</div>
<p>The data frame has 8 rows (“obs.”) and 13 columns (“variables”). The first three columns have information about the observation (Site, Depth, Sample.name), and the remaining columns have the abundance for each of 10 classes of bacteria.</p>
<p>We ultimately want a heatmap where the different sites are shown along the x-axis, the classes of bacteria are shown along the y-axis, and the shading of the cell reflects the abundance. This latter value, the abundance of a bacteria at specific depths at different site, is really just a third dimension. However, instead of creating a 3-dimensional plot that can be difficult to visualize, we instead use shading for our “z-axis”. To this end, we need our data formatted so we have a column corresponding to each of these three dimensions:</p>
<ul>
<li>X: Sample identity</li>
<li>Y: Bacterial class</li>
<li>Z: Abundance</li>
</ul>
<p>The challenge is that our data are not formatted like this. While the Sample.name column corresponds to what we would like for our x-axis, we do not have columns that correspond to what is needed for the y- and z-axes. All the data are in our data frame, but we need to take a table that looks like this:</p>
<p>Sample.name Actinobacteria Cytophagia 1-S 373871 8052 2-S 332856 28561 … … …</p>
<p>And transform it to one with a column for bacterial class and a column for abundance, like this:</p>
<p>Sample.name Class Abundance 1-S Actinobacteria 373871 1-S Cytophagia 8052 2-S Actinobacteria 332856 … … …</p>
<p>In the later labs, you will learn convenient package and function to achieve this. But for now, we just use some basic function to do so.</p>
<ol start="4" type="1">
<li>Remove the first two columns.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>mine.data <span class="ot">&lt;-</span> mine.data[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a>mine.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sample.name Actinobacteria Cytophagia Flavobacteriia Sphingobacteriia
1         1-S         373871       8052              0                0
2         2-S         332856      28561              0            10013
3         3-S         326695      10468              0             4918
4         1-M         409809       4481              0                0
5         2-M         319778      15885           5230             8274
6         3-M         445572       7302           6218             8284
7         2-B         128251       4732           5917                0
8         3-B          96304       5566           6353                0
  Nitrospira Planctomycetia Alphaproteobacteria Betaproteobacteria
1          0           4553              143534             124454
2          0          10008               70575             170161
3          0              0              105890             187673
4          0              0              110746              87245
5          0              0               52504             146073
6          0              0               45000              91711
7       4609          56836              133851              90204
8          0          67380               95580              85707
  Deltaproteobacteria Gammaproteobacteria
1                   0                8426
2                   0                9005
3                   0               12935
4                   0                7025
5                   0              110825
6                   0               69452
7                4260               31956
8                   0              165572</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Use “colnames()” to get a vector of class names and assign it to the object named by “class.name”</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a>class.name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(mine.data)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a>class.name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Actinobacteria"      "Cytophagia"          "Flavobacteriia"     
 [4] "Sphingobacteriia"    "Nitrospira"          "Planctomycetia"     
 [7] "Alphaproteobacteria" "Betaproteobacteria"  "Deltaproteobacteria"
[10] "Gammaproteobacteria"</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>For Sample.name 1-S, use the as.numeric() function to convert its corresponding row to a vector. You should first exclude the 1-S in that row. Store this vector using an object named “abundance”.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a>abundance <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'1-S'</span>, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a>abundance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 373871   8052      0      0      0   4553 143534 124454      0   8426</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Combine the <code>Sample.name</code> 1-S, <code>class.name</code> vector, and <code>abundance</code> vector into a 10-row, 3-column (Sample.name , Class, Abundance) data.frame as shown in the table above.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a>df1s <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'1-S'</span>,</span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span>abundance)</span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a>df1s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sample.name               Class Abundance
1          1-S      Actinobacteria    373871
2          1-S          Cytophagia      8052
3          1-S      Flavobacteriia         0
4          1-S    Sphingobacteriia         0
5          1-S          Nitrospira         0
6          1-S      Planctomycetia      4553
7          1-S Alphaproteobacteria    143534
8          1-S  Betaproteobacteria    124454
9          1-S Deltaproteobacteria         0
10         1-S Gammaproteobacteria      8426</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Repeat question 6 and 7 for all Sample.name, and <code>rbind()</code> the results into a data frame named “mine.table”.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb487"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb487-1"><a href="#cb487-1" aria-hidden="true" tabindex="-1"></a>df2s <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'2-S'</span>,</span>
<span id="cb487-2"><a href="#cb487-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb487-3"><a href="#cb487-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'2-S'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb487-4"><a href="#cb487-4" aria-hidden="true" tabindex="-1"></a>df3s <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'3-S'</span>,</span>
<span id="cb487-5"><a href="#cb487-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb487-6"><a href="#cb487-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'3-S'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb487-7"><a href="#cb487-7" aria-hidden="true" tabindex="-1"></a>df1m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'1-M'</span>,</span>
<span id="cb487-8"><a href="#cb487-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb487-9"><a href="#cb487-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'1-M'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb487-10"><a href="#cb487-10" aria-hidden="true" tabindex="-1"></a>df2m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'2-M'</span>,</span>
<span id="cb487-11"><a href="#cb487-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb487-12"><a href="#cb487-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'2-M'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb487-13"><a href="#cb487-13" aria-hidden="true" tabindex="-1"></a>df3m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'3-M'</span>,</span>
<span id="cb487-14"><a href="#cb487-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb487-15"><a href="#cb487-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'3-M'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb487-16"><a href="#cb487-16" aria-hidden="true" tabindex="-1"></a>df2b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'2-B'</span>,</span>
<span id="cb487-17"><a href="#cb487-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb487-18"><a href="#cb487-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'2-B'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb487-19"><a href="#cb487-19" aria-hidden="true" tabindex="-1"></a>df3b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'3-B'</span>,</span>
<span id="cb487-20"><a href="#cb487-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb487-21"><a href="#cb487-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'3-B'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb487-22"><a href="#cb487-22" aria-hidden="true" tabindex="-1"></a>mine.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1s, df2s, df3s, df1m, df2m, df3m, df2b, df3b)</span>
<span id="cb487-23"><a href="#cb487-23" aria-hidden="true" tabindex="-1"></a>mine.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sample.name               Class Abundance
1          1-S      Actinobacteria    373871
2          1-S          Cytophagia      8052
3          1-S      Flavobacteriia         0
4          1-S    Sphingobacteriia         0
5          1-S          Nitrospira         0
6          1-S      Planctomycetia      4553
7          1-S Alphaproteobacteria    143534
8          1-S  Betaproteobacteria    124454
9          1-S Deltaproteobacteria         0
10         1-S Gammaproteobacteria      8426
11         2-S      Actinobacteria    332856
12         2-S          Cytophagia     28561
13         2-S      Flavobacteriia         0
14         2-S    Sphingobacteriia     10013
15         2-S          Nitrospira         0
16         2-S      Planctomycetia     10008
17         2-S Alphaproteobacteria     70575
18         2-S  Betaproteobacteria    170161
19         2-S Deltaproteobacteria         0
20         2-S Gammaproteobacteria      9005
21         3-S      Actinobacteria    326695
22         3-S          Cytophagia     10468
23         3-S      Flavobacteriia         0
24         3-S    Sphingobacteriia      4918
25         3-S          Nitrospira         0
26         3-S      Planctomycetia         0
27         3-S Alphaproteobacteria    105890
28         3-S  Betaproteobacteria    187673
29         3-S Deltaproteobacteria         0
30         3-S Gammaproteobacteria     12935
31         1-M      Actinobacteria    409809
32         1-M          Cytophagia      4481
33         1-M      Flavobacteriia         0
34         1-M    Sphingobacteriia         0
35         1-M          Nitrospira         0
36         1-M      Planctomycetia         0
37         1-M Alphaproteobacteria    110746
38         1-M  Betaproteobacteria     87245
39         1-M Deltaproteobacteria         0
40         1-M Gammaproteobacteria      7025
41         2-M      Actinobacteria    319778
42         2-M          Cytophagia     15885
43         2-M      Flavobacteriia      5230
44         2-M    Sphingobacteriia      8274
45         2-M          Nitrospira         0
46         2-M      Planctomycetia         0
47         2-M Alphaproteobacteria     52504
48         2-M  Betaproteobacteria    146073
49         2-M Deltaproteobacteria         0
50         2-M Gammaproteobacteria    110825
51         3-M      Actinobacteria    445572
52         3-M          Cytophagia      7302
53         3-M      Flavobacteriia      6218
54         3-M    Sphingobacteriia      8284
55         3-M          Nitrospira         0
56         3-M      Planctomycetia         0
57         3-M Alphaproteobacteria     45000
58         3-M  Betaproteobacteria     91711
59         3-M Deltaproteobacteria         0
60         3-M Gammaproteobacteria     69452
61         2-B      Actinobacteria    128251
62         2-B          Cytophagia      4732
63         2-B      Flavobacteriia      5917
64         2-B    Sphingobacteriia         0
65         2-B          Nitrospira      4609
66         2-B      Planctomycetia     56836
67         2-B Alphaproteobacteria    133851
68         2-B  Betaproteobacteria     90204
69         2-B Deltaproteobacteria      4260
70         2-B Gammaproteobacteria     31956
71         3-B      Actinobacteria     96304
72         3-B          Cytophagia      5566
73         3-B      Flavobacteriia      6353
74         3-B    Sphingobacteriia         0
75         3-B          Nitrospira         0
76         3-B      Planctomycetia     67380
77         3-B Alphaproteobacteria     95580
78         3-B  Betaproteobacteria     85707
79         3-B Deltaproteobacteria         0
80         3-B Gammaproteobacteria    165572</code></pre>
</div>
</div>
<p>This can also be realized by</p>
<div class="sourceCode" id="cb489"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb489-1"><a href="#cb489-1" aria-hidden="true" tabindex="-1"></a>exp.long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="at">data =</span> exp.data, </span>
<span id="cb489-2"><a href="#cb489-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(subject, treatment),</span>
<span id="cb489-3"><a href="#cb489-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to =</span> <span class="st">"gene"</span>, </span>
<span id="cb489-4"><a href="#cb489-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to =</span> <span class="st">"expression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>better look of lables</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb490-1"><a href="#cb490-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb490-2"><a href="#cb490-2" aria-hidden="true" tabindex="-1"></a>exp.heatmap <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove the y-axis title</span></span>
<span id="cb490-3"><a href="#cb490-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="co"># Rotate the x-axis labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now the data are ready - on to the plot!</p>
<ol start="9" type="1">
<li>To plot a heatmap, we are going to use the <code>ggplot2</code> package. Install and library <code>ggplot2</code>.</li>
</ol>
<p>For this plot, we are going to first create the heatmap object with the <code>ggplot</code> function, then print the plot. We create the object by assigning the output of the <code>ggplot</code> call to the variable <code>mine.heatmap</code>, then entering the name of this object to print it to the screen.</p>
<ul>
<li>Plot heatmap with x=Sample.name and y=Class. Fill the heatmap using Abundance value.</li>
<li>Choose right <code>geom_</code> function to perform heatmap</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb491"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mine.table, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sample.name,</span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">y =</span> Class,</span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">fill =</span> Abundance)) <span class="sc">+</span> </span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="co"># use geom_tile to draw the heatmap</span></span>
<span id="cb491-5"><a href="#cb491-5" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="11" type="1">
<li>First let’s deal with a scaling issue. Most values are dark blue, but this is partly caused by the distribution of values - there are a few really high values in the Abundance column. We can transform the data for display by taking the square root of abundance and plotting that. To do this, we need to add another column to our data frame and update our call to ggplot to reference this new column, <code>Sqrt.abundance</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb492"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb492-1"><a href="#cb492-1" aria-hidden="true" tabindex="-1"></a>mine.table<span class="sc">$</span>Sqrt.abundance <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mine.table<span class="sc">$</span>Abundance)</span>
<span id="cb492-2"><a href="#cb492-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mine.table, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sample.name,</span>
<span id="cb492-3"><a href="#cb492-3" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">y =</span> Class,</span>
<span id="cb492-4"><a href="#cb492-4" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">fill =</span> Sqrt.abundance)) <span class="sc">+</span></span>
<span id="cb492-5"><a href="#cb492-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb492-6"><a href="#cb492-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="at">label =</span> <span class="st">"Sample"</span>)</span>
<span id="cb492-7"><a href="#cb492-7" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="12" type="1">
<li>Change the shading so low values are light and high values are dark. Use white (#FFFFFF) for the low values and a dark blue (#012345) for high values. You can also pick whatever color you like.</li>
</ol>
<div class="sourceCode" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> mine.heatmap <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"#FFFFFF"</span>, <span class="at">high=</span><span class="st">"#012345"</span>)</span>
<span id="cb493-2"><a href="#cb493-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="13" type="1">
<li>Add a title “Microbe Class Abundance” to this plot.</li>
</ol>
<div class="sourceCode" id="cb494"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb494-1"><a href="#cb494-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> mine.heatmap <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">"Microbe Class Abundance"</span>)</span>
<span id="cb494-2"><a href="#cb494-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="14" type="1">
<li>Reverse the order of the y-axis, so ‘Actinobacteria’ is at the top. Use <code>rev()</code> function to get the reverse of the <code>levels</code> of the Class. Use the obtained character vector as the <code>limits</code> of <code>scale_y_discrete()</code> function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> mine.heatmap <span class="sc">+</span> <span class="fu">scale_y_discrete</span>(<span class="at">limits=</span><span class="fu">rev</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(mine.table<span class="sc">$</span>Class))))</span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="15" type="1">
<li>Use “geom_text()” to add abundance values on top of the heatmap. Maybe the text is too big to display on top of the heatmap? what can we do? Consider removing decimals and resizing the text.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Sqrt.abundance, <span class="dv">0</span>)), <span class="at">size=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="16" type="1">
<li>Congratulations on completing the above task, but you may have noticed that the x-axis Sample.name are not in the correct order. In fact, a good idea is to visualize different categories of data, we will learn this function next lab. But if you have some time, you may have a try by looking the help information of <code>facet_grid</code>.</li>
</ol>
<p>This approach, called “faceting” requires one additional layer to the plotting command called facet_grid. With <code>facet_grid</code> we indicate which column contains the categories we want to use for the plot. But before we do that, we need add <code>Depth</code> back to the data frame. For Sample.name %in% c(“1-S”, “2-S”, “3-S”), add Depth=0.5 in a new column named <code>Depth</code>; For Sample.name ends with M, add Depth=3.5; and 25 for those end with B.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb497"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb497-1"><a href="#cb497-1" aria-hidden="true" tabindex="-1"></a>mine.table<span class="sc">$</span>Depth <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb497-2"><a href="#cb497-2" aria-hidden="true" tabindex="-1"></a>mine.table[mine.table<span class="sc">$</span>Sample.name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1-S"</span>, <span class="st">"2-S"</span>, <span class="st">"3-S"</span>), <span class="st">'Depth'</span>] <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb497-3"><a href="#cb497-3" aria-hidden="true" tabindex="-1"></a>mine.table[mine.table<span class="sc">$</span>Sample.name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1-M"</span>, <span class="st">"2-M"</span>, <span class="st">"3-M"</span>), <span class="st">'Depth'</span>] <span class="ot">=</span> <span class="fl">3.5</span></span>
<span id="cb497-4"><a href="#cb497-4" aria-hidden="true" tabindex="-1"></a>mine.table[mine.table<span class="sc">$</span>Sample.name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2-B"</span>, <span class="st">"3-B"</span>), <span class="st">'Depth'</span>] <span class="ot">=</span> <span class="dv">25</span></span>
<span id="cb497-5"><a href="#cb497-5" aria-hidden="true" tabindex="-1"></a>mine.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sample.name               Class Abundance Sqrt.abundance Depth
1          1-S      Actinobacteria    373871      611.44992   0.5
2          1-S          Cytophagia      8052       89.73294   0.5
3          1-S      Flavobacteriia         0        0.00000   0.5
4          1-S    Sphingobacteriia         0        0.00000   0.5
5          1-S          Nitrospira         0        0.00000   0.5
6          1-S      Planctomycetia      4553       67.47592   0.5
7          1-S Alphaproteobacteria    143534      378.85881   0.5
8          1-S  Betaproteobacteria    124454      352.78038   0.5
9          1-S Deltaproteobacteria         0        0.00000   0.5
10         1-S Gammaproteobacteria      8426       91.79325   0.5
11         2-S      Actinobacteria    332856      576.93674   0.5
12         2-S          Cytophagia     28561      169.00000   0.5
13         2-S      Flavobacteriia         0        0.00000   0.5
14         2-S    Sphingobacteriia     10013      100.06498   0.5
15         2-S          Nitrospira         0        0.00000   0.5
16         2-S      Planctomycetia     10008      100.03999   0.5
17         2-S Alphaproteobacteria     70575      265.65956   0.5
18         2-S  Betaproteobacteria    170161      412.50576   0.5
19         2-S Deltaproteobacteria         0        0.00000   0.5
20         2-S Gammaproteobacteria      9005       94.89468   0.5
21         3-S      Actinobacteria    326695      571.57239   0.5
22         3-S          Cytophagia     10468      102.31324   0.5
23         3-S      Flavobacteriia         0        0.00000   0.5
24         3-S    Sphingobacteriia      4918       70.12845   0.5
25         3-S          Nitrospira         0        0.00000   0.5
26         3-S      Planctomycetia         0        0.00000   0.5
27         3-S Alphaproteobacteria    105890      325.40744   0.5
28         3-S  Betaproteobacteria    187673      433.21242   0.5
29         3-S Deltaproteobacteria         0        0.00000   0.5
30         3-S Gammaproteobacteria     12935      113.73214   0.5
31         1-M      Actinobacteria    409809      640.16326   3.5
32         1-M          Cytophagia      4481       66.94027   3.5
33         1-M      Flavobacteriia         0        0.00000   3.5
34         1-M    Sphingobacteriia         0        0.00000   3.5
35         1-M          Nitrospira         0        0.00000   3.5
36         1-M      Planctomycetia         0        0.00000   3.5
37         1-M Alphaproteobacteria    110746      332.78522   3.5
38         1-M  Betaproteobacteria     87245      295.37265   3.5
39         1-M Deltaproteobacteria         0        0.00000   3.5
40         1-M Gammaproteobacteria      7025       83.81527   3.5
41         2-M      Actinobacteria    319778      565.48917   3.5
42         2-M          Cytophagia     15885      126.03571   3.5
43         2-M      Flavobacteriia      5230       72.31874   3.5
44         2-M    Sphingobacteriia      8274       90.96153   3.5
45         2-M          Nitrospira         0        0.00000   3.5
46         2-M      Planctomycetia         0        0.00000   3.5
47         2-M Alphaproteobacteria     52504      229.13751   3.5
48         2-M  Betaproteobacteria    146073      382.19498   3.5
49         2-M Deltaproteobacteria         0        0.00000   3.5
50         2-M Gammaproteobacteria    110825      332.90389   3.5
51         3-M      Actinobacteria    445572      667.51180   3.5
52         3-M          Cytophagia      7302       85.45174   3.5
53         3-M      Flavobacteriia      6218       78.85430   3.5
54         3-M    Sphingobacteriia      8284       91.01648   3.5
55         3-M          Nitrospira         0        0.00000   3.5
56         3-M      Planctomycetia         0        0.00000   3.5
57         3-M Alphaproteobacteria     45000      212.13203   3.5
58         3-M  Betaproteobacteria     91711      302.83824   3.5
59         3-M Deltaproteobacteria         0        0.00000   3.5
60         3-M Gammaproteobacteria     69452      263.53747   3.5
61         2-B      Actinobacteria    128251      358.12149  25.0
62         2-B          Cytophagia      4732       68.78953  25.0
63         2-B      Flavobacteriia      5917       76.92204  25.0
64         2-B    Sphingobacteriia         0        0.00000  25.0
65         2-B          Nitrospira      4609       67.88962  25.0
66         2-B      Planctomycetia     56836      238.40302  25.0
67         2-B Alphaproteobacteria    133851      365.85653  25.0
68         2-B  Betaproteobacteria     90204      300.33981  25.0
69         2-B Deltaproteobacteria      4260       65.26868  25.0
70         2-B Gammaproteobacteria     31956      178.76241  25.0
71         3-B      Actinobacteria     96304      310.32886  25.0
72         3-B          Cytophagia      5566       74.60563  25.0
73         3-B      Flavobacteriia      6353       79.70571  25.0
74         3-B    Sphingobacteriia         0        0.00000  25.0
75         3-B          Nitrospira         0        0.00000  25.0
76         3-B      Planctomycetia     67380      259.57658  25.0
77         3-B Alphaproteobacteria     95580      309.16015  25.0
78         3-B  Betaproteobacteria     85707      292.75758  25.0
79         3-B Deltaproteobacteria         0        0.00000  25.0
80         3-B Gammaproteobacteria    165572      406.90539  25.0</code></pre>
</div>
</div>
<ol start="17" type="1">
<li>Faceting the plot by <code>Depth</code>, set <code>scales</code> and <code>space</code> as <code>free</code> and add <code>x</code> to <code>switch</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb499"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb499-1"><a href="#cb499-1" aria-hidden="true" tabindex="-1"></a>mine.table<span class="sc">$</span>Sqrt.abundance <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mine.table<span class="sc">$</span>Abundance)</span>
<span id="cb499-2"><a href="#cb499-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mine.table, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sample.name,</span>
<span id="cb499-3"><a href="#cb499-3" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">y =</span> Class,</span>
<span id="cb499-4"><a href="#cb499-4" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">fill =</span> Sqrt.abundance)) <span class="sc">+</span></span>
<span id="cb499-5"><a href="#cb499-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb499-6"><a href="#cb499-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Depth, <span class="at">switch =</span> <span class="st">'x'</span>, <span class="at">scales=</span><span class="st">'free'</span>, <span class="at">space=</span><span class="st">'free'</span>) <span class="sc">+</span> </span>
<span id="cb499-7"><a href="#cb499-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="at">label =</span> <span class="st">"Sample"</span>) <span class="sc">+</span> </span>
<span id="cb499-8"><a href="#cb499-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"#FFFFFF"</span>, <span class="at">high=</span><span class="st">"#012345"</span>) <span class="sc">+</span> </span>
<span id="cb499-9"><a href="#cb499-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">"Microbe Class Abundance"</span>) <span class="sc">+</span> </span>
<span id="cb499-10"><a href="#cb499-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits=</span><span class="fu">rev</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(mine.table<span class="sc">$</span>Class)))) <span class="sc">+</span> </span>
<span id="cb499-11"><a href="#cb499-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Sqrt.abundance, <span class="dv">0</span>)), <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb499-12"><a href="#cb499-12" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb500"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x=</span>flipper_length_mm, <span class="at">y=</span>body_mass_g)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>bill_depth_mm, <span class="at">shape=</span>species), <span class="at">na.rm=</span>T) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">na.rm=</span>T, <span class="at">se=</span>F) <span class="sc">+</span> <span class="fu">scale_color_gradient2</span>(<span class="at">low=</span><span class="st">'yellow'</span>, <span class="at">mid=</span><span class="st">'green'</span>, <span class="at">high=</span><span class="st">'blue'</span>, <span class="at">midpoint =</span> <span class="dv">17</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Flipper length (millimeters)'</span>, <span class="at">y=</span><span class="st">'Body mass (grams)'</span>, <span class="at">color=</span><span class="st">'Bill depth (millimeters)'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Failed to fit group -1.
Caused by error in `if (se) ...`:
! the condition has length &gt; 1</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Faceting (make many panels of graphics where each panel represents the same relationship between variables, but something changes between each pane)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb503"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb503-1"><a href="#cb503-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width)) <span class="sc">+</span></span>
<span id="cb503-2"><a href="#cb503-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb503-3"><a href="#cb503-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Species) <span class="co">#or facet_grid(Species~.)--Categorical variables of species will be vertical</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Another example</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tips, <span class="at">package=</span><span class="st">'reshape'</span>)</span>
<span id="cb504-3"><a href="#cb504-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tips, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  total_bill  tip    sex smoker day   time size
1      16.99 1.01 Female     No Sun Dinner    2
2      10.34 1.66   Male     No Sun Dinner    3
3      21.01 3.50   Male     No Sun Dinner    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tips, <span class="fu">aes</span>(<span class="at">x =</span> total_bill, <span class="at">y =</span> tip <span class="sc">/</span> total_bill)) <span class="sc">+</span></span>
<span id="cb506-2"><a href="#cb506-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb506-3"><a href="#cb506-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>( smoker <span class="sc">~</span> day )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb507"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb507-1"><a href="#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'free_y' means the scale of different panels are adjusted by themselves</span></span>
<span id="cb507-2"><a href="#cb507-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tips, <span class="fu">aes</span>(<span class="at">x =</span> total_bill, <span class="at">y =</span> tip <span class="sc">/</span> total_bill)) <span class="sc">+</span></span>
<span id="cb507-3"><a href="#cb507-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb507-4"><a href="#cb507-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> day, <span class="at">scales=</span><span class="st">'free_y'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-78-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log scales ---a wrapper of  scale_y_continuous() function , trans_new() function</span></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(ACS, aes(x=Age, y=Income)) + geom_point() +</span></span>
<span id="cb508-3"><a href="#cb508-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_y_log10(breaks=c(1, 10, 100),</span></span>
<span id="cb508-4"><a href="#cb508-4" aria-hidden="true" tabindex="-1"></a><span class="co">#            minor=c(1:10,</span></span>
<span id="cb508-5"><a href="#cb508-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                 seq(10, 100, by=10 ),</span></span>
<span id="cb508-6"><a href="#cb508-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                seq(100, 1000, by=100))) +</span></span>
<span id="cb508-7"><a href="#cb508-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  ylab('Income (1000s of dollars)')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Multi-plot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb509"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb509-1"><a href="#cb509-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ChickWeight, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>weight, <span class="at">colour=</span>Diet, <span class="at">group=</span>Chick)) <span class="sc">+</span></span>
<span id="cb509-2"><a href="#cb509-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb509-3"><a href="#cb509-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Growth curve for individual chicks"</span>)</span>
<span id="cb509-4"><a href="#cb509-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Second plot</span></span>
<span id="cb509-5"><a href="#cb509-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ChickWeight, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb509-6"><a href="#cb509-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb509-7"><a href="#cb509-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">alpha=</span>.<span class="dv">2</span>, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb509-8"><a href="#cb509-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Fitted growth curve per diet"</span>)</span>
<span id="cb509-9"><a href="#cb509-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Third plot </span></span>
<span id="cb509-10"><a href="#cb509-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">21</span>), <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb509-11"><a href="#cb509-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb509-12"><a href="#cb509-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Final weight, by diet"</span>)</span>
<span id="cb509-13"><a href="#cb509-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-14"><a href="#cb509-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-15"><a href="#cb509-15" aria-hidden="true" tabindex="-1"></a><span class="co"># to realize:</span></span>
<span id="cb509-16"><a href="#cb509-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 plot2 plot2</span></span>
<span id="cb509-17"><a href="#cb509-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 plot2 plot2</span></span>
<span id="cb509-18"><a href="#cb509-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 plot3 plot3</span></span>
<span id="cb509-19"><a href="#cb509-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb509-20"><a href="#cb509-20" aria-hidden="true" tabindex="-1"></a>my.layout <span class="ot">=</span> <span class="fu">cbind</span>( <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>) ) <span class="co"># each c represents a column in a matrix and 1,2,3 represents p1,p2,p3</span></span>
<span id="cb509-21"><a href="#cb509-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span>
<span id="cb509-22"><a href="#cb509-22" aria-hidden="true" tabindex="-1"></a>Rmisc<span class="sc">::</span><span class="fu">multiplot</span>( p1, p2, p3, <span class="at">layout=</span>my.layout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb511"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb511-1"><a href="#cb511-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR library(ggpubr) https://rpkgs.datanovia.com/ggpubr/). </span></span>
<span id="cb511-2"><a href="#cb511-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-3"><a href="#cb511-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb511-4"><a href="#cb511-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot (bp)</span></span>
<span id="cb511-5"><a href="#cb511-5" aria-hidden="true" tabindex="-1"></a>bxp <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(ToothGrowth, <span class="at">x =</span> <span class="st">"dose"</span>, <span class="at">y =</span> <span class="st">"len"</span>,</span>
<span id="cb511-6"><a href="#cb511-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"dose"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>)</span>
<span id="cb511-7"><a href="#cb511-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dot plot (dp)</span></span>
<span id="cb511-8"><a href="#cb511-8" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">ggdotplot</span>(ToothGrowth, <span class="at">x =</span> <span class="st">"dose"</span>, <span class="at">y =</span> <span class="st">"len"</span>,</span>
<span id="cb511-9"><a href="#cb511-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"dose"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>, <span class="at">binwidth =</span> <span class="dv">1</span>)</span>
<span id="cb511-10"><a href="#cb511-10" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mtcars)</span>
<span id="cb511-11"><a href="#cb511-11" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>cyl)</span>
<span id="cb511-12"><a href="#cb511-12" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">ggbarplot</span>(mtcars, <span class="at">x =</span> <span class="st">"name"</span>, <span class="at">y =</span> <span class="st">"mpg"</span>,</span>
<span id="cb511-13"><a href="#cb511-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"cyl"</span>,               <span class="co"># change fill color by cyl</span></span>
<span id="cb511-14"><a href="#cb511-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"white"</span>,            <span class="co"># Set bar border colors to white</span></span>
<span id="cb511-15"><a href="#cb511-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"jco"</span>,            <span class="co"># jco journal color palett. see ?ggpar</span></span>
<span id="cb511-16"><a href="#cb511-16" aria-hidden="true" tabindex="-1"></a>          <span class="at">sort.val =</span> <span class="st">"asc"</span>,           <span class="co"># Sort the value in ascending order</span></span>
<span id="cb511-17"><a href="#cb511-17" aria-hidden="true" tabindex="-1"></a>          <span class="at">sort.by.groups =</span> <span class="cn">TRUE</span>,      <span class="co"># Sort inside each group</span></span>
<span id="cb511-18"><a href="#cb511-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">x.text.angle =</span> <span class="dv">90</span>           <span class="co"># Rotate vertically x axis texts</span></span>
<span id="cb511-19"><a href="#cb511-19" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span> <span class="fu">font</span>(<span class="st">"x.text"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb511-20"><a href="#cb511-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plots (sp)</span></span>
<span id="cb511-21"><a href="#cb511-21" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(mtcars, <span class="at">x =</span> <span class="st">"wt"</span>, <span class="at">y =</span> <span class="st">"mpg"</span>,</span>
<span id="cb511-22"><a href="#cb511-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">add =</span> <span class="st">"reg.line"</span>,               <span class="co"># Add regression line</span></span>
<span id="cb511-23"><a href="#cb511-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">conf.int =</span> <span class="cn">TRUE</span>,                <span class="co"># Add confidence interval</span></span>
<span id="cb511-24"><a href="#cb511-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"cyl"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>, <span class="co"># Color by groups "cyl"</span></span>
<span id="cb511-25"><a href="#cb511-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape =</span> <span class="st">"cyl"</span>                   <span class="co"># Change point shape by groups "cyl"</span></span>
<span id="cb511-26"><a href="#cb511-26" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">+</span> </span>
<span id="cb511-27"><a href="#cb511-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(<span class="fu">aes</span>(<span class="at">color =</span> cyl), <span class="at">label.x =</span> <span class="dv">3</span>)       <span class="co"># Add correlation coefficient</span></span>
<span id="cb511-28"><a href="#cb511-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb511-29"><a href="#cb511-29" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(bxp, dp, bp <span class="sc">+</span> <span class="fu">rremove</span>(<span class="st">"x.text"</span>),</span>
<span id="cb511-30"><a href="#cb511-30" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb511-31"><a href="#cb511-31" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-79-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb512"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb512-1"><a href="#cb512-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Themes</span></span>
<span id="cb512-2"><a href="#cb512-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rmisc::multiplot( p1 + theme_bw(),          # Black and white</span></span>
<span id="cb512-3"><a href="#cb512-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                   p1 + theme_minimal(),   </span></span>
<span id="cb512-4"><a href="#cb512-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                   p1 + theme_dark(),        </span></span>
<span id="cb512-5"><a href="#cb512-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                   p1 + theme_light(),</span></span>
<span id="cb512-6"><a href="#cb512-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                   cols=2 )</span></span>
<span id="cb512-7"><a href="#cb512-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb512-8"><a href="#cb512-8" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave('p1.png', width=6, height=3, dpi=350)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-2348163751.png" class="img-fluid"></p>
<ul>
<li>data manipulation</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb513"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb513-1"><a href="#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb513-2"><a href="#cb513-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb513-3"><a href="#cb513-3" aria-hidden="true" tabindex="-1"></a><span class="co"># apply</span></span>
<span id="cb513-4"><a href="#cb513-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize each column by calculating the mean.</span></span>
<span id="cb513-5"><a href="#cb513-5" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(iris[,<span class="sc">-</span><span class="dv">5</span>],        <span class="co"># what object do we want to apply the function to</span></span>
<span id="cb513-6"><a href="#cb513-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">MARGIN=</span><span class="dv">1</span>,    <span class="co"># rows = 1, columns = 2, (same order as [rows, cols]</span></span>
<span id="cb513-7"><a href="#cb513-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN=</span>mean     <span class="co"># what function do we want to apply     </span></span>
<span id="cb513-8"><a href="#cb513-8" aria-hidden="true" tabindex="-1"></a>     ) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2.550 2.375 2.350 2.350 2.550 2.850 2.425 2.525 2.225 2.400</code></pre>
</div>
<div class="sourceCode cell-code" id="cb515"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb515-1"><a href="#cb515-1" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span> <span class="fu">apply</span>( </span>
<span id="cb515-2"><a href="#cb515-2" aria-hidden="true" tabindex="-1"></a>  iris[,<span class="sc">-</span><span class="dv">5</span>],        <span class="co"># what object do we want to apply the function to</span></span>
<span id="cb515-3"><a href="#cb515-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">MARGIN=</span><span class="dv">2</span>,    <span class="co"># rows = 1, columns = 2, (same order as [rows, cols]</span></span>
<span id="cb515-4"><a href="#cb515-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN=</span>mean     <span class="co"># what function do we want to apply</span></span>
<span id="cb515-5"><a href="#cb515-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb515-6"><a href="#cb515-6" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">rbind</span>(iris[,<span class="sc">-</span><span class="dv">5</span>], average)</span>
<span id="cb515-7"><a href="#cb515-7" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width
1          5.1         3.5          1.4         0.2
2          4.9         3.0          1.4         0.2
3          4.7         3.2          1.3         0.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb517"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are several variants of the apply() function, and the most frequently used ones are lapply() and sapply(). These two functions apply a given function to each element of a list or vector and returns a corresponding list or vector of results.</span></span>
<span id="cb517-2"><a href="#cb517-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb517-3"><a href="#cb517-3" aria-hidden="true" tabindex="-1"></a><span class="co">#lapply</span></span>
<span id="cb517-4"><a href="#cb517-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">beta =</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">logic =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb517-5"><a href="#cb517-5" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
 [1]  1  2  3  4  5  6  7  8  9 10

$beta
[1]  0.04978707  0.13533528  0.36787944  1.00000000  2.71828183  7.38905610
[7] 20.08553692

$logic
[1]  TRUE FALSE FALSE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb519"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb519-1"><a href="#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x, quantile, <span class="at">probs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="co"># list </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
 25%  50%  75% 
3.25 5.50 7.75 

$beta
      25%       50%       75% 
0.2516074 1.0000000 5.0536690 

$logic
25% 50% 75% 
0.0 0.5 1.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb521"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb521-1"><a href="#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x, quantile, <span class="at">probs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="co"># matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       a      beta logic
25% 3.25 0.2516074   0.0
50% 5.50 1.0000000   0.5
75% 7.75 5.0536690   1.0</code></pre>
</div>
</div>
<p>A tibble, or tbl_df, is a modern reimagining of the data.frame, keeping what time has proven to be effective, and throwing out what is not. Tibbles are data.frames that are lazy and surly: they do less (i.e.&nbsp;they don t change variable names or types, and don t do partial matching) and complain more (e.g.&nbsp;when a variable does not exist). This forces you to confront problems earlier, typically leading to cleaner, more expressive code. Tibbles also have an enhanced print() method which makes them easier to use with large datasets containing complex objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb523"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb523-1"><a href="#cb523-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">b =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">c =</span> <span class="fu">Sys.Date</span>() <span class="sc">-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb523-2"><a href="#cb523-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  a b          c
1 1 a 2025-10-11
2 2 b 2025-10-10
3 3 c 2025-10-09</code></pre>
</div>
<div class="sourceCode cell-code" id="cb525"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb525-1"><a href="#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
      a b     c         
  &lt;int&gt; &lt;chr&gt; &lt;date&gt;    
1     1 a     2025-10-11
2     2 b     2025-10-10
3     3 c     2025-10-09</code></pre>
</div>
</div>
<ul>
<li>%&gt;%</li>
</ul>
<p>For example, if we wanted to start with x, and first apply function f(), then g(), and then h(), the usual R command would be h(g(f(x))) which is hard to read because you have to start reading at the innermost set of parentheses. Using the pipe command %&gt;%, this sequence of operations becomes x %&gt;% f() %&gt;% g() %&gt;% h().</p>
<ul>
<li>select</li>
</ul>
<div class="sourceCode" id="cb527"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb527-1"><a href="#cb527-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-2"><a href="#cb527-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb527-3"><a href="#cb527-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb527-4"><a href="#cb527-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct usage of select() within a pipeline</span></span>
<span id="cb527-5"><a href="#cb527-5" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">ends_with</span>(<span class="st">'color'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>filter</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb528"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb528-1"><a href="#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb528-2"><a href="#cb528-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-3"><a href="#cb528-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where species is "Droid" and mass is greater than or equal to 100</span></span>
<span id="cb528-4"><a href="#cb528-4" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Droid"</span>, mass <span class="sc">&lt;</span> <span class="dv">100</span>)</span>
<span id="cb528-5"><a href="#cb528-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(filtered_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name  height  mass hair_color skin_color  eye_color birth_year sex   gender   
  &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
1 C-3PO    167    75 &lt;NA&gt;       gold        yellow           112 none  masculine
2 R2-D2     96    32 &lt;NA&gt;       white, blue red               33 none  masculine
3 R5-D4     97    32 &lt;NA&gt;       white, red  red               NA none  masculine
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<ul>
<li>slice</li>
</ul>
<p>filter rows based on row number:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb530"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb530-1"><a href="#cb530-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
2 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
3 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<ul>
<li>arrange</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb532"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb532-1"><a href="#cb532-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(name)) <span class="co">#The default sorting is in ascending order</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Zam Wes…    168    55 blonde     fair, gre… yellow            NA fema… femin…
 2 Yoda         66    17 white      green      brown            896 male  mascu…
 3 Yarael …    264    NA none       white      yellow            NA male  mascu…
 4 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…
 5 Wicket …     88    20 brown      brown      brown              8 male  mascu…
 6 Wedge A…    170    77 brown      fair       hazel             21 male  mascu…
 7 Watto       137    NA black      blue, grey yellow            NA male  mascu…
 8 Wat Tam…    193    48 none       green, gr… unknown           NA male  mascu…
 9 Tion Me…    206    80 none       grey       black             NA male  mascu…
10 Taun We     213    NA none       grey       black             NA fema… femin…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb534"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb534-1"><a href="#cb534-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(height)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Yarael P…    264    NA none       white      yellow            NA male  mascu…
2 Tarfful      234   136 brown      brown      blue              NA male  mascu…
3 Lama Su      229    88 none       grey       black             NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb536"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb536-1"><a href="#cb536-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb536-2"><a href="#cb536-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Trt =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"Med"</span>, <span class="st">"High"</span>, <span class="st">"Low"</span>),        </span>
<span id="cb536-3"><a href="#cb536-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Med"</span>, <span class="st">"High"</span>)), <span class="co"># level</span></span>
<span id="cb536-4"><a href="#cb536-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">9</span>),      </span>
<span id="cb536-5"><a href="#cb536-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)) </span>
<span id="cb536-6"><a href="#cb536-6" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Trt, <span class="fu">desc</span>(y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Trt y z
1  Low 9 2
2  Med 3 1
3 High 9 1
4 High 8 1</code></pre>
</div>
</div>
<ul>
<li>mutate</li>
</ul>
<div class="sourceCode" id="cb538"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb538-1"><a href="#cb538-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select using the old columns</span></span>
<span id="cb538-2"><a href="#cb538-2" aria-hidden="true" tabindex="-1"></a>starwars<span class="sc">$</span>bmi <span class="ot">=</span> starwars<span class="sc">$</span>mass <span class="sc">/</span> ((starwars<span class="sc">$</span>height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb538-3"><a href="#cb538-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, bmi) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb538-4"><a href="#cb538-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-5"><a href="#cb538-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate avoids all the starwars$</span></span>
<span id="cb538-6"><a href="#cb538-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-7"><a href="#cb538-7" aria-hidden="true" tabindex="-1"></a>starwars<span class="sc">$</span>bmi <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb538-8"><a href="#cb538-8" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb538-9"><a href="#cb538-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bmi =</span> mass <span class="sc">/</span> ((height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb538-10"><a href="#cb538-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, bmi) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb538-11"><a href="#cb538-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-12"><a href="#cb538-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate_at() and mutate_if() allow us to apply a function to a particular column and save the output.</span></span>
<span id="cb538-13"><a href="#cb538-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-14"><a href="#cb538-14" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span> </span>
<span id="cb538-15"><a href="#cb538-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">square_height =</span> (height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb538-16"><a href="#cb538-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> mass <span class="sc">/</span> square_height) <span class="sc">%&gt;%</span></span>
<span id="cb538-17"><a href="#cb538-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, square_height, bmi)</span>
<span id="cb538-18"><a href="#cb538-18" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb538-19"><a href="#cb538-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-20"><a href="#cb538-20" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">0</span>) <span class="co"># here, is.numeric is the condition</span></span>
<span id="cb538-21"><a href="#cb538-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-22"><a href="#cb538-22" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, round, <span class="at">digits=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="co"># column 2 3</span></span>
<span id="cb538-23"><a href="#cb538-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-24"><a href="#cb538-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the transformation to columns 2 and 3 for rows 1 to 3</span></span>
<span id="cb538-25"><a href="#cb538-25" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> subset <span class="sc">%&gt;%</span> </span>
<span id="cb538-26"><a href="#cb538-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">round</span>(., <span class="at">digits =</span> <span class="dv">0</span>), .))</span>
<span id="cb538-27"><a href="#cb538-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb538-28"><a href="#cb538-28" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">avg.example =</span> <span class="fu">select</span>(., square_height<span class="sc">:</span>bmi) <span class="sc">%&gt;%</span> <span class="fu">rowMeans</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>summarise</li>
</ul>
<p>This function is used to create a summary table. It reduces the data frame to a single row containing summary statistics.</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb539-1"><a href="#cb539-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean.height=</span><span class="fu">mean</span>(height, <span class="at">na.rm=</span>T), <span class="at">sd.height=</span><span class="fu">sd</span>(height, <span class="at">na.rm=</span>T))</span>
<span id="cb539-2"><a href="#cb539-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb539-3"><a href="#cb539-3" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the same statistic to each column</span></span>
<span id="cb539-4"><a href="#cb539-4" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(height<span class="sc">:</span>mass) <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(<span class="fu">list</span>(<span class="at">min=</span>min, <span class="at">max=</span>max), <span class="at">na.rm=</span>T)</span>
<span id="cb539-5"><a href="#cb539-5" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">summarise_if</span>(is.numeric, <span class="fu">list</span>(<span class="at">min=</span>min, <span class="at">max=</span>max), <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>group_by</li>
</ul>
<div class="sourceCode" id="cb540"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb540-1"><a href="#cb540-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb540-2"><a href="#cb540-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb540-3"><a href="#cb540-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb540-4"><a href="#cb540-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(penguins<span class="sc">$</span>sex, penguins<span class="sc">$</span>species)</span>
<span id="cb540-5"><a href="#cb540-5" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb540-6"><a href="#cb540-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb540-7"><a href="#cb540-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span>           </span>
<span id="cb540-8"><a href="#cb540-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb540-9"><a href="#cb540-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean.flipper =</span> <span class="fu">mean</span>(flipper_length_mm),</span>
<span id="cb540-10"><a href="#cb540-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd.flipper =</span> <span class="fu">sd</span>(flipper_length_mm),</span>
<span id="cb540-11"><a href="#cb540-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups=</span><span class="st">'keep'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb540-12"><a href="#cb540-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb540-13"><a href="#cb540-13" aria-hidden="true" tabindex="-1"></a>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>the comparison between whether to use %&gt;% or not</li>
</ul>
<div class="sourceCode" id="cb541"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb541-1"><a href="#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% </span></span>
<span id="cb541-2"><a href="#cb541-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb541-3"><a href="#cb541-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb541-4"><a href="#cb541-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span>           </span>
<span id="cb541-5"><a href="#cb541-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sum.Sq.Cells =</span> (flipper_length_mm <span class="sc">-</span> <span class="fu">mean</span>(flipper_length_mm))<span class="sc">^</span><span class="dv">2</span>)  <span class="sc">%&gt;%</span>  </span>
<span id="cb541-6"><a href="#cb541-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sex, species, flipper_length_mm, Sum.Sq.Cells) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb541-7"><a href="#cb541-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb541-8"><a href="#cb541-8" aria-hidden="true" tabindex="-1"></a><span class="co"># not use %&gt;% </span></span>
<span id="cb541-9"><a href="#cb541-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(</span>
<span id="cb541-10"><a href="#cb541-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">mutate</span>(<span class="fu">group_by</span>(<span class="fu">filter</span>(penguins, <span class="sc">!</span><span class="fu">is.na</span>(sex)), sex, species),</span>
<span id="cb541-11"><a href="#cb541-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">Sum.Sq.Cells =</span> (flipper_length_mm <span class="sc">-</span> <span class="fu">mean</span>(flipper_length_mm))<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb541-12"><a href="#cb541-12" aria-hidden="true" tabindex="-1"></a>       sex, species, flipper_length_mm, Sum.Sq.Cells))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb542"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb542-1"><a href="#cb542-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb542-2"><a href="#cb542-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(nycflights13<span class="sc">::</span>flights)</span>
<span id="cb542-3"><a href="#cb542-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the order of group_by and summarize matters</span></span>
<span id="cb542-4"><a href="#cb542-4" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb542-5"><a href="#cb542-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">%&gt;%</span> </span>
<span id="cb542-6"><a href="#cb542-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb542-7"><a href="#cb542-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_dep_delay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="13" type="1">
<li>Find the flight with the longest departure delay among flights from the same origin and destination (use <code>filter()</code>). Relocate the origin, destination, and departure delay to the first three columns and sort by origin and dest.</li>
</ol>
<div class="sourceCode" id="cb543"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb543-1"><a href="#cb543-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb543-2"><a href="#cb543-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb543-3"><a href="#cb543-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin, dest) <span class="sc">%&gt;%</span> </span>
<span id="cb543-4"><a href="#cb543-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dep_delay <span class="sc">==</span> <span class="fu">max</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb543-5"><a href="#cb543-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(origin, dest, dep_delay) <span class="sc">%&gt;%</span> </span>
<span id="cb543-6"><a href="#cb543-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(origin, dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="14" type="1">
<li>Find the flight with the longest departure delay among flights from the same origin and destination (use <code>top_n()</code> or <code>slice_max()</code>). Relocate the origin, destination, and departure delay to the first three columns and sort by origin and dest.</li>
</ol>
<div class="sourceCode" id="cb544"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb544-1"><a href="#cb544-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb544-2"><a href="#cb544-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb544-3"><a href="#cb544-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin, dest) <span class="sc">%&gt;%</span> </span>
<span id="cb544-4"><a href="#cb544-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">1</span>, dep_delay) <span class="sc">%&gt;%</span>  <span class="co"># or using slice_max(dep_delay) %&gt;% </span></span>
<span id="cb544-5"><a href="#cb544-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(origin, dest, dep_delay) <span class="sc">%&gt;%</span> </span>
<span id="cb544-6"><a href="#cb544-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(origin, dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="15" type="1">
<li>How do departure delays vary at different times of the day? Summarize the averaged departure delays by hours and create an new column named as <code>dep_delay_level</code> which <code>cut()</code> the averaged departure delays into three levels (low, median, and high).</li>
</ol>
<div class="sourceCode" id="cb545"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb545-1"><a href="#cb545-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb545-2"><a href="#cb545-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour) <span class="sc">%&gt;%</span> </span>
<span id="cb545-3"><a href="#cb545-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb545-4"><a href="#cb545-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dep_delay_level =</span> <span class="fu">cut</span>(avg_dep_delay, <span class="at">breaks=</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">'low'</span>, <span class="st">'median'</span>, <span class="st">'high'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="16" type="1">
<li>How do departure delays vary at different times of the day? Illustrate your answer with a <code>geom_smooth()</code> plot.</li>
</ol>
<div class="sourceCode" id="cb546"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb546-1"><a href="#cb546-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb546-2"><a href="#cb546-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour) <span class="sc">%&gt;%</span> </span>
<span id="cb546-3"><a href="#cb546-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb546-4"><a href="#cb546-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hour, <span class="at">y =</span> avg_dep_delay)) <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb547"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb547-1"><a href="#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ways to deleter the blanks</span></span>
<span id="cb547-2"><a href="#cb547-2" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb547-3"><a href="#cb547-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb547-4"><a href="#cb547-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">student_id =</span> <span class="st">`</span><span class="at">Student ID</span><span class="st">`</span>,</span>
<span id="cb547-5"><a href="#cb547-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_name =</span> <span class="st">`</span><span class="at">Full Name</span><span class="st">`</span></span>
<span id="cb547-6"><a href="#cb547-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb548"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb548-1"><a href="#cb548-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb548-2"><a href="#cb548-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb548-3"><a href="#cb548-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(</span>
<span id="cb548-4"><a href="#cb548-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# A comment I want to skip</span></span>
<span id="cb548-5"><a href="#cb548-5" aria-hidden="true" tabindex="-1"></a><span class="st">  x,y,z</span></span>
<span id="cb548-6"><a href="#cb548-6" aria-hidden="true" tabindex="-1"></a><span class="st">  1,2,3"</span>,</span>
<span id="cb548-7"><a href="#cb548-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="st">"#"</span></span>
<span id="cb548-8"><a href="#cb548-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb549"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb549-1"><a href="#cb549-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb549-2"><a href="#cb549-2" aria-hidden="true" tabindex="-1"></a>grade.book <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb549-3"><a href="#cb549-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">name=</span><span class="st">'Alison'</span>,  <span class="at">HW.1=</span><span class="dv">8</span>, <span class="at">HW.2=</span><span class="dv">5</span>, <span class="at">HW.3=</span><span class="dv">8</span>, <span class="at">HW.4=</span><span class="dv">4</span>),</span>
<span id="cb549-4"><a href="#cb549-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">name=</span><span class="st">'Brandon'</span>, <span class="at">HW.1=</span><span class="dv">5</span>, <span class="at">HW.2=</span><span class="dv">3</span>, <span class="at">HW.3=</span><span class="dv">6</span>, <span class="at">HW.4=</span><span class="dv">9</span>),</span>
<span id="cb549-5"><a href="#cb549-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">name=</span><span class="st">'Charles'</span>, <span class="at">HW.1=</span><span class="dv">9</span>, <span class="at">HW.2=</span><span class="dv">7</span>, <span class="at">HW.3=</span><span class="dv">9</span>, <span class="at">HW.4=</span><span class="dv">10</span>))</span>
<span id="cb549-6"><a href="#cb549-6" aria-hidden="true" tabindex="-1"></a>grade.book</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     name HW.1 HW.2 HW.3 HW.4
1  Alison    8    5    8    4
2 Brandon    5    3    6    9
3 Charles    9    7    9   10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb551"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb551-1"><a href="#cb551-1" aria-hidden="true" tabindex="-1"></a>tidy.scores <span class="ot">&lt;-</span> grade.book <span class="sc">%&gt;%</span></span>
<span id="cb551-2"><a href="#cb551-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb551-3"><a href="#cb551-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"HW"</span>),</span>
<span id="cb551-4"><a href="#cb551-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Homework"</span>,</span>
<span id="cb551-5"><a href="#cb551-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Score"</span></span>
<span id="cb551-6"><a href="#cb551-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb551-7"><a href="#cb551-7" aria-hidden="true" tabindex="-1"></a>tidy.scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   name    Homework Score
   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;
 1 Alison  HW.1         8
 2 Alison  HW.2         5
 3 Alison  HW.3         8
 4 Alison  HW.4         4
 5 Brandon HW.1         5
 6 Brandon HW.2         3
 7 Brandon HW.3         6
 8 Brandon HW.4         9
 9 Charles HW.1         9
10 Charles HW.2         7
11 Charles HW.3         9
12 Charles HW.4        10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb553"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb553-1"><a href="#cb553-1" aria-hidden="true" tabindex="-1"></a>tidy.scores <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Homework, <span class="at">values_from=</span>Score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  name     HW.1  HW.2  HW.3  HW.4
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Alison      8     5     8     4
2 Brandon     5     3     6     9
3 Charles     9     7     9    10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb555"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb555-1"><a href="#cb555-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table joins</span></span>
<span id="cb555-2"><a href="#cb555-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb555-3"><a href="#cb555-3" aria-hidden="true" tabindex="-1"></a>Fish.Data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb555-4"><a href="#cb555-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lake_ID =</span> <span class="fu">c</span>(<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'C'</span>), </span>
<span id="cb555-5"><a href="#cb555-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fish.Weight=</span><span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean=</span><span class="dv">260</span>, <span class="at">sd=</span><span class="dv">25</span>) ) <span class="co"># make up some data</span></span>
<span id="cb555-6"><a href="#cb555-6" aria-hidden="true" tabindex="-1"></a>Fish.Data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Lake_ID Fish.Weight
  &lt;chr&gt;         &lt;dbl&gt;
1 A              211.
2 A              298.
3 B              311.
4 B              293.
5 C              266.
6 C              218.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb557"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb557-1"><a href="#cb557-1" aria-hidden="true" tabindex="-1"></a>Lake.Data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb557-2"><a href="#cb557-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lake_ID =</span> <span class="fu">c</span>(<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>),   </span>
<span id="cb557-3"><a href="#cb557-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lake_Name =</span> <span class="fu">c</span>(<span class="st">'Lake Elaine'</span>, <span class="st">'Mormon Lake'</span>, <span class="st">'Lake Mary'</span>),   </span>
<span id="cb557-4"><a href="#cb557-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pH=</span><span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">6.3</span>, <span class="fl">6.1</span>),</span>
<span id="cb557-5"><a href="#cb557-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">area =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">210</span>, <span class="dv">240</span>),</span>
<span id="cb557-6"><a href="#cb557-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_depth =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">38</span>))</span>
<span id="cb557-7"><a href="#cb557-7" aria-hidden="true" tabindex="-1"></a>Lake.Data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Lake_ID Lake_Name      pH  area avg_depth
  &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 B       Lake Elaine   6.5    40         8
2 C       Mormon Lake   6.3   210        10
3 D       Lake Mary     6.1   240        38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb559"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb559-1"><a href="#cb559-1" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(Fish.Data, Lake.Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Lake_ID)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  Lake_ID Fish.Weight Lake_Name      pH  area avg_depth
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 A              211. &lt;NA&gt;         NA      NA        NA
2 A              298. &lt;NA&gt;         NA      NA        NA
3 B              311. Lake Elaine   6.5    40         8
4 B              293. Lake Elaine   6.5    40         8
5 C              266. Mormon Lake   6.3   210        10
6 C              218. Mormon Lake   6.3   210        10
7 D               NA  Lake Mary     6.1   240        38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb562"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb562-1"><a href="#cb562-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(Fish.Data, Lake.Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Lake_ID)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Lake_ID Fish.Weight Lake_Name      pH  area avg_depth
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 A              211. &lt;NA&gt;         NA      NA        NA
2 A              298. &lt;NA&gt;         NA      NA        NA
3 B              311. Lake Elaine   6.5    40         8
4 B              293. Lake Elaine   6.5    40         8
5 C              266. Mormon Lake   6.3   210        10
6 C              218. Mormon Lake   6.3   210        10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb565"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb565-1"><a href="#cb565-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(Fish.Data, Lake.Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Lake_ID)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  Lake_ID Fish.Weight Lake_Name      pH  area avg_depth
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 B              311. Lake Elaine   6.5    40         8
2 B              293. Lake Elaine   6.5    40         8
3 C              266. Mormon Lake   6.3   210        10
4 C              218. Mormon Lake   6.3   210        10</code></pre>
</div>
</div>
<div class="sourceCode" id="cb568"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb568-1"><a href="#cb568-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb568-2"><a href="#cb568-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">week =</span> <span class="fu">parse_number</span>(week)</span>
<span id="cb568-3"><a href="#cb568-3" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>how many data points are in the data set</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb569-1"><a href="#cb569-1" aria-hidden="true" tabindex="-1"></a>gender_year <span class="ot">&lt;-</span> Survey <span class="sc">%&gt;%</span> </span>
<span id="cb569-2"><a href="#cb569-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb569-3"><a href="#cb569-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb569-4"><a href="#cb569-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb569-5"><a href="#cb569-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">nu=</span>n)</span>
<span id="cb569-6"><a href="#cb569-6" aria-hidden="true" tabindex="-1"></a>gender_year</span>
<span id="cb569-7"><a href="#cb569-7" aria-hidden="true" tabindex="-1"></a>gender_year <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Year, <span class="at">values_from =</span> nu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb570"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb570-1"><a href="#cb570-1" aria-hidden="true" tabindex="-1"></a>who2 <span class="sc">%&gt;%</span> </span>
<span id="cb570-2"><a href="#cb570-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb570-3"><a href="#cb570-3" aria-hidden="true" tabindex="-1"></a>who2 <span class="ot">&lt;-</span> who2 <span class="sc">%&gt;%</span> </span>
<span id="cb570-4"><a href="#cb570-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb570-5"><a href="#cb570-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">!</span>(country<span class="sc">:</span>year), </span>
<span id="cb570-6"><a href="#cb570-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>), </span>
<span id="cb570-7"><a href="#cb570-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb570-8"><a href="#cb570-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"count"</span></span>
<span id="cb570-9"><a href="#cb570-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb570-10"><a href="#cb570-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(count))</span>
<span id="cb570-11"><a href="#cb570-11" aria-hidden="true" tabindex="-1"></a>who2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb571"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb571-1"><a href="#cb571-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(feb14_VX, airports, <span class="at">by=</span><span class="fu">c</span>(<span class="st">'dest'</span><span class="ot">=</span><span class="st">'faa'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb572"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb572-1"><a href="#cb572-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb572-2"><a href="#cb572-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb572-3"><a href="#cb572-3" aria-hidden="true" tabindex="-1"></a>drug_prop <span class="ot">&lt;-</span> drug_prop <span class="sc">%&gt;%</span> </span>
<span id="cb572-4"><a href="#cb572-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">'Carboxylic acids and derivatives'</span>) </span>
<span id="cb572-5"><a href="#cb572-5" aria-hidden="true" tabindex="-1"></a>drug_prop <span class="sc">%&gt;%</span> </span>
<span id="cb572-6"><a href="#cb572-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(logP, logS, water_solubility) <span class="sc">%&gt;%</span> </span>
<span id="cb572-7"><a href="#cb572-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs.panels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>for loop</li>
</ul>
<div class="sourceCode" id="cb573"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb573-1"><a href="#cb573-1" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">10</span>)        </span>
<span id="cb573-2"><a href="#cb573-2" aria-hidden="true" tabindex="-1"></a>F[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>             </span>
<span id="cb573-3"><a href="#cb573-3" aria-hidden="true" tabindex="-1"></a>F[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span>              </span>
<span id="cb573-4"><a href="#cb573-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'F = '</span>, F, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>) </span>
<span id="cb573-5"><a href="#cb573-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb573-6"><a href="#cb573-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( n <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span> ){</span>
<span id="cb573-7"><a href="#cb573-7" aria-hidden="true" tabindex="-1"></a>  F[n] <span class="ot">&lt;-</span> F[n<span class="dv">-1</span>] <span class="sc">+</span> F[n<span class="dv">-2</span>]</span>
<span id="cb573-8"><a href="#cb573-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">'F = '</span>, F, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)    </span>
<span id="cb573-9"><a href="#cb573-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>bootstrap estimate of a sampling distribution</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb574"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb574-1"><a href="#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb574-2"><a href="#cb574-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb574-3"><a href="#cb574-3" aria-hidden="true" tabindex="-1"></a>SampDist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb574-4"><a href="#cb574-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb574-5"><a href="#cb574-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb574-6"><a href="#cb574-6" aria-hidden="true" tabindex="-1"></a>  SampDist <span class="ot">&lt;-</span> trees <span class="sc">%&gt;%</span> </span>
<span id="cb574-7"><a href="#cb574-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">replace =</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb574-8"><a href="#cb574-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">xbar=</span><span class="fu">mean</span>(Height)) <span class="sc">%&gt;%</span> </span>
<span id="cb574-9"><a href="#cb574-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>(SampDist)</span>
<span id="cb574-10"><a href="#cb574-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb574-11"><a href="#cb574-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SampDist,<span class="fu">aes</span>(<span class="at">x=</span>xbar)) <span class="sc">+</span></span>
<span id="cb574-12"><a href="#cb574-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="ellipses-1" class="level2">
<h2 class="anchored" data-anchor-id="ellipses-1">Ellipses</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb576"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb576-1"><a href="#cb576-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a function that draws the regression line and confidence interval</span></span>
<span id="cb576-2"><a href="#cb576-2" aria-hidden="true" tabindex="-1"></a><span class="co"># notice it doesn't return anything, all it does is draw a plot</span></span>
<span id="cb576-3"><a href="#cb576-3" aria-hidden="true" tabindex="-1"></a>show.lm <span class="ot">&lt;-</span> <span class="cf">function</span>(m, <span class="at">interval.type=</span><span class="st">'confidence'</span>, <span class="at">fill.col=</span><span class="st">'light grey'</span>, ...){</span>
<span id="cb576-4"><a href="#cb576-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> m<span class="sc">$</span>model[,<span class="dv">2</span>]       <span class="co"># extract the predictor variable</span></span>
<span id="cb576-5"><a href="#cb576-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> m<span class="sc">$</span>model[,<span class="dv">1</span>]       <span class="co"># extract the response</span></span>
<span id="cb576-6"><a href="#cb576-6" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">interval=</span>interval.type)</span>
<span id="cb576-7"><a href="#cb576-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x, y, ...)</span>
<span id="cb576-8"><a href="#cb576-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>( <span class="fu">c</span>(x,<span class="fu">rev</span>(x)),                         <span class="co"># draw the ribbon defined</span></span>
<span id="cb576-9"><a href="#cb576-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(pred[,<span class="st">'lwr'</span>], <span class="fu">rev</span>(pred[,<span class="st">'upr'</span>])),  <span class="co"># by lwr and upr - polygon</span></span>
<span id="cb576-10"><a href="#cb576-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col=</span><span class="st">'light grey'</span>)                    <span class="co"># fills in the region defined by            </span></span>
<span id="cb576-11"><a href="#cb576-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, pred[, <span class="st">'fit'</span>])                       <span class="co"># a set of vertices, need to reverse            </span></span>
<span id="cb576-12"><a href="#cb576-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x, y)                                  <span class="co"># the uppers to make a nice figure</span></span>
<span id="cb576-13"><a href="#cb576-13" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="copy-of-x" class="level1">
<h1>copy of x</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb577"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb577-1"><a href="#cb577-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb577-2"><a href="#cb577-2" aria-hidden="true" tabindex="-1"></a>example.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb577-3"><a href="#cb577-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb577-4"><a href="#cb577-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (k <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb577-5"><a href="#cb577-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(x)</span>
<span id="cb577-6"><a href="#cb577-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb577-7"><a href="#cb577-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb577-8"><a href="#cb577-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb577-9"><a href="#cb577-9" aria-hidden="true" tabindex="-1"></a><span class="fu">example.func</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb579"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb579-1"><a href="#cb579-1" aria-hidden="true" tabindex="-1"></a>x <span class="co"># x is changed inside the function but not outsied the function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 1 5 4 2</code></pre>
</div>
</div>
</section>
<section id="lab-10" class="level1">
<h1>LAB 10</h1>
<section id="part-1" class="level2">
<h2 class="anchored" data-anchor-id="part-1">Part 1</h2>
<ol type="1">
<li>Load the <code>bloodpress.txt</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb581"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb581-1"><a href="#cb581-1" aria-hidden="true" tabindex="-1"></a>bloodpress <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"bloodpress.txt"</span>, <span class="at">header=</span>T)</span>
<span id="cb581-2"><a href="#cb581-2" aria-hidden="true" tabindex="-1"></a>bloodpress</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Pt  BP Age Weight  BSA  Dur Pulse Stress
1   1 105  47   85.4 1.75  5.1    63     33
2   2 115  49   94.2 2.10  3.8    70     14
3   3 116  49   95.3 1.98  8.2    72     10
4   4 117  50   94.7 2.01  5.8    73     99
5   5 112  51   89.4 1.89  7.0    72     95
6   6 121  48   99.5 2.25  9.3    71     10
7   7 121  49   99.8 2.25  2.5    69     42
8   8 110  47   90.9 1.90  6.2    66      8
9   9 110  49   89.2 1.83  7.1    69     62
10 10 114  48   92.7 2.07  5.6    64     35
11 11 114  47   94.4 2.07  5.3    74     90
12 12 115  49   94.1 1.98  5.6    71     21
13 13 114  50   91.6 2.05 10.2    68     47
14 14 106  45   87.1 1.92  5.6    67     80
15 15 125  52  101.3 2.19 10.0    76     98
16 16 114  46   94.5 1.98  7.4    69     95
17 17 106  46   87.0 1.87  3.6    62     18
18 18 113  46   94.5 1.90  4.3    70     12
19 19 110  48   90.5 1.88  9.0    71     99
20 20 122  56   95.7 2.09  7.0    75     99</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Use <code>pairs.panels()</code> function from <code>psych</code> pacakge to draw scatterplots, histograms, and calculate correlations between variables.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb583"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb583-1"><a href="#cb583-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:gtools':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:mosaic':

    logit, rescale</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb589"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb589-1"><a href="#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(bloodpress[, <span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Fit a simple linear regression model of BP vs Stress. Is Stress significant?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb590"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb590-1"><a href="#cb590-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Stress, <span class="at">data=</span>bloodpress)</span>
<span id="cb590-2"><a href="#cb590-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Stress, data = bloodpress)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.6394 -3.3014  0.0722  2.2181  9.9287 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 112.71997    2.19345  51.389   &lt;2e-16 ***
Stress        0.02399    0.03404   0.705     0.49    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.502 on 18 degrees of freedom
Multiple R-squared:  0.02686,   Adjusted R-squared:  -0.0272 
F-statistic: 0.4969 on 1 and 18 DF,  p-value: 0.4899</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Fit a simple linear regression model of BP vs Weight.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb592"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb592-1"><a href="#cb592-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Weight, <span class="at">data=</span>bloodpress)</span>
<span id="cb592-2"><a href="#cb592-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Weight, data = bloodpress)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.6933 -0.9318 -0.4935  0.7703  4.8656 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.20531    8.66333   0.255    0.802    
Weight       1.20093    0.09297  12.917 1.53e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.74 on 18 degrees of freedom
Multiple R-squared:  0.9026,    Adjusted R-squared:  0.8972 
F-statistic: 166.9 on 1 and 18 DF,  p-value: 1.528e-10</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Fit a simple linear regression model of BP vs BSA.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb594"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb594-1"><a href="#cb594-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> BSA, <span class="at">data=</span>bloodpress)</span>
<span id="cb594-2"><a href="#cb594-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ BSA, data = bloodpress)

Residuals:
   Min     1Q Median     3Q    Max 
-5.314 -1.963 -0.197  1.934  4.831 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   45.183      9.392   4.811  0.00014 ***
BSA           34.443      4.690   7.343 8.11e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.79 on 18 degrees of freedom
Multiple R-squared:  0.7497,    Adjusted R-squared:  0.7358 
F-statistic: 53.93 on 1 and 18 DF,  p-value: 8.114e-07</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Fit a multiple linear regression model of BP vs Weight + BSA. Is BSA still significant? Why?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb596"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb596-1"><a href="#cb596-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Weight <span class="sc">+</span> BSA, <span class="at">data=</span>bloodpress)</span>
<span id="cb596-2"><a href="#cb596-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Weight + BSA, data = bloodpress)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8932 -1.1961 -0.4061  1.0764  4.7524 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   5.6534     9.3925   0.602    0.555    
Weight        1.0387     0.1927   5.392 4.87e-05 ***
BSA           5.8313     6.0627   0.962    0.350    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.744 on 17 degrees of freedom
Multiple R-squared:  0.9077,    Adjusted R-squared:  0.8968 
F-statistic: 83.54 on 2 and 17 DF,  p-value: 1.607e-09</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Predict BP for Weight=92 and BSA=2 for the two simple linear regression models and the multiple linear regression model, by hand and by <code>predict()</code> function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb598"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb598-1"><a href="#cb598-1" aria-hidden="true" tabindex="-1"></a><span class="fl">2.20531</span> <span class="sc">+</span> <span class="fl">1.20093</span> <span class="sc">*</span> <span class="dv">92</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 112.6909</code></pre>
</div>
<div class="sourceCode cell-code" id="cb600"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb600-1"><a href="#cb600-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model<span class="fl">.2</span>,</span>
<span id="cb600-2"><a href="#cb600-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Weight=</span><span class="dv">92</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1 
112.691 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb602"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb602-1"><a href="#cb602-1" aria-hidden="true" tabindex="-1"></a><span class="fl">45.183</span> <span class="sc">+</span> <span class="fl">34.443</span> <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 114.069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb604"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb604-1"><a href="#cb604-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model<span class="fl">.3</span>,</span>
<span id="cb604-2"><a href="#cb604-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">BSA=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
114.0689 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb606"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb606-1"><a href="#cb606-1" aria-hidden="true" tabindex="-1"></a><span class="fl">5.6534</span> <span class="sc">+</span> <span class="fl">1.0387</span> <span class="sc">*</span> <span class="dv">92</span> <span class="sc">+</span> <span class="fl">5.8313</span> <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 112.8764</code></pre>
</div>
<div class="sourceCode cell-code" id="cb608"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb608-1"><a href="#cb608-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model<span class="fl">.4</span>,</span>
<span id="cb608-2"><a href="#cb608-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Weight=</span><span class="dv">92</span>, <span class="at">BSA=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
112.8794 </code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Fit a multiple linear regression model of BP vs Age + Weight. Set argument <code>x</code> and <code>y</code> as TRUE. Save the output of <code>lm()</code> as <code>model.5</code>. How do we interpret each estimated coefficients?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb610"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb610-1"><a href="#cb610-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Age <span class="sc">+</span> Weight, <span class="at">data=</span>bloodpress, <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>)</span>
<span id="cb610-2"><a href="#cb610-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Age + Weight, data = bloodpress, x = TRUE, 
    y = TRUE)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.89968 -0.35242  0.06979  0.35528  0.82781 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -16.57937    3.00746  -5.513 3.80e-05 ***
Age           0.70825    0.05351  13.235 2.22e-10 ***
Weight        1.03296    0.03116  33.154  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5327 on 17 degrees of freedom
Multiple R-squared:  0.9914,    Adjusted R-squared:  0.9904 
F-statistic: 978.2 on 2 and 17 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Use the <code>plot_ly</code> function in the <code>plotly</code> package to create a 3D scatterplot of the data with the fitted plane for a multiple linear regression model of BP vs Age + Weight.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb612"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb612-1"><a href="#cb612-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:plyr':

    arrange, mutate, rename, summarise</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:reshape':

    rename</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mosaic':

    do</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb621"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb621-1"><a href="#cb621-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x=</span>bloodpress<span class="sc">$</span>Age, <span class="at">y=</span>bloodpress<span class="sc">$</span>Weight, <span class="at">z=</span>bloodpress<span class="sc">$</span>BP, <span class="at">type=</span><span class="st">'scatter3d'</span>, <span class="at">mode=</span><span class="st">'markers'</span>, <span class="at">color=</span>bloodpress<span class="sc">$</span>BP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-8c2820b5e6663da2b7fc" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-8c2820b5e6663da2b7fc">{"x":{"visdat":{"926444306ad9":["function () ","plotlyVisDat"]},"cur_data":"926444306ad9","attrs":{"926444306ad9":{"x":[47,49,49,50,51,48,49,47,49,48,47,49,50,45,52,46,46,46,48,56],"y":[85.400000000000006,94.200000000000003,95.299999999999997,94.700000000000003,89.400000000000006,99.5,99.799999999999997,90.900000000000006,89.200000000000003,92.700000000000003,94.400000000000006,94.099999999999994,91.599999999999994,87.099999999999994,101.3,94.5,87,94.5,90.5,95.700000000000003],"z":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122],"mode":"markers","color":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":[]},"yaxis":{"title":[]},"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[47,49,49,50,51,48,49,47,49,48,47,49,50,45,52,46,46,46,48,56],"y":[85.400000000000006,94.200000000000003,95.299999999999997,94.700000000000003,89.400000000000006,99.5,99.799999999999997,90.900000000000006,89.200000000000003,92.700000000000003,94.400000000000006,94.099999999999994,91.599999999999994,87.099999999999994,101.3,94.5,87,94.5,90.5,95.700000000000003],"z":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122],"mode":"markers","type":"scatter3d","marker":{"colorbar":{"title":"","ticklen":2},"cmin":105,"cmax":125,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666664","rgba(70,19,97,1)"],["0.0833333333333336","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666666","rgba(68,58,128,1)"],["0.208333333333334","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666666","rgba(56,93,140,1)"],["0.333333333333334","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666666","rgba(42,123,142,1)"],["0.458333333333334","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666666","rgba(33,154,138,1)"],["0.583333333333334","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666666","rgba(53,183,121,1)"],["0.708333333333334","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666666","rgba(119,207,85,1)"],["0.833333333333334","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333334","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122],"line":{"colorbar":{"title":"","ticklen":2},"cmin":105,"cmax":125,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666664","rgba(70,19,97,1)"],["0.0833333333333336","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666666","rgba(68,58,128,1)"],["0.208333333333334","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666666","rgba(56,93,140,1)"],["0.333333333333334","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666666","rgba(42,123,142,1)"],["0.458333333333334","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666666","rgba(33,154,138,1)"],["0.583333333333334","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666666","rgba(53,183,121,1)"],["0.708333333333334","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666666","rgba(119,207,85,1)"],["0.833333333333334","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333334","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122]}},"frame":null},{"x":[45,56],"y":[85.400000000000006,101.3],"type":"scatter3d","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":105,"cmax":125,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666664","rgba(70,19,97,1)"],["0.0833333333333336","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666666","rgba(68,58,128,1)"],["0.208333333333334","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666666","rgba(56,93,140,1)"],["0.333333333333334","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666666","rgba(42,123,142,1)"],["0.458333333333334","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666666","rgba(33,154,138,1)"],["0.583333333333334","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666666","rgba(53,183,121,1)"],["0.708333333333334","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666666","rgba(119,207,85,1)"],["0.833333333333334","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333334","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[105,125],"line":{"color":"rgba(255,127,14,1)"}},"z":[105,125],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ol start="9" type="1">
<li>Extract the matrix <code>x</code> and <code>y</code> of <code>model.5</code> and assign it to a new object <code>X</code> and <code>y</code>. Remember, if you save the output of <code>lm()</code> as an object, this object contains many elements. After we set <code>x=TRUE</code> and <code>y=TRUE</code> in question 8, we can find <code>x</code> and <code>y</code> in this list.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb622"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb622-1"><a href="#cb622-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> model<span class="fl">.5</span><span class="sc">$</span>x</span>
<span id="cb622-2"><a href="#cb622-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> model<span class="fl">.5</span><span class="sc">$</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="10" type="1">
<li>Calculate <span class="math inline">\(X^{T}X\)</span>, <span class="math inline">\(X^{T}y\)</span>, <span class="math inline">\((X^{T}X)^{-1}\)</span>, and <span class="math inline">\((X^{T}X)^{-1}X^{T}y\)</span>. Use <code>t()</code> for transpose, <code>%*%</code> for matrix multiplication, and <code>solve()</code> for inverse of matrix. For the last one, is your result same as the estimated values you obtained in question 7? –Of course!</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb623"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb623-1"><a href="#cb623-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(X) <span class="sc">%*%</span> X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)     Age   Weight
(Intercept)        20.0   972.0   1861.8
Age               972.0 47358.0  90566.6
Weight           1861.8 90566.6 173665.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb625"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb625-1"><a href="#cb625-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(X) <span class="sc">%*%</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                [,1]
(Intercept)   2280.0
Age         110978.0
Weight      212666.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb627"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb627-1"><a href="#cb627-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)          Age       Weight
(Intercept)  31.8748075 -0.267669593 -0.202127676
Age          -0.2676696  0.010092130 -0.002393468
Weight       -0.2021277 -0.002393468  0.003420885</code></pre>
</div>
<div class="sourceCode cell-code" id="cb629"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb629-1"><a href="#cb629-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> (<span class="fu">t</span>(X) <span class="sc">%*%</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   [,1]
(Intercept) -16.5793694
Age           0.7082515
Weight        1.0329611</code></pre>
</div>
</div>
<ol start="11" type="1">
<li>Use the anova function to display the ANOVA table with sequential (type I) sums of squares for the <code>model.5</code>.</li>
</ol>
<p>$SS_{} = *{i=1}^n (* - {y})^2 $</p>
<p><span class="math inline">\(\hat{y}_{\text{Variable}, i}\)</span> is the model including only varible i.</p>
<p>$ F = $</p>
<p>If (F <span class="math inline">\(\approx\)</span> 1) : It indicates that the sizes of MS_Variable and MS_Residuals are approximately the same, suggesting that the explanatory power of the independent variable for the dependent variable is comparable to the random error, and the null hypothesis ((H_0)) cannot be rejected.</p>
<p>If (F <span class="math inline">\(\gg\)</span> 1) : It indicates that MS_Variable is significantly greater than MS_Residuals, suggesting that the independent variable has a significant influence on the dependent variable, and the null hypothesis ((H_0)) can be rejected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb631"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb631-1"><a href="#cb631-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: BP
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Age        1 243.266 243.266  857.29 5.481e-16 ***
Weight     1 311.910 311.910 1099.20 &lt; 2.2e-16 ***
Residuals 17   4.824   0.284                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb633"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb633-1"><a href="#cb633-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remark</span></span>
<span id="cb633-2"><a href="#cb633-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((model<span class="fl">.5</span><span class="sc">$</span>y<span class="sc">-</span><span class="fu">mean</span>(model<span class="fl">.5</span><span class="sc">$</span>y))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">==</span> <span class="fl">243.266+311.910+4.824</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>$SS_{} = SS_{} + SS_{} + SS_{} $</p>
<ol start="12" type="1">
<li>Use the <code>residuals</code> element in fitted model or <code>residuals()</code> function to extract the fitted residuals. Calculate the sum of square of these residual values. Extract the <code>df.residual</code> element in fitted model and use the above elements to calculate the MSE. Is your result same as the <code>anova()</code> output?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb635"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb635-1"><a href="#cb635-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((model<span class="fl">.5</span><span class="sc">$</span>residuals)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>model<span class="fl">.5</span><span class="sc">$</span>df.residual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2837604</code></pre>
</div>
</div>
<ol start="13" type="1">
<li>Fit a multiple linear regression model of BP vs Age + Weight + Pulse. Save the output of <code>lm()</code> as <code>model.6</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb637"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb637-1"><a href="#cb637-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Age <span class="sc">+</span> Weight <span class="sc">+</span> Pulse, <span class="at">data=</span>bloodpress)</span>
<span id="cb637-2"><a href="#cb637-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Age + Weight + Pulse, data = bloodpress)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.71174 -0.45422 -0.01909  0.41745  0.88743 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -16.69000    2.93761  -5.681 3.40e-05 ***
Age           0.75018    0.06074  12.350 1.36e-09 ***
Weight        1.06135    0.03695  28.722 3.40e-15 ***
Pulse        -0.06566    0.04852  -1.353    0.195    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5201 on 16 degrees of freedom
Multiple R-squared:  0.9923,    Adjusted R-squared:  0.9908 
F-statistic: 684.7 on 3 and 16 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ol start="14" type="1">
<li>Use <code>anova()</code> function to obtain the ANOVA table for <code>model.6</code>. We may consider <code>model.6</code> as full model, and <code>model.5</code> as reduced model in this question. Based on the obtained ANOVA table and the output of question 11, calculate the F-statistic for testing the reduced model by hand. You may use the Residuals Sum sq and the corresponding Residuals Df from both tables. Then, calculate the p-value using <span class="math inline">\(pf()\)</span> function, don’t forget about the <code>lower.tail</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb639"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb639-1"><a href="#cb639-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: BP
          Df  Sum Sq Mean Sq   F value    Pr(&gt;F)    
Age        1 243.266 243.266  899.2446 1.726e-15 ***
Weight     1 311.910 311.910 1152.9909 2.433e-16 ***
Pulse      1   0.496   0.496    1.8319    0.1947    
Residuals 16   4.328   0.271                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb641"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb641-1"><a href="#cb641-1" aria-hidden="true" tabindex="-1"></a>Fstat <span class="ot">&lt;-</span> (<span class="fl">4.824-4.328</span>)<span class="sc">/</span>(<span class="dv">17-16</span>) <span class="sc">/</span> (<span class="fl">4.328</span><span class="sc">/</span><span class="dv">16</span>)</span>
<span id="cb641-2"><a href="#cb641-2" aria-hidden="true" tabindex="-1"></a>Fstat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.833641</code></pre>
</div>
<div class="sourceCode cell-code" id="cb643"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb643-1"><a href="#cb643-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(Fstat, <span class="dv">1</span>, <span class="dv">16</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1945157</code></pre>
</div>
</div>
<ol start="15" type="1">
<li>Use <code>anova()</code> function to do the F-test on <code>model.5</code> and <code>model.6</code>. Compare the output with your answers of question 14. What is the conclustion of the F-test?</li>
</ol>
<p>$ = _{i=1}^n (y_i - _i)^2 $</p>
<p>$ = - $ (It represents the variation in the interpretation of the dependent variable by the newly added variable Pulse.)</p>
<p><span class="math display">\[ F = \frac{\text{Sum of Sq} / \text{Df}}{\text{RSS(Model 2)} / \text{Res.Df(Model 2)}} \\F = \frac{0.49557}{0.270525} \approx 1.8319\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb645"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb645-1"><a href="#cb645-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model<span class="fl">.5</span>, model<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: BP ~ Age + Weight
Model 2: BP ~ Age + Weight + Pulse
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     17 4.8239                           
2     16 4.3284  1   0.49557 1.8319 0.1947</code></pre>
</div>
</div>
<ol start="16" type="1">
<li>Plot the qqPlot for residuals of <code>model.5</code>. What is the x-axis and y-axis of the qqPlot? What can we say about the qqPlot?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb647"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb647-1"><a href="#cb647-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb647-2"><a href="#cb647-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(model<span class="fl">.5</span><span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19 10</code></pre>
</div>
</div>
<ol start="17" type="1">
<li>Plot the residual vs fitted plot of <code>model.5</code>. You may extract <code>fitted.values</code> from <code>model.5</code> and use it as <code>x</code> in <code>plot()</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb649"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb649-1"><a href="#cb649-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>model<span class="fl">.5</span><span class="sc">$</span>fitted.values, <span class="at">y=</span>model<span class="fl">.5</span><span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="18" type="1">
<li>Directly use <code>plot()</code> function on <code>model.5</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb650"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb650-1"><a href="#cb650-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-107-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-107-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-107-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-2" class="level2">
<h2 class="anchored" data-anchor-id="part-2">Part 2</h2>
<ol start="19" type="1">
<li>Load the <code>hospital_infct.txt</code> data and select observations with Stay &lt;= 14.</li>
</ol>
<div class="sourceCode" id="cb651"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb651-1"><a href="#cb651-1" aria-hidden="true" tabindex="-1"></a>infectionrisk <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"/Users/luyu/Desktop/APH——course/NOTEsAPH101/hospital_infct.txt"</span>, <span class="at">header=</span>T)</span>
<span id="cb651-2"><a href="#cb651-2" aria-hidden="true" tabindex="-1"></a>infectionrisk <span class="ot">&lt;-</span> infectionrisk[infectionrisk<span class="sc">$</span>Stay<span class="sc">&lt;=</span><span class="dv">14</span>,]</span>
<span id="cb651-3"><a href="#cb651-3" aria-hidden="true" tabindex="-1"></a>infectionrisk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="20" type="1">
<li>Create new dummy/indicator columns (<code>i1</code>, <code>i2</code>, <code>i3</code>, <code>i4</code>) for regions using <code>ifelse()</code> function. For example, i1 = 1 when Region = 1 and i1 = 0 when Region is not equal to 1; i2 = 1 when Region = 2 and i2 = 0 when Region is not equal to 2; …</li>
</ol>
<div class="sourceCode" id="cb652"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb652-1"><a href="#cb652-1" aria-hidden="true" tabindex="-1"></a>infectionrisk<span class="sc">$</span>i1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(infectionrisk<span class="sc">$</span>Region <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb652-2"><a href="#cb652-2" aria-hidden="true" tabindex="-1"></a>infectionrisk<span class="sc">$</span>i2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(infectionrisk<span class="sc">$</span>Region <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb652-3"><a href="#cb652-3" aria-hidden="true" tabindex="-1"></a>infectionrisk<span class="sc">$</span>i3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(infectionrisk<span class="sc">$</span>Region <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb652-4"><a href="#cb652-4" aria-hidden="true" tabindex="-1"></a>infectionrisk<span class="sc">$</span>i4 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(infectionrisk<span class="sc">$</span>Region <span class="sc">==</span> <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="21" type="1">
<li>Fit a multiple linear regression model of InfctRsk on Stay + Xray + i2 + i3 + i4.</li>
</ol>
<div class="sourceCode" id="cb653"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb653-1"><a href="#cb653-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(InfctRsk <span class="sc">~</span> Stay <span class="sc">+</span> Xray <span class="sc">+</span> i2 <span class="sc">+</span> i3 <span class="sc">+</span> i4, <span class="at">data=</span>infectionrisk)</span>
<span id="cb653-2"><a href="#cb653-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="23" type="1">
<li>Can we include i1 + i2 + i3 + i4 in this multiple linear regression? Why?</li>
</ol>
<p>No.&nbsp;In the context of using dummy variables for categorical data in regression analysis, it’s essential to designate a reference category. This reference category is represented by a coefficient of zero, while the coefficients for the other categories are interpreted as deviations from this reference point.</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb654-1"><a href="#cb654-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(InfctRsk <span class="sc">~</span> Stay <span class="sc">+</span> Xray <span class="sc">+</span> i1 <span class="sc">+</span> i2 <span class="sc">+</span> i3 <span class="sc">+</span> i4, <span class="at">data=</span>infectionrisk)</span>
<span id="cb654-2"><a href="#cb654-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="24" type="1">
<li>Conduct an F-test (use <code>anova()</code> function) to see if at least one of i2, i3, and i4 are useful.</li>
</ol>
<div class="sourceCode" id="cb655"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb655-1"><a href="#cb655-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(InfctRsk <span class="sc">~</span> Stay <span class="sc">+</span> Xray, <span class="at">data=</span>infectionrisk)</span>
<span id="cb655-2"><a href="#cb655-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model<span class="fl">.7</span>, model<span class="fl">.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="confusion-matrix" class="level1">
<h1>Confusion Matrix</h1>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 17%">
<col style="width: 26%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Total population <span class="math inline">\(=\mathrm{P}+\mathrm{N}\)</span></th>
<th style="text-align: left;">Predicted Positive (PP)</th>
<th style="text-align: left;">Predicted Negative (PN)</th>
<th style="text-align: left;">Informedness, bookmaker informedness (BM) <span class="math inline">\(=\mathrm{TPR}+\mathrm{TNR}-1\)</span></th>
<th style="text-align: left;">Prevalence threshold (PT) <span class="math inline">\(=\frac{\sqrt{\mathrm{TPR} \times \mathrm{FPR}}-\mathrm{FPR}}{\mathrm{TPR}-\mathrm{FPR}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Positive (P) <span class="math inline">\({ }^{[\text {a }]}\)</span></td>
<td style="text-align: left;">True positive (TP), hit <span class="math inline">\({ }^{[b]}\)</span></td>
<td style="text-align: left;">False negative (FN), miss, underestimation</td>
<td style="text-align: left;">True positive rate (TPR), recall, sensitivity (SEN), probability of detection, hit rate, power <span class="math inline">\(=\frac{\mathrm{TP}}{\mathrm{P}}=1-\mathrm{FNR}\)</span></td>
<td style="text-align: left;">False negative rate (FNR), miss rate type ll error <span class="math inline">\({ }^{[c]}\)</span> <span class="math inline">\(=\frac{\mathrm{FN}}{\mathrm{P}}=1-\mathrm{TPR}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Negative ( N ) <span class="math inline">\({ }^{[d]}\)</span></td>
<td style="text-align: left;">False positive (FP), false alarm, overestimation</td>
<td style="text-align: left;">True negative (TN), correct rejection <span class="math inline">\({ }^{[\text {e }]}\)</span></td>
<td style="text-align: left;">False positive rate (FPR), probability of false alarm, fall-out type I error <span class="math inline">\({ }^{[7]}\)</span> <span class="math inline">\(=\frac{\mathrm{FP}}{\mathrm{~N}}=1-\mathrm{TNR}\)</span></td>
<td style="text-align: left;">True negative rate (TNR), specificity (SPC), selectivity <span class="math inline">\(=\frac{\mathrm{TN}}{\mathrm{N}}=1-\mathrm{FPR}\)</span></td>
</tr>
</tbody>
</table>
<section id="example-2" class="level2">
<h2 class="anchored" data-anchor-id="example-2">example</h2>
<section id="lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv" class="level3">
<h3 class="anchored" data-anchor-id="lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv">Lung Cancer Classification (https://www.kaggle.com/datasets/mysarahmadbhat/lung-cancer?select=survey+lung+cancer.csv)</h3>
<p>The effectiveness of cancer prediction system helps the people to know their cancer risk with low cost and it also helps the people to take the appropriate decision based on their cancer risk status. The data is collected from the website online lung cancer prediction system.</p>
<p>Total no. of attributes: 16 No.&nbsp;of instances: 284</p>
<p>Attribute information:</p>
<p>Gender: M(male), F(female) Age: Age of the patient Smoking: YES=2, NO=1. Yellow fingers: YES=2, NO=1. Anxiety: YES=2, NO=1. Peer_pressure: YES=2, NO=1. Chronic Disease: YES=2, NO=1. Fatigue: YES=2, NO=1. Allergy: YES=2, NO=1. Wheezing: YES=2, NO=1. Alcohol: YES=2, NO=1. Coughing: YES=2, NO=1. Shortness of Breath: YES=2, NO=1. Swallowing Difficulty: YES=2, NO=1. Chest pain: YES=2, NO=1. Lung Cancer: YES, NO.</p>
<p>Goal: It is your job to classify Lung Cancer using other variables</p>
<section id="example-code" class="level4">
<h4 class="anchored" data-anchor-id="example-code">Example Code</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb656"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb656-1"><a href="#cb656-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the dataset </span></span>
<span id="cb656-2"><a href="#cb656-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb656-3"><a href="#cb656-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'/Users/luyu/Desktop/Math-s-interesting-things/survey_lung_cancer.csv'</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb656-4"><a href="#cb656-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>LUNG_CANCER <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>LUNG_CANCER<span class="sc">==</span><span class="st">"YES"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb656-5"><a href="#cb656-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    GENDER               AGE           SMOKING      YELLOW_FINGERS
 Length:309         Min.   :21.00   Min.   :1.000   Min.   :1.00  
 Class :character   1st Qu.:57.00   1st Qu.:1.000   1st Qu.:1.00  
 Mode  :character   Median :62.00   Median :2.000   Median :2.00  
                    Mean   :62.67   Mean   :1.563   Mean   :1.57  
                    3rd Qu.:69.00   3rd Qu.:2.000   3rd Qu.:2.00  
                    Max.   :87.00   Max.   :2.000   Max.   :2.00  
    ANXIETY      PEER_PRESSURE   CHRONIC DISEASE    FATIGUE     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
 Median :1.000   Median :2.000   Median :2.000   Median :2.000  
 Mean   :1.498   Mean   :1.502   Mean   :1.505   Mean   :1.673  
 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  
 Max.   :2.000   Max.   :2.000   Max.   :2.000   Max.   :2.000  
    ALLERGY         WHEEZING     ALCOHOL CONSUMING    COUGHING    
 Min.   :1.000   Min.   :1.000   Min.   :1.000     Min.   :1.000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000     1st Qu.:1.000  
 Median :2.000   Median :2.000   Median :2.000     Median :2.000  
 Mean   :1.557   Mean   :1.557   Mean   :1.557     Mean   :1.579  
 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000     3rd Qu.:2.000  
 Max.   :2.000   Max.   :2.000   Max.   :2.000     Max.   :2.000  
 SHORTNESS OF BREATH SWALLOWING DIFFICULTY   CHEST PAIN     LUNG_CANCER    
 Min.   :1.000       Min.   :1.000         Min.   :1.000   Min.   :0.0000  
 1st Qu.:1.000       1st Qu.:1.000         1st Qu.:1.000   1st Qu.:1.0000  
 Median :2.000       Median :1.000         Median :2.000   Median :1.0000  
 Mean   :1.641       Mean   :1.469         Mean   :1.557   Mean   :0.8738  
 3rd Qu.:2.000       3rd Qu.:2.000         3rd Qu.:2.000   3rd Qu.:1.0000  
 Max.   :2.000       Max.   :2.000         Max.   :2.000   Max.   :1.0000  </code></pre>
</div>
</div>
<div class="sourceCode" id="cb658"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb658-1"><a href="#cb658-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb658-2"><a href="#cb658-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(SMOKING), <span class="at">fill =</span> <span class="fu">factor</span>(LUNG_CANCER))) <span class="sc">+</span></span>
<span id="cb658-3"><a href="#cb658-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb658-4"><a href="#cb658-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"salmon"</span>)) <span class="sc">+</span></span>
<span id="cb658-5"><a href="#cb658-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb659"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb659-1"><a href="#cb659-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Data SAMPLING ####</span></span>
<span id="cb659-2"><a href="#cb659-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mosaic':

    dotPlot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    cluster</code></pre>
</div>
<div class="sourceCode cell-code" id="cb664"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb664-1"><a href="#cb664-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb664-2"><a href="#cb664-2" aria-hidden="true" tabindex="-1"></a>split <span class="ot">=</span> <span class="fu">createDataPartition</span>(data<span class="sc">$</span>LUNG_CANCER, <span class="at">p =</span> <span class="fl">0.80</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb664-3"><a href="#cb664-3" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">=</span> data[split,]</span>
<span id="cb664-4"><a href="#cb664-4" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">=</span> data[<span class="sc">-</span>split,]</span>
<span id="cb664-5"><a href="#cb664-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 248</code></pre>
</div>
<div class="sourceCode cell-code" id="cb666"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb666-1"><a href="#cb666-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb668"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb668-1"><a href="#cb668-1" aria-hidden="true" tabindex="-1"></a><span class="co">#error metrics -- Confusion Matrix</span></span>
<span id="cb668-2"><a href="#cb668-2" aria-hidden="true" tabindex="-1"></a>err_metric<span class="ot">=</span><span class="cf">function</span>(CM)</span>
<span id="cb668-3"><a href="#cb668-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb668-4"><a href="#cb668-4" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">=</span>CM[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb668-5"><a href="#cb668-5" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">=</span>CM[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb668-6"><a href="#cb668-6" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">=</span>CM[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb668-7"><a href="#cb668-7" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">=</span>CM[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb668-8"><a href="#cb668-8" aria-hidden="true" tabindex="-1"></a>  precision <span class="ot">=</span>(TP)<span class="sc">/</span>(TP<span class="sc">+</span>FP)</span>
<span id="cb668-9"><a href="#cb668-9" aria-hidden="true" tabindex="-1"></a>  recall_score <span class="ot">=</span>(TP)<span class="sc">/</span>(TP<span class="sc">+</span>FN)</span>
<span id="cb668-10"><a href="#cb668-10" aria-hidden="true" tabindex="-1"></a>  f1_score<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>((precision<span class="sc">*</span>recall_score)<span class="sc">/</span>(precision<span class="sc">+</span>recall_score))</span>
<span id="cb668-11"><a href="#cb668-11" aria-hidden="true" tabindex="-1"></a>  accuracy_model  <span class="ot">=</span>(TP<span class="sc">+</span>TN)<span class="sc">/</span>(TP<span class="sc">+</span>TN<span class="sc">+</span>FP<span class="sc">+</span>FN)</span>
<span id="cb668-12"><a href="#cb668-12" aria-hidden="true" tabindex="-1"></a>  False_positive_rate <span class="ot">=</span>(FP)<span class="sc">/</span>(FP<span class="sc">+</span>TN)</span>
<span id="cb668-13"><a href="#cb668-13" aria-hidden="true" tabindex="-1"></a>  False_negative_rate <span class="ot">=</span>(FN)<span class="sc">/</span>(FN<span class="sc">+</span>TP)</span>
<span id="cb668-14"><a href="#cb668-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Precision value of the model: "</span>,<span class="fu">round</span>(precision,<span class="dv">2</span>)))</span>
<span id="cb668-15"><a href="#cb668-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy of the model: "</span>,<span class="fu">round</span>(accuracy_model,<span class="dv">2</span>)))</span>
<span id="cb668-16"><a href="#cb668-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Recall value of the model: "</span>,<span class="fu">round</span>(recall_score,<span class="dv">2</span>)))</span>
<span id="cb668-17"><a href="#cb668-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"False Positive rate of the model: "</span>,<span class="fu">round</span>(False_positive_rate,<span class="dv">2</span>)))</span>
<span id="cb668-18"><a href="#cb668-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"False Negative rate of the model: "</span>,<span class="fu">round</span>(False_negative_rate,<span class="dv">2</span>)))</span>
<span id="cb668-19"><a href="#cb668-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"F1 score of the model: "</span>,<span class="fu">round</span>(f1_score,<span class="dv">2</span>)))</span>
<span id="cb668-20"><a href="#cb668-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb669"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb669-1"><a href="#cb669-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb669-2"><a href="#cb669-2" aria-hidden="true" tabindex="-1"></a>logit_m <span class="ot">=</span><span class="fu">glm</span>(<span class="at">formula =</span> LUNG_CANCER <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb669-3"><a href="#cb669-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = LUNG_CANCER ~ ., family = "binomial", data = train_data)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             -32.13449    6.57393  -4.888 1.02e-06 ***
GENDERM                  -0.84716    0.82793  -1.023 0.306203    
AGE                       0.01537    0.03490   0.440 0.659756    
SMOKING                   1.10495    0.82246   1.343 0.179119    
YELLOW_FINGERS            1.10971    0.82005   1.353 0.175982    
ANXIETY                   2.08645    1.08610   1.921 0.054725 .  
PEER_PRESSURE             1.94159    0.74009   2.623 0.008704 ** 
`CHRONIC DISEASE`         3.91378    1.12190   3.489 0.000486 ***
FATIGUE                   2.62906    0.89032   2.953 0.003148 ** 
ALLERGY                   1.42702    0.83764   1.704 0.088454 .  
WHEEZING                  1.07933    0.90761   1.189 0.234357    
`ALCOHOL CONSUMING`       2.41116    0.98495   2.448 0.014365 *  
COUGHING                  3.14783    1.22386   2.572 0.010110 *  
`SHORTNESS OF BREATH`    -0.22681    0.84245  -0.269 0.787757    
`SWALLOWING DIFFICULTY`   2.24613    1.24347   1.806 0.070865 .  
`CHEST PAIN`              0.89356    0.73930   1.209 0.226791    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 198.230  on 247  degrees of freedom
Residual deviance:  77.353  on 232  degrees of freedom
AIC: 109.35

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb671"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb671-1"><a href="#cb671-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb671-2"><a href="#cb671-2" aria-hidden="true" tabindex="-1"></a>logit_m2 <span class="ot">=</span><span class="fu">glm</span>(<span class="at">formula =</span> LUNG_CANCER <span class="sc">~</span> ANXIETY<span class="sc">+</span>PEER_PRESSURE<span class="sc">+</span><span class="st">`</span><span class="at">CHRONIC DISEASE</span><span class="st">`</span><span class="sc">+</span>FATIGUE<span class="sc">+</span>ALLERGY<span class="sc">+</span><span class="st">`</span><span class="at">ALCOHOL CONSUMING</span><span class="st">`</span><span class="sc">+</span>COUGHING<span class="sc">+</span><span class="st">`</span><span class="at">SWALLOWING DIFFICULTY</span><span class="st">`</span>, <span class="at">data =</span> train_data, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb671-3"><a href="#cb671-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = LUNG_CANCER ~ ANXIETY + PEER_PRESSURE + `CHRONIC DISEASE` + 
    FATIGUE + ALLERGY + `ALCOHOL CONSUMING` + COUGHING + `SWALLOWING DIFFICULTY`, 
    family = "binomial", data = train_data)

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             -27.3830     5.5206  -4.960 7.05e-07 ***
ANXIETY                   2.5514     0.8659   2.947 0.003213 ** 
PEER_PRESSURE             2.1822     0.7245   3.012 0.002593 ** 
`CHRONIC DISEASE`         3.5120     0.9696   3.622 0.000292 ***
FATIGUE                   2.4939     0.6979   3.573 0.000353 ***
ALLERGY                   2.0104     0.7428   2.707 0.006796 ** 
`ALCOHOL CONSUMING`       2.5084     0.8653   2.899 0.003744 ** 
COUGHING                  3.2220     0.9540   3.377 0.000732 ***
`SWALLOWING DIFFICULTY`   2.5273     1.0096   2.503 0.012309 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 198.230  on 247  degrees of freedom
Residual deviance:  83.501  on 239  degrees of freedom
AIC: 101.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb673"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb673-1"><a href="#cb673-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb673-2"><a href="#cb673-2" aria-hidden="true" tabindex="-1"></a>logit_P_prob <span class="ot">=</span> <span class="fu">predict</span>(logit_m, <span class="at">newdata =</span> <span class="fu">select</span>(test_data, <span class="sc">-</span>LUNG_CANCER), <span class="at">type =</span> <span class="st">'response'</span>)</span>
<span id="cb673-3"><a href="#cb673-3" aria-hidden="true" tabindex="-1"></a>logit_P_prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3 
0.9912600 0.9997708 0.9980692 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb675"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb675-1"><a href="#cb675-1" aria-hidden="true" tabindex="-1"></a>logit_P <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(logit_P_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># Probability check</span></span>
<span id="cb675-2"><a href="#cb675-2" aria-hidden="true" tabindex="-1"></a>logit_P[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 
1 1 1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb677"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb677-1"><a href="#cb677-1" aria-hidden="true" tabindex="-1"></a>CM <span class="ot">=</span> <span class="fu">table</span>(test_data<span class="sc">$</span>LUNG_CANCER, logit_P)</span>
<span id="cb677-2"><a href="#cb677-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   logit_P
     0  1
  0  3  2
  1  1 55</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb679"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb679-1"><a href="#cb679-1" aria-hidden="true" tabindex="-1"></a><span class="fu">err_metric</span>(CM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Precision value of the model:  0.96"
[1] "Accuracy of the model:  0.95"
[1] "Recall value of the model:  0.98"
[1] "False Positive rate of the model:  0.4"
[1] "False Negative rate of the model:  0.02"
[1] "F1 score of the model:  0.97"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb681"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb681-1"><a href="#cb681-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ROC-curve using pROC library</span></span>
<span id="cb681-2"><a href="#cb681-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:colorspace':

    coords</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:mosaic':

    cov, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb687"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb687-1"><a href="#cb687-1" aria-hidden="true" tabindex="-1"></a>roc_score<span class="ot">=</span><span class="fu">roc</span>(test_data<span class="sc">$</span>LUNG_CANCER, logit_P_prob) <span class="co">#AUC score</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb690"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb690-1"><a href="#cb690-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_score, <span class="at">main =</span> <span class="st">"ROC curve -- Logistic Regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
<section id="below-is-the-further-remark" class="level1">
<h1>Below is the further remark</h1>
</section>
<section id="margin-of-error" class="level1">
<h1>margin of error</h1>
<p>For a given level of confidence c, The greatest possible distance between the point estimate and the value of the parameter it is estimating.</p>
<p>Sometimes called the maximum error of estimate or error tolerance.</p>
</section>
<section id="why-n-1-in-sampling-variance" class="level1">
<h1>Why n-1 in sampling variance</h1>
<p>？</p>
<ul>
<li><p>degree of freedom</p></li>
<li><p>ubiased estimation. (是指在已知sample时，这个无偏估计是所有估计中的平均值，这样我们才能称其为“无偏”。)</p></li>
</ul>
<p><img src="images/clipboard-2819513011.png" class="img-fluid"></p>
<ul>
<li>sampling proportion is unbiased</li>
</ul>
<p>E(<span class="math inline">\(\hat P\)</span>) = E(X/n)=npn (binomial distribution) =p Var—also 如果E满足 variance 不满足呢</p>
</section>
<section id="simple-random-samlple" class="level1">
<h1>Simple random samlple</h1>
<p>We know the total population but do not know p of our interests.</p>
<p>Based on hypergeometric probability calculation we can estimate p as <span class="math inline">\(\hat p = \text{intrests}/N= X_1+...+X_N/N\)</span> where <span class="math inline">\(X_i\)</span>~ Bernoulli(p) and <span class="math inline">\(\hat p\)</span> is a random variable. Therefore, <span class="math inline">\(E[\hat p] = p\)</span> (E<span class="math inline">\(X_i\)</span>=p based on Bernouli distribution).</p>
<ul>
<li>If <span class="math inline">\(X_i\)</span> are independent then E(<span class="math inline">\(X_1+X_2\)</span>) = 2E(<span class="math inline">\(X_1\)</span>)</li>
</ul>
<p>Here, eg. E<span class="math inline">\(\hat p^2\)</span>= 1/n E<span class="math inline">\(X_1^2\)</span>+n-1/nE<span class="math inline">\(X_1 X_2\)</span></p>
<p>Since <span class="math inline">\(X_1=1\)</span> <span class="math inline">\(X_1^2=X_1\)</span></p>
<p>and E<span class="math inline">\(X_1 X_2\)</span> = P<span class="math inline">\(X_1, X_2\)</span></p>
<p>Finally, we can look at the distribution of <span class="math inline">\(\hat p\)</span>, suppose we know the true p is 0.54, we can use <strong>simulation</strong> to randomly sample <span class="math inline">\(X_1,...X_n\)</span> from Np people who support 1 and ……who support</p>
<ul>
<li>God’s perspective</li>
</ul>
<div class="sourceCode" id="cb691"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb691-1"><a href="#cb691-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb691-2"><a href="#cb691-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-3"><a href="#cb691-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb691-4"><a href="#cb691-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-5"><a href="#cb691-5" aria-hidden="true" tabindex="-1"></a>population_size <span class="ot">&lt;-</span> <span class="dv">12141897</span></span>
<span id="cb691-6"><a href="#cb691-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-7"><a href="#cb691-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.54</span></span>
<span id="cb691-8"><a href="#cb691-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-9"><a href="#cb691-9" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb691-10"><a href="#cb691-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-11"><a href="#cb691-11" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb691-12"><a href="#cb691-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-13"><a href="#cb691-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>()</span>
<span id="cb691-14"><a href="#cb691-14" aria-hidden="true" tabindex="-1"></a>p_hat_values <span class="ot">&lt;-</span> <span class="fu">replicate</span>(num_simulations, {</span>
<span id="cb691-15"><a href="#cb691-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate sampling from the population</span></span>
<span id="cb691-16"><a href="#cb691-16" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,population_size <span class="sc">*</span> p), <span class="fu">rep</span>(<span class="dv">0</span>,population_size<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))), sample_size, <span class="at">replace =</span><span class="cn">FALSE</span>) <span class="co"># replicate(num_simulations, {...})：这个函数会重复执行大括号中的代码num_simulations次，并将每次的结果存储在一个向量中； rep创建一个包含population_size * p个1和population_size * (1-p)个0的向量，模拟总体。</span></span>
<span id="cb691-17"><a href="#cb691-17" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sample) <span class="co">#calculate the p_hat for each sample</span></span>
<span id="cb691-18"><a href="#cb691-18" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb691-19"><a href="#cb691-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-20"><a href="#cb691-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-21"><a href="#cb691-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb691-22"><a href="#cb691-22" aria-hidden="true" tabindex="-1"></a>histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">p =</span> p_hat_values), <span class="fu">aes</span>(<span class="at">x=</span>p))<span class="sc">+</span></span>
<span id="cb691-23"><a href="#cb691-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">fill =</span><span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb691-24"><a href="#cb691-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span><span class="st">" "</span>,</span>
<span id="cb691-25"><a href="#cb691-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"p_hat"</span>,</span>
<span id="cb691-26"><a href="#cb691-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb691-27"><a href="#cb691-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb691-28"><a href="#cb691-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb691-29"><a href="#cb691-29" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(histogram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>doing this 500 times,</p>
<p>based on the central limit theory</p>
<p>Statistical inference and Probability distribution</p>
<ul>
<li><p>estimation</p></li>
<li><p>condifidence intervals</p></li>
<li><p>hypothesis testing</p></li>
</ul>
</section>
<section id="sample-space-and-probability-measure" class="level1">
<h1>Sample Space and Probability Measure</h1>
<p><span class="math inline">\(\sigma\)</span> algebra <span class="math inline">\(F\)</span> is a collection of satisfying :</p>
<p>full and null set</p>
<p>completerment</p>
<p>countably union</p>
<p>measurble we can find a function that takes the elements of F and output a real number</p>
<p>A probability measure is a mapping P:F–&gt; R satisfying the following 3 axioms:</p>
<p>countably for mutually exclusive events <span class="math inline">\(A_1, A_2,...\in F\)</span></p>
</section>
<section id="interpret-the-probability" class="level1">
<h1>interpret the probability</h1>
<ul>
<li><p>frequentist view</p></li>
<li><p>Bayesian view</p></li>
</ul>
<p>Borel set is a combination of open set in some spaces</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb692-1"><a href="#cb692-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb692-2"><a href="#cb692-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb692-3"><a href="#cb692-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb692-4"><a href="#cb692-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb692-5"><a href="#cb692-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb692-6"><a href="#cb692-6" aria-hidden="true" tabindex="-1"></a>circ <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"Charm_City_Circulator_Ridership.csv"</span>)</span>
<span id="cb692-7"><a href="#cb692-7" aria-hidden="true" tabindex="-1"></a><span class="do">## take just average ridership per day</span></span>
<span id="cb692-8"><a href="#cb692-8" aria-hidden="true" tabindex="-1"></a>avg <span class="ot">=</span> circ <span class="sc">%&gt;%</span> </span>
<span id="cb692-9"><a href="#cb692-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Average"</span>)</span>
<span id="cb692-10"><a href="#cb692-10" aria-hidden="true" tabindex="-1"></a><span class="co"># keep non-missing data</span></span>
<span id="cb692-11"><a href="#cb692-11" aria-hidden="true" tabindex="-1"></a>avg <span class="ot">=</span> avg <span class="sc">%&gt;%</span> </span>
<span id="cb692-12"><a href="#cb692-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(number))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="moment-generating-functions-1" class="level1">
<h1>Moment Generating Functions</h1>
<p><span class="math inline">\(M_x (t)=E(e^{tx})\)</span></p>
<section id="case-1" class="level2">
<h2 class="anchored" data-anchor-id="case-1">case 1</h2>
<p><span class="math inline">\(M_x\)</span> may not exist. When it exists in a neighborhood of 0, using talor</p>
<p><span class="math display">\[e^{tx}=1+tX+(tX)^2/2+...\]</span></p>
<p><span class="math display">\[M_x(t)=1+t\mu+t^2 \mu/2+...\]</span></p>
<p><span class="math inline">\(\mu_j = E(X^i)\)</span> is the j-th moment of X. Therefore,</p>
<p><span class="math display">\[E(X^i)=M^{(j)}(0)\]</span></p>
<p>eg. Then we could also get the variance by take the 2nd order derivatives</p>
</section>
<section id="case-2" class="level2">
<h2 class="anchored" data-anchor-id="case-2">case 2</h2>
<p><span class="math inline">\(\int\)</span></p>
<p>eg. normal</p>
<ul>
<li>X~N(0,1)</li>
</ul>
<p>idea: try to write an integral of a certain distribution’s pdf and we get the result of this integral as 1. here, we get the pdf of the N(t,1) and finally we get <span class="math inline">\(e^{t^2/2}\)</span></p>
<ul>
<li>X~N(<span class="math inline">\(\mu, \sigma^2\)</span>)</li>
</ul>
<p>Then X=<span class="math inline">\(\mu+\sigma Z\)</span> where Z~N(0,1)</p>
<p><span class="math display">\[M_x(t)=E[e^{tx}]=e^{\mu t} E[e^{\sigma t Z}]=e^{\mu t} M_Z(\sigma t)=e^{\mu t +\sigma^2 t^2/2}\]</span></p>
<section id="gamma-disteibution" class="level3">
<h3 class="anchored" data-anchor-id="gamma-disteibution">Gamma disteibution</h3>
<p>the family of gamma distributions generalizes the family of exponential distributions. The gamma distribution with shape r and rate <span class="math inline">\(\lambda\)</span></p>
<section id="addition-rule" class="level4">
<h4 class="anchored" data-anchor-id="addition-rule">addition rule</h4>
<p>r +</p>
<p><span class="math inline">\(\lambda\)</span> stays</p>
</section>
</section>
</section>
<section id="why-mgf-is-useful-to-determine-if-two-random-variables-have-the-identical-cdf-to-prove-the-addition-property-of-distributions" class="level2">
<h2 class="anchored" data-anchor-id="why-mgf-is-useful-to-determine-if-two-random-variables-have-the-identical-cdf-to-prove-the-addition-property-of-distributions">why MGF is useful? – to determine if two random variables have the identical CDF / to prove the addition property of distributions</h2>
<p><strong>MGF</strong> includes all characteristics of a distribution, from whom we could get pdf, cdf, expectation, variance</p>
<ul>
<li>Thm If X and Y are random variables with the same MGF, which is finite on [-t, t ] for some t &gt;0 then X and Y have the same distribution</li>
</ul>
<p>A gamma distribution with shape r =1 is an exponential distribution</p>
<p>A more general function than MGF is the characteristic function.</p>
<p><span class="math inline">\(\phi_X (t) = E(e^{itX})\)</span></p>
</section>
</section>
<section id="normal-chi-squared-distribution" class="level1">
<h1>Normal –&gt; Chi-squared distribution</h1>
<p>MGF</p>
<p>the MGF of the Gamma(1/2, 1/2) distribution is the chi-squared</p>
<p>standard normal random variables’ sum of their each own squers follow a <span class="math inline">\(\chi^2\)</span> distribution</p>
<p>the addition rule lies on the sum of the dgree of freedom</p>
<p><span class="math inline">\((n-1)S^2/\sigma^2\)</span></p>
<p>consider</p>
</section>
<section id="preface" class="level1">
<h1>Preface</h1>
<p>The first section here is the knowledge that attracts most of my interests on this module, followed by the lecture notes I tapped when I am on the journey of this module.</p>
<ul>
<li>Motivation</li>
</ul>
<p>The history of the development of statistics has helped me gain a deeper understanding of this fascinating and practical field of knowledge. Each advancement represents a leap from specific facts to broader, generalized conclusions. What truly captivates me is the remarkable alignment between natural phenomena and statistical principles; there always seems to be a coincidence where reality and theory intersect.</p>
<p>Initially, I only grasped the surface of this knowledge. Then, as I delved deeper, I began to understand the underlying principles through observable phenomena. Eventually, almost miraculously, I realized how incredibly useful these theories are and how they coincide with natural occurrences. This process of moving closer and closer to generalization has profoundly illustrated to me the truth in the saying: “Mathematics is the art of giving the same name to different things.”</p>
<p>Theorems come, theorems go. Only examples are lying forever. (Practice to use statistics to interpret real world examples)</p>
</section>
<section id="把公式推导单独放一栏后" class="level1">
<h1>把公式推导单独放一栏（后）</h1>
</section>
<section id="error" class="level1">
<h1>error?</h1>
<ul>
<li><p>Independent = Disjoint? NO!</p>
<p>Independent vs Disjoint: If P(E) &gt; 0 and P(F) &gt; 0, then E and F can NOT be both independent and disjoint.</p>
<p>Subsets are dependent. If E ⊂ F and neither P(E) = 0 nor P(F) = 1, then E and F are dependent.</p>
<p>Complements are dependent. If neither P(E) = 0 nor P(E) = 1, then E and E C are dependent.</p></li>
</ul>
</section>
<section id="my-reading-during-this-course" class="level1">
<h1>My reading during this course：</h1>
<section id="十堂极简概率课-中信出版-diaconis" class="level2">
<h2 class="anchored" data-anchor-id="十堂极简概率课-中信出版-diaconis">十堂极简概率课 中信出版 diaconis</h2>
</section>
<section id="心理统计" class="level2">
<h2 class="anchored" data-anchor-id="心理统计">心理统计</h2>
</section>
<section id="the-lady-tasting-tea" class="level2">
<h2 class="anchored" data-anchor-id="the-lady-tasting-tea">The lady tasting tea</h2>
</section>
<section id="概率论与数理统计第三版-峁诗松等老师编著" class="level2">
<h2 class="anchored" data-anchor-id="概率论与数理统计第三版-峁诗松等老师编著">概率论与数理统计（第三版） 峁诗松等老师编著</h2>
</section>
<section id="probability." class="level2">
<h2 class="anchored" data-anchor-id="probability.">Probability….</h2>
</section>
</section>
<section id="bivariate-data" class="level1">
<h1>bivariate data</h1>
</section>
<section id="linear-regression-1" class="level1">
<h1>linear regression</h1>
<p><img src="images/clipboard-1774849890.png" class="img-fluid"></p>
<p><img src="images/clipboard-807464638.png" class="img-fluid"></p>
<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">background</h2>
<ul>
<li>Regression to the mean (Galton’s thinking)</li>
</ul>
<p><img src="images/clipboard-3333660003.png" class="img-fluid"></p>
<p><img src="images/clipboard-1881050695.png" class="img-fluid"></p>
</section>
<section id="it-is-not-stable-to-predict-the-data-outside-our-data-sample" class="level2">
<h2 class="anchored" data-anchor-id="it-is-not-stable-to-predict-the-data-outside-our-data-sample">it is not stable to predict the data outside our data sample’</h2>
</section>
<section id="residual-plot-should-have-no-pattern" class="level2">
<h2 class="anchored" data-anchor-id="residual-plot-should-have-no-pattern">Residual plot should have no pattern</h2>
<p>across the whole range, it could not be showing a certain trend or a specific shape.</p>
<p>positive and negative points sperate averagely .</p>
<p><img src="images/clipboard-2419630434.png" class="img-fluid"></p>
<p><img src="images/clipboard-3592387892.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb693"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb693-1"><a href="#cb693-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 数据</span></span>
<span id="cb693-2"><a href="#cb693-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">55</span>, <span class="dv">50</span>, <span class="dv">79</span>, <span class="dv">44</span>, <span class="dv">37</span>, <span class="dv">70</span>, <span class="dv">45</span>, <span class="dv">49</span>)  <span class="co"># Rock surface area</span></span>
<span id="cb693-3"><a href="#cb693-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">152</span>, <span class="dv">48</span>, <span class="dv">22</span>, <span class="dv">35</span>, <span class="dv">38</span>, <span class="dv">171</span>, <span class="dv">13</span>, <span class="dv">185</span>, <span class="dv">25</span>)  <span class="co"># Algae colony density</span></span>
<span id="cb693-4"><a href="#cb693-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb693-5"><a href="#cb693-5" aria-hidden="true" tabindex="-1"></a><span class="co"># (a) 计算最小二乘回归方程</span></span>
<span id="cb693-6"><a href="#cb693-6" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb693-7"><a href="#cb693-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
   Min     1Q Median     3Q    Max 
-65.53 -63.91 -14.47  46.99  84.39 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  232.258     92.390   2.514   0.0402 *
x             -2.926      1.690  -1.731   0.1271  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 63.32 on 7 degrees of freedom
Multiple R-squared:  0.2998,    Adjusted R-squared:  0.1997 
F-statistic: 2.997 on 1 and 7 DF,  p-value: 0.1271</code></pre>
</div>
<div class="sourceCode cell-code" id="cb695"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb695-1"><a href="#cb695-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 获取回归系数</span></span>
<span id="cb695-2"><a href="#cb695-2" aria-hidden="true" tabindex="-1"></a>intercept <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)[<span class="dv">1</span>]</span>
<span id="cb695-3"><a href="#cb695-3" aria-hidden="true" tabindex="-1"></a>slope <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)[<span class="dv">2</span>]</span>
<span id="cb695-4"><a href="#cb695-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"最小二乘回归方程: y ="</span>, intercept, <span class="st">"+"</span>, slope, <span class="st">"* x</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>最小二乘回归方程: y = 232.2575 + -2.925507 * x</code></pre>
</div>
<div class="sourceCode cell-code" id="cb697"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb697-1"><a href="#cb697-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (b) 计算 R^2 值并解释</span></span>
<span id="cb697-2"><a href="#cb697-2" aria-hidden="true" tabindex="-1"></a>r_squared <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span>
<span id="cb697-3"><a href="#cb697-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"R^2 值:"</span>, r_squared, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R^2 值: 0.2997552 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb699"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb699-1"><a href="#cb699-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"解释: R^2 表示了"</span>, <span class="fu">round</span>(r_squared <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>), <span class="st">"% 的 y 的变异可以通过 x 来解释。</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>解释: R^2 表示了 29.98 % 的 y 的变异可以通过 x 来解释。</code></pre>
</div>
<div class="sourceCode cell-code" id="cb701"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb701-1"><a href="#cb701-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (c) 计算残差标准误差 s_e</span></span>
<span id="cb701-2"><a href="#cb701-2" aria-hidden="true" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">summary</span>(model)<span class="sc">$</span>sigma</span>
<span id="cb701-3"><a href="#cb701-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"残差标准误差 s_e:"</span>, se, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>残差标准误差 s_e: 63.31527 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb703"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb703-1"><a href="#cb703-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"解释: s_e 表示了回归模型的平均预测误差，越小表明预测的精确度越高。</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>解释: s_e 表示了回归模型的平均预测误差，越小表明预测的精确度越高。</code></pre>
</div>
<div class="sourceCode cell-code" id="cb705"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb705-1"><a href="#cb705-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (d) 判断线性关系的方向和强度</span></span>
<span id="cb705-2"><a href="#cb705-2" aria-hidden="true" tabindex="-1"></a>correlation <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y)</span>
<span id="cb705-3"><a href="#cb705-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"相关系数 r:"</span>, correlation, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>相关系数 r: -0.547499 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb707"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb707-1"><a href="#cb707-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (correlation <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb707-2"><a href="#cb707-2" aria-hidden="true" tabindex="-1"></a>  direction <span class="ot">&lt;-</span> <span class="st">"正相关"</span></span>
<span id="cb707-3"><a href="#cb707-3" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb707-4"><a href="#cb707-4" aria-hidden="true" tabindex="-1"></a>  direction <span class="ot">&lt;-</span> <span class="st">"负相关"</span></span>
<span id="cb707-5"><a href="#cb707-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb707-6"><a href="#cb707-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-7"><a href="#cb707-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;</span> <span class="fl">0.7</span>) {</span>
<span id="cb707-8"><a href="#cb707-8" aria-hidden="true" tabindex="-1"></a>  strength <span class="ot">&lt;-</span> <span class="st">"强相关"</span></span>
<span id="cb707-9"><a href="#cb707-9" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">abs</span>(correlation) <span class="sc">&gt;</span> <span class="fl">0.3</span>) {</span>
<span id="cb707-10"><a href="#cb707-10" aria-hidden="true" tabindex="-1"></a>  strength <span class="ot">&lt;-</span> <span class="st">"中等相关"</span></span>
<span id="cb707-11"><a href="#cb707-11" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb707-12"><a href="#cb707-12" aria-hidden="true" tabindex="-1"></a>  strength <span class="ot">&lt;-</span> <span class="st">"弱相关"</span></span>
<span id="cb707-13"><a href="#cb707-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb707-14"><a href="#cb707-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb707-15"><a href="#cb707-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"线性关系:"</span>, direction, <span class="st">"且为"</span>, strength, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>线性关系: 负相关 且为 中等相关 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb709"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb709-1"><a href="#cb709-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 数据</span></span>
<span id="cb709-2"><a href="#cb709-2" aria-hidden="true" tabindex="-1"></a>quality_rating <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">111</span>, <span class="dv">113</span>, <span class="dv">93</span>, <span class="dv">130</span>, <span class="dv">170</span>, <span class="dv">87</span>, <span class="dv">83</span>, <span class="dv">117</span>, <span class="dv">135</span>, <span class="dv">109</span>)</span>
<span id="cb709-3"><a href="#cb709-3" aria-hidden="true" tabindex="-1"></a>satisfaction_rating <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">832</span>, <span class="dv">845</span>, <span class="dv">794</span>, <span class="dv">854</span>, <span class="dv">836</span>, <span class="dv">842</span>, <span class="dv">877</span>, <span class="dv">745</span>, <span class="dv">797</span>, <span class="dv">795</span>)</span>
<span id="cb709-4"><a href="#cb709-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb709-5"><a href="#cb709-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算相关系数</span></span>
<span id="cb709-6"><a href="#cb709-6" aria-hidden="true" tabindex="-1"></a>correlation_coefficient <span class="ot">&lt;-</span> <span class="fu">cor</span>(quality_rating, satisfaction_rating)</span>
<span id="cb709-7"><a href="#cb709-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"相关系数 r:"</span>, correlation_coefficient))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "相关系数 r: -0.115403519735578"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb711"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb711-1"><a href="#cb711-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制散点图</span></span>
<span id="cb711-2"><a href="#cb711-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(quality_rating, satisfaction_rating,</span>
<span id="cb711-3"><a href="#cb711-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Scatterplot of Quality Rating vs. Satisfaction Rating"</span>,</span>
<span id="cb711-4"><a href="#cb711-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Quality Rating"</span>,</span>
<span id="cb711-5"><a href="#cb711-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Satisfaction Rating"</span>,</span>
<span id="cb711-6"><a href="#cb711-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb711-7"><a href="#cb711-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(satisfaction_rating <span class="sc">~</span> quality_rating), <span class="at">col =</span> <span class="st">"red"</span>)  <span class="co"># 添加回归线</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="skew" class="level1">
<h1>skew</h1>
<p>Data skewed to the left(negatively skewed) have a longer left tail, and the mean and media are to the left of the mode.</p>
<p>Data skewed to the right(positively skewed) have a longer right tail, and the mean and media are to the right of the mode.</p>
<p>mean is much sensitive than the median to the extreame value(not a resistant measure of center) so the outlier drags the mean to the skew…… <img src="images/clipboard-2849357671.png" class="img-fluid"></p>
<p>Compare <span class="math inline">\(Q_2-Q_1\)</span> and <span class="math inline">\(Q_3-Q_2\)</span> to decide left/right skew or symmetry.</p>
<p>ps: the <strong>trimmed mean</strong> is more resistant.</p>
<p><img src="images/clipboard-2111278063.png" class="img-fluid"></p>
<p><img src="images/clipboard-2144359450.png" class="img-fluid"></p>
<p><img src="images/clipboard-1854557292.png" class="img-fluid"></p>
<p>As long as we know the mean and standard deviation of the data, we can determine how far a certain proportion of the data falls, without knowing the specific distribution shape of the data.</p>
</section>
<section id="outlier-eg-of-normal-distribution" class="level1">
<h1>outlier (eg of normal distribution)</h1>
<p>a mild outlier if it lies more than 1.5(iqr) away from the nearest quartile (the nearest end of the box);</p>
<p>an extreme outlier if it lies more than 3(iqr) away from the nearest quartile.</p>
<p>(These definitions and distances are based on the hypothetical Normal distribution (bell shaped, symmetric, normal tails). When there is a reason to suspect that the distribution is skewed, the bounds should be changed.)</p>
</section>
<section id="quartile" class="level1">
<h1>quartile</h1>
<p><span class="math inline">\(Q_1\)</span>(First quartile): at least 25% of the sorted values are less than or equal to <span class="math inline">\(Q_1\)</span> and at least 75% of the values are greater than or equal to <span class="math inline">\(Q_1\)</span></p>
<p><span class="math inline">\(Q_3\)</span>(Third quartile): ..</p>
</section>
<section id="modified-boxplot" class="level1">
<h1>modified boxplot</h1>
<p>A modified boxplot is a box plot where the whiskers only extend to the largest (or smallest) observation that is not an outlier and the outliers are plotted using a full circle (mild) or empty circle (extreme).</p>
<p>If there are no outliers, then the the whiskers end at the maximum (or minimum)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb712"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb712-1"><a href="#cb712-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 数据</span></span>
<span id="cb712-2"><a href="#cb712-2" aria-hidden="true" tabindex="-1"></a>ratios <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.553</span>, <span class="fl">0.570</span>, <span class="fl">0.576</span>, <span class="fl">0.601</span>, <span class="fl">0.606</span>, <span class="fl">0.606</span>, <span class="fl">0.609</span>, <span class="fl">0.611</span>, </span>
<span id="cb712-3"><a href="#cb712-3" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.615</span>, <span class="fl">0.628</span>, <span class="fl">0.654</span>, <span class="fl">0.662</span>, <span class="fl">0.668</span>, <span class="fl">0.670</span>, <span class="fl">0.672</span>, <span class="fl">0.690</span>, </span>
<span id="cb712-4"><a href="#cb712-4" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.693</span>, <span class="fl">0.749</span>, <span class="fl">0.844</span>, <span class="fl">0.933</span>)</span>
<span id="cb712-5"><a href="#cb712-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-6"><a href="#cb712-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算四分位数、IQR、温和和极端异常值的界限</span></span>
<span id="cb712-7"><a href="#cb712-7" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(ratios, <span class="fl">0.25</span>)</span>
<span id="cb712-8"><a href="#cb712-8" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(ratios, <span class="fl">0.75</span>)</span>
<span id="cb712-9"><a href="#cb712-9" aria-hidden="true" tabindex="-1"></a>median_val <span class="ot">&lt;-</span> <span class="fu">median</span>(ratios)</span>
<span id="cb712-10"><a href="#cb712-10" aria-hidden="true" tabindex="-1"></a>iqr <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb712-11"><a href="#cb712-11" aria-hidden="true" tabindex="-1"></a>mild_outlier_limit <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr</span>
<span id="cb712-12"><a href="#cb712-12" aria-hidden="true" tabindex="-1"></a>extreme_outlier_limit <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> iqr</span>
<span id="cb712-13"><a href="#cb712-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-14"><a href="#cb712-14" aria-hidden="true" tabindex="-1"></a>lower_mild <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> mild_outlier_limit</span>
<span id="cb712-15"><a href="#cb712-15" aria-hidden="true" tabindex="-1"></a>lower_extreme <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> extreme_outlier_limit</span>
<span id="cb712-16"><a href="#cb712-16" aria-hidden="true" tabindex="-1"></a>upper_mild <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> mild_outlier_limit</span>
<span id="cb712-17"><a href="#cb712-17" aria-hidden="true" tabindex="-1"></a>upper_extreme <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> extreme_outlier_limit</span>
<span id="cb712-18"><a href="#cb712-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-19"><a href="#cb712-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 标记温和和极端异常值</span></span>
<span id="cb712-20"><a href="#cb712-20" aria-hidden="true" tabindex="-1"></a>mild_outliers <span class="ot">&lt;-</span> ratios[ratios <span class="sc">&gt;</span> upper_mild <span class="sc">&amp;</span> ratios <span class="sc">&lt;=</span> upper_extreme <span class="sc">|</span> ratios <span class="sc">&lt;</span> lower_mild <span class="sc">&amp;</span> ratios <span class="sc">&gt;=</span> lower_extreme]</span>
<span id="cb712-21"><a href="#cb712-21" aria-hidden="true" tabindex="-1"></a>extreme_outliers <span class="ot">&lt;-</span> ratios[ratios <span class="sc">&gt;</span> upper_extreme <span class="sc">|</span> ratios <span class="sc">&lt;</span> lower_extreme]</span>
<span id="cb712-22"><a href="#cb712-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb712-23"><a href="#cb712-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制箱线图，并标记温和和极端异常值</span></span>
<span id="cb712-24"><a href="#cb712-24" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ratios, <span class="at">main =</span> <span class="st">"Modified Boxplot of Width-to-Length Ratios"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">1</span>))</span>
<span id="cb712-25"><a href="#cb712-25" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">which</span>(ratios <span class="sc">%in%</span> mild_outliers), mild_outliers, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>)    <span class="co"># 实心圆表示温和异常值</span></span>
<span id="cb712-26"><a href="#cb712-26" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">which</span>(ratios <span class="sc">%in%</span> extreme_outliers), extreme_outliers, <span class="at">pch =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="co"># 空心圆表示极端异常值</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb713"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb713-1"><a href="#cb713-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 输出四分位数、中位数和IQR结果</span></span>
<span id="cb713-2"><a href="#cb713-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb713-3"><a href="#cb713-3" aria-hidden="true" tabindex="-1"></a><span class="co">#确定第一四分位数（Q1）：这是数据从小到大排列后，位于下四分之一位置的值，表示前25%的数据范围的最大值。</span></span>
<span id="cb713-4"><a href="#cb713-4" aria-hidden="true" tabindex="-1"></a><span class="co">#确定第三四分位数（Q3）：这是数据从小到大排列后，位于上四分之一位置的值，表示后75%的数据范围的最小值。</span></span>
<span id="cb713-5"><a href="#cb713-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb713-6"><a href="#cb713-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Q1:"</span>, Q1, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Q1: 0.606 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb715"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb715-1"><a href="#cb715-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Median:"</span>, median_val, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Median: 0.641 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb717"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb717-1"><a href="#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Q3:"</span>, Q3, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Q3: 0.6765 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb719"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb719-1"><a href="#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"IQR:"</span>, iqr, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>IQR: 0.0705 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb721"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb721-1"><a href="#cb721-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lower mild outlier limit:"</span>, lower_mild, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Lower mild outlier limit: 0.50025 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb723"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb723-1"><a href="#cb723-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Lower extreme outlier limit:"</span>, lower_extreme, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Lower extreme outlier limit: 0.3945 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb725"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb725-1"><a href="#cb725-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Upper mild outlier limit:"</span>, upper_mild, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Upper mild outlier limit: 0.78225 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb727"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb727-1"><a href="#cb727-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Upper extreme outlier limit:"</span>, upper_extreme, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Upper extreme outlier limit: 0.888 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb729"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb729-1"><a href="#cb729-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 加载ggplot2包</span></span>
<span id="cb729-2"><a href="#cb729-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(ggplot2)) <span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb729-3"><a href="#cb729-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb729-4"><a href="#cb729-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-5"><a href="#cb729-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 数据</span></span>
<span id="cb729-6"><a href="#cb729-6" aria-hidden="true" tabindex="-1"></a>ratios <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.553</span>, <span class="fl">0.570</span>, <span class="fl">0.576</span>, <span class="fl">0.601</span>, <span class="fl">0.606</span>, <span class="fl">0.606</span>, <span class="fl">0.609</span>, <span class="fl">0.611</span>, </span>
<span id="cb729-7"><a href="#cb729-7" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.615</span>, <span class="fl">0.628</span>, <span class="fl">0.654</span>, <span class="fl">0.662</span>, <span class="fl">0.668</span>, <span class="fl">0.670</span>, <span class="fl">0.672</span>, <span class="fl">0.690</span>, </span>
<span id="cb729-8"><a href="#cb729-8" aria-hidden="true" tabindex="-1"></a>            <span class="fl">0.693</span>, <span class="fl">0.749</span>, <span class="fl">0.844</span>, <span class="fl">0.933</span>)</span>
<span id="cb729-9"><a href="#cb729-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-10"><a href="#cb729-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算四分位数、IQR、温和和极端异常值的界限</span></span>
<span id="cb729-11"><a href="#cb729-11" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(ratios, <span class="fl">0.25</span>)</span>
<span id="cb729-12"><a href="#cb729-12" aria-hidden="true" tabindex="-1"></a>Q3 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(ratios, <span class="fl">0.75</span>)</span>
<span id="cb729-13"><a href="#cb729-13" aria-hidden="true" tabindex="-1"></a>median_val <span class="ot">&lt;-</span> <span class="fu">median</span>(ratios)</span>
<span id="cb729-14"><a href="#cb729-14" aria-hidden="true" tabindex="-1"></a>iqr <span class="ot">&lt;-</span> Q3 <span class="sc">-</span> Q1</span>
<span id="cb729-15"><a href="#cb729-15" aria-hidden="true" tabindex="-1"></a>mild_outlier_limit <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr</span>
<span id="cb729-16"><a href="#cb729-16" aria-hidden="true" tabindex="-1"></a>extreme_outlier_limit <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="sc">*</span> iqr</span>
<span id="cb729-17"><a href="#cb729-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-18"><a href="#cb729-18" aria-hidden="true" tabindex="-1"></a>lower_mild <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> mild_outlier_limit</span>
<span id="cb729-19"><a href="#cb729-19" aria-hidden="true" tabindex="-1"></a>lower_extreme <span class="ot">&lt;-</span> Q1 <span class="sc">-</span> extreme_outlier_limit</span>
<span id="cb729-20"><a href="#cb729-20" aria-hidden="true" tabindex="-1"></a>upper_mild <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> mild_outlier_limit</span>
<span id="cb729-21"><a href="#cb729-21" aria-hidden="true" tabindex="-1"></a>upper_extreme <span class="ot">&lt;-</span> Q3 <span class="sc">+</span> extreme_outlier_limit</span>
<span id="cb729-22"><a href="#cb729-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-23"><a href="#cb729-23" aria-hidden="true" tabindex="-1"></a><span class="co"># 标记温和和极端异常值</span></span>
<span id="cb729-24"><a href="#cb729-24" aria-hidden="true" tabindex="-1"></a>mild_outliers <span class="ot">&lt;-</span> ratios[ratios <span class="sc">&gt;</span> upper_mild <span class="sc">&amp;</span> ratios <span class="sc">&lt;=</span> upper_extreme <span class="sc">|</span> ratios <span class="sc">&lt;</span> lower_mild <span class="sc">&amp;</span> ratios <span class="sc">&gt;=</span> lower_extreme]</span>
<span id="cb729-25"><a href="#cb729-25" aria-hidden="true" tabindex="-1"></a>extreme_outliers <span class="ot">&lt;-</span> ratios[ratios <span class="sc">&gt;</span> upper_extreme <span class="sc">|</span> ratios <span class="sc">&lt;</span> lower_extreme]</span>
<span id="cb729-26"><a href="#cb729-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-27"><a href="#cb729-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb729-28"><a href="#cb729-28" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ratios =</span> ratios)</span>
<span id="cb729-29"><a href="#cb729-29" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>outlier_type <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>ratios <span class="sc">%in%</span> mild_outliers, <span class="st">"Mild Outlier"</span>,</span>
<span id="cb729-30"><a href="#cb729-30" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">ifelse</span>(data<span class="sc">$</span>ratios <span class="sc">%in%</span> extreme_outliers, <span class="st">"Extreme Outlier"</span>, <span class="st">"Normal"</span>))</span>
<span id="cb729-31"><a href="#cb729-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-32"><a href="#cb729-32" aria-hidden="true" tabindex="-1"></a><span class="co"># 使用ggplot2绘制</span></span>
<span id="cb729-33"><a href="#cb729-33" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> ratios)) <span class="sc">+</span></span>
<span id="cb729-34"><a href="#cb729-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="st">"lightblue"</span>) <span class="sc">+</span>  <span class="co"># 不显示默认的异常值</span></span>
<span id="cb729-35"><a href="#cb729-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, outlier_type <span class="sc">==</span> <span class="st">"Mild Outlier"</span>), <span class="fu">aes</span>(<span class="at">y =</span> ratios), <span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">16</span>) <span class="sc">+</span> <span class="co"># 温和异常值，实心圆</span></span>
<span id="cb729-36"><a href="#cb729-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">subset</span>(data, outlier_type <span class="sc">==</span> <span class="st">"Extreme Outlier"</span>), <span class="fu">aes</span>(<span class="at">y =</span> ratios), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">shape =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># 极端异常值，空心圆</span></span>
<span id="cb729-37"><a href="#cb729-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Modified Boxplot of Width-to-Length Ratios"</span>, <span class="at">y =</span> <span class="st">"Width-to-Length Ratios"</span>) <span class="sc">+</span></span>
<span id="cb729-38"><a href="#cb729-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb729-39"><a href="#cb729-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> <span class="co"># 移除x轴标签</span></span>
<span id="cb729-40"><a href="#cb729-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="dv">1</span>))      <span class="co"># 设置y轴范围</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="measures-of-relative-standing" class="level1">
<h1>Measures of relative standing</h1>
<section id="z-scores" class="level2">
<h2 class="anchored" data-anchor-id="z-scores">z Scores</h2>
<p>eg. height(among women or men (come from different populations)instead of just comparing the height itself)</p>
</section>
</section>
<section id="tutorial" class="level1">
<h1>tutorial</h1>
<p>dotplot没有纵轴in r(vs scallar plot)</p>
<p>price of a textbook is discrete</p>
<p>zip code is categorical</p>
<p>dotplot and scallar plot</p>
<p>do not manipulate data—experimental</p>
<p>table 2.1</p>
<p>11</p>
<p>huge data for 顺序的 shuffle is ok</p>
<p>but ..</p>
<p>the likelihood is totally different</p>
</section>
<section id="the-role-of-statistics-and-the-data-analysis-process" class="level1">
<h1>The role of statistics and the Data Analysis Process</h1>
<section id="intro" class="level2">
<h2 class="anchored" data-anchor-id="intro">Intro</h2>
<p>stat is a large field in math involving the collection, organization, analysis,interpretation, and presentation of data(a collection of observations on one or more variables(A characteristic whose value may change from one observation to another))</p>
<p>Statistics is the scientific discipline that provides methods to help us make sense of data.</p>
<p>It is important to be able to:</p>
<p>1 Extract information from tables, charts, and graphs.</p>
<p>2 Follow numerical arguments.</p>
<p>3 Understand the basics of how data should be gathered, summarized, and analysed to draw statistical conclusions.</p>
<p>The Data Analysis Process</p>
<p>1 Understanding the nature of the research problem or goals.</p>
<p>2 Deciding what to measure and how.</p>
<p>3 Collecting data.</p>
<p>4 Data summarization and preliminary analysis.</p>
<p>5 Formal Data Analysis (Statistical Methods).</p>
<p>6 Interpretation of the results.</p>
</section>
<section id="populations-and-samples" class="level2">
<h2 class="anchored" data-anchor-id="populations-and-samples">populations and samples</h2>
<p>population: The entire collection of individuals or objects about which information is desired</p>
<p>sample: A sample is a subset of the population, selected for study.</p>
<p>then select the sample</p>
<p>then we could summarize it using 2 branches of stat.— Decriptive stat.(methods for organizing and summarizing data.) or inferential stat.(generalizing from a sample(incomplete information) to the population from which the sample was selected and assessing the reliability of such generalizations.So we run the risk(An important aspect of statistics and making statistics inferences involves quantifying the chance of making an incorrect conclusions.))</p>
<section id="descriptive-stat" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-stat">descriptive stat</h3>
</section>
<section id="inferential-stat" class="level3">
<h3 class="anchored" data-anchor-id="inferential-stat">inferential stat</h3>
<p>sample</p>
</section>
</section>
<section id="types-of-data" class="level2">
<h2 class="anchored" data-anchor-id="types-of-data">Types of data</h2>
<section id="uni-data-set-and-bivariate-and-multivariate" class="level3">
<h3 class="anchored" data-anchor-id="uni-data-set-and-bivariate-and-multivariate">uni data set and bivariate and multivariate</h3>
</section>
<section id="categorical-and-numericaldiscrete-and-continuous-with-plot-using-excel-data-analysis-or-rstudio-plot-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="categorical-and-numericaldiscrete-and-continuous-with-plot-using-excel-data-analysis-or-rstudio-plot-ggplot2">categorical and numerical(discrete and continuous) with plot using excel (data analysis) or rstudio plot (ggplot2)</h3>
<p>for categorial data we could use a bar chart which is a graph of a frequency distribution for categorical data.</p>
<p>for a small numerical data we could use dotplot</p>
<ul>
<li>discrete</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb730"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb730-1"><a href="#cb730-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb730-2"><a href="#cb730-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-3"><a href="#cb730-3" aria-hidden="true" tabindex="-1"></a><span class="co"># creat data：Wechat number</span></span>
<span id="cb730-4"><a href="#cb730-4" aria-hidden="true" tabindex="-1"></a>discrete_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> <span class="fu">c</span>(<span class="dv">30</span>, <span class="dv">15</span>, <span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">60</span>))</span>
<span id="cb730-5"><a href="#cb730-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb730-6"><a href="#cb730-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb730-7"><a href="#cb730-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(discrete_data, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb730-8"><a href="#cb730-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">dotsize =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb730-9"><a href="#cb730-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Dot Plot of Discrete Data (Number of Wechats)"</span>) <span class="sc">+</span></span>
<span id="cb730-10"><a href="#cb730-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>continuous</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb731"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb731-1"><a href="#cb731-1" aria-hidden="true" tabindex="-1"></a>all_athletes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">79</span>, <span class="dv">79</span>, <span class="dv">86</span>, <span class="dv">85</span>, <span class="dv">95</span>, <span class="dv">78</span>, <span class="dv">89</span>, <span class="dv">84</span>, <span class="dv">81</span>, <span class="dv">85</span>, <span class="dv">89</span>, <span class="dv">89</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">81</span>, <span class="dv">80</span>, <span class="dv">98</span>, <span class="dv">84</span>, </span>
<span id="cb731-2"><a href="#cb731-2" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">80</span>, <span class="dv">82</span>, <span class="dv">81</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">87</span>, <span class="dv">83</span>, <span class="dv">86</span>, <span class="dv">92</span>, <span class="dv">85</span>, <span class="dv">93</span>, <span class="dv">94</span>, <span class="dv">76</span>, <span class="dv">69</span>, <span class="dv">82</span>, <span class="dv">80</span>, <span class="dv">94</span>, <span class="dv">98</span>)</span>
<span id="cb731-3"><a href="#cb731-3" aria-hidden="true" tabindex="-1"></a>basketball <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">36</span>, <span class="dv">83</span>, <span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">62</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">93</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">80</span>, <span class="dv">46</span>, <span class="dv">75</span>, <span class="dv">100</span>, <span class="dv">71</span>, </span>
<span id="cb731-4"><a href="#cb731-4" aria-hidden="true" tabindex="-1"></a>                <span class="dv">50</span>, <span class="dv">62</span>, <span class="dv">82</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">83</span>, <span class="dv">90</span>, <span class="dv">64</span>, <span class="dv">91</span>, <span class="dv">67</span>, <span class="dv">83</span>, <span class="dv">100</span>, <span class="dv">83</span>, <span class="dv">100</span>, <span class="dv">83</span>, <span class="dv">63</span>, <span class="dv">91</span>, <span class="dv">95</span>)</span>
<span id="cb731-5"><a href="#cb731-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-6"><a href="#cb731-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 设置画布的高度，以便将两个图绘制在同一页面上</span></span>
<span id="cb731-7"><a href="#cb731-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb731-8"><a href="#cb731-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.window</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">2.5</span>))</span>
<span id="cb731-9"><a href="#cb731-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-10"><a href="#cb731-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制 Basketball 数据的 dotplot</span></span>
<span id="cb731-11"><a href="#cb731-11" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(basketball, <span class="at">method =</span> <span class="st">"stack"</span>, <span class="at">at =</span> <span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"orange"</span>, </span>
<span id="cb731-12"><a href="#cb731-12" aria-hidden="true" tabindex="-1"></a>           <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">offset =</span> <span class="fl">0.5</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb731-13"><a href="#cb731-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-14"><a href="#cb731-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 绘制 All Athletes 数据的 dotplot</span></span>
<span id="cb731-15"><a href="#cb731-15" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(all_athletes, <span class="at">method =</span> <span class="st">"stack"</span>, <span class="at">at =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"orange"</span>, </span>
<span id="cb731-16"><a href="#cb731-16" aria-hidden="true" tabindex="-1"></a>           <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">offset =</span> <span class="fl">0.5</span>, <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb731-17"><a href="#cb731-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-18"><a href="#cb731-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加 X 轴</span></span>
<span id="cb731-19"><a href="#cb731-19" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="at">at =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="dv">10</span>))</span>
<span id="cb731-20"><a href="#cb731-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-21"><a href="#cb731-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加标签</span></span>
<span id="cb731-22"><a href="#cb731-22" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">2</span>, <span class="st">"Basketball"</span>, <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb731-23"><a href="#cb731-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">1</span>, <span class="st">"All Athletes"</span>, <span class="at">xpd =</span> <span class="cn">TRUE</span>, <span class="at">adj =</span> <span class="dv">1</span>)</span>
<span id="cb731-24"><a href="#cb731-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-25"><a href="#cb731-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加横线</span></span>
<span id="cb731-26"><a href="#cb731-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb731-27"><a href="#cb731-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb731-28"><a href="#cb731-28" aria-hidden="true" tabindex="-1"></a><span class="co"># 添加 X 轴标签</span></span>
<span id="cb731-29"><a href="#cb731-29" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">xlab =</span> <span class="st">"Graduation rates (%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb732"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb732-1"><a href="#cb732-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creat data--time spent in minutes</span></span>
<span id="cb732-2"><a href="#cb732-2" aria-hidden="true" tabindex="-1"></a>continuous_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="fl">5.25</span>, <span class="fl">3.62</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">3.1</span>,<span class="fl">3.2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">4</span>,<span class="dv">10</span>))</span>
<span id="cb732-3"><a href="#cb732-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb732-4"><a href="#cb732-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dotplot</span></span>
<span id="cb732-5"><a href="#cb732-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(continuous_data, <span class="fu">aes</span>(<span class="at">x =</span> value)) <span class="sc">+</span></span>
<span id="cb732-6"><a href="#cb732-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">dotsize =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb732-7"><a href="#cb732-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Dot Plot of Continuous Data (Time Spent in Minutes)"</span>) <span class="sc">+</span></span>
<span id="cb732-8"><a href="#cb732-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-123-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb733"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb733-1"><a href="#cb733-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb733-2"><a href="#cb733-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-3"><a href="#cb733-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 毕业率数据</span></span>
<span id="cb733-4"><a href="#cb733-4" aria-hidden="true" tabindex="-1"></a>school <span class="ot">&lt;-</span> <span class="dv">33</span><span class="sc">:</span><span class="dv">68</span></span>
<span id="cb733-5"><a href="#cb733-5" aria-hidden="true" tabindex="-1"></a>all_athletes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">79</span>, <span class="dv">79</span>, <span class="dv">86</span>, <span class="dv">85</span>, <span class="dv">95</span>, <span class="dv">78</span>, <span class="dv">89</span>, <span class="dv">84</span>, <span class="dv">81</span>, <span class="dv">85</span>, <span class="dv">89</span>, <span class="dv">89</span>, <span class="dv">85</span>, <span class="dv">85</span>, <span class="dv">81</span>, <span class="dv">80</span>, <span class="dv">98</span>, <span class="dv">84</span>, </span>
<span id="cb733-6"><a href="#cb733-6" aria-hidden="true" tabindex="-1"></a>                  <span class="dv">80</span>, <span class="dv">82</span>, <span class="dv">81</span>, <span class="dv">70</span>, <span class="dv">85</span>, <span class="dv">87</span>, <span class="dv">83</span>, <span class="dv">86</span>, <span class="dv">92</span>, <span class="dv">85</span>, <span class="dv">93</span>, <span class="dv">94</span>, <span class="dv">76</span>, <span class="dv">69</span>, <span class="dv">82</span>, <span class="dv">80</span>, <span class="dv">94</span>, <span class="dv">98</span>)</span>
<span id="cb733-7"><a href="#cb733-7" aria-hidden="true" tabindex="-1"></a>basketball <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">55</span>, <span class="dv">36</span>, <span class="dv">83</span>, <span class="dv">20</span>, <span class="dv">100</span>, <span class="dv">62</span>, <span class="dv">100</span>, <span class="dv">100</span>, <span class="dv">90</span>, <span class="dv">91</span>, <span class="dv">93</span>, <span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">80</span>, <span class="dv">46</span>, <span class="dv">75</span>, <span class="dv">100</span>, <span class="dv">71</span>, </span>
<span id="cb733-8"><a href="#cb733-8" aria-hidden="true" tabindex="-1"></a>                <span class="dv">50</span>, <span class="dv">62</span>, <span class="dv">82</span>, <span class="dv">50</span>, <span class="dv">100</span>, <span class="dv">83</span>, <span class="dv">90</span>, <span class="dv">64</span>, <span class="dv">91</span>, <span class="dv">67</span>, <span class="dv">83</span>, <span class="dv">100</span>, <span class="dv">83</span>, <span class="dv">100</span>, <span class="dv">83</span>, <span class="dv">63</span>, <span class="dv">91</span>, <span class="dv">95</span>)</span>
<span id="cb733-9"><a href="#cb733-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-10"><a href="#cb733-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb733-11"><a href="#cb733-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(school, all_athletes, basketball)</span>
<span id="cb733-12"><a href="#cb733-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb733-13"><a href="#cb733-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 画图</span></span>
<span id="cb733-14"><a href="#cb733-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb733-15"><a href="#cb733-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> all_athletes, <span class="at">y =</span> <span class="st">"All Athletes"</span>), <span class="at">binaxis =</span> <span class="st">'x'</span>, <span class="at">stackdir =</span> <span class="st">'up'</span>, <span class="at">dotsize =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb733-16"><a href="#cb733-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(<span class="at">data =</span> data, <span class="fu">aes</span>(<span class="at">x =</span> basketball, <span class="at">y =</span> <span class="st">"Basketball"</span>), <span class="at">binaxis =</span> <span class="st">'x'</span>, <span class="at">stackdir =</span> <span class="st">'up'</span>, <span class="at">dotsize =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb733-17"><a href="#cb733-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Graduation rates (%)"</span>) <span class="sc">+</span></span>
<span id="cb733-18"><a href="#cb733-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb733-19"><a href="#cb733-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb733-20"><a href="#cb733-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Dotplot of Graduation Rates for All Athletes and Basketball Players"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.
Bin width defaults to 1/30 of the range of the data. Pick better value with
`binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="mth1113_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-3026116502.png" class="img-fluid figure-img"></p>
<figcaption>histogram excel plot</figcaption>
</figure>
</div>
</section>
</section>
<section id="collect-data-sensibly" class="level2">
<h2 class="anchored" data-anchor-id="collect-data-sensibly">collect data sensibly</h2>
</section>
</section>
<section id="chapter-2" class="level1">
<h1>chapter 2</h1>
<section id="two-types-of-studies-observational-studies-and-experiments." class="level2">
<h2 class="anchored" data-anchor-id="two-types-of-studies-observational-studies-and-experiments.">Two types of studies: Observational studies and Experiments.</h2>
<section id="observational" class="level3">
<h3 class="anchored" data-anchor-id="observational">Observational</h3>
<p>A study in which the investigator observes characteristics of a sample selected from one or more existing populations. The goal is to draw conclusions about the corresponding population or about differences between two or more populations.</p>
<p>In an observational study, it is impossible to draw clear cause-and-effect conclusions</p>
</section>
<section id="experiments" class="level3">
<h3 class="anchored" data-anchor-id="experiments">Experiments</h3>
<p>A study in which the investigator observes how a response variable behaves when one or more explanatory variables, also called factors, are manipulated.</p>
<p>A well-designed experiment can result in data that provide evidence for a cause-and-effect relationship.</p>
<p><img src="images/clipboard-858121668.png" class="img-fluid"></p>
<ul>
<li>Experimental conditions: Any particular combination of values for the explanatory variables, which are also called treatments.</li>
</ul>
</section>
<section id="comparison" class="level3">
<h3 class="anchored" data-anchor-id="comparison">comparison</h3>
<ul>
<li><p>Both observational studies and experiments can be used to compare groups, but in an experiment the researcher controls who is in which group, whereas this is not the case in an observational study.</p></li>
<li><p>In an observational study, it is impossible to draw clear cause-andeffect conclusions</p></li>
</ul>
</section>
<section id="confounding-vars" class="level3">
<h3 class="anchored" data-anchor-id="confounding-vars">confounding vars</h3>
<p>A variable that is related to both how the experimental groups were formed and the response variable of interest.</p>
<ul>
<li><p>Two methods for data collection: Sampling and Experimentation.</p></li>
<li><p>distinguish between selection bias, measurement or response bias, and non-response bias.</p></li>
<li><p>select a simple random sample from a given population.</p></li>
<li><p>distinguish between simple random sampling, stratified random sampling, cluster sampling, systematic sampling, and convenience sampling</p></li>
</ul>
</section>
</section>
<section id="variable" class="level2">
<h2 class="anchored" data-anchor-id="variable">variable</h2>
<section id="response-variabley" class="level3">
<h3 class="anchored" data-anchor-id="response-variabley">response variable–y</h3>
<p>The response variable is the focus of a question in a study or experiment.</p>
</section>
<section id="explanotory-variablex" class="level3">
<h3 class="anchored" data-anchor-id="explanotory-variablex">explanotory variable–x</h3>
<p>An explanatory variable is one that explains for changes in the response variable.</p>
</section>
<section id="experiments-and-obeservational-study" class="level3">
<h3 class="anchored" data-anchor-id="experiments-and-obeservational-study">experiments and obeservational study</h3>
</section>
<section id="bias" class="level3">
<h3 class="anchored" data-anchor-id="bias">bias</h3>
<p>selection bias：When the way the sample is selected systematically excludes some part of the population of interest.</p>
<p>measurement or response bias</p>
<p>eg: survey question/scale(The scale or a machine used for measurements is not calibrated properly)</p>
<p>Non-response Bias:When responses are not obtained from all individuals selected for inclusion in the sample.</p>
<p>non-response bias can distort results if those who respond differ in important ways from those who do not respond (e.g.&nbsp;laziness a confounding variable).</p>
</section>
<section id="random-sampling" class="level3">
<h3 class="anchored" data-anchor-id="random-sampling">random sampling</h3>
<p>def: A sample that is selected from a population in a way that ensures that every different possible sample of size n has the same chance of being selected.</p>
<p>the same chance to be selected</p>
<p>counter eg:</p>
<p>Consider 100 students in a classroom, 60 females and 40 males. If we randomly sample 6 females, and 4 males, then each female has a 6/60 = 0.1 chance of being selected. Same for males, 4/40=0.1. However, not every group of 10 students is equally likely to be selected. This is not simple random sampling</p>
<p>The random selection process allows us to be confident that the sample adequately reflects the population, even when the sample consists of only a small fraction of the population.</p>
<p>eg.Voting Sample Size in a country</p>
</section>
<section id="stratified-and-cluster" class="level3">
<h3 class="anchored" data-anchor-id="stratified-and-cluster">stratified and cluster</h3>
<ul>
<li>stratified random sampling:In stratified random sampling, separate simple random samples are independently selected from each subgroup. Each subgroup is called a strata.</li>
</ul>
<p>In general, it is much easier to produce relatively accurate estimates of characteristics of a homogeneous group than of a heterogeneous group.</p>
<p>stratified: according to certain characteristic</p>
<p>eg.Even with a small sample, it is possible to obtain an accurate estimate of the average grade point average (GPA) of students graduating with high honours from a university (Similar high grades, homogenous, thus only sample a few students). On the other hand, producing a reasonably accurate estimate of the average GPA of all seniors at the university, a much more diverse group of GPAs, is a more difficult task. <strong>Not only does this ensure that students at each GPA level are represented, it also allows for a more accurate estimate of the overall average GPA.</strong></p>
<ul>
<li>cluster reflect general characteristic about the whole entire population</li>
</ul>
<p>cluster: randomly groups</p>
<p>Cluster sampling involves dividing the population of interest into non-overlapping subgroups, called clusters. Clusters are then selected at random, and then all individuals in the selected clusters are included in the sample.</p>
</section>
<section id="systematic-sampling" class="level3">
<h3 class="anchored" data-anchor-id="systematic-sampling">systematic sampling</h3>
<p>A value k is specified (e.g.&nbsp;k = 50 or k = 200). Then one of the first k individuals is selected at random, after which every k-th individual in the sequence is included in the sample. A sample selected in this way is called a 1 in k systematic sample.</p>
<p>In the case of large samples, it can ensure that the sample is evenly distributed in the population.</p>
</section>
</section>
</section>
<section id="random-variable-1" class="level1">
<h1>Random Variable</h1>
<section id="random-variable-r.v." class="level2">
<h2 class="anchored" data-anchor-id="random-variable-r.v.">Random Variable (R.V.)</h2>
<p>A numerical variable whose value depends on the outcome of a chance experiment. A random variable associates a numerical value with each outcome of a chance experiment. (Think of it as a rule that translates each result of a chance event into a number.)</p>
<p>In shorta: random variables convert random events into numbers.</p>
<p>A real-valued random variable X is a function: X : S → <span class="math inline">\(\mathbb R\)</span>, where S is the sample space of a chance experiment.</p>
<p>Continuous random variable X: S–&gt; R is continuous if its set of possible values includes an entire interval on the number line(measurement), which could not be count.</p>
<p>Discrete random variable: X: S–&gt; R if its set of possible value is a collection of isolated points along the number line.(counting)</p>
<section id="eg-1" class="level3">
<h3 class="anchored" data-anchor-id="eg-1">eg</h3>
<p>Examples: Coin Tossing (Discrete Random Variable) If we flip a coin 5 times, let X be the number of heads we get. Possible values of X {0,1,2,3,4,5} (where 0 means no heads, and 5 means all heads). Here, X turns each outcome of multiple coin tosses into a count of heads.</p>
<p>Departure Time (Continuous Random Variable) Imagine tracking when people leave a subway station between 10 PM and 11 PM. Let Y represent the time (in hours) someone leaves, so Y can be any number from 10 to 11. Here, Y assigns each departure time to a point in the range [10,11].</p>
</section>
</section>
<section id="sample-space-of-multivariables" class="level2">
<h2 class="anchored" data-anchor-id="sample-space-of-multivariables">sample space of multivariables</h2>
<p>G:gender; F: year—corresponding to a certain student:S</p>
<p>(G, H) : S → <span class="math inline">\(\mathbb R^2\)</span>, S={1,2,3,4}</p>
<p>…</p>
</section>
<section id="probability-mass-function-and-cumulative-distribution-function-for-discrete-random-variables" class="level2">
<h2 class="anchored" data-anchor-id="probability-mass-function-and-cumulative-distribution-function-for-discrete-random-variables">Probability Mass Function and Cumulative Distribution Function for Discrete Random Variables</h2>
<p>Probability Mass Function (PMF): <span class="math inline">\(p_x (x) := P(X = x) ,\forall x\)</span></p>
<p>Cumulative Distribution Function (CDF): <span class="math inline">\(F_x (x) := P(X \leq x) ,\forall x\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb735"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb735-1"><a href="#cb735-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义每个事件的概率和对应的 X 值</span></span>
<span id="cb735-2"><a href="#cb735-2" aria-hidden="true" tabindex="-1"></a>outcomes <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GGGG"</span>, <span class="st">"EGGG"</span>, <span class="st">"GEGG"</span>, <span class="st">"GGEG"</span>, <span class="st">"GGGE"</span>, </span>
<span id="cb735-3"><a href="#cb735-3" aria-hidden="true" tabindex="-1"></a>              <span class="st">"EEGG"</span>, <span class="st">"EGEG"</span>, <span class="st">"EGGE"</span>, <span class="st">"GEEG"</span>, <span class="st">"GEGE"</span>, </span>
<span id="cb735-4"><a href="#cb735-4" aria-hidden="true" tabindex="-1"></a>              <span class="st">"GGEE"</span>, <span class="st">"GEEE"</span>, <span class="st">"EEEG"</span>, <span class="st">"EEGE"</span>, <span class="st">"EEEE"</span>)</span>
<span id="cb735-5"><a href="#cb735-5" aria-hidden="true" tabindex="-1"></a>probabilities <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1296</span>, <span class="fl">0.0864</span>, <span class="fl">0.0864</span>, <span class="fl">0.0864</span>, <span class="fl">0.0864</span>, </span>
<span id="cb735-6"><a href="#cb735-6" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.0576</span>, <span class="fl">0.0576</span>, <span class="fl">0.0576</span>, <span class="fl">0.0576</span>, <span class="fl">0.0576</span>, </span>
<span id="cb735-7"><a href="#cb735-7" aria-hidden="true" tabindex="-1"></a>                   <span class="fl">0.0384</span>, <span class="fl">0.0384</span>, <span class="fl">0.0384</span>, <span class="fl">0.0384</span>, <span class="fl">0.0256</span>)</span>
<span id="cb735-8"><a href="#cb735-8" aria-hidden="true" tabindex="-1"></a>X_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, </span>
<span id="cb735-9"><a href="#cb735-9" aria-hidden="true" tabindex="-1"></a>              <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>,</span>
<span id="cb735-10"><a href="#cb735-10" aria-hidden="true" tabindex="-1"></a>              <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb735-11"><a href="#cb735-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-12"><a href="#cb735-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算每个 X 值的 PMF 通过分组和求和</span></span>
<span id="cb735-13"><a href="#cb735-13" aria-hidden="true" tabindex="-1"></a>pmf <span class="ot">&lt;-</span> <span class="fu">tapply</span>(probabilities, X_values, sum)</span>
<span id="cb735-14"><a href="#cb735-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-15"><a href="#cb735-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 定义可能的 X 值</span></span>
<span id="cb735-16"><a href="#cb735-16" aria-hidden="true" tabindex="-1"></a>X_values_unique <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(X_values))</span>
<span id="cb735-17"><a href="#cb735-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-18"><a href="#cb735-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 计算 CDF</span></span>
<span id="cb735-19"><a href="#cb735-19" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(pmf)</span>
<span id="cb735-20"><a href="#cb735-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-21"><a href="#cb735-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 确保 CDF 在 x &gt; 4 时为 1</span></span>
<span id="cb735-22"><a href="#cb735-22" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">c</span>(cdf, <span class="dv">1</span>)</span>
<span id="cb735-23"><a href="#cb735-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-24"><a href="#cb735-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 更新 X 值以包括 x &gt; 4 的情况</span></span>
<span id="cb735-25"><a href="#cb735-25" aria-hidden="true" tabindex="-1"></a>X_values_unique <span class="ot">&lt;-</span> <span class="fu">c</span>(X_values_unique, <span class="st">"&gt;4"</span>)</span>
<span id="cb735-26"><a href="#cb735-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-27"><a href="#cb735-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 创建数据框显示 PMF 和 CDF</span></span>
<span id="cb735-28"><a href="#cb735-28" aria-hidden="true" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb735-29"><a href="#cb735-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">X =</span> X_values_unique,</span>
<span id="cb735-30"><a href="#cb735-30" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">PMF P(X=x)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(pmf, <span class="dv">1</span><span class="fl">-0.1296-0.3456-0.2880-0.1536-0.0256</span>),  <span class="co"># PMF 没有对应的 x &gt; 4 值，填 NA</span></span>
<span id="cb735-31"><a href="#cb735-31" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">CDF F(X&lt;=x)</span><span class="st">`</span> <span class="ot">=</span> cdf</span>
<span id="cb735-32"><a href="#cb735-32" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb735-33"><a href="#cb735-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-34"><a href="#cb735-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 打印表格</span></span>
<span id="cb735-35"><a href="#cb735-35" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   X PMF.P.X.x. CDF.F.X..x.
0  0     0.1296      0.1296
1  1     0.3456      0.4752
2  2     0.2880      0.7632
3  3     0.1536      0.9168
4  4     0.0256      0.9424
  &gt;4     0.0576      1.0000</code></pre>
</div>
</div>
<ul>
<li>Note that the domain of a cdf is (−∞, ∞)</li>
</ul>
<p><span class="math inline">\(\mathrm{pmf} \Longrightarrow \mathrm{cdf}\)</span> <span class="math display">\[
F_x(x)=\sum_{y \leq x} p_x(y)
\]</span> cdf <span class="math inline">\(\Longrightarrow\)</span> pmf Suppose <span class="math inline">\(X\)</span> takes ordered values <span class="math inline">\(x_1, x_2, x_3, \cdots\)</span>, then <span class="math display">\[
\begin{aligned}
p_X\left(x_i\right) &amp; =P\left(X=x_i\right)=P\left(x_{i-1}&lt;X \leq x_i\right) \\
&amp; =P\left(X \leq x_i\right)-P\left(X \leq x_{i-1}\right) \\
&amp; =F\left(x_i\right)-F\left(x_{i-1}\right)
\end{aligned}
\]</span></p>
<ul>
<li>remark: The probability of a discrete distribution varies depending on the inclusion and exclusion of the boundary values.</li>
</ul>
</section>
<section id="expectation-and-variance-for-discrete-random-variables" class="level2">
<h2 class="anchored" data-anchor-id="expectation-and-variance-for-discrete-random-variables">Expectation and Variance for Discrete Random Variables</h2>
<p><span class="math display">\[
\frac{0 \cdot f_0+1 \cdot f_1+2 \cdot f_2+\cdots+n \cdot f_n}{N}=\frac{1}{N} \sum_{i=0}^n i \cdot f_i
\]</span></p>
<p>Note that in <span class="math inline">\(\frac{1}{N} \sum_{i=0}^n i \cdot f_i\)</span>, <span class="math display">\[
\lim _{N \rightarrow \infty} \frac{f_i}{N}=P(X=i)
\]</span></p>
<p>So the average number will be <span class="math display">\[
\sum_{i=0}^n i \cdot P(X=i)
\]</span></p>
<ul>
<li><p>Definition: Expectation Given a discrete random variable <span class="math inline">\(X\)</span>, the expectation of <span class="math inline">\(X\)</span> is <span class="math display">\[
E[X]=\sum_x x \cdot p_X(x)
\]</span></p></li>
<li><p>Properties of Expectation</p></li>
<li><p>If <span class="math inline">\(c\)</span> is a constant, then <span class="math inline">\(E[c]=c\)</span>.</p></li>
<li><p>If <span class="math inline">\(X \geq 0\)</span> then <span class="math inline">\(E[X] \geq 0\)</span>.</p></li>
<li><p>If <span class="math inline">\(a \leq X \leq b\)</span> then <span class="math inline">\(a \leq E[X] \leq b\)</span>.</p></li>
<li><p>Proof of 3: First show <span class="math inline">\(E[X] \geq a\)</span>, then show <span class="math inline">\(E[X] \leq b\)</span>, <span class="math display">\[
\begin{aligned}
E[X] &amp; =\sum_x x p_X(x) \geq \sum_x a p_X(x), \\
&amp; =a \sum_x p_x(x)=a .
\end{aligned}
\]</span></p></li>
</ul>
<p>Similarly, <span class="math inline">\(E[X] \leq b\)</span>.</p>
<ul>
<li><p>Suppose <span class="math inline">\(X\)</span> is a discrete random variable and <span class="math inline">\(Y=g(X)\)</span>, then <span class="math display">\[
\begin{aligned}
E[Y] &amp; =\sum_y y p_Y(y)=\sum_y y P(Y=y) \\
&amp; =\sum_y y \sum_{\{x: g(x)=y\}} P(X=x) \\
&amp; =\sum_y \sum_{\{x: g(x)=y\}} y P(X=x) \\
&amp; =\sum_y \sum_{\{x: g(x)=y\}} g(x) P(X=x) \\
&amp; =\sum_x g(x) P(X=x)
\end{aligned}
\]</span></p></li>
<li><p>First moment of <span class="math inline">\(X\)</span> (mean): <span class="math display">\[
E[X]=\sum_x x p_X(x) .
\]</span></p></li>
<li><p>Second moment of <span class="math inline">\(X\)</span> : <span class="math display">\[
E\left[X^2\right]=\sum_x x^2 p_x(x) .
\]</span></p></li>
<li><p>In general, <span class="math inline">\(E[g(X)] \neq g(E[X])\)</span>. For example, let <span class="math inline">\(g(x)=x^2\)</span>, and consider <span class="math inline">\(X\)</span> such that <span class="math display">\[
p_X(x)= \begin{cases}0.5, &amp; \text { for } x=-1 \\ 0.5, &amp; \text { for } x=1\end{cases}
\]</span></p></li>
</ul>
<p>Then clearly <span class="math inline">\(E\left[X^2\right]=1 \neq 0=(E[X])^2\)</span>.</p>
<ul>
<li><p>There are exceptions (e.g.&nbsp;when g is linear)!</p></li>
<li><p>Linearity of Expectation</p></li>
</ul>
<p>E[aX + b] = aE[X] + b</p>
<p>proof:</p>
<p>Suppose <span class="math inline">\(g(x)=a x+b\)</span>. Then <span class="math display">\[
\begin{aligned}
E[g(X)] &amp; =\sum_x g(x) p_X(x), \\
&amp; =\sum_x(a x+b) p_x(x), \\
&amp; =\sum_x a x p_x(x)+\sum_x b p_x(x), \\
&amp; =a \sum_x x p_x(x)+b \sum_x p_x(x), \\
&amp; =a E[X]+b=g(E[X]),
\end{aligned}
\]</span> this implies <span class="math display">\[
E[a X+b]=a E[X]+b
\]</span></p>
<ul>
<li>Remark: Apart from this case, always assume <span class="math inline">\(E[g(X)] \neq g(E[X])\)</span>.</li>
</ul>
</section>
</section>
<section id="joint-distribution-of-x-and-y" class="level1">
<h1>joint distribution of X and Y</h1>
<p>The joint probability mass function (i.e., joint pmf) of X and Y for discrete random variables is defined as <span class="math inline">\(p_{X,Y} (x, y) := P(X = x \text{ and } Y = y)\)</span></p>
<p>P[(X,Y) ∈ A] =<span class="math inline">\(\sum_{(x,y)\in A}p_{X,Y}(x,y)\)</span>,where A belongs to a subset of the <span class="math inline">\(\mathbb R^2\)</span> where X and Y taking values.</p>
</section>
<section id="marginal-probability-mass-function" class="level1">
<h1>Marginal Probability Mass Function</h1>
<p>Let <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have the joint probability mass function <span class="math inline">\(p_{X, Y}(x, y)\)</span> with space <span class="math inline">\(\mathcal{S}\)</span>. The probability mass function of <span class="math inline">\(X\)</span> (or <span class="math inline">\(Y\)</span> ) alone, is called the marginal probability mass function of <span class="math inline">\(X\)</span> (or <span class="math inline">\(Y\)</span> ) and defined by: <span class="math display">\[
\begin{aligned}
&amp; p_X(x)=P(X=x)=\sum_y p_{X, Y}(x, y) \\
&amp; p_Y(y)=P(Y=y)=\sum_x p_{X, Y}(x, y)
\end{aligned}
\]</span></p>
<p>For the marginal of X, we sum over all values of y.</p>
<p>For the marginal of Y, we sum over all values of x.</p>
<p>eg.–helping understand both sample space, event and Marginal probability mass function</p>
<p><img src="images/clipboard-206208503.png" class="img-fluid"></p>
</section>
<section id="functions-of-multiple-random-variables" class="level1">
<h1>Functions of multiple random variables</h1>
<p>it has the same philosophy as one random variable things, such as expectation:</p>
<p><span class="math display">\[E[g(X,Y)]=\sum_x \sum_y g(x,y)p_{X,Y}(x,y)\]</span>, also the linearity of expectation</p>
<p>eg. Z = X + 2Y.</p>
<p><img src="images/clipboard-369824916.png" class="img-fluid"></p>
</section>
<section id="independence" class="level1">
<h1>independence</h1>
<ul>
<li><p>P(<span class="math inline">\(A\cap B\)</span>)=P(A)P(B) or P(A|B)=P(A)</p></li>
<li><p>Two discrete random variables X and Y are independent if P(X = x and Y = y) = P(X = x)P(Y = y):</p></li>
</ul>
<p><span class="math inline">\(p_{X,Y}(x,y)=p_X(x)p_Y(y), \forall x,y\)</span></p>
<p><span class="math inline">\(p_{X|Y}(x|y)=p_X(x), \forall x,y\)</span></p>
<p>it is easy to detect the dependent as long as we find one example, eg: <span class="math inline">\(P_{X|Y}(1|1)\)</span> is not equal to <span class="math inline">\(P(X=1)\)</span></p>
<section id="independence-expectationsmean-and-variance" class="level2">
<h2 class="anchored" data-anchor-id="independence-expectationsmean-and-variance">independence, expectations(mean) and variance</h2>
<p>Independence and Expectations If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, then <span class="math display">\[
E[X Y]=E[X] E[Y] .
\]</span></p>
<p>Proof: We use <span class="math inline">\(E[g(X, Y)]\)</span> where <span class="math inline">\(g(x, y)=x y\)</span>. <span class="math display">\[
\begin{aligned}
E[X Y] &amp; =\sum_x \sum_y x y p_{X, Y}(x, y) \\
&amp; =\sum_x \sum_y x y p_X(x) p_Y(y), \quad(\text { by inde } \\
&amp; =\left(\sum_x x p_X(x)\right)\left(\sum_y y p_Y(y)\right)=E[X] E[Y] .
\end{aligned}
\]</span> (by independence)</p>
<p>Similarly, if <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent, then <span class="math display">\[
E[g(X) h(Y)]=E[g(X)] E[h(Y)]
\]</span></p>
<ul>
<li>Independence and Variances</li>
</ul>
<p>It is always true that <span class="math display">\[
\operatorname{Var}(a X)=a^2 \operatorname{Var}(X), \quad \text { and } \quad \operatorname{Var}(X+a)=\operatorname{Var}(X)
\]</span></p>
<p>In general, when we have a sum of random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> <span class="math display">\[
\operatorname{Var}(X+Y) \neq \operatorname{Var}(X)+\operatorname{Var}(Y) .
\]</span></p>
<p>It is only true if <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent</p>
<ul>
<li><p>Sum of Variance for independent R.V. If two random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent then <span class="math display">\[
\operatorname{Var}(X+Y)=\operatorname{Var}(X)+\operatorname{Var}(Y)
\]</span></p></li>
<li><p>Sum of Variance for independent R.V.</p></li>
</ul>
<p>If two random variables <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent then <span class="math display">\[
\operatorname{Var}(X+Y)=\operatorname{Var}(X)+\operatorname{Var}(Y) .
\]</span></p>
<p>Proof: Independence implies <span class="math inline">\(E[X Y]=E[X] E[Y]\)</span>. Thus <span class="math display">\[
\begin{aligned}
&amp; \operatorname{Var}(X+Y)=E\left[(X+Y-(E[X]+E[Y]))^2\right], \\
&amp; =E\left[(X-E[X])^2+2(X-E[X])(Y-E[Y])+(Y-E[Y])^2\right], \\
&amp; =\operatorname{Var}(X)+\operatorname{Var}(Y)+2 E[(X-E[X])(Y-E[Y])]
\end{aligned}
\]</span></p>
<p>As <span class="math inline">\(X\)</span> is indep to <span class="math inline">\(Y\)</span>, then <span class="math inline">\(X-\mu_X\)</span> is indep to <span class="math inline">\(Y-\mu_Y\)</span> so <span class="math display">\[
E[(X-E[X])(Y-E[Y])]=E[X-E[X]] E[Y-E[Y]]=0
\]</span></p>
<p>Example: Assume independence, <span class="math inline">\(\operatorname{Var}(3 X-5 Y)=\)</span> <span class="math display">\[
\operatorname{Var}(3 X)+\operatorname{Var}(-5 Y)=9 \operatorname{Var}(X)+25 \operatorname{Var}(Y)
\]</span></p>
<ul>
<li>Example. Independence, mean and variance</li>
</ul>
<p>Let <span class="math inline">\(Y\)</span> be the random variable denoting the total number of heads by tossing a coin <span class="math inline">\(n\)</span> times. Find the mean and variance of <span class="math inline">\(Y\)</span>.</p>
<p>Let <span class="math display">\[
Y_i= \begin{cases}1, &amp; \text { if the } i^{\text {th }} \text { toss gets a head } \\ 0, &amp; \text { otherwise. }\end{cases}
\]</span></p>
<p>Then <span class="math inline">\(Y=Y_1+Y_2+\cdots+Y_n\)</span> where <span class="math inline">\(Y_1, Y_2, \cdots, Y_n\)</span> are independent. For any <span class="math inline">\(i=1,2, \cdots, n\)</span>, we have <span class="math display">\[
\begin{array}{ccc}
y &amp; 0 &amp; 1 \\
P_{Y_i}(y) &amp; 1 / 2 &amp; 1 / 2
\end{array}
\]</span></p>
<p>As <span class="math inline">\(E\left[Y_i\right]=\frac{1}{2}\)</span> and <span class="math inline">\(\operatorname{Var}\left(Y_i\right)=\frac{1}{4}\)</span> for <span class="math inline">\(i=1,2, \cdots, n\)</span> <span class="math display">\[
\begin{gathered}
E[Y]=E\left[Y_1\right]+E\left[Y_2\right]+\cdots+E\left[Y_n\right]=\frac{n}{2} \\
\operatorname{Var}(Y)=\operatorname{Var}\left(Y_1\right)+\operatorname{Var}\left(Y_2\right)+\cdots+\operatorname{Var}\left(Y_n\right)=\frac{n}{4}
\end{gathered}
\]</span> (for not independent cases we have the same result as E but not Var because Var is not linear)</p>
</section>
</section>
<section id="continuous-random-variables" class="level1">
<h1>Continuous Random Variables</h1>
<p>We have to consider intervals instead of one when referring to continuous random variables or the probability will equals to 0, which has no meaning.</p>
<p>eg. <span class="math inline">\(P(a\leq Y\leq b)=P(a&lt;Y&lt;b)\)</span> if Y is a continuous variable.</p>
<section id="definition.-probability-density-function-pdf" class="level2">
<h2 class="anchored" data-anchor-id="definition.-probability-density-function-pdf">Definition. Probability Density Function (pdf)</h2>
<p>For a continuous random variable X, the Probability Density Function (PDF) of X is f(x) where P(X = x) = 0 for all x and for any a ≤ b</p>
</section>
<section id="discrete-and-continuous" class="level2">
<h2 class="anchored" data-anchor-id="discrete-and-continuous">discrete and continuous</h2>
<p><img src="images/clipboard-1910128728.png" class="img-fluid"></p>
<p>Density function’s value could be greater than 1 because the integral of it in a very tiny interval could be very small, which represents the probability(which could not be greater than 1 and since the interval could be very tiny this condition is satisfied!).(This reminder notices that the value of pdf is not the probability since the integration is the probability which is totally 1)</p>
</section>
</section>
<section id="covariance" class="level1">
<h1>Covariance</h1>
<p><img src="images/clipboard-4061434485.png" class="img-fluid"></p>
<section id="wait-for-reviewing.." class="level2">
<h2 class="anchored" data-anchor-id="wait-for-reviewing..">wait for reviewing…..</h2>
<p><img src="images/clipboard-2808960987.png" class="img-fluid"></p>
</section>
</section>
<section id="descrete-distributions" class="level1">
<h1>Descrete distributions</h1>
<p>A probability distribution is a graph, table of formula that gives the probability for each value of the random variable.</p>
<section id="bernoulli-is-composed-by-binomial" class="level2">
<h2 class="anchored" data-anchor-id="bernoulli-is-composed-by-binomial">Bernoulli is composed by binomial</h2>
</section>
<section id="hypergeometric-distribution-could-be-approximated-by-binomial-when-samples-are-large" class="level2">
<h2 class="anchored" data-anchor-id="hypergeometric-distribution-could-be-approximated-by-binomial-when-samples-are-large">Hypergeometric distribution could be approximated by Binomial when samples are large</h2>
</section>
<section id="poisson-distribution-as-the-limit-of-binomial-distribution-when-the-number-of-trials-is-large-and-the-probabiliy-of-success-of-each-trial-is-inverse-proportional-to-the-number-of-trials" class="level2">
<h2 class="anchored" data-anchor-id="poisson-distribution-as-the-limit-of-binomial-distribution-when-the-number-of-trials-is-large-and-the-probabiliy-of-success-of-each-trial-is-inverse-proportional-to-the-number-of-trials">Poisson distribution as the limit of Binomial distribution when the number of trials is large and the probabiliy of success of each trial is inverse-proportional to the number of trials</h2>
<ul>
<li>The Poisson distribution is a discrete probability distribution that applies to occurrences of some event over a specified interval. The random variable x is the number of occurrences of the event in an interval.The probability of the event occurring x times over an interval is given by <span class="math display">\[P(x)=\frac{u^x\cdot e^{-\mu}}{x!}\]</span> where the random variable x is the number of occurences of an event over some interval and the ovvurrences must be random and independent of each other.</li>
</ul>
<p>中心极限定理：当泊松分布的参数 λ 较大时，泊松分布的形状会接近正态分布。这是因为中心极限定理指出，大量独立随机变量的和趋向于正态分布，而泊松分布可以看作是大量伯努利试验成功次数的分布，当试验次数足够多时，其和可以用正态分布来近似</p>
<section id="the-occurrences-must-be-uniformly-distributed-over-the-interval-being-used" class="level3">
<h3 class="anchored" data-anchor-id="the-occurrences-must-be-uniformly-distributed-over-the-interval-being-used">???The occurrences must be uniformly distributed over the interval being used</h3>
<p>The mean is <span class="math inline">\(\mu\)</span></p>
<p>The standard deviation is <span class="math inline">\(\sigma= \sqrt \mu\)</span></p>
<ul>
<li><p>eg of Poisson distribution: (describing the behavior of rare events(with small probabilities). radioactive decay, arrivals of people in a line, eagles nesting in a region, patients arriving at an emergency room(the local hospital experiences a mean of 2.3 patients arriving at the emergency room during 10-11 P.M. on Fri. is known, we can find the probability that for a randomly selected Fri. between 10-11 P.M., exactly four patients arrive), Internet users logging onto a Web site )</p></li>
<li><p>Comparison between Binomial:</p></li>
</ul>
<p>Binomal distribution is affected by yhe smaple size n and the probability p, whereas the Poisson distribution is affected only by mean <span class="math inline">\(\mu\)</span></p>
<p>A binomial distribution has a limit of possible values but a Poisson distribution has a possible values x without upper bound.</p>
<p>Suppose the <span class="math inline">\(X_n,n\geq1\)</span> is a sequence of random variables such that <span class="math inline">\(X_n\)</span>~Bin(<span class="math inline">\(n,p_n\)</span>), where <span class="math inline">\(p_n\)</span>~<span class="math inline">\(\lambda/n\)</span> as <span class="math inline">\(n-&gt;\infty\)</span> <span class="math inline">\(lim_{n-&gt;\infty}(np_0)=\lambda\)</span>, <strong>intuitively we can observe that</strong> <span class="math inline">\(\lambda\)</span> is the mean of</p>
<p>given the well-known limit <span class="math inline">\(\lim _{n \rightarrow \infty}\left(1-\frac{\lambda}{n}\right)^n=e^{-\lambda}\)</span>, and <span class="math display">\[
\begin{aligned}
&amp; \frac{n}{n} \frac{n-1}{n} \ldots \frac{n-k+1}{n}=\prod_{i=0}^{k-1}\left(1-\frac{i}{n}\right) \\
&amp; \lim _{n \rightarrow \infty} \prod_{i=0}^{k-1}\left(1-\frac{i}{n}\right)=1 \\
&amp; P\left(X_n=k\right)=\binom{n}{k} p_n^k\left(1-p_n\right)^{n-k} \\
&amp;= \frac{n \cdots(n-k+1)}{k!} p_n^k\left(1-p_n\right)^n\left(1-p_n\right)^{-k} \\
&amp;= \frac{1}{k!}(\underbrace{n p_n}_{\rightarrow \lambda})^k \underbrace{\frac{n}{n} \frac{n-1}{n} \cdots \frac{n-k+1}{n}}_{\rightarrow 1} \underbrace{\left(1-p_n\right)^n}_{\rightarrow \mathrm{e}^{-\lambda}} \underbrace{\left(1-p_n\right)^{-k}}_{\rightarrow 1} \\
&amp; \rightarrow \frac{\lambda^k}{k!} \mathrm{e}^{-\lambda} \underbrace{}_{\text {as } n \rightarrow \infty .}
\end{aligned}
\]</span></p>
<p>Check that <span class="math inline">\(p_x(k), k=0,1,2, \cdots\)</span> defines a probability mass function: given the Taylor Series of <span class="math inline">\(e^\lambda\)</span> around <span class="math inline">\(\lambda=0\)</span> is given by <span class="math inline">\(f(x)=\)</span> <span class="math inline">\(\sum_{n=0}^{\infty} \frac{f^{(n)}(0)}{n!} x^n\)</span> and <span class="math inline">\(e^\lambda=\sum_{n=0}^{\infty} \frac{\lambda^n}{n!}\)</span>. Hence, <span class="math display">\[
\begin{aligned}
\sum_{k=0}^{\infty} p_X(k) &amp; =\sum_{k=0}^{\infty} \frac{\lambda^k}{k!} \mathrm{e}^{-\lambda} \\
&amp; =\mathrm{e}^{-\lambda} \sum_{k=0}^{\infty} \frac{\lambda^k}{k!} \\
&amp; =\mathrm{e}^{-\lambda} \cdot \mathrm{e}^\lambda \\
&amp; =1 .
\end{aligned}
\]</span> ## Geometric distribution (and Geometric series–powerful!fantastic series)</p>
<ul>
<li><p>The probability of the first happening</p></li>
<li><p>well-defined <span class="math inline">\(\begin{aligned} \sum_{k=1}^{\infty} p_X(k) &amp; =\sum_{k=1}^{\infty}(1-p)^{k-1} p \\ &amp; =p \sum_{k=0}^{\infty}(1-p)^k \\ &amp; =p \cdot \frac{1}{1-(1-p)} \\ &amp; =1 .\end{aligned}\)</span></p></li>
<li><p>Tail probability of the Geometric distribution</p></li>
</ul>
<p>Let <span class="math inline">\(X \sim \operatorname{Geom}(p)\)</span> then <span class="math display">\[
\begin{aligned}
P(X&gt;n) &amp; =P(X=n+1)+P(X=n+2)+P(X=n+3)+\cdots \\
&amp; =(1-p)^n p+(1-p)^{n+1} p+(1-p)^{n+2} p+\cdots \\
&amp; =(1-p)^n p\left(1+(1-p)+(1-p)^2+\cdots\right) \\
&amp; =(1-p)^n p \frac{1}{1-(1-p)} \\
&amp; =(1-p)^n
\end{aligned}
\]</span> for any <span class="math inline">\(n=0,1,2, \ldots\)</span></p>
<ul>
<li>Memoryless property of Geometric distribution</li>
</ul>
<p>Suppose that <span class="math inline">\(X \sim \operatorname{Geom}(p)\)</span> and <span class="math inline">\(n \in\{1,2,3, \cdots\}\)</span>. Then <span class="math display">\[
P(X-n=k \mid X&gt;n)=P(X=k) \quad, k=1,2,3, \cdots
\]</span></p>
<p>That is, the distribution of <span class="math inline">\(X-n\)</span> under the probability function <span class="math inline">\(P(\cdot \mid X&gt;n)\)</span> is the same as the distribution of <span class="math inline">\(X\)</span></p>
<p>the memoryless property is saying that given the first n trials are unsuccessful, the number of trials until success after the first n trials has the same distribution as the unconditional number of trials until success (independent)</p>
<ul>
<li>Expectation</li>
</ul>
<p>Suppose that <span class="math inline">\(X \sim \operatorname{Geom}(p)\)</span>. Then <span class="math display">\[
\begin{aligned}
E(X)=\sum_{k=1}^{\infty} k P(X=k) &amp; =\sum_{k=1}^{\infty} k(1-p)^{k-1} p \\
&amp; =p \sum_{k=1}^{\infty}\left[-\frac{\mathrm{d}}{\mathrm{~d} p}(1-p)^k\right] \\
&amp; =-p \frac{\mathrm{~d}}{\mathrm{~d} p}\left[\sum_{k=0}^{\infty}(1-p)^k\right] \\
&amp; =-p \frac{\mathrm{~d}}{\mathrm{~d} p}\left[\frac{1}{1-(1-p)}\right] \\
&amp; =-p \frac{\mathrm{~d}}{\mathrm{~d} p}\left[\frac{1}{p}\right] \\
&amp; =\frac{1}{p}
\end{aligned}
\]</span> — variance</p>
<p>Likewise, <span class="math display">\[
\begin{aligned}
E(X(X-1)) &amp; =\sum_{k=1}^{\infty} k(k-1) P(X=k) \\
&amp; =\sum_{k=2}^{\infty} k(k-1)(1-p)^{k-1} p \\
&amp; =p(1-p) \sum_{k=2}^{\infty} k(k-1)(1-p)^{k-2} \\
&amp; =p(1-p) \frac{\mathrm{d}^2}{\mathrm{~d} p^2}\left[\sum_{k=0}^{\infty}(1-p)^k\right] \\
&amp; =p(1-p) \frac{\mathrm{d}^2}{\mathrm{~d} p^2} \frac{1}{p} \\
&amp; =p(1-p) \cdot \frac{2}{p^3} \\
&amp; =\frac{2(1-p)}{p^2} .
\end{aligned}
\]</span> <span class="math display">\[\begin{aligned} \operatorname{Var}(X) &amp; =E(X(X-1))+E(X)-(E(X))^2 \\ &amp; =\frac{2(1-p)}{p^2}+\frac{1}{p}-\frac{1}{p^2} \\ &amp; =\frac{1-p}{p^2}\end{aligned}\]</span></p>
</section>
</section>
<section id="geometric-distribution" class="level2">
<h2 class="anchored" data-anchor-id="geometric-distribution">Geometric distribution</h2>
<section id="the-irrelevance-of-past-events-to-the-probability-of-future-independent-events" class="level3">
<h3 class="anchored" data-anchor-id="the-irrelevance-of-past-events-to-the-probability-of-future-independent-events">The irrelevance of past events to the probability of future independent events</h3>
<p>Given the first n trials are unsuccessful, the number of trials until success after the first n trials has the same distribution as the unconditional number of trials until success.</p>
<p>X~Geom(p) and n$${1,2,3,….}</p>
<p>P(X-n=k|X&gt;n)=P(X=k), k=1,2,3,…</p>
<p>Tail probability for the probability calculation of more/higher than….</p>
</section>
</section>
<section id="addition" class="level2">
<h2 class="anchored" data-anchor-id="addition">Addition</h2>
<p>Independent random variable with the same distribution allows the addition law</p>
</section>
</section>
<section id="normal-distribution-1" class="level1">
<h1>Normal distribution</h1>
<section id="interpretation-1" class="level2">
<h2 class="anchored" data-anchor-id="interpretation-1">interpretation:</h2>
<ul>
<li><p>Standard normally distributed sth. z=1.58(corresponding to 0.9429):</p>
<p>the probability of randomly selecting sth. with a value less than 1.58(unit) is equal to the area(probability) of 0.9429.</p>
<p>(Or: 94.29% of sth, will have a value below 1.58(unit))</p></li>
</ul>
</section>
<section id="sampling-distributions-and-estimators" class="level2">
<h2 class="anchored" data-anchor-id="sampling-distributions-and-estimators">Sampling distributions and Estimators</h2>
<p>We are beginning to embark a jourfa d dney that allows us to learn about populations by obtaining data from samples since it is rare that we know all values in an entire population.</p>
<p><strong>Sampling distribution of a statistic</strong> is the probability distribution of a sample statistics (such as mean/proportion which tend to target the population mean/proportion), with all samples having the same sample size. This concept is important to understand. The behavior of a statistic can be known by understanding its distribution( (The random variable in this case is the value of that sample statistics)). Under certain condition, the distribution of sampling mean/proportion approximates a normal distribution.</p>
<p><strong>Though statistics does not depend on unknown parameters, the distribution of it depend on unknown parameters.(eg. Normal distribution of sample means depends on population mean(an unknow parameter) and standard deviation)</strong></p>
<p>(ps: the advantage of sampling with replacement:</p>
<p>when selecting a relatively small sample from a large population, it makes no significant difference whether we sample with or without replacement.</p>
<p>Sampling with replacement results in independent events that are unaffected by previous outcomes, and independent events are easier to analyze and they result in simpler formulas.)</p>
<p><strong>For a fixed sample size, the mean of all possible sample means is equal to the mean of population though sample means vary(sampling variability)</strong></p>
</section>
<section id="unbiased-estimators-and-biased-estimators" class="level2">
<h2 class="anchored" data-anchor-id="unbiased-estimators-and-biased-estimators">Unbiased estimators and biased estimators</h2>
<p>Statistics that target population parameters: Mean, variance, proportion</p>
<p>Statistics that do target population parameters: Median, Range, Standard Deviation</p>
<p>(the bias is relatively small then sampling standard deviation in large samples so s is ofent used to estimate <span class="math inline">\(\sigma\)</span>)</p>
</section>
</section>
<section id="the-central-limit-thm" class="level1">
<h1>The Central Limit Thm</h1>
<p>It is the foundation for estimation population parameters and hypothesis testing</p>
<p>(Recall: A random variable is a variable that has a single numerical value(eg. x=1,x=2), determined by chance, for each outcome of a procedure随机变量是一种变量，对于一个过程的每个结果都有一个随机确定的单一数值(可以理解为，现象作用其上</p>
<p>A probability distribution is a graph, table or formula that gives the probability for each value of a random variable</p>
<p>The sampling distribution of the mean is the probability fistribution of sample means, with all sample having the same sample size n)</p>
<p>As the sample size increases, the corresponding sample means tend to vary less. The central limit thm tells us that if the sample size is large engough, the distribution of sample means can be approximated by normal distribution</p>
<p>Conclusion of CLT: (it is so important since it allows us to use the basic normal distribution methods in a wide variety of different circumstances)</p>
<p>The distribution of sample means will, as the sample size increases, approach a normal distribution</p>
<p>The mean of all sample means is the population mean <span class="math inline">\(\mu.\)</span>. <span class="math display">\[\mu_{\bar x}=\mu\]</span></p>
<p>The standard deviation of all sample means is <span class="math inline">\(\sigma/ \sqrt n\)</span> (i,e, the normal distribution from conclusion”The distribution of sample means will, as the sample size increases, approach a normal distribution” has standard deviation <span class="math inline">\(\sigma/ \sqrt n\)</span> ) <span class="math display">\[\sigma_{\bar x}=\frac{\sigma}{\sqrt n}\]</span> <span class="math inline">\(\sigma_{\bar x}\)</span> is often called the standard error of the mean.</p>
<p>30</p>
<p>Notice: Be careful to look at if it is from a normally ditributed population or a mean for some sample/group.</p>
<p>If given the population mean is a and a sample(c subjects) mean is b which has so small probbility under the sampling distribution with this populatio mean, if the mean is really a, then there is an extremely small probability of getting a sample mean of b or lower when c subjects are randomly selected. we can interpret it in such 2 ways:</p>
<ol type="1">
<li><p>population mean is true and their sample represents a chance event that is extreamely rare</p></li>
<li><p>population mean is not true and sample is typical.</p></li>
</ol>
<p>Because the probability is too low, it seems more reasonable to conclude that the population mean is lower than a—hypothesis testing’s thinking</p>
<section id="optional-correction-for-a-finite-population" class="level3">
<h3 class="anchored" data-anchor-id="optional-correction-for-a-finite-population">Optional: Correction for a finite population</h3>
<p>When sampling without replacement and the sample size n is greater than 5% of the finite populaiton size B(i.e.&nbsp;n&gt;0.05N), …</p>
</section>
<section id="using-the-normal-distribution-as-an-approximation-to-the-binomial-distribution" class="level2">
<h2 class="anchored" data-anchor-id="using-the-normal-distribution-as-an-approximation-to-the-binomial-distribution">Using the Normal distribution as an approximation to the binomial distribution</h2>
<p>requirement: np, n(1-p) <span class="math inline">\(\geq\)</span> 5</p>
<p>Be careful: adjust x for continuity by + or - 0.5(eg. at least 99, choose 98.5)</p>
</section>
<section id="to-hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="to-hypothesis-testing">to hypothesis testing</h2>
<p>a question (eg):</p>
<p>In a test of a gender-selection technique assume that 100 couples using a particular treatment give birth to 52 girls (and 48 boys). If the technique has no effect, then the probability of a girl is approximately 0.5. If the probability of a girl is 0.5, find the probability that among 100 newborn babies, exactly 52 are girls. Based on the result, is there strong evidence supporting a claim that the gender-selection technique increases the likelihood that a baby is a girl?</p>
<p>it is a binomial distribution with np=nq=100*0.5=50<span class="math inline">\(\geq 5\)</span></p>
<p>so we use the normal distribution with mean of 50 and <span class="math inline">\(\sigma = \sqrt {npq} = 5\)</span>as an approximation to the binomial distribution</p>
<p>to answer”is there strong evidence supporting a claim that the gender-selection technique increases the likelihood that a baby is a girl?“, we need to calculate more than 52(x successes among n trials is an unusually high number of successes if P(<span class="math inline">\(x\geq a\)</span>) is very small)</p>
<p>原因是因为如果只看52这个数字肯定概率很小，因为任何单个数字发生的可能性概率都很小</p>
<p>So if the answer of P(<span class="math inline">\(x\geq 52\)</span>) is small we could conclude that the gender selection is useful</p>
<p>(总结：如果是0。5概率来看的话52以上本来就不是难事，as indicated by the such large probability of P(<span class="math inline">\(x\geq 52\)</span>) 所以我们没有充分证据拒绝“not effective”这个假设前提)</p>
<p>此处还没有引入假设检验所以都是用using probability to determine when results are unusual这个思想来思考问题的：</p>
<ul>
<li>Unusually low： x successes among n trails is an unually low number of successes if P(x or fewer) is very small</li>
</ul>
<p><img src="images/clipboard-804415.png" class="img-fluid"></p>
<p>Interpretation for another example of gender selection(using only unusual results to explain): Because the probability of more than 13 girls, which is 0.001 is so low, we conclude that it is unusual to get 13 girls among 14 babies (using binomial to calculate it). This suggests that the technique of gender selection appears to be effective since it is highly unlikely that the result of 13 girls among 14 births happened by chance.</p>
</section>
<section id="normal-distribution-2" class="level2">
<h2 class="anchored" data-anchor-id="normal-distribution-2">Normal distribution</h2>
<p>If a variable is the superposition result of a large number of small independent random factors, then the variable must obey the normal distribution of variables</p>
<p>e.g.&nbsp;measure error</p>
<section id="assessing-normality" class="level3">
<h3 class="anchored" data-anchor-id="assessing-normality">Assessing Normality</h3>
<p>In general, quantile plots can be used to assess any probability distribution.</p>
<p>For a normal quantile plot(or normal probability plot), it is a graph of points(x,y) where each x vaue is from the original set of sample data and each y value is the cooresponding z score that is a quantile value expected from the standard normal distribution</p>
<section id="procedures" class="level4">
<h4 class="anchored" data-anchor-id="procedures">Procedures</h4>
<ul>
<li><p>Histogram(not helpful for small data set)</p></li>
<li><p>outliers: reject normality if there is more than 1 outlier present(not helpful for small data set)</p></li>
<li><p>normal quantile plot:</p></li>
</ul>
<p>sort data from lowest to highest</p>
<ul>
<li>Sampling distribution of pˆ when population is infinite</li>
</ul>
<p><img src="images/clipboard-1400086523.png" class="img-fluid"></p>
</section>
</section>
</section>
<section id="inferences-from-2-samples-introduces-the-differences-between-two-populaton-means-using-matched-pairs-but-correlaition-and-regression-analyze-the-association-between-the-2-variables-and-if-such-an-association-exists-we-wnat-to-describe-it-with-an-equation-that-can-be-used-for-predictions" class="level2">
<h2 class="anchored" data-anchor-id="inferences-from-2-samples-introduces-the-differences-between-two-populaton-means-using-matched-pairs-but-correlaition-and-regression-analyze-the-association-between-the-2-variables-and-if-such-an-association-exists-we-wnat-to-describe-it-with-an-equation-that-can-be-used-for-predictions"><img src="images/clipboard-2929822579.png" class="img-fluid">inferences from 2 samples introduces the differences between two populaton means using matched pairs but correlaition and regression analyze the association between the 2 variables and if such an association exists we wnat to describe it with an equation that can be used for predictions</h2>
<p>paired sampled data(or called bivariate data)</p>
<ul>
<li><p>a correlation exists between two variables when one of them is related to the other in some way.</p></li>
<li><p>the linear correlation coefficient r measures the strength of the linear association between the paired x- and y-quantitative values in a sample. Its value is computed by using the formula(Pearson(1857-1937) product moment correlation coefficient)</p></li>
</ul>
<p>……otherwise there is not sufficient evidence to support the conclusion of a significant linear equation</p>
<p>!!!: interpreting r: explained variation: the value of <span class="math inline">\(r^2\)</span> is the proportion of the variation in y that is explained by the linear association between x and y.(and the other percentage is explained by factors other thanx such as characteristics not included in the study)</p>
<ul>
<li><p>correlation does not imply causality,just the association</p></li>
<li><p>average suppress individual variation and may inflate the correlation coefficient(the linear correlation coefficient became higher when reginal averages were used)</p></li>
</ul>
</section>
</section>
<section id="point-estimation-and-confident-interval" class="level1">
<h1>point estimation and confident interval</h1>
<ul>
<li><p>Tomorrow is the exam Good luck! 12.29</p></li>
<li><p>12.30 Everything on MTH113 exam was fine</p></li>
</ul>
<p>All in all, the exam did not decide anything. I think there is a long way to go and MTH113 just include not many about statistics, more than a half has been teached during high school……I will keep exploring the charismatic statistics world since we could not only understand it using the very basic life common sense but also prove them in a rigorous way, while during the proof, such as regression, we also could enjoy its explanation by linear algebra which I also enjoy…..</p>
<ul>
<li>I love you MTH113!!!</li>
</ul>
<p><img src="images/clipboard-1345728232.png" class="img-fluid"></p>
</section>
<section id="acknowledgements" class="level1">
<h1>Acknowledgements</h1>
<ul>
<li><p>Thanks to Dr.&nbsp;Xiaojun Zhu</p></li>
<li><p>Thanks to Dr.&nbsp;Mu He</p></li>
<li><p>I am deeply grateful to Dr.&nbsp;Daiyun Huang for his instruction in the “Biostatistics and R” course. This course has marked the beginning of my formal journey into the world of statistics. Dr.&nbsp;Huang’s comprehensive lectures, accompanied by detailed PDFs, and his well-structured labs, complete with code and solutions, have been incredibly valuable. They have not only enhanced my intuitive grasp of key statistical concepts, such as hypothesis testing, but also significantly improved my proficiency in R programming.</p></li>
<li><p>Also, thanks to the course of “Introduction to statistical learning” by Trevor Hastie and Robert Tibshirani. Examples in their online video lectures are abundant and easy to understand for beginners. Their book is also very helpful.</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>