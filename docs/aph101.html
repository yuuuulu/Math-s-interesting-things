<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Foundation Math Learning - APH101-Biostatistics And R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Foundation Math Learning</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://yuuuulu.github.io/"> 
<span class="menu-text">yuuuulu</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Homepage</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./aph101.html" aria-current="page"> 
<span class="menu-text">Biostat and R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mth107.html"> 
<span class="menu-text">Advanced Linear Algebra</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Simple_ODEs.html"> 
<span class="menu-text">ODEs and PDEs with codes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mth106.html"> 
<span class="menu-text">ODE, PDE, and Fourier Series</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Mathematical Analysis 1.html"> 
<span class="menu-text">Analysis 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mth1113.html"> 
<span class="menu-text">intro to prob, and stat.</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Calculus.html"> 
<span class="menu-text">Calculus</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#i-am-deeply-grateful-to-dr.-daiyun-huang-for-his-instruction-in-the-biostatistics-and-r-course.-this-course-has-marked-the-beginning-of-my-formal-journey-into-the-world-of-statistics.-dr.-huangs-comprehensive-lectures-accompanied-by-detailed-pdfs-and-his-well-structured-labs-complete-with-code-and-solutions-have-been-incredibly-valuable.-they-have-not-only-enhanced-my-intuitive-grasp-of-key-statistical-concepts-such-as-hypothesis-testing-but-also-significantly-improved-my-proficiency-in-r-programming." id="toc-i-am-deeply-grateful-to-dr.-daiyun-huang-for-his-instruction-in-the-biostatistics-and-r-course.-this-course-has-marked-the-beginning-of-my-formal-journey-into-the-world-of-statistics.-dr.-huangs-comprehensive-lectures-accompanied-by-detailed-pdfs-and-his-well-structured-labs-complete-with-code-and-solutions-have-been-incredibly-valuable.-they-have-not-only-enhanced-my-intuitive-grasp-of-key-statistical-concepts-such-as-hypothesis-testing-but-also-significantly-improved-my-proficiency-in-r-programming." class="nav-link active" data-scroll-target="#i-am-deeply-grateful-to-dr.-daiyun-huang-for-his-instruction-in-the-biostatistics-and-r-course.-this-course-has-marked-the-beginning-of-my-formal-journey-into-the-world-of-statistics.-dr.-huangs-comprehensive-lectures-accompanied-by-detailed-pdfs-and-his-well-structured-labs-complete-with-code-and-solutions-have-been-incredibly-valuable.-they-have-not-only-enhanced-my-intuitive-grasp-of-key-statistical-concepts-such-as-hypothesis-testing-but-also-significantly-improved-my-proficiency-in-r-programming.">I am deeply grateful to Dr.&nbsp;Daiyun Huang for his instruction in the “Biostatistics and R” course. This course has marked the beginning of my formal journey into the world of statistics. Dr.&nbsp;Huang’s comprehensive lectures, accompanied by detailed PDFs, and his well-structured labs, complete with code and solutions, have been incredibly valuable. They have not only enhanced my intuitive grasp of key statistical concepts, such as hypothesis testing, but also significantly improved my proficiency in R programming.</a></li>
  <li><a href="#also-thanks-to-the-course-of-introduction-to-statistical-learning-by-trevor-hastie-and-robert-tibshirani.-examples-in-their-online-video-lectures-are-abundant-and-easy-to-understand-for-beginners.-their-book-is-also-very-helpful." id="toc-also-thanks-to-the-course-of-introduction-to-statistical-learning-by-trevor-hastie-and-robert-tibshirani.-examples-in-their-online-video-lectures-are-abundant-and-easy-to-understand-for-beginners.-their-book-is-also-very-helpful." class="nav-link" data-scroll-target="#also-thanks-to-the-course-of-introduction-to-statistical-learning-by-trevor-hastie-and-robert-tibshirani.-examples-in-their-online-video-lectures-are-abundant-and-easy-to-understand-for-beginners.-their-book-is-also-very-helpful.">Also, thanks to the course of “Introduction to statistical learning” by Trevor Hastie and Robert Tibshirani. Examples in their online video lectures are abundant and easy to understand for beginners. Their book is also very helpful.</a></li>
  <li><a href="#review-and-introduce-probability" id="toc-review-and-introduce-probability" class="nav-link" data-scroll-target="#review-and-introduce-probability">Review and Introduce Probability</a>
  <ul class="collapse">
  <li><a href="#simple-random-sampling" id="toc-simple-random-sampling" class="nav-link" data-scroll-target="#simple-random-sampling">Simple Random Sampling</a></li>
  <li><a href="#unbiased-estimator" id="toc-unbiased-estimator" class="nav-link" data-scroll-target="#unbiased-estimator">Unbiased estimator</a></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance">Variance</a></li>
  <li><a href="#sampling-distribution" id="toc-sampling-distribution" class="nav-link" data-scroll-target="#sampling-distribution">Sampling distribution</a>
  <ul class="collapse">
  <li><a href="#sample-mean-of-i.i.d.-normals" id="toc-sample-mean-of-i.i.d.-normals" class="nav-link" data-scroll-target="#sample-mean-of-i.i.d.-normals">Sample mean of i.i.d. normals</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a></li>
  <li><a href="#moment-generating-functions" id="toc-moment-generating-functions" class="nav-link" data-scroll-target="#moment-generating-functions">Moment generating functions</a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition">Definition</a></li>
  <li><a href="#theorems-about-mgf" id="toc-theorems-about-mgf" class="nav-link" data-scroll-target="#theorems-about-mgf">Theorems about MGF</a></li>
  </ul></li>
  <li><a href="#distribution-transformation" id="toc-distribution-transformation" class="nav-link" data-scroll-target="#distribution-transformation">Distribution Transformation</a>
  <ul class="collapse">
  <li><a href="#universality-of-the-uniformfrom-uniform-you-can-get-everything" id="toc-universality-of-the-uniformfrom-uniform-you-can-get-everything" class="nav-link" data-scroll-target="#universality-of-the-uniformfrom-uniform-you-can-get-everything">Universality of the Uniform—From uniform you can get everything</a></li>
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution">Normal Distribution</a></li>
  <li><a href="#from.." id="toc-from.." class="nav-link" data-scroll-target="#from..">From…..</a></li>
  </ul></li>
  <li><a href="#pdf-functionss-transformationfrom-books" id="toc-pdf-functionss-transformationfrom-books" class="nav-link" data-scroll-target="#pdf-functionss-transformationfrom-books">PDF functions’s transformation(from books)</a>
  <ul class="collapse">
  <li><a href="#standard-normal-distribution" id="toc-standard-normal-distribution" class="nav-link" data-scroll-target="#standard-normal-distribution">Standard normal distribution</a></li>
  <li><a href="#chi-square-distribution" id="toc-chi-square-distribution" class="nav-link" data-scroll-target="#chi-square-distribution">Chi-square distribution</a></li>
  <li><a href="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2" id="toc-from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2" class="nav-link" data-scroll-target="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Chi-square distribution <span class="math inline">\(f(x; k) = \frac{1}{2^{k/2} \Gamma(k/2)} x^{k/2 - 1} e^{-x/2}\)</span><br>
  </a></li>
  <li><a href="#student--t-distribution" id="toc-student--t-distribution" class="nav-link" data-scroll-target="#student--t-distribution">Student- t distribution</a></li>
  <li><a href="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom." id="toc-from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom." class="nav-link" data-scroll-target="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom.">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Student- t distribution <span class="math inline">\(f(t) = \frac{\Gamma \left(\frac{\nu+1}{2}\right)}{\sqrt{\nu \pi} \, \Gamma \left(\frac{\nu}{2}\right)} \left(1 + \frac{t^2}{\nu}\right)^{-\frac{\nu+1}{2}}\)</span>, where <span class="math inline">\(\Gamma\)</span> is the gamma function and <span class="math inline">\(\nu\)</span> is the degrees of freedom.<br>
  </a></li>
  <li><a href="#f-distribution" id="toc-f-distribution" class="nav-link" data-scroll-target="#f-distribution">F-distribution</a></li>
  <li><a href="#we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution" id="toc-we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution" class="nav-link" data-scroll-target="#we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution">We will do some trnsformation on chi-square distribution to get F-distribution</a></li>
  <li><a href="#beta-and-gamma" id="toc-beta-and-gamma" class="nav-link" data-scroll-target="#beta-and-gamma">beta and Gamma</a></li>
  <li><a href="#why-is-the-integral-result-as-shown" id="toc-why-is-the-integral-result-as-shown" class="nav-link" data-scroll-target="#why-is-the-integral-result-as-shown">Why is the integral result as shown?</a></li>
  </ul></li>
  <li><a href="#three-main-sampling-distribution" id="toc-three-main-sampling-distribution" class="nav-link" data-scroll-target="#three-main-sampling-distribution">Three Main Sampling distribution</a>
  <ul class="collapse">
  <li><a href="#chi-square-distribution-1" id="toc-chi-square-distribution-1" class="nav-link" data-scroll-target="#chi-square-distribution-1">Chi-square distribution</a></li>
  <li><a href="#students-t-distribution" id="toc-students-t-distribution" class="nav-link" data-scroll-target="#students-t-distribution">Student’s t-distribution</a></li>
  <li><a href="#f-distribution-1" id="toc-f-distribution-1" class="nav-link" data-scroll-target="#f-distribution-1">F-distribution</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimation-of-population-characteristic" id="toc-estimation-of-population-characteristic" class="nav-link" data-scroll-target="#estimation-of-population-characteristic">Estimation of Population Characteristic</a>
  <ul class="collapse">
  <li><a href="#point-estimation" id="toc-point-estimation" class="nav-link" data-scroll-target="#point-estimation">Point Estimation</a></li>
  </ul></li>
  <li><a href="#interval-estimationconfidence-intervalci" id="toc-interval-estimationconfidence-intervalci" class="nav-link" data-scroll-target="#interval-estimationconfidence-intervalci">Interval Estimation—Confidence interval(CI)</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#definition-1" id="toc-definition-1" class="nav-link" data-scroll-target="#definition-1">Definition</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a>
  <ul class="collapse">
  <li><a href="#eg" id="toc-eg" class="nav-link" data-scroll-target="#eg">eg</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#example-of-one-sample-t-test" id="toc-example-of-one-sample-t-test" class="nav-link" data-scroll-target="#example-of-one-sample-t-test">Example of one-sample t-test</a>
  <ul class="collapse">
  <li><a href="#a" id="toc-a" class="nav-link" data-scroll-target="#a">a</a></li>
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">b</a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c">c</a></li>
  <li><a href="#d" id="toc-d" class="nav-link" data-scroll-target="#d">d</a></li>
  </ul></li>
  <li><a href="#example-of-unpaired-t-test" id="toc-example-of-unpaired-t-test" class="nav-link" data-scroll-target="#example-of-unpaired-t-test">Example of unpaired t-test</a></li>
  <li><a href="#example-of-one-sample-variance-test" id="toc-example-of-one-sample-variance-test" class="nav-link" data-scroll-target="#example-of-one-sample-variance-test">Example of one-sample Variance Test</a></li>
  <li><a href="#example-of-two-sample-variance-test" id="toc-example-of-two-sample-variance-test" class="nav-link" data-scroll-target="#example-of-two-sample-variance-test">Example of two-sample Variance Test</a></li>
  <li><a href="#anova-analysis-of-variance" id="toc-anova-analysis-of-variance" class="nav-link" data-scroll-target="#anova-analysis-of-variance">ANOVA– Analysis of Variance</a>
  <ul class="collapse">
  <li><a href="#example-of-two-way-anova" id="toc-example-of-two-way-anova" class="nav-link" data-scroll-target="#example-of-two-way-anova">Example of two-way ANOVA</a></li>
  </ul></li>
  <li><a href="#non-parametric-tests" id="toc-non-parametric-tests" class="nav-link" data-scroll-target="#non-parametric-tests">Non-parametric tests</a>
  <ul class="collapse">
  <li><a href="#application-of-testing-the-goodness-of-fit" id="toc-application-of-testing-the-goodness-of-fit" class="nav-link" data-scroll-target="#application-of-testing-the-goodness-of-fit">Application of testing the goodness of fit</a></li>
  <li><a href="#application-of-testing-for-homogeneity" id="toc-application-of-testing-for-homogeneity" class="nav-link" data-scroll-target="#application-of-testing-for-homogeneity">Application of testing for homogeneity</a></li>
  <li><a href="#application-of-testing-for-independence" id="toc-application-of-testing-for-independence" class="nav-link" data-scroll-target="#application-of-testing-for-independence">Application of testing for independence</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a>
  <ul class="collapse">
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression">Simple linear regression</a>
  <ul class="collapse">
  <li><a href="#brief-introduction" id="toc-brief-introduction" class="nav-link" data-scroll-target="#brief-introduction">Brief introduction</a></li>
  <li><a href="#maximum-likelihood-estimation-mle" id="toc-maximum-likelihood-estimation-mle" class="nav-link" data-scroll-target="#maximum-likelihood-estimation-mle">Maximum Likelihood Estimation (MLE)</a></li>
  <li><a href="#hypothesis-testing-for-estimates-with-unknown-sigma2" id="toc-hypothesis-testing-for-estimates-with-unknown-sigma2" class="nav-link" data-scroll-target="#hypothesis-testing-for-estimates-with-unknown-sigma2">Hypothesis testing for estimates with unknown <span class="math inline">\(\sigma^2\)</span></a></li>
  <li><a href="#r2the-fraction-of-variability-explained-by-the-regression" id="toc-r2the-fraction-of-variability-explained-by-the-regression" class="nav-link" data-scroll-target="#r2the-fraction-of-variability-explained-by-the-regression"><span class="math inline">\(R^2\)</span>–the fraction of variability explained by the regression</a></li>
  </ul></li>
  <li><a href="#multiple-linear-regression-mlr" id="toc-multiple-linear-regression-mlr" class="nav-link" data-scroll-target="#multiple-linear-regression-mlr">Multiple linear regression (MLR)</a>
  <ul class="collapse">
  <li><a href="#a-potential-problem-in-practice-multicollinearity" id="toc-a-potential-problem-in-practice-multicollinearity" class="nav-link" data-scroll-target="#a-potential-problem-in-practice-multicollinearity">A potential problem in practice –multicollinearity</a></li>
  <li><a href="#adjusted-r-squared" id="toc-adjusted-r-squared" class="nav-link" data-scroll-target="#adjusted-r-squared">Adjusted R-squared</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#odds" id="toc-odds" class="nav-link" data-scroll-target="#odds">Odds</a></li>
  </ul></li>
  <li><a href="#generalized-linear-models" id="toc-generalized-linear-models" class="nav-link" data-scroll-target="#generalized-linear-models">Generalized Linear Models</a>
  <ul class="collapse">
  <li><a href="#random-component" id="toc-random-component" class="nav-link" data-scroll-target="#random-component">Random Component</a></li>
  <li><a href="#exponential-family" id="toc-exponential-family" class="nav-link" data-scroll-target="#exponential-family">Exponential Family</a></li>
  <li><a href="#systematic-component-and-link-component" id="toc-systematic-component-and-link-component" class="nav-link" data-scroll-target="#systematic-component-and-link-component">Systematic Component and Link Component</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a>
  <ul class="collapse">
  <li><a href="#gaussian-noise-linear-regression" id="toc-gaussian-noise-linear-regression" class="nav-link" data-scroll-target="#gaussian-noise-linear-regression">Gaussian-noise Linear Regression</a></li>
  <li><a href="#bernoulli" id="toc-bernoulli" class="nav-link" data-scroll-target="#bernoulli">Bernoulli</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#link-function" id="toc-link-function" class="nav-link" data-scroll-target="#link-function">Link Function</a>
  <ul class="collapse">
  <li><a href="#logistic" id="toc-logistic" class="nav-link" data-scroll-target="#logistic">Logistic</a></li>
  </ul></li>
  <li><a href="#survival-analysis" id="toc-survival-analysis" class="nav-link" data-scroll-target="#survival-analysis">Survival Analysis</a>
  <ul class="collapse">
  <li><a href="#some-definations" id="toc-some-definations" class="nav-link" data-scroll-target="#some-definations">Some definations</a></li>
  <li><a href="#kaplan-meier-estimate" id="toc-kaplan-meier-estimate" class="nav-link" data-scroll-target="#kaplan-meier-estimate">Kaplan-Meier estimate</a></li>
  <li><a href="#cox-proportional-harzards-model" id="toc-cox-proportional-harzards-model" class="nav-link" data-scroll-target="#cox-proportional-harzards-model">Cox-proportional harzards model</a></li>
  </ul></li>
  <li><a href="#labs-for-r-code" id="toc-labs-for-r-code" class="nav-link" data-scroll-target="#labs-for-r-code">Labs for R-code</a>
  <ul class="collapse">
  <li><a href="#basic-calculation" id="toc-basic-calculation" class="nav-link" data-scroll-target="#basic-calculation">basic calculation</a></li>
  <li><a href="#vectors" id="toc-vectors" class="nav-link" data-scroll-target="#vectors">Vectors</a></li>
  <li><a href="#vector-algebra" id="toc-vector-algebra" class="nav-link" data-scroll-target="#vector-algebra">Vector Algebra</a></li>
  <li><a href="#matrices" id="toc-matrices" class="nav-link" data-scroll-target="#matrices">Matrices</a></li>
  <li><a href="#factors" id="toc-factors" class="nav-link" data-scroll-target="#factors">Factors</a></li>
  <li><a href="#list" id="toc-list" class="nav-link" data-scroll-target="#list">List</a></li>
  <li><a href="#ggplot-2" id="toc-ggplot-2" class="nav-link" data-scroll-target="#ggplot-2">ggplot 2</a></li>
  <li><a href="#data-manipulation" id="toc-data-manipulation" class="nav-link" data-scroll-target="#data-manipulation">Data manipulation</a></li>
  <li><a href="#evaluation-metrics-for-classification" id="toc-evaluation-metrics-for-classification" class="nav-link" data-scroll-target="#evaluation-metrics-for-classification">Evaluation Metrics for Classification</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">APH101-Biostatistics And R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="i-am-deeply-grateful-to-dr.-daiyun-huang-for-his-instruction-in-the-biostatistics-and-r-course.-this-course-has-marked-the-beginning-of-my-formal-journey-into-the-world-of-statistics.-dr.-huangs-comprehensive-lectures-accompanied-by-detailed-pdfs-and-his-well-structured-labs-complete-with-code-and-solutions-have-been-incredibly-valuable.-they-have-not-only-enhanced-my-intuitive-grasp-of-key-statistical-concepts-such-as-hypothesis-testing-but-also-significantly-improved-my-proficiency-in-r-programming." class="level1">
<h1>I am deeply grateful to Dr.&nbsp;Daiyun Huang for his instruction in the “Biostatistics and R” course. This course has marked the beginning of my formal journey into the world of statistics. Dr.&nbsp;Huang’s comprehensive lectures, accompanied by detailed PDFs, and his well-structured labs, complete with code and solutions, have been incredibly valuable. They have not only enhanced my intuitive grasp of key statistical concepts, such as hypothesis testing, but also significantly improved my proficiency in R programming.</h1>
</section>
<section id="also-thanks-to-the-course-of-introduction-to-statistical-learning-by-trevor-hastie-and-robert-tibshirani.-examples-in-their-online-video-lectures-are-abundant-and-easy-to-understand-for-beginners.-their-book-is-also-very-helpful." class="level1">
<h1>Also, thanks to the course of “Introduction to statistical learning” by Trevor Hastie and Robert Tibshirani. Examples in their online video lectures are abundant and easy to understand for beginners. Their book is also very helpful.</h1>
</section>
<section id="review-and-introduce-probability" class="level1">
<h1>Review and Introduce Probability</h1>
<section id="simple-random-sampling" class="level2">
<h2 class="anchored" data-anchor-id="simple-random-sampling">Simple Random Sampling</h2>
<p>We can get information about the population by taking a sample from it. The sample should be representative of the population.</p>
<p>A simple random sample of size n is a sample selected from a population in such a way that every possible sample of size n has the same chance of being selected and without replacement.</p>
</section>
<section id="unbiased-estimator" class="level2">
<h2 class="anchored" data-anchor-id="unbiased-estimator">Unbiased estimator</h2>
<p>An estimator is a statistic used to estimate a population parameter. An estimator is unbiased if the expected value of the estimator equals the population parameter.</p>
<p><span class="math inline">\(E(\hat \theta) = \theta\)</span></p>
<p>where <span class="math inline">\(\hat \theta\)</span> is the estimator and <span class="math inline">\(\theta\)</span> is the population parameter.</p>
<p>eg.</p>
<p><span class="math display">\[
\mathbb{E}[\hat{p}]=\mathbb{E}\left[\frac{X_1+X_2+\cdots+X_n}{n}\right]=\frac{1}{n}\left(\mathbb{E}\left[X_1\right]+\cdots+\mathbb{E}\left[X_n\right]\right)=p
\]</span></p>
</section>
<section id="variance" class="level2">
<h2 class="anchored" data-anchor-id="variance">Variance</h2>
<p><span class="math display">\[
\operatorname{Var}[X]=\mathbb{E}\left[X^2\right]-(\mathbb{E}[X])^2
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}\left[\hat{p}^2\right] &amp; =\mathbb{E}\left[\left(\frac{X_1+X_2+\cdots+X_n}{n}\right)^2\right] \\
&amp; =\frac{1}{n^2} \mathbb{E}\left[X_1^2+\cdots+X_n^2+2\left(X_1 X_2+X_1 X_3+\cdots+X_{n-1} X_n\right)\right] \\
&amp; =\frac{1}{n^2}\left(n \mathbb{E}\left[X_1^2\right]+2\binom{n}{2} \mathbb{E}\left[X_1 X_2\right]\right) \\
&amp; =\frac{1}{n} \mathbb{E}\left[X_1^2\right]+\frac{n-1}{n} \mathbb{E}\left[X_1 X_2\right]
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\mathbb{E}\left[\hat{p}^2\right]=\frac{1}{n} \mathbb{E}\left[X_1^2\right]+\frac{n-1}{n} \mathbb{E}\left[X_1 X_2\right]
\]</span></p>
<p>Since <span class="math inline">\(X_1\)</span> is 0 or <span class="math inline">\(1, X_1=X_1^2\)</span>. Then <span class="math inline">\(\mathbb{E}\left[X_1^2\right]=\mathbb{E}\left[X_1\right]=p\)</span>.</p>
<p>Notice: <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are not independent.</p>
<p><span class="math display">\[
\mathbb{E}\left[X_1 X_2\right]=\mathbb{P}\left[X_1=1, X_2=1\right]=\mathbb{P}\left[X_1=1\right] \mathbb{P}\left[X_2=1 \mid X_1=1\right]
\]</span></p>
<p><span class="math display">\[
\mathbb{P}\left[X_1=1\right]=p, \quad \mathbb{P}\left[X_2=1 \mid X_1=1\right]=\frac{N p-1}{N-1}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\operatorname{Var}[\hat{p}] &amp; =\mathbb{E}\left[\hat{p}^2\right]-(\mathbb{E}[\hat{p}])^2 \\
&amp; =\frac{1}{n} p+\frac{n-1}{n} p\left(\frac{N p-1}{N-1}\right)-p^2 \\
&amp; =\left(\frac{1}{n}-\frac{n-1}{n} \frac{1}{N-1}\right) p+\left(\frac{n-1}{n} \frac{N}{N-1}-1\right) p^2 \\
&amp; =\frac{N-n}{n(N-1)} p+\frac{n-N}{n(N-1)} p^2 \\
&amp; =\frac{p(1-p)}{n} \frac{N-n}{N-1}=\frac{p(1-p)}{n}\left(1-\frac{n-1}{N-1}\right)
\end{aligned}
\]</span> When N is much bigger than n, it is <span class="math inline">\(\frac{p(1-p)}{n}\)</span>, which is like we sample n things with replacement (independently).</p>
</section>
<section id="sampling-distribution" class="level2">
<h2 class="anchored" data-anchor-id="sampling-distribution">Sampling distribution</h2>
<p>The sampling distribution of a statistic is the probability distribution of that statistic based on a random sample.</p>
<section id="sample-mean-of-i.i.d.-normals" class="level3">
<h3 class="anchored" data-anchor-id="sample-mean-of-i.i.d.-normals">Sample mean of i.i.d. normals</h3>
<p>Sample mean follows a normal distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>.</p>
</section>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<p>Below codes explains the central limit theorem (CLT) and the sampling distribution of the sample proportion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>population_size <span class="ot">&lt;-</span> <span class="dv">12141897</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.54</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p_hat_values <span class="ot">&lt;-</span> <span class="fu">replicate</span>(num_simulations, {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate sampling from the population</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,population_size <span class="sc">*</span> p), <span class="fu">rep</span>(<span class="dv">0</span>,population_size<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))),sample_size, <span class="at">replace =</span><span class="cn">FALSE</span>) <span class="co"># replicate(num_simulations, {...})：这个函数会重复执行大括号中的代码num_simulations次，并将每次的结果存储在一个向量中； rep创建一个包含population_size * p个1和population_size * (1-p)个0的向量，模拟总体。</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sample) <span class="co">#calculate the p_hat for each sample</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">p =</span> p_hat_values), <span class="fu">aes</span>(<span class="at">x=</span>p))<span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">fill =</span><span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span><span class="st">" "</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"p_hat"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(histogram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="moment-generating-functions" class="level2">
<h2 class="anchored" data-anchor-id="moment-generating-functions">Moment generating functions</h2>
<p>Moment generating function (MGF) and characteristic function are powerful functions that describe the underlying features of a random variable.</p>
<section id="definition" class="level3">
<h3 class="anchored" data-anchor-id="definition">Definition</h3>
<p><span class="math inline">\(M_x(t) = \mathbb E (e^{tx})\)</span></p>
</section>
<section id="theorems-about-mgf" class="level3">
<h3 class="anchored" data-anchor-id="theorems-about-mgf">Theorems about MGF</h3>
<ol type="1">
<li>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are random variables with the same MGF, which is finite on <span class="math inline">\(\left[-t_0, t_0\right]\)</span> for some <span class="math inline">\(t_0&gt;0\)</span>, then <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have the same distribution.</li>
</ol>
<p><strong>MGFs can be used as a tool to determine if two random variables have the identical CDF.</strong></p>
<ol start="2" type="1">
<li>Let <span class="math inline">\(X_1, \cdots, X_n\)</span> be independent random variables, with MGFs <span class="math inline">\(M_{X_1}, \cdots, M_{X_n}\)</span>. Then the MGF of their sum is given by <span class="math display">\[
M_{X_1+\cdots+X_n}(t)=M_{X_1}(t) \cdots M_{X_n}(t)
\]</span></li>
</ol>
<section id="example-of-gamma-and-exponential-mgf" class="level4">
<h4 class="anchored" data-anchor-id="example-of-gamma-and-exponential-mgf">Example of Gamma and Exponential MGF</h4>
<p>A gamma distribution with shape <span class="math inline">\(r=1\)</span> is an exponential distribution. If <span class="math inline">\(X \sim \operatorname{Gamma}\left(r_X, \lambda\right)\)</span> and <span class="math inline">\(Y \sim \operatorname{Gamma}\left(r_Y, \lambda\right)\)</span> are independent, then we have <span class="math inline">\(X+Y \sim \operatorname{Gamma}\left(r_X+r_Y, \lambda\right)\)</span>. As a special case, if <span class="math inline">\(X_1, X_2, \cdots, X_n\)</span> are i.i.d. with <span class="math inline">\(\operatorname{Exp}(\lambda)\)</span> distribution, then <span class="math inline">\(X_1+X_2+\cdots+X_n\)</span> has <span class="math inline">\(\operatorname{Gamma}(n, \lambda)\)</span> distribution.</p>
<p>Suppose <span class="math inline">\(X \sim \operatorname{Exp}(\lambda)\)</span>, for <span class="math inline">\(\lambda&gt;0\)</span>. Then <span class="math display">\[
M_X(t)=\mathbb{E}\left[e^{t X}\right]=\int_0^{\infty} e^{t x} \lambda e^{-\lambda x} d x=\lambda \int_0^{\infty} e^{(t-\lambda) x} d x
\]</span></p>
<p>Similar to Gamma MGF, the integral of Exponential MGF converges only for <span class="math inline">\(t&lt;\lambda\)</span>. For <span class="math inline">\(t&lt;\lambda\)</span>, we can integrate: <span class="math display">\[
M_X(t)=\lambda\left[\frac{e^{(t-\lambda) x}}{t-\lambda}\right]_0^{\infty}=\frac{\lambda}{\lambda-t}
\]</span></p>
<p>Since the Gamma MGF is <span class="math inline">\(M_X(t)=\frac{\lambda^r}{(\lambda-t)^r}\)</span> for any <span class="math inline">\(t&lt;\lambda\)</span> For shape <span class="math inline">\(r=1\)</span>, Exponential MGF = Gamma MGF.</p>
</section>
</section>
</section>
<section id="distribution-transformation" class="level2">
<h2 class="anchored" data-anchor-id="distribution-transformation">Distribution Transformation</h2>
<section id="universality-of-the-uniformfrom-uniform-you-can-get-everything" class="level3">
<h3 class="anchored" data-anchor-id="universality-of-the-uniformfrom-uniform-you-can-get-everything">Universality of the Uniform—From uniform you can get everything</h3>
<p>Let u~unif(0,1), F be a CDF(assume F is strictly increased, continuous). Then there comes a theorem: <span class="math display">\[
x = F^{-1}(u)
\]</span> Then <span class="math display">\[
X \sim F
\]</span> (Proof: <span class="math display">\[
P(X\leq x)=P(F^{-1}(u)\leq x)=P(F(F^{-1}(u))\leq F(x))=P(u\leq F(x))=F(x)
\]</span>)</p>
<p>You can convert from the random uniforms to whatever you want to simulate. One example is the simulation of Logistic distribution: F(X)=<span class="math inline">\(e^x\)</span>/(<span class="math inline">\(1+e^x\)</span>)</p>
<p>u~unif(0,1), <span class="math display">\[
X = F^{-1}(u)=log(u/1-u)
\]</span>&nbsp;and X~F</p>
<p>Another example is that we could try to use uniform to simulate normal distribution:</p>
<p>The Box-Muller transform generates pairs of independent standard normally distributed (zero mean, unit variance) random numbers, given a source of uniformly distributed random numbers.</p>
<p>Given two independent random variables <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> that are uniformly distributed on the interval (0, 1), we can generate two independent standard normal random variables <span class="math inline">\(Z_0\)</span> and <span class="math inline">\(Z_1\)</span> using the following formulas:</p>
<p><span class="math display">\[
Z_0 = \sqrt{-2 \ln U_1} \cos(2 \pi U_2)
\]</span></p>
<p><span class="math display">\[
Z_1 = \sqrt{-2 \ln U_1} \sin(2 \pi U_2)
\]</span></p>
<p>Inversely, the example could be: let <span class="math inline">\(Z_0\)</span> and <span class="math inline">\(Z_1\)</span> be standard normal random variables with the following values: <span class="math inline">\(Z_0\)</span> = 0.5 and <span class="math inline">\(Z_1\)</span> = -1.0.</p>
<ol type="1">
<li><p><strong>Compute CDF values</strong>:</p>
<p>For standard normal distribution, the CDF <span class="math display">\[ \Phi(z) \]</span> is given by:</p>
<p><span class="math display">\[
\Phi(z) = \frac{1}{2} \left[ 1 + \text{erf} \left( \frac{z}{\sqrt{2}} \right) \right]
\]</span></p>
<p>(ps:<span class="math display">\[
\text{erf}(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} \, dt
\]</span>)</p>
<ul>
<li><p>For <span class="math display">\[ Z_0 = 0.5 \]</span>:</p>
<p><span class="math display">\[
\Phi(0.5) = \frac{1}{2} \left[ 1 + \text{erf} \left( \frac{0.5}{\sqrt{2}} \right) \right]
\]</span></p></li>
<li><p>For <span class="math display">\[ Z_1 = -1.0 \]</span>:</p>
<p><span class="math display">\[
\Phi(-1.0) = \frac{1}{2} \left[ 1 + \text{erf} \left( \frac{-1.0}{\sqrt{2}} \right) \right]
\]</span></p></li>
</ul></li>
<li><p><strong>Compute Uniform values</strong>:</p>
<p>Since the CDF values <span class="math display">\[ \Phi(Z_0) \]</span> and <span class="math display">\[ \Phi(Z_1) \]</span> are in the range [0, 1], we can directly use them as uniform random variables <span class="math inline">\(U_0\)</span> and <span class="math inline">\(U_1\)</span>.</p>
<ul>
<li><span class="math display">\[U_0 = \Phi(0.5)\]</span></li>
<li><span class="math display">\[U_1 = \Phi(-1.0)\]</span></li>
</ul></li>
<li><p><strong>Result</strong>:</p>
<ul>
<li>Using the error function values:
<ul>
<li><span class="math display">\[ \Phi(0.5) \approx 0.6915 \]</span></li>
<li><span class="math display">\[ \Phi(-1.0) \approx 0.1587 \]</span></li>
</ul></li>
</ul>
<p>Thus, the corresponding uniform distribution values are:</p>
<ul>
<li><span class="math display">\[ U_0 \approx 0.6915 \]</span></li>
<li><span class="math display">\[ U_1 \approx 0.1587 \]</span></li>
</ul></li>
</ol>
<p>Another example is that we can create a function that has good quality as F in the theorem, for example, <span class="math display">\[
u=F(x)=1-e^{-x}          (x&gt;0)
\]</span> then we can simulate X~F:X=-ln(1-u)~F</p>
<p>Also, if <span class="math display">\[
X \sim F
\]</span></p>
<p>Then, <span class="math display">\[
F(x) \sim unif(0,1)
\]</span> e.g.&nbsp;let X~F, if<span class="math display">\[
F(x_0)=1/3\]</span> then <span class="math display">\[P(F(X)\leq 1/3)=P(X\leq x_0)=F(x_0)=1/3 \]</span> which follows the uniform distribution(0,1) because 1/3 generates 1/3. (Uniform distribution: Probability(CDF) is proportional to length)</p>
</section>
<section id="normal-distribution" class="level3">
<h3 class="anchored" data-anchor-id="normal-distribution">Normal Distribution</h3>
<section id="from-standard-normal-distribution-to-normal-distribution" class="level4">
<h4 class="anchored" data-anchor-id="from-standard-normal-distribution-to-normal-distribution">From Standard Normal Distribution to Normal Distribution</h4>
<p><span class="math inline">\(f(z)=ce^{-z^2/2}\)</span> is a function with good qualities such as symmetric……..</p>
<p>To generate normalization constant c using CDF=1, instead of using impossible integral methods to compute it we should try to find the area under it. In that case, we transfer the integral shape to the double integral’s multiplication then we get c: <span class="math display">\[
\int_{-\infty}^{\infty}\exp(-z^2/2) dz=\int_{-\infty}^{\infty}\exp(-z^2/2) dz=\int_{-\infty}^{\infty}\exp(-x^2/2)dx\int_{-\infty}^{\infty}\exp(-y^2/2)dy
\]</span> <span class="math display">\[
=\int_{0}^{\infty}\exp(-r^2/2)r dr\int_{0}^{2π} d\theta\ =\sqrt2\pi\
\]</span> So <span class="math display">\[
c=1/\sqrt2\pi\
\]</span> …….</p>
</section>
</section>
<section id="from.." class="level3">
<h3 class="anchored" data-anchor-id="from..">From…..</h3>
<p>111</p>
<section id="exponential-distribution" class="level4">
<h4 class="anchored" data-anchor-id="exponential-distribution">Exponential distribution</h4>
<p>the only one parameter is the rate parameter. The probability density function (pdf) of an exponential distribution with rate parameter (&gt; 0) is given by:</p>
<p><span class="math display">\[
f_X(x) =
\begin{cases}
\lambda e^{-\lambda x} &amp; \text{for } x \geq 0, \\
0 &amp; \text{for } x &lt; 0.
\end{cases}
\]</span> The cumulative distribution function (cdf) of an exponential distribution with rate parameter (&gt; 0) is given by:</p>
<p><span class="math display">\[
F_X(x) =
\begin{cases}
1 - e^{-\lambda x} &amp; \text{for } x \geq 0, \\
0 &amp; \text{for } x &lt; 0.
\end{cases}
\]</span> 2.Let Y~x, then Y ~Expo(1)</p>
<p>proof: since <span class="math display">\[
P(Y\leq y)=P(X\leq y/\lambda)=1-e^{-y}
\]</span> (just plot it into x) and we could check that E[X]=Var[X]=1, so X=Y/<span class="math inline">\(\lambda\)</span> has E[x]=1/<span class="math inline">\(\lambda\)</span>, Var[x]=1/<span class="math inline">\(\lambda^2\)</span></p>
<p>e.g.&nbsp;Memoryless Property(This property implies that the remaining lifetime distribution does not depend on how much time has already elapsed.)(The exponential distribution is the only continuous distribution that has the memoryless property):<span class="math display">\[ P(X\geq s+t|X\geq s)=P(X\geq t)\]</span> which is actually satisfied by the exponential and we could prove it(though it intuitively makes sence): Here <span class="math display">\[
P(X\geq s)=1-P(X\leq s)=e^{-\lambda s}
\]</span> <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{P(X \geq s+t \text { and } X \geq s)}{P(X \geq s)}
\]</span></p>
<p>Since <span class="math inline">\(X \geq s+t\)</span> implies <span class="math inline">\(X \geq s\)</span>, we can simplify the numerator: <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{P(X \geq s+t)}{P(X \geq s)}
\]</span></p>
<p>Now, substitute the survival function for the exponential distribution: <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{e^{-\lambda(s+t)}}{e^{-\lambda s}}
\]</span></p>
<p>Simplify the expression: <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{e^{-\lambda s} \cdot e^{-\lambda t}}{e^{-\lambda s}}=e^{-\lambda t}
\]</span></p>
<p>Notice that <span class="math inline">\(e^{-\lambda t}=P(X \geq t)\)</span> : <span class="math display">\[
P(X \geq s+t \mid X \geq s)=P(X \geq t)
\]</span> usefulness of it: <span class="math display">\[
X\sim Expo(\lambda),E(X|X&gt;a)=a+E(X-a|X&gt;a)=a+1/\lambda
\]</span></p>
<p>e.g.2The hazard rate (or failure rate) for an exponential distribution is constant over time. For an exponential random variable <span class="math inline">\(X\)</span> with rate parameter <span class="math inline">\(\lambda\)</span>, the hazard rate is: <span class="math display">\[
h(t)=\frac{f_X(t)}{1-F_X(t)}=\lambda .
\]</span></p>
<p>A constant hazard rate implies that the event is equally likely to occur at any point in time, which is a reasonable assumption for many processes, such as the lifetime of certain electronic components or the occurrence of certain types of random failures.</p>
<p>e.g.3 The exponential distribution is closely related to the Poisson process, which is a process that models the occurrence of events happening independently at a constant average rate. If the times between consecutive events in a Poisson process are independent and identically distributed, then these interarrival times follow an exponential distribution. This relationship makes the exponential distribution a natural choice in contexts where events occur randomly over time, such as phone calls arriving at a switchboard or buses arriving at a bus stop.</p>
</section>
<section id="ga" class="level4">
<h4 class="anchored" data-anchor-id="ga">Ga</h4>
<p>If r.v.X~N(0,1), then <span class="math inline">\(X^2\)</span>~<span class="math inline">\(Ga\)</span>(1/2,1/2)</p>
<p>Proof: If r.v. (X N(0,1)), then (X^2 (, ))</p>
<p>Let (X) be a random variable such that (X N(0,1)).</p>
<p>The probability density function (pdf) of (X) is: <span class="math display">\[
f_X(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}, \quad -\infty &lt; x &lt; \infty.
\]</span></p>
<p>First, we find the pdf of (Y = X^2).</p>
<p>The cumulative distribution function (CDF) of (Y) is given by: <span class="math display">\[
F_Y(y) = P(Y \leq y) = P(X^2 \leq y).
\]</span></p>
<p>Since (X^2 ), we only consider (y ): <span class="math display">\[
F_Y(y) = P(-\sqrt{y} \leq X \leq \sqrt{y}).
\]</span></p>
<p>Using the CDF of the normal distribution, we have: <span class="math display">\[
F_Y(y) = \int_{-\sqrt{y}}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \, dx.
\]</span></p>
<p>The pdf of (Y) is the derivative of the CDF: <span class="math display">\[
f_Y(y) = \frac{d}{dy} F_Y(y).
\]</span></p>
<p><span class="math display">\[
F_Y(y) = 2 \int_{0}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \, dx.
\]</span></p>
<p><span class="math display">\[
F_Y(y) = 2 \int_{0}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{-u} \frac{du}{\sqrt{2u}} = \frac{2}{\sqrt{2\pi}} \int_{0}^{\sqrt{y}} e^{-u} \frac{du}{\sqrt{2u}}.
\]</span></p>
<p>Thus, <span class="math display">\[
f_Y(y) = \frac{d}{dy} \left( \frac{2}{\sqrt{2\pi}} \int_{0}^{\sqrt{y}} e^{-u} \frac{du}{\sqrt{2u}} \right).
\]</span></p>
<p>Differentiating with respect to y gives: <span class="math display">\[
f_Y(y) = \frac{1}{\sqrt{2\pi}} \cdot e^{-\frac{y}{2}} \cdot y^{-\frac{1}{2}}.
\]</span></p>
<p>Simplifying, we get: <span class="math display">\[
f_Y(y) = \frac{1}{\sqrt{2\pi}} y^{-\frac{1}{2}} e^{-\frac{y}{2}}.
\]</span></p>
<p><span class="math display">\[
Y = X^2 \sim \text{Ga}\left(\frac{1}{2}, \frac{1}{2}\right).
\]</span></p>
</section>
<section id="chi-square" class="level4">
<h4 class="anchored" data-anchor-id="chi-square">Chi-square</h4>
<p>Chi-square is a</p>
<p>1.Let ( <span class="math inline">\(Z_1\)</span>, <span class="math inline">\(Z_2\)</span>, , <span class="math inline">\(Z_i\)</span> ) are independent standard normal random variables(i.e.&nbsp;Z~N(0,1)), then the random variable ( X ) defined by</p>
<p><span class="math display">\[
X = Z_1^2 + Z_2^2 + \cdots + Z_i^2
\]</span> (<span class="math inline">\(Z_j\)</span>~iid.N(0,1))</p>
<p>follows a chi-square distribution with ( i ) degrees of freedom. So chi-square of 1 is the same thing as Gamma of (1/2,1/2) so chi-square of n is Gamma(n/2,1/2)</p>
<p>2.If <span class="math display">\[
Z_i = \frac{x_i - \mu}{\sigma}
\]</span> The sum of squared standardized deviations is:</p>
<p><span class="math display">\[
\sum_{i=1}^n Z_i^2 = \sum_{i=1}^n \left( \frac{x_i - \mu}{\sigma} \right)^2 = \frac{1}{\sigma^2} \sum_{i=1}^n (x_i - \mu)^2
\]</span></p>
<p>Let <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> be samples of <span class="math inline">\(N\left(\mu, \sigma^2\right)\)</span> , <span class="math inline">\(\mu\)</span> is a known constant, find the distribution of statistics: <span class="math display">\[
T=\sum_{i=1}^n\left(x_i-\mu\right)^2
\]</span></p>
<p>sol: <span class="math inline">\(y_i=\left(x_i-\mu\right) / \sigma, i=1,2, \cdots, n\)</span>, 则 <span class="math inline">\(y_1, y_2, \cdots, y_n\)</span> are iid r.v. of <span class="math inline">\(N(0,1)\)</span>,so<span class="math display">\[
\frac{T}{\sigma^2}=\sum_{i=1}^n\left(\frac{x_i-\mu}{\sigma}\right)^2=\sum_{i=1}^n y_i^2 \sim \chi^2(n),
\]</span> (i.e.<span class="math display">\[
\sum_{i=1}^n Z_i^2 {\sigma^2}\sim \chi^2(n)\]</span>)</p>
<p>Besides, <span class="math inline">\(T\)</span>’s PDF is <span class="math display">\[
p(t)=\frac{1}{\left(2 \sigma^2\right)^{n / 2} \Gamma(n / 2)} \mathrm{e}^{-\frac{1}{2 \sigma^2} t^{\frac{n}{2}}-1}, \quad t&gt;0,
\]</span></p>
<p>which is Gamma distribution <span class="math inline">\(G a\left(\frac{n}{2}, \frac{1}{2 \sigma^2}\right) \cdot\)</span></p>
<p>3.chi-square is uesful because of theorems below:let <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> are samples from <span class="math inline">\(N\left(\mu, \sigma^2\right)\)</span> , whose sample mean and sample variance are<span class="math display">\[
\bar{x}=\frac{1}{n} \sum_{i=1}^n x_i \text { and } s^2=\frac{1}{n-1} \sum_{i=1}^n\left(x_i-\bar{x}\right)^2,
\]</span></p>
<p>then we can get: (1) <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(s^2\)</span> are independent; (2) <span class="math inline">\(\bar{x} \sim N\left(\mu, \sigma^2 / n\right)\)</span>; (3) <span class="math inline">\(\frac{(n-1) s^2}{\sigma^2} \sim \chi^2(n-1)\)</span>.</p>
<p>Proof: <span class="math display">\[
p\left(x_1, x_2, \cdots, x_n\right)=\left(2 \pi \sigma^2\right)^{-n / 2} \mathrm{e}^{-\sum_{i=1}^n \frac{\left(x_i-\mu\right)^2}{2 \sigma^2}}=\left(2 \pi \sigma^2\right)^{-n / 2} \exp \left\{-\frac{\sum_{i=1}^n x_i^2-2 n \bar{x} \mu+n \mu^2}{2 \sigma^2}\right\}
\]</span></p>
<p>denote<span class="math inline">\(\boldsymbol{X}=\left(x_1, x_2, \cdots, x_n\right)^{\mathrm{T}}\)</span>, then we create an <span class="math inline">\(n\)</span>-dimension orthogonal <span class="math inline">\(\boldsymbol{A}\)</span> and every element in the first row is <span class="math inline">\(1 / \sqrt{n}\)</span>, such as <span class="math display">\[
A=\left(\begin{array}{ccccc}
\frac{1}{\sqrt{n}} &amp; \frac{1}{\sqrt{n}} &amp; \frac{1}{\sqrt{n}} &amp; \cdots &amp; \frac{1}{\sqrt{n}} \\
\frac{1}{\sqrt{2 \cdot 1}} &amp; -\frac{1}{\sqrt{2 \cdot 1}} &amp; 0 &amp; \cdots &amp; 0 \\
\frac{1}{\sqrt{3 \cdot 2}} &amp; \frac{1}{\sqrt{3 \cdot 2}} &amp; -\frac{2}{\sqrt{3 \cdot 2}} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; &amp; \vdots \\
\frac{1}{\sqrt{n(n-1)}} &amp; \frac{1}{\sqrt{n(n-1)}} &amp; \frac{1}{\sqrt{n(n-1)}} &amp; \cdots &amp; -\frac{n-1}{\sqrt{n(n-1)}}
\end{array}\right),
\]</span> 令 <span class="math inline">\(\boldsymbol{Y}=\left(y_1, y_2, \cdots, y_n\right)^{\mathrm{T}}=\boldsymbol{A} \boldsymbol{X}\)</span>, <span class="math inline">\(|Jacobi|=1\)</span>, and we can find thatt<span class="math display">\[
\begin{gathered}
\bar{x}=\frac{1}{\sqrt{n}} y_1, \\
\sum_{i=1}^n y_i^2=\boldsymbol{Y}^{\mathrm{T}} \boldsymbol{Y}=\boldsymbol{X}^{\mathrm{T}} \boldsymbol{A}^{\mathrm{T}} \boldsymbol{A} \boldsymbol{X}=\sum_{i=1}^n x_i^2,
\end{gathered}
\]</span></p>
<p>so<span class="math inline">\(y_1, y_2, \cdots, y_n\)</span> ’s joint density function is <span class="math display">\[
\begin{aligned}
p\left(y_1, y_2, \cdots, y_n\right) &amp; =\left(2 \pi \sigma^2\right)^{-n / 2} \exp \left\{-\frac{\sum_{i=1}^n y_i^2-2 \sqrt{n} y_1 \mu+n \mu^2}{2 \sigma^2}\right\} \\
&amp; =\left(2 \pi \sigma^2\right)^{-n / 2} \exp \left\{-\frac{\sum_{i=2}^n y_i^2+\left(y_1-\sqrt{n} \mu\right)^2}{2 \sigma^2}\right\}
\end{aligned}
\]</span></p>
<p>So, <span class="math inline">\(\boldsymbol{Y}=\left(y_1, y_2, \cdots, y_n\right)^{\mathrm{T}}\)</span> independently distributed as normal distribution and their variances are all equal to<span class="math inline">\(\sigma^2\)</span>, but their means are not all the same because <span class="math inline">\(y_2, \cdots, y_n\)</span> ’s means are <span class="math inline">\(0, y_1\)</span>’s is <span class="math inline">\(\sqrt{n} \mu\)</span>, which ends our proof of (2). <span class="math display">\[
(n-1) s^2=\sum_{i=1}^n\left(x_i-\bar{x}\right)^2=\sum_{i=1}^n x_i^2-(\sqrt{n} \bar{x})^2=\sum_{i=1}^n y_i^2-y_1^2=\sum_{i=2}^n y_i^2,
\]</span></p>
<p>This proves conclusion (1). Since <span class="math inline">\(y_2, \cdots, y_n\)</span> are independently and identically distributed as <span class="math inline">\(N\left(0, \sigma^2\right)\)</span>, we have: <span class="math display">\[
\frac{(n-1) s^2}{\sigma^2}=\sum_{i=2}^n\left(\frac{y_i}{\sigma}\right)^2 \sim \chi^2(n-1) .
\]</span></p>
<p>Theorem is proved. (similar to the proof above this maybe easier to understand:<span class="math inline">\(\begin{aligned} &amp; i z\left(Y_1, Y_2, \cdots, Y_2\right)^{\top}=A\left(X_1, \cdots, x_n\right)^{\top} \\ &amp; \text { then } \sum_{i=1}^n Y_i^2=\left(Y_1, \cdots, Y_n\right)\left(Y_1, \cdots, Y_n\right)^{\top} \\ &amp; =\left[A\left(x_1, \cdots, x_n\right)^{\top}\right]^{\top}\left[A\left(x_1, \cdots, X_n\right)^{\top}\right] \\ &amp; =\left(x_1, \cdots, x_n\right) A^{\top} A\left(x_1, \cdots, x_n\right)^{\top} \\ &amp; =\left(x_1, \cdots, x_n\right) E\left(x_1, \cdots, x_n\right)^{\top}=\sum_{i=1}^n x_i^2 \\ &amp; \end{aligned}\)</span>) <span class="math inline">\(\begin{aligned} &amp; \text { besides } Y_1=\frac{1}{\sqrt{n}} x_1+\cdots+\frac{1}{\sqrt{n}} x_n=\frac{1}{\sqrt{n}} \sum_{i=1}^n X_i \\ &amp; \text { and } Y_1=\sqrt{n} \cdot \frac{1}{n} \sum_{i=1}^n X_i=\sqrt{n} \bar{X}, \text { then } \bar{x}=\frac{1}{\sqrt{n}} y_i \\ &amp; B S^2=\frac{1}{n-1} \sum_{i=1}^n\left(x_i-\bar{x}\right)^2=\frac{1}{n-1}\left[\sum_{i=1}^n x_i^2-n \bar{x}^2\right] \\ &amp; =\frac{1}{n-1}\left[\sum_{i=1}^n Y_i^2-Y_1^2\right]=\frac{1}{n-1} \sum_{i=2}^n Y_i^2 \\ &amp; 2 \oplus L=(\sqrt{2 \pi} \sigma)^{-n} \exp \left[-\frac{1}{2 \sigma^2} \sum_{i=1}^n\left(x_i-\mu\right)^2\right] \text {. } \\ &amp; =(\sqrt{2 \pi} \sigma)^{-n} \exp \left[-\frac{1}{2 \sigma^2}\left(\sum_{i=1}^n x_i^2-2 \mu n \bar{x}+\mu^2 n\right]\right. \\ &amp; =(\sqrt{2 \pi} \sigma)^{-n} \exp \left[-\frac{1}{2 \sigma^2}\left(\sum_{1=1}^n y_i{ }^2-2 \mu n \frac{1}{\sqrt{n}} Y_1+n \mu^2\right]\right. \\ &amp; \end{aligned}\)</span> <span class="math display">\[=(\sqrt2\pi\sigma)^{-1}exp[-1/2\sigma^2(Y_1-\sqrt nu)^2]×(\sqrt2\pi\sigma)^{-1}exp[-1/2\sigma^2{Y_2}^2]*...*(\sqrt2\pi\sigma)^{-1}exp[-1/2\sigma^2{Y_n}^2]
\]</span></p>
<p>So L is <span class="math inline">\(Y_1\)</span>…<span class="math inline">\(Y_n\)</span>’s joint density function and so they are independent. Besides, we have proved that its mean is <span class="math inline">\(1/\sqrt n\)</span><span class="math inline">\(Y_1\)</span> and <span class="math inline">\(S^2\)</span>=<span class="math inline">\(1/n-1 \Sigma{i=2}Y_i^2\)</span>, so the normal distribution’s mean and variance are independent.</p>
<p>When the random variable <span class="math inline">\(\chi^2 \sim \chi^2(n)\)</span>, for a given <span class="math inline">\(\alpha\)</span> (where <span class="math inline">\(0&lt;\)</span> <span class="math inline">\(\alpha&lt;1\)</span> ), the value <span class="math inline">\(\chi_{1-\alpha}^2(n)\)</span> satisfying the probability equation <span class="math inline">\(P\left(\chi^2 \leqslant \chi_{1-\alpha}^2(n)\right)=1-\)</span> <span class="math inline">\(\alpha\)</span> is called the <span class="math inline">\(1-\alpha\)</span> quantile of the <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(n\)</span> degrees of freedom.</p>
<p>Suppose the random variables <span class="math inline">\(X_1 \sim \chi^2(m)\)</span> and <span class="math inline">\(X_2 \sim \chi^2(n)\)</span>, and <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are independent. Then the distribution of <span class="math inline">\(F=\frac{X_1 / m}{X_2 / n}\)</span> is called the <span class="math inline">\(\mathrm{F}\)</span> distribution with <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> degrees of freedom, denoted as <span class="math inline">\(F \sim F(m, n)\)</span>. Here, <span class="math inline">\(m\)</span> is called the numerator degrees of freedom and <span class="math inline">\(n\)</span> the denominator degrees of freedom. We derive the density function of the <span class="math inline">\(\mathrm{F}\)</span> distribution in two steps. First, we derive the density function of <span class="math inline">\(Z=\frac{X_1}{X_2}\)</span>. Let <span class="math inline">\(p_1(x)\)</span> and <span class="math inline">\(p_2(x)\)</span> be the density functions of <span class="math inline">\(\chi^2(m)\)</span> and <span class="math inline">\(\chi^2(n)\)</span> respectively. According to the formula for the distribution of the quotient of independent random variables, the density function of <span class="math inline">\(Z\)</span> is: <span class="math display">\[
\begin{gathered}
p_Z(z)=\int_0^{\infty} x_2 p_1\left(z x_2\right) p_2\left(x_2\right) \mathrm{d} x_2 \\
=\frac{z^{\frac{m}{2}-1}}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right) 2^{\frac{m+n}{2}}} \int_0^{\infty} x_2^{\frac{n}{2}-1} e^{-\frac{x_2}{2}(1+z)} \mathrm{d} x_2 .
\end{gathered}
\]</span></p>
<p>Using the transformation <span class="math inline">\(u=\frac{x_2}{2}(1+z)\)</span>, we get: <span class="math display">\[
p_Z(z)=\frac{z^{\frac{m}{2}-1}(1+z)^{-\frac{m+n}{2}}}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)} \int_0^{\infty} u^{\frac{n}{2}-1} e^{-u} \mathrm{~d} u
\]</span></p>
<p>The final integral is the gamma function <span class="math inline">\(\Gamma\left(\frac{n}{2}\right)\)</span>, so: <span class="math display">\[
p_Z(z)=\frac{\Gamma\left(\frac{m+n}{2}\right)}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)} z^{\frac{m}{2}-1}(1+z)^{-\frac{m+n}{2}}, \quad z \geq 0 .
\]</span></p>
<p>Second, we derive the density function of <span class="math inline">\(F=\frac{n}{m} Z\)</span>. Let the value of <span class="math inline">\(F\)</span> be <span class="math inline">\(y\)</span>. For <span class="math inline">\(y \geq 0\)</span>, we have: <span class="math display">\[
\begin{aligned}
p_F(y) &amp; =p_Z\left(\frac{m}{n} y\right) \cdot \frac{m}{n}=\frac{\Gamma\left(\frac{m+n}{2}\right)}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)}\left(\frac{m}{n} y\right)^{\frac{m}{2}-1}\left(1+\frac{m}{n} y\right)^{-\frac{m+n}{2}} \cdot \frac{m}{n} \\
&amp; =\frac{\Gamma\left(\frac{m+n}{2}\right)}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)}\left(\frac{m}{n}\right)\left(\frac{m}{n} y\right)^{\downarrow \frac{2}{2}-1}\left(1+\frac{m}{n} y\right)^{-\frac{m+n}{2}}
\end{aligned}
\]</span></p>
<p>When the random variable <span class="math inline">\(F \sim F(m, n)\)</span>, for a given <span class="math inline">\(\alpha\)</span> (where <span class="math inline">\(0&lt;\alpha&lt;1\)</span> ), the value <span class="math inline">\(F_{1-\alpha}(m, n)\)</span> satisfying the probability equation <span class="math inline">\(P\left(F \leqslant F_{1-\alpha}(m, n)\right)=1-\alpha\)</span> is called the <span class="math inline">\(1-\alpha\)</span> quantile of the <span class="math inline">\(\mathrm{F}\)</span> distribution with <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> degrees of freedom. By the construction of the <span class="math inline">\(\mathrm{F}\)</span> distribution, if <span class="math inline">\(F \sim F(m, n)\)</span>, then <span class="math inline">\(1 / F \sim F(n, m)\)</span>. Therefore, for a given <span class="math inline">\(\alpha\)</span> (where <span class="math inline">\(0&lt;\alpha&lt;1\)</span> ), <span class="math display">\[
\alpha=P\left(\frac{1}{F} \leqslant F_\alpha(n, m)\right)=P\left(F \geqslant \frac{1}{F_\alpha(n, m)}\right) .
\]</span></p>
<p>Thus, <span class="math display">\[
P\left(F \leqslant \frac{1}{F_\alpha(n, m)}\right)=1-\alpha
\]</span></p>
<p>This implies <span class="math display">\[
F_\alpha(n, m)=\frac{1}{F_{1-\alpha}(m, n)} .
\]</span></p>
<p>Corollary Suppose <span class="math inline">\(x_1, x_2, \cdots, x_m\)</span> is a sample from <span class="math inline">\(N\left(\mu_1, \sigma_1^2\right)\)</span> and <span class="math inline">\(y_1, y_2, \cdots, y_n\)</span> is a sample from <span class="math inline">\(N\left(\mu_2, \sigma_2^2\right)\)</span>, and these two samples are independent. Let: <span class="math display">\[
s_x^2=\frac{1}{m-1} \sum_{i=1}^m\left(x_i-\bar{x}\right)^2, \quad s_y^2=\frac{1}{n-1} \sum_{i=1}^n\left(y_i-\bar{y}\right)^2,
\]</span> where <span class="math display">\[
\bar{x}=\frac{1}{m} \sum_{i=1}^m x_i, \quad \bar{y}=\frac{1}{n} \sum_{i=1}^n y_i
\]</span> then <span class="math display">\[
F=\frac{s_x^2 / \sigma_1^2}{s_y^2 / \sigma_2^2} \sim F(m-1, n-1) .
\]</span></p>
<p>In particular, if <span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span>, then <span class="math inline">\(F=\frac{s_x}{s_y^2} \sim F(m-1, n-1)\)</span>. Proof: Since the two samples are independent, <span class="math inline">\(s_x^2\)</span> and <span class="math inline">\(s_y^2\)</span> are independent. According to a Theorem , we have <span class="math display">\[
\frac{(m-1) s_x^2}{\sigma_1^2} \sim \chi^2(m-1), \quad \frac{(n-1) s_y^2}{\sigma_2^2} \sim \chi^2(n-1) .
\]</span></p>
<p>By the definition of the <span class="math inline">\(\mathrm{F}\)</span> distribution, <span class="math inline">\(F \sim F(m-1, n-1)\)</span>. Corollary: Suppose <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> is a sample from a normal distribution <span class="math inline">\(N\left(\mu, \sigma^2\right)\)</span>, and let <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(s^2\)</span> denote the sample mean and sample variance of the sample, respectively. Then <span class="math display">\[
t=\frac{\sqrt{n}(\bar{x}-\mu)}{s} \sim t(n-1) .
\]</span></p>
<p>Proof: From a Theorem we obtain <span class="math display">\[
\frac{\bar{x}-\mu}{\sigma / \sqrt{n}} \sim N(0,1)
\]</span></p>
<p>Then, <span class="math display">\[
\frac{\sqrt{n}(\bar{x}-\mu)}{s}=\frac{\frac{\bar{x}-\mu}{\sigma / \sqrt{n}}}{\sqrt{\frac{(n-1) s^2 / \sigma^2}{n-1}}}
\]</span></p>
<p>Since the numerator is a standard normal variable and the denominator’s square root contains a <span class="math inline">\(\chi^2\)</span> variable with <span class="math inline">\(n-1\)</span> degrees of freedom divided by its degrees of freedom, and they are independent, by the definition of the <span class="math inline">\(t\)</span> distribution, <span class="math inline">\(t \sim t(n-1)\)</span>. The proof is complete.</p>
<p>Corollary: In the notation of Corollary , assume <span class="math inline">\(\sigma_1^2=\sigma_2^2=\sigma^2\)</span>, and let <span class="math display">\[
s_w^2=\frac{(m-1) s_x^2+(n-1) s_y^2}{m+n-2}=\frac{\sum_{i=1}^m\left(x_i-\bar{x}\right)^2+\sum_{i=1}^n\left(y_i-\bar{y}\right)^2}{m+n-2}
\]</span></p>
<p>Then <span class="math display">\[
\frac{(\bar{x}-\bar{y})-\left(\mu_1-\mu_2\right)}{s_w \sqrt{\frac{1}{m}+\frac{1}{n}}} \sim t(m+n-2)
\]</span></p>
<p>Proof: Since <span class="math inline">\(\bar{x} \sim N\left(\mu_1, \frac{\sigma^2}{m}\right), \bar{y} \sim N\left(\mu_2, \frac{\sigma^2}{n}\right)\)</span>, and <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> are independent, we have</p>
<p><span class="math display">\[
\bar{x}-\bar{y} \sim N\left(\mu_1-\mu_2,\left(\frac{1}{m}+\frac{1}{n}\right) \sigma^2\right) .
\]</span></p>
<p>Thus, <span class="math display">\[
\frac{(\bar{x}-\bar{y})-\left(\mu_1-\mu_2\right)}{\sigma \sqrt{\frac{1}{m}+\frac{1}{n}}} \sim N(0,1) .
\]</span></p>
<p>By a Theorem , we know that <span class="math inline">\(\frac{(m-1) s_x^2}{\sigma^2} \sim \chi^2(m-1)\)</span> and <span class="math inline">\(\frac{(n-1) s_y^2}{\sigma^2} \sim \chi^2(n-1)\)</span>, and they are independent. By additivity, we have <span class="math display">\[
\frac{(m+n-2) s_w^2}{\sigma^2}=\frac{(m-1) s_x^2+(n-1) s_y^2}{\sigma^2} \sim \chi^2(m+n-2) .
\]</span></p>
<p>Since <span class="math inline">\(\bar{x}-\bar{y}\)</span> and <span class="math inline">\(s_w^2\)</span> are independent, by the definition of the <span class="math inline">\(\mathrm{t}\)</span> distribution, we get the desired result. <span class="math inline">\(\square\)</span></p>
<p>One interesting example shows the relationship of above distributions used charismatically to solve problems: r.v.: <span class="math inline">\(X_1 ， X_2 ， X_3 ， X_4\)</span> indpendently identically distribute(iid) as <span class="math inline">\(N\left(0 . \sigma^2\right)\)</span>. <span class="math inline">\(Z=\left(x_1^2+x_2^2\right) /\left(x_1^2+x_2^2+x_3^2+x_4^2\right)\)</span> prove: <span class="math inline">\(Z \sim U(0.1)\)</span>. <span class="math display">\[
\begin{aligned}
&amp; \text { Solution: } Let Y=\frac{X_3^2+X_4^2}{X_1^2+X_2^2}=\frac{\left[\left(\frac{X_3}{\sigma}\right)^2+\left(\frac{X_4}{\sigma}\right)^2\right] / 2}{\left[\left(\frac{X_1}{\sigma}\right)^2+\left(\frac{X_2}{\sigma}\right)^2\right] / 2} \sim F(2,2) . \\
&amp; \text { i.e.  } f_Y(y)=\frac{1}{(1+y)^2},  y&gt;0 \\
&amp; \text { then } P(Z \leq z)=P\left(\frac{1}{1+Y} \leq z\right)=P\left(Y \geqslant \frac{1}{z}-1\right) \\
&amp; =\int_{\frac{1}{z}-1}^{+\infty} \frac{1}{(1+y)^2} d y=z \quad \text { H } 0&lt;z&lt;1 . \\
&amp; \therefore Z \sim U(0.1)
\end{aligned}
\]</span> (ps:$</p>
<span class="math display">\[\begin{aligned} &amp; f(x)=\frac{\Gamma\left(\frac{n_1+n_2}{2}\right)}{\Gamma\left(\frac{n_2}{2}\right) \Gamma\left(\frac{n_1}{2}\right)}\left(\frac{n_1}{n_2}\right)\left(\frac{n_1}{n_2} x\right)^{\frac{n_1}{2}-1}\left(1+\frac{n_1}{n_2} x\right)^{\frac{-1}{2}\left(n_1+n_2\right)} . \\ &amp; \text { of these } x&gt;0 \text {. and } E(x)=\frac{n_2}{n_2-2} \text {, when } n_2&gt;2 \text {. } \\ &amp; \operatorname{Var}(X)=\frac{2 n_2^2\left(n_1+n_2-2\right)}{n_1\left(n_2-2\right)^2\left(n_2-4\right)} \text {when $n_2&gt;4$. } \\ &amp; \end{aligned}\]</span>
<p><br>
</p>
</section>
</section>
</section>
<section id="pdf-functionss-transformationfrom-books" class="level2">
<h2 class="anchored" data-anchor-id="pdf-functionss-transformationfrom-books">PDF functions’s transformation(from books)</h2>
<section id="standard-normal-distribution" class="level3">
<h3 class="anchored" data-anchor-id="standard-normal-distribution">Standard normal distribution</h3>
<p>Pdf : <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span><br>
</p>
</section>
<section id="chi-square-distribution" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-distribution">Chi-square distribution</h3>
</section>
<section id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2" class="level3">
<h3 class="anchored" data-anchor-id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Chi-square distribution <span class="math inline">\(f(x; k) = \frac{1}{2^{k/2} \Gamma(k/2)} x^{k/2 - 1} e^{-x/2}\)</span><br>
</h3>
<p>Assuming that <span class="math inline">\(Z \sim N(0, 1)\)</span><br>
<span class="math inline">\(W=Z^2\)</span><br>
So we can deduce the pdf for the variable W <span class="math display">\[
\begin{align}
f_W(w)&amp;=Pr(Z^2=w)\\
&amp; =f_Z(\sqrt{w}) \left| \frac{d(\sqrt{w})}{dw} \right| + f_Z(-\sqrt{w}) \left| \frac{d(-\sqrt{w})}{dw} \right|\\
&amp;=2 \cdot \frac{1}{\sqrt{2\pi}} e^{-w / 2} \cdot \frac{1}{2\sqrt{w}} = \frac{1}{\sqrt{2\pi w}} e^{-w / 2}\\
\end{align}
\]</span></p>
<p><span class="math inline">\(\Gamma(z) = \int_0^\infty t^{z-1} e^{-t} \, dt\)</span><br>
<span class="math inline">\(\Gamma(1/2)\)</span>=<span class="math inline">\(\sqrt(\pi)\)</span>,we can know that <span class="math inline">\(W\sim \chi^2(1)\)</span><br>
</p>
<p>Now, we can introduce the variable Y.<br>
<span class="math inline">\(Y=\sum_{i=1}^k Z_i^2\)</span> (<span class="math inline">\(Z_i\)</span> is independent of each other)<br>
We want to get the mgf of Y <span class="math display">\[
\begin{align}
M_Y(t)&amp;=E[e^{tY}]\\
&amp; =E[e^{tZ_1^2}e^{tZ_2^2}...e^{tZ_k^2}]\\
&amp; =E[e^{tZ_1^2}]E[e^{tZ_2^2}]...E[e^{tZ_k^2}] \\
&amp; = \prod_{i=1}^k M_{Z_i^2}(t)\\
&amp;=(1-2t)^{-r1/2}(1-2t)^{-r2/2}...(1-2t)^{-rk/2}\\
&amp; =(1-2t)^{-\sum_{i=1}^kri/2}\\
\end{align}
\]</span> Because the mgf of Chi-square function is <span class="math inline">\((1-2t)^{-r/2}\)</span><br>
r is the degree of freedom of this chi-square function<br>
So <span class="math inline">\(Y\sim \chi^2(r1+r2+...+rk)\)</span><br>
r1,r2…rk represents the degree of freedom of every single sample<br>
Here, df=1 for every sample</p>
</section>
<section id="student--t-distribution" class="level3">
<h3 class="anchored" data-anchor-id="student--t-distribution">Student- t distribution</h3>
</section>
<section id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom." class="level3">
<h3 class="anchored" data-anchor-id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom.">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Student- t distribution <span class="math inline">\(f(t) = \frac{\Gamma \left(\frac{\nu+1}{2}\right)}{\sqrt{\nu \pi} \, \Gamma \left(\frac{\nu}{2}\right)} \left(1 + \frac{t^2}{\nu}\right)^{-\frac{\nu+1}{2}}\)</span>, where <span class="math inline">\(\Gamma\)</span> is the gamma function and <span class="math inline">\(\nu\)</span> is the degrees of freedom.<br>
</h3>
<p>Given two independent variables Z and V (<span class="math inline">\(Z \sim N(0, 1)\)</span> &amp; <span class="math inline">\(V\sim \chi^2(\nu)\)</span>), then we construct a new variable <span class="math inline">\(T=\frac{Z}{\sqrt(V/\nu)}\)</span>.<br>
The joint pdf is <span class="math display">\[
g(z,v)=\frac{1}{\sqrt{2\pi}} e^{-\frac{z^2}{2}}\frac{1}{2^{\nu/2} \Gamma(\nu/2)} v^{\nu/2 - 1} e^{-v/2}
\]</span> Cdf of T is given by <span class="math display">\[
\begin{align}
F(t) &amp; =Pr(\frac{Z}{\sqrt(V/\nu)}\leq t)\\
&amp; =Pr(Z\leq {\sqrt(V/\nu)}t)\\
&amp; =\int_{0}^{\infty} \int_{-\infty}^{\sqrt(V/\nu)t} g(z,v) \, dz \, dv
\end{align}
\]</span> Simplify F(t) <span class="math display">\[
F(t)=\frac{1}{\sqrt{\pi}\Gamma(\nu/2)}\int_{0}^{\infty}[\int_{-\infty}^{\sqrt(V/\nu)t} \frac{e^{-z^2/2}}{2^\frac{\nu+1}{2}}dz]v^{\frac{\nu}{2}-1}e^{-\frac{v}{2}}dv
\]</span></p>
<p>To get pdf, we will differentiate F(t) <span class="math display">\[
\begin{align}
f(t) &amp;=F'(t)=\frac{1}{\sqrt{\pi}\Gamma(\nu/2)}\int_{0}^{\infty} \frac{e^{-(v/2)(t^2/\nu)}}{2^{\frac{\nu+1}{2}}}\sqrt\frac{v}{\nu}v^{\nu/2-1}e^{-\frac{v}{2}}dv\\
&amp;=\frac{1}{\sqrt{\pi\nu}\Gamma(\nu/2)}\int_{0}^{\infty}\frac{v^{(\nu+1)/2-1}}{2^{(\nu+1)/2}}e^{-(\nu/2)(1+t^2/\nu)}dv
\end{align}
\]</span> We need to make the change of variables: <span class="math inline">\(y=(1+t^2/\nu)v\)</span><br>
And we need to change dv: <span class="math inline">\(\frac{dv}{dy}=\frac{1}{1+t^2/\nu}\)</span></p>
<p><span class="math display">\[
\begin{align}
f(t)&amp;=\frac{\Gamma[(\nu+1)/2]}{\sqrt{\pi\nu}\Gamma(\nu/2)}[\frac{1}{(1+t^2/\nu)^{(\nu+1)/2}}]\int_{0}^{\infty}\frac{y^{(\nu+1)/2-1}}{\Gamma[(\nu+1)/2]2^{(\nu+1)/2}}e^{-y/2}dy
\end{align}
\]</span> This part <span class="math inline">\(\int_{0}^{\infty}\frac{y^{(\nu+1)/2-1}}{\Gamma[(\nu+1)/2]2^{(\nu+1)/2}}e^{-y/2}dy\)</span> is equal to 1, because this part is the whole area under the chi-square distribution with <span class="math inline">\(\nu+1\)</span> degrees of freedom. So, the pdf for T can be written as follows <span class="math display">\[
f(t)=\frac{\Gamma[(\nu+1)/2]}{\sqrt{\pi\nu}\Gamma(\nu/2)}\frac{1}{(1+t^2/\nu)^{(\nu+1)/2}}
\]</span></p>
</section>
<section id="f-distribution" class="level3">
<h3 class="anchored" data-anchor-id="f-distribution">F-distribution</h3>
</section>
<section id="we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution" class="level3">
<h3 class="anchored" data-anchor-id="we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution">We will do some trnsformation on chi-square distribution to get F-distribution</h3>
<p>Assuming that we have two independent random variables <span class="math display">\[
X \sim \chi^2(n_1) \quad and\quad  Y \sim \chi^2(n_2)\
\]</span> Now,we will define a new variable F <span class="math display">\[
F = \frac{(X / n_1)}{(Y / n_2)}
\]</span> This looks a little complex, so let’s do some simplification. <span class="math display">\[
U = \frac{X}{n_1} \quad \text{and} \quad V = \frac{Y}{n_2}\
\]</span></p>
<p>So, <span class="math inline">\(F = \frac{U}{V}\)</span>.<br>
Because, X and Y are independent of each other. Obviously, U and V are also independent of each other.<br>
</p>
<p><span class="math display">\[
f_{U,V}(u,v) = f_U(u) f_V(v)
\]</span> <span class="math display">\[
f_U(u) = \frac{(n_1 u)^{n_1/2 - 1} e^{-n_1 u/2}}{2^{n_1/2} \Gamma(n_1/2)}
\]</span> <span class="math display">\[
f_V(v) = \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)}
\]</span> To find the joint density function of F &amp; V, we use Jacobian transformation <span class="math display">\[
J =\left| \frac{\partial(U,V)}{\partial(F,V)} \right| = \left| \begin{matrix}
\frac{\partial U}{\partial F} &amp; \frac{\partial U}{\partial V} \\
\frac{\partial V}{\partial F} &amp; \frac{\partial V}{\partial V}
\end{matrix} \right| = \left| \begin{matrix}
V &amp; F \\
0 &amp; 1
\end{matrix} \right| = V
\]</span> <span class="math display">\[
f_{F,V}(f,v) = f_{U,V}(u,v) \left| \frac{\partial(u,v)}{\partial(f,v)} \right|= f_{U,V}(u,v)v
\]</span> Then, we substitute<span class="math inline">\(f_U(u)\)</span> and <span class="math inline">\(f_V(v)\)</span> into <span class="math inline">\(f_{F,V}(f,v)\)</span> <span class="math display">\[
f_{F,V}(f,v) = \frac{(n_1 u)^{n_1/2 - 1} e^{-n_1 u/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v
\]</span> Use the condition u=fv <span class="math display">\[
\begin{align}
f_{F,V}(f,v) &amp;= \frac{(n_1 fv)^{n_1/2 - 1} e^{-n_1 fv/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v\\
&amp; =\frac{(n_1 f v)^{n_1/2 - 1} e^{-n_1 f v/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v\\
&amp; = \frac{n_1^{n_1/2-1} f^{n_1/2 - 1} v^{n_1/2 - 1} e^{-n_1 f v/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{n_2^{n_2/2-1} v^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v\\
&amp; = \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1} v^{(n_1 + n_2)/2 - 1} e^{-(n_1 f + n_2) v/2}}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)}
\end{align}
\]</span> We will integrate this density function with respect to V <span class="math display">\[
\begin{align}
f_F(f) &amp;= \int_0^\infty f_{F,V}(f,v) dv\\
&amp;= \int_0^\infty \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1} v^{(n_1 + n_2)/2 - 1} e^{-(n_1 f + n_2) v/2}}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)} dv\\
\end{align}
\]</span> Let’s do some substitutions to make it look simpler <span class="math display">\[
\begin{align}
c = \frac{n_1 f + n_2}{2}
\end{align}
\]</span> This is the definition of Gamma function <span class="math display">\[
\int_0^\infty v^{(n_1 + n_2)/2 - 1} e^{-c v} dv = \frac{\Gamma((n_1 + n_2)/2)}{c^{(n_1 + n_2)/2}}
\]</span></p>
<p>Then <span class="math display">\[
f_F(f) = \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1}}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)} \cdot \frac{\Gamma((n_1 + n_2)/2)}{\left(\frac{n_1 f + n_2}{2}\right)^{(n_1 + n_2)/2}}
\]</span> Let’s rewrite it in an approximate F-distribution pdf form <span class="math display">\[
f_F(f) = \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1} \Gamma((n_1 + n_2)/2)}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)} \cdot \left(\frac{2}{n_1 f + n_2}\right)^{(n_1 + n_2)/2}
\]</span></p>
</section>
<section id="beta-and-gamma" class="level3">
<h3 class="anchored" data-anchor-id="beta-and-gamma">beta and Gamma</h3>
<p>When considering the product of two Gamma functions <span class="math display">\[(\Gamma(a) \Gamma(b))\]</span>, we can write it as two independent integrals:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \left( \int_0^\infty t^{a-1} e^{-t} \, dt \right) \left( \int_0^\infty s^{b-1} e^{-s} \, ds \right)
\]</span></p>
<p>To convert this product into a double integral, we can use a change of variables. Consider using polar coordinates in the two independent integrals, which allows us to use certain integration techniques to simplify them. First, we transform the integration region from Cartesian coordinates to polar coordinates:</p>
<p><span class="math display">\[
t = r \cos \theta, \quad s = r \sin \theta
\]</span></p>
<p>The Jacobian determinant is <span class="math display">\[r\]</span>, so the integral can be rewritten as:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \int_0^\infty \int_0^\infty t^{a-1} e^{-t} s^{b-1} e^{-s} \, dt \, ds
\]</span></p>
<p>Using the polar coordinate transformation, the integral becomes:</p>
<p><span class="math display">\[
= \int_0^\frac{\pi}{2} \int_0^\infty (r \cos \theta)^{a-1} e^{-r \cos \theta} (r \sin \theta)^{b-1} e^{-r \sin \theta} r \, dr \, d\theta
\]</span></p>
<p>Separating all <span class="math display">\[r\]</span> and <span class="math display">\[\theta\]</span> related terms:</p>
<p><span class="math display">\[
= \int_0^\frac{\pi}{2} (\cos \theta)^{a-1} (\sin \theta)^{b-1} \, d\theta \int_0^\infty r^{a+b-1} e^{-r(\cos \theta + \sin \theta)} \, dr
\]</span></p>
<p>First, compute the <span class="math display">\[r\]</span> integral part:</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r(\cos \theta + \sin \theta)} \, dr = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}}
\]</span></p>
<p>Next, compute the <span class="math display">\[\theta\]</span> integral part:</p>
<p><span class="math display">\[
\int_0^\frac{\pi}{2} (\cos \theta)^{a-1} (\sin \theta)^{b-1} \, d\theta = B(a, b)
\]</span></p>
<p>where <span class="math display">\[B(a, b)\]</span> is the Beta function, defined as:</p>
<p><span class="math display">\[
B(a, b) = \int_0^1 t^{a-1} (1-t)^{b-1} \, dt
\]</span></p>
<p>Therefore, we get:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}} \cdot B(a, b)
\]</span></p>
<p>Since <span class="math display">\[\cos \theta + \sin \theta = 1\]</span> (in polar coordinates), we have:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \Gamma(a+b) B(a, b)
\]</span></p>
<p>Thus, the double integral form of the Gamma function product directly comes from the polar transformation and the application of the Beta function. This is an important mathematical technique used to simplify complex integrals and functional relationships.</p>
</section>
<section id="why-is-the-integral-result-as-shown" class="level3">
<h3 class="anchored" data-anchor-id="why-is-the-integral-result-as-shown">Why is the integral result as shown?</h3>
<p>The given integral,</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr,
\]</span></p>
<p>can be evaluated using the definition of the Gamma function. The Gamma function <span class="math display">\[\Gamma(z)\]</span> is defined as:</p>
<p><span class="math display">\[
\Gamma(z) = \int_0^\infty t^{z-1} e^{-t} \, dt.
\]</span></p>
<p>To see why the integral can be expressed in terms of the Gamma function, let’s rewrite the integral in a form that matches the Gamma function’s definition. The integral has the form:</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr.
\]</span></p>
<p>Let’s set <span class="math display">\[t = r (\cos \theta + \sin \theta)\]</span>, then <span class="math display">\[r = \frac{t}{\cos \theta + \sin \theta}\]</span> and <span class="math display">\[dr = \frac{dt}{\cos \theta + \sin \theta}\]</span>. Substituting these into the integral gives:</p>
<p><span class="math display">\[
\int_0^\infty \left( \frac{t}{\cos \theta + \sin \theta} \right)^{a+b-1} e^{-t} \cdot \frac{dt}{\cos \theta + \sin \theta}.
\]</span></p>
<p>Simplifying inside the integral:</p>
<p><span class="math display">\[
\int_0^\infty \frac{t^{a+b-1}}{(\cos \theta + \sin \theta)^{a+b}} e^{-t} \, dt.
\]</span></p>
<p>Since <span class="math display">\[(\cos \theta + \sin \theta)^{a+b}\]</span> is a constant with respect to <span class="math display">\[t\]</span>, it can be factored out of the integral:</p>
<p><span class="math display">\[
\frac{1}{(\cos \theta + \sin \theta)^{a+b}} \int_0^\infty t^{a+b-1} e^{-t} \, dt.
\]</span></p>
<p>The integral</p>
<p><span class="math display">\[
\int_0^\infty t^{a+b-1} e^{-t} \, dt
\]</span></p>
<p>is recognized as the Gamma function <span class="math display">\[\Gamma(a+b)\]</span>. Thus, we have:</p>
<p><span class="math display">\[
\frac{1}{(\cos \theta + \sin \theta)^{a+b}} \Gamma(a+b).
\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}}.
\]</span></p>
<p>This demonstrates why the integral is evaluated as shown:</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}}.
\]</span> (method 2 for integral calculation: x=uv,y=u(1-v) J=-u)</p>
</section>
</section>
<section id="three-main-sampling-distribution" class="level2">
<h2 class="anchored" data-anchor-id="three-main-sampling-distribution">Three Main Sampling distribution</h2>
<section id="chi-square-distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-distribution-1">Chi-square distribution</h3>
<p>Suppose <span class="math inline">\(X_1, \cdots, X_n \stackrel{\text { i.i.d. }}{\sim} \mathcal{N}(0,1)\)</span>.the distribution of the statistic <span class="math display">\[
X_1^2+\cdots+X_n^2
\]</span> is called a chi-square distribution with <span class="math inline">\(n\)</span> degrees of freedom, denoted by <span class="math inline">\(\chi^2(n)\)</span>.</p>
<p>Besides, random variable <span class="math inline">\(X_i^2 \sim \operatorname{Gamma}\left(\frac{1}{2}, \frac{1}{2}\right)\)</span> corresponds to the chi-squared distribution with 1 degree of freedom, denoted as <span class="math inline">\(\chi_1^2\)</span>.</p>
<p>This is derived by the MGF:</p>
<p>Since <span class="math display">\[
M_{X_1^2+\cdots+X_n^2}(t)=M_{X_1^2}(t) \times \cdots \times M_{X_n^2}(t)= \begin{cases}\infty &amp; t \geq \frac{1}{2} \\ (1-2 t)^{-\frac{n}{2}} &amp; t&lt;\frac{1}{2}\end{cases}
\]</span></p>
<p>This is the MGF of the <span class="math inline">\(\operatorname{Gamma}\left(\frac{n}{2}, \frac{1}{2}\right)\)</span> distribution, so <span class="math inline">\(X_1^2+\cdots+X_n^2 \sim \operatorname{Gamma}\left(\frac{n}{2}, \frac{1}{2}\right)\)</span>. This is called the chi-squared distribution with <span class="math inline">\(\mathbf{n}\)</span> degree of freedom, denoted <span class="math inline">\(\chi_n^2\)</span>.</p>
<section id="properties" class="level4">
<h4 class="anchored" data-anchor-id="properties">Properties</h4>
<p>The random variable <span class="math inline">\(\frac{(X-\mu)^2}{\sigma^2}\)</span> follows a <span class="math inline">\(\chi^2\)</span>-distribution with 1 degree of freedom when <span class="math inline">\(X\)</span> follows a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.</p>
<ul>
<li><p>If <span class="math inline">\(W_1, \ldots, W_n\)</span> are independent <span class="math inline">\(\chi^2\)</span> random variables with, respectively, <span class="math inline">\(v_1, \cdots, v_n\)</span> degrees of freedom, then the random variable <span class="math inline">\(W_1+\cdots+W_n\)</span> follows a <span class="math inline">\(\chi^2\)</span>-distribution with <span class="math inline">\(v_1+\cdots+v_n\)</span> degree of freedom.</p></li>
<li><p>The random variable <span class="math inline">\(\frac{(\bar{X}-\mu)^2}{\sigma^2 / n}\)</span> follows a <span class="math inline">\(\chi^2\)</span>-distribution with 1 degree of freedom when <span class="math inline">\(X\)</span> follows a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.</p></li>
</ul>
</section>
<section id="code-to-plot-examples-of-chi-square-distribution" class="level4">
<h4 class="anchored" data-anchor-id="code-to-plot-examples-of-chi-square-distribution">Code to plot examples of Chi-square distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the density for different degrees of freedom</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">4</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>df8 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">8</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>df12 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">12</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>chi_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, df4, df8, df12)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chi_data, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df4, <span class="at">color =</span> <span class="st">"df=4"</span>)) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df8, <span class="at">color =</span> <span class="st">"df=8"</span>)) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df12, <span class="at">color =</span> <span class="st">"df=12"</span>)) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Chi-Square Distribution"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Degrees of Freedom"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"df=4"</span> <span class="ot">=</span> <span class="st">"blue"</span>,<span class="st">"df=8"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"df=12"</span> <span class="ot">=</span> <span class="st">"green"</span>)) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="application" class="level4">
<h4 class="anchored" data-anchor-id="application">Application</h4>
<p>Chi-square distribution is primarily used in testing:</p>
<ul>
<li><p>Goodness-of-fit</p></li>
<li><p>Independence in contingency tables</p></li>
</ul>
</section>
</section>
<section id="students-t-distribution" class="level3">
<h3 class="anchored" data-anchor-id="students-t-distribution">Student’s t-distribution</h3>
<section id="construction" class="level4">
<h4 class="anchored" data-anchor-id="construction">Construction</h4>
<p>The statistic <span class="math inline">\(T=\frac{\bar{X}-\mu}{S / \sqrt{n}}\)</span> follows a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(v=n-1\)</span> degrees of freedom when <span class="math inline">\(X_1, \cdots, X_n\)</span> are i.i.d. normal RVs.</p>
<p><span class="math display">\[
\bar{X} \sim \mathcal{N}\left(\mu, \frac{\sigma^2}{n}\right) \quad \frac{\bar{X}-\mu}{\sigma / \sqrt{n}} \sim \mathcal{N}(0,1) \quad \frac{(n-1) s^2}{\sigma^2} \sim \chi_{n-1}^2
\]</span></p>
<p>If we know the population variance <span class="math inline">\(\sigma^2\)</span>, we can easily do inference using the statistic <span class="math inline">\(\frac{\bar{X}-\mu}{\sigma / \sqrt{n}}\)</span>. However, <span class="math inline">\(\sigma^2\)</span> is usually unknown in practice.</p>
<p><span class="math display">\[
\bar{X} \sim \mathcal{N}\left(\mu, \frac{\sigma^2}{n}\right) \quad \frac{\bar{X}-\mu}{\sigma / \sqrt{n}} \sim \mathcal{N}(0,1) \quad \frac{(n-1) s^2}{\sigma^2} \sim \chi_{n-1}^2
\]</span></p>
<p>We can construct the <span class="math inline">\(t\)</span>-statistic using the sample variance <span class="math inline">\(S^2\)</span> : <span class="math display">\[
T=\frac{\frac{\bar{X}-\mu}{\sigma / \sqrt{n}}}{\sqrt{\frac{(n-1) s^2}{\sigma^2} /(n-1)}}=\frac{\bar{X}-\mu}{S / \sqrt{n}}
\]</span></p>
<p>Notice the sample mean <span class="math inline">\(\bar{X}\)</span> and the sample variance <span class="math inline">\(S^2\)</span> are independent (the proof is beyond the scope of this course). So the <span class="math inline">\(T\)</span> is now a ratio of a standard normal variable and the square root of a <span class="math inline">\(\chi^2 \mathrm{RV}\)</span> divided by its degrees of freedom. This is the definition of a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
</section>
<section id="properties-1" class="level4">
<h4 class="anchored" data-anchor-id="properties-1">Properties</h4>
<p>The <span class="math inline">\(t\)</span>-distribution is primarily used in contexts where the underlying population is assumed to be normally distributed, especially when the sample size is small. Used extensively in problems that deal with inference about population mean <span class="math inline">\(\mu\)</span> when population variance <span class="math inline">\(\sigma^2\)</span> is unknown.</p>
<ul>
<li>problems where one is trying to determine if means from two samples are significantly different when population variances <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are unknown.</li>
</ul>
</section>
<section id="code-to-plot-examples-of-t-distribution" class="level4">
<h4 class="anchored" data-anchor-id="code-to-plot-examples-of-t-distribution">Code to plot examples of t-distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the density for different degrees of freedom</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">30</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>distributions <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df_values, <span class="cf">function</span>(df) <span class="fu">dt</span>(x, <span class="at">df =</span> df))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the data</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>df_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df_values)) {</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  df_data[<span class="fu">paste0</span>(<span class="st">"df"</span>, df_values[i])] <span class="ot">&lt;-</span> distributions[[i]]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the densities</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df1, <span class="at">color =</span> <span class="st">"df=1"</span>)) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df2, <span class="at">color =</span> <span class="st">"df=2"</span>)) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df3, <span class="at">color =</span> <span class="st">"df=3"</span>)) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df5, <span class="at">color =</span> <span class="st">"df=5"</span>)) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df10, <span class="at">color =</span> <span class="st">"df=10"</span>)) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df30, <span class="at">color =</span> <span class="st">"df=30"</span>)) <span class="sc">+</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(x), <span class="at">color =</span> <span class="st">"Standard Normal"</span>)) <span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Distribution"</span>, </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"df=1"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"df=2"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"df=3"</span> <span class="ot">=</span> <span class="st">"red"</span>, </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"df=5"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"df=10"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"df=30"</span> <span class="ot">=</span> <span class="st">"green"</span>, </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Standard Normal"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density of the t-distribution compared to the standard normal distribution"</span>,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="f-distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="f-distribution-1">F-distribution</h3>
<p>Let <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> be two independent RVs following <span class="math inline">\(\chi^2\)</span> distributions with <span class="math inline">\(\nu_1\)</span> and <span class="math inline">\(\nu_2\)</span> degrees of freedom, respectively. Then the distribution of the random variable <span class="math inline">\(F=\frac{U / \nu_1}{V / \nu_2}\)</span> is known as <span class="math inline">\(F\)</span>-distribution.</p>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example</h4>
<p>If <span class="math inline">\(S_1^2\)</span> and <span class="math inline">\(S_2^2\)</span> are the variances of independent RVs of size <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> taken from normal populations with variances <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> respectively, then <span class="math display">\[
F=\frac{S_1^2 / \sigma_1^2}{S_2^2 / \sigma_2^2}=\frac{\sigma_2^2 S_1^2}{\sigma_1^2 S_2^2}
\]</span> follows an <span class="math inline">\(F\)</span>-distribution with <span class="math inline">\(\nu_1=n_1-1\)</span> and <span class="math inline">\(\nu_2=n_2-1\)</span> degrees of freedom.</p>
</section>
<section id="code-to-plot-examples-of-f-distribution" class="level4">
<h4 class="anchored" data-anchor-id="code-to-plot-examples-of-f-distribution">Code to plot examples of F-distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the density for different degrees of freedom</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>df1_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>df2_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>distributions <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df1_values), <span class="cf">function</span>(i) <span class="fu">df</span>(x, <span class="at">df1 =</span> df1_values[i], <span class="at">df2 =</span> df2_values[i]))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the data</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>df_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df1_values)) {</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  df_data[<span class="fu">paste0</span>(<span class="st">"df1"</span>, df1_values[i], <span class="st">"_df2"</span>, df2_values[i])] <span class="ot">&lt;-</span> distributions[[i]]</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the densities</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df11_df21, <span class="at">color =</span> <span class="st">"d1=1, d2=1"</span>)) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df12_df21, <span class="at">color =</span> <span class="st">"d1=2, d2=1"</span>)) <span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df15_df22, <span class="at">color =</span> <span class="st">"d1=5, d2=2"</span>)) <span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df110_df21, <span class="at">color =</span> <span class="st">"d1=10, d2=1"</span>)) <span class="sc">+</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df1100_df2100, <span class="at">color =</span> <span class="st">"d1=100, d2=100"</span>)) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">""</span>, </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"d1=1, d2=1"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"d1=2, d2=1"</span> <span class="ot">=</span> <span class="st">"black"</span>, </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"d1=5, d2=2"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"d1=10, d2=1"</span> <span class="ot">=</span> <span class="st">"green"</span>, </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"d1=100, d2=100"</span> <span class="ot">=</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"F-distribution with different degrees of freedom"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="application-1" class="level4">
<h4 class="anchored" data-anchor-id="application-1">Application</h4>
<p>Analysis of variance (ANOVA)</p>
</section>
</section>
</section>
</section>
<section id="estimation-of-population-characteristic" class="level1">
<h1>Estimation of Population Characteristic</h1>
<section id="point-estimation" class="level2">
<h2 class="anchored" data-anchor-id="point-estimation">Point Estimation</h2>
<p>A point estimate of a population characteristic is a single number that is based on sample data and represents a plausible value of the characteristic.</p>
</section>
</section>
<section id="interval-estimationconfidence-intervalci" class="level1">
<h1>Interval Estimation—Confidence interval(CI)</h1>
<p>An interval estimate of a parameter <span class="math inline">\(\theta\)</span> is an interval of the form <span class="math inline">\(\hat{\theta}_L&lt;\theta&lt;\hat{\theta}_U\)</span>, where <span class="math inline">\(\hat{\theta}_L\)</span> and <span class="math inline">\(\hat{\theta}_U\)</span> depend on the value of <span class="math inline">\(\hat{\theta}\)</span> for a particular sample and also on the sampling distribution of <span class="math inline">\(\hat{\Theta}\)</span>.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<ul>
<li><p>If we were to construct a 95% confidence interval for some population characteristics (population proportion p or population mean <span class="math inline">\(\mu\)</span>), we would be using a method that is successful 95% of the time.</p></li>
<li><p>This is also about the question relevant to “How to choose a sample size”</p></li>
</ul>
</section>
<section id="definition-1" class="level2">
<h2 class="anchored" data-anchor-id="definition-1">Definition</h2>
<p>A <span class="math inline">\(100(1-\alpha) \%\)</span> confidence interval is an interval of the form <span class="math inline">\(\hat{\theta}_L&lt;\theta&lt;\hat{\theta}_U\)</span>, where <span class="math inline">\(\hat{\theta}_L\)</span> and <span class="math inline">\(\hat{\theta}_U\)</span> are respectively values of <span class="math inline">\(\widehat{\Theta}_L\)</span> and <span class="math inline">\(\widehat{\Theta}_U\)</span> obtained for a particular sample, based on <span class="math display">\[
P\left(\widehat{\Theta}_L&lt;\theta&lt;\widehat{\Theta}_U\right)=1-\alpha \quad ; \quad 0&lt;\alpha&lt;1
\]</span> in the estimation of population parameter <span class="math inline">\(\theta\)</span>.</p>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<p>For confidence level of 95%, t for any normal distribution: About 95% of the values are within 1.96 standard deviations of the mean. (Recall the concept of Z-scores)</p>
<p>That is, if this method was used to generate an interval estimate over and over again with different samples, in the long run 95% of the resulting intervals would include the actual value of the characteristic being estimated.</p>
<ul>
<li>The confidence level 95% refers to the method used to construct the interval rather than to any particular interval, such as the one we obtained.</li>
</ul>
<section id="eg" class="level3">
<h3 class="anchored" data-anchor-id="eg">eg</h3>
<section id="proportion" class="level4">
<h4 class="anchored" data-anchor-id="proportion">Proportion</h4>
<ul>
<li>check to make sure that the three necessary conditions are met:</li>
</ul>
<p><span class="math inline">\(n\hat p \ge 10, n(1-\hat p) \ge 10\)</span></p>
<p><span class="math inline">\(\frac {\hat p -p }{\sigma/\sqrt n} = 1.96\)</span>)</p>
<ul>
<li>sample size question</li>
</ul>
<p>Using sample proportion with 95% confidence interval, and we want ME no more than 5%, we may be interested in solving n from the following equation:</p>
<p>0.05=1.96 <span class="math inline">\(\sqrt {\frac {\hat p(1-\hat p) }{ n}}\)</span></p>
</section>
<section id="ci-on-mean" class="level4">
<h4 class="anchored" data-anchor-id="ci-on-mean">CI on Mean</h4>
<p>Here, <span class="math inline">\(\bar x\)</span> is the sample mean from a simple random sample.</p>
<p><span class="math inline">\(\mu\)</span> is the population mean which we are interested in estimating.</p>
<section id="ci-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics" class="level5">
<h5 class="anchored" data-anchor-id="ci-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics">CI on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\sigma\)</span> known n <span class="math inline">\(\ge 30\)</span> or the population is normal — Use z-statistics</h5>
<p>CI: <span class="math inline">\(\bar x \pm z_{\alpha/2} \frac {\sigma}{\sqrt n}\)</span>, for example, 95% CI is <span class="math inline">\(\bar x \pm 1.96 \frac {\sigma}{\sqrt n}\)</span></p>
</section>
<section id="one-side-confidence-bound-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics" class="level5">
<h5 class="anchored" data-anchor-id="one-side-confidence-bound-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics">One-side Confidence Bound on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\sigma\)</span> known n <span class="math inline">\(\ge 30\)</span> or the population is normal — Use z-statistics</h5>
<p>Upper one-side bound: <span class="math inline">\(\mu &lt;\bar x + z_{\alpha} \frac {\sigma}{\sqrt n}\)</span></p>
<p>Lower one-side bound: <span class="math inline">\(\mu &gt;\bar x - z_{\alpha} \frac {\sigma}{\sqrt n}\)</span></p>
<p>For example, 95% Confidence bound on <span class="math inline">\(\mu\)</span> is <span class="math inline">\(\bar x \pm 1.645 \frac {\sigma}{\sqrt n}\)</span></p>
</section>
<section id="ci-on-mu-with-sigma-unknown-and-the-population-is-normal-use-t-statistics-use-s-as-the-estimate-for-σ-t-statistics-with-df-n-1" class="level5">
<h5 class="anchored" data-anchor-id="ci-on-mu-with-sigma-unknown-and-the-population-is-normal-use-t-statistics-use-s-as-the-estimate-for-σ-t-statistics-with-df-n-1">CI on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\sigma\)</span> unknown and the population is normal — Use t-statistics (use s as the estimate for σ (t-statistics with df = n-1))</h5>
<p>CI: <span class="math inline">\(\bar x \pm t_{\alpha/2} \frac {s}{\sqrt n}\)</span>, for example, 95% CI is <span class="math inline">\(\bar x \pm t_{0.025} \frac {s}{\sqrt n}\)</span> and df = n-1</p>
<p>Remark: The distribution of t is more spread out than the standard normal distribution but when n <span class="math inline">\(\ge 30\)</span>, t and z are very close to each other.</p>
</section>
<section id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-known" class="level5">
<h5 class="anchored" data-anchor-id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-known">CI for <span class="math inline">\(\mu_1 - \mu_2\)</span>, both <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are known</h5>
<p>CI of <span class="math inline">\(\mu_1-\mu_2\)</span>: <span class="math inline">\((\bar x_1 - \bar x_2) \pm z_{\alpha/2} \sqrt {\frac {\sigma_1^2}{n_1} + \frac {\sigma_2^2}{n_2}}\)</span></p>
</section>
<section id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-unknown-but-assumed-equal" class="level5">
<h5 class="anchored" data-anchor-id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-unknown-but-assumed-equal">CI for <span class="math inline">\(\mu_1 - \mu_2\)</span>, both <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are unknown but assumed equal</h5>
<p>CI of <span class="math inline">\(\mu_1-\mu_2\)</span>: <span class="math inline">\((\bar x_1 - \bar x_2) \pm t_{\alpha/2} s_p \sqrt {\frac {1}{n_1} + \frac {1}{n_2}}\)</span> with df = <span class="math inline">\(n_1+n_2-2\)</span> where <span class="math inline">\(s_p = \sqrt {\frac {(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1+n_2-2}}\)</span></p>
</section>
<section id="ci-for-paired-observations" class="level5">
<h5 class="anchored" data-anchor-id="ci-for-paired-observations">CI for paired observations</h5>
<p>Previous, we have two independent samples, now we have two dependent samples. We can use the difference between the two samples to construct a confidence interval.</p>
<p>CI of <span class="math inline">\(\mu_d\)</span>: <span class="math inline">\(\bar d \pm t_{\alpha/2} \frac {s_d}{\sqrt n}\)</span> with df = n-1 where <span class="math inline">\(s_d\)</span> is the sample standard deviation of the differences <span class="math inline">\(d_i = x_{1i} - x_{2i}\)</span> and <span class="math inline">\(\bar d\)</span> is the sample mean of the differences.</p>
</section>
<section id="estimating-sigma" class="level5">
<h5 class="anchored" data-anchor-id="estimating-sigma">Estimating <span class="math inline">\(\sigma\)</span></h5>
<p>a <span class="math inline">\(100(1-\alpha)\%\)</span> CI for <span class="math inline">\(\sigma^2\)</span> is <span class="math inline">\(\left(\frac{(n-1) S^2}{\chi_{\alpha / 2, n-1}^2}, \frac{(n-1) S^2}{\chi_{1-\alpha / 2, n-1}^2}\right)\)</span></p>
<p>where <span class="math inline">\(S^2\)</span> is the sample variance and <span class="math inline">\(\chi_{\alpha / 2, n-1}^2\)</span> and <span class="math inline">\(\chi_{1-\alpha / 2, n-1}^2\)</span> are the critical values of the chi-square distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
</section>
<section id="estimating-sigma_12-sigma_22" class="level5">
<h5 class="anchored" data-anchor-id="estimating-sigma_12-sigma_22">Estimating <span class="math inline">\(\sigma_1^2/ \sigma_2^2\)</span></h5>
<p>A <span class="math inline">\(100(1-\alpha)\%\)</span> CI for <span class="math inline">\(\frac{\sigma_1^2}{\sigma_2^2}\)</span> using F-statistics with <span class="math inline">\(f_{1-\alpha/2}(n_1-1,n_2-1)=1/f_{\alpha/2}(n_1-1,n_2-1)\)</span> is <span class="math display">\[
\frac{s_1^2}{s_2^2} \frac{1}{f_{\alpha / 2}\left(n_1-1, n_2-1\right)}&lt;\frac{\sigma_1^2}{\sigma_2^2}&lt;\frac{s_1^2}{s_2^2} f_{\alpha / 2}\left(n_2-1, n_1-1\right)
\]</span> where <span class="math inline">\(f_{\alpha / 2}\left(v_1, v_2\right)\)</span> is an <span class="math inline">\(F\)</span>-value with <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span> degrees of freedom, leaving an area of <span class="math inline">\(\alpha / 2\)</span> to the right, and <span class="math inline">\(f_{\alpha / 2}\left(v_2, v_1\right)\)</span> is a similar <span class="math inline">\(F\)</span>-value with <span class="math inline">\(v_2\)</span> and <span class="math inline">\(v_1\)</span> degrees of freedom.</p>
</section>
</section>
</section>
</section>
</section>
<section id="hypothesis-testing" class="level1">
<h1>Hypothesis Testing</h1>
<p><img src="images/clipboard-2219722049.png" class="img-fluid"></p>
<ul>
<li>z-test</li>
</ul>
<p>Suppose <span class="math inline">\(X_1, \cdots, X_n \xrightarrow[\sim]{\text { iid }} \mathcal{N}\left(\mu, \sigma^2\right)\)</span>, where <span class="math inline">\(\mu\)</span> is unknown and where <span class="math inline">\(\sigma^2=\sigma_0^2\)</span> is known.</p>
<p>Suppose we wish to test <span class="math inline">\(H_0: \mu=\mu_0\)</span> against <span class="math inline">\(H_1: \mu&gt;\mu_0\)</span>. Then we can use the test statistic <span class="math display">\[
Z=\frac{\bar{X}-\mu_0}{\sigma_0 / \sqrt{n}}
\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true then <span class="math inline">\(Z \sim \mathcal{N}(0,1)\)</span>. Let <span class="math display">\[
z_{\mathrm{obs}}=\frac{\bar{x}-\mu_0}{\sigma_0 / \sqrt{n}}
\]</span></p>
<p>A large value of <span class="math inline">\(z_{\text {obs }}\)</span> casts doubt on the validity of <span class="math inline">\(H_0\)</span> and indicates a departure from <span class="math inline">\(H_0\)</span> in the direction of <span class="math inline">\(H_1\)</span>. So the <span class="math inline">\(p\)</span>-value for testing <span class="math inline">\(H_0\)</span> against <span class="math inline">\(H_1\)</span> is <span class="math display">\[
\begin{aligned}
p &amp; =P\left(Z \geq Z_{\mathrm{obs}} \mid H_0\right) \\
&amp; =P\left(\mathcal{N}(0,1) \geq Z_{\mathrm{obs}}\right) \\
&amp; =1-\Phi\left(Z_{\mathrm{obs}}\right)
\end{aligned}
\]</span></p>
<p>The z-test of <span class="math inline">\(H_0: \mu=\mu_0\)</span> against the alternative <span class="math inline">\(H_1: \mu&lt;\mu_0\)</span> is similar but this time a small, i.e.&nbsp;very negative, value of <span class="math inline">\(Z_{\text {obs }}\)</span> casts doubt on <span class="math inline">\(H_0\)</span>. So the <span class="math inline">\(p\)</span>-value is <span class="math display">\[
\begin{aligned}
p &amp; =P\left(Z \leq Z_{\mathrm{obs}} \mid H_0\right) \\
&amp; =P\left(\mathcal{N}(0,1) \leq Z_{\mathrm{obs}}\right) \\
&amp; =\Phi\left(Z_{\mathrm{obs}}\right)
\end{aligned}
\]</span></p>
<p>Finally, consider testing <span class="math inline">\(H_0: \mu=\mu_0\)</span> against the alternative <span class="math inline">\(H_1: \mu \neq\)</span> <span class="math inline">\(\mu_0\)</span>. Let <span class="math inline">\(z_0=\left|z_{\text {obs }}\right|\)</span>. A large value of <span class="math inline">\(z_0\)</span> indicates a departure from <span class="math inline">\(H_0\)</span>, so the <span class="math inline">\(p\)</span>-value is <span class="math display">\[
\begin{aligned}
p &amp; =P\left(|Z| \geq z_0 \mid H_0\right) \\
&amp; =P\left(\mathcal{N}(0,1) \geq z_0\right)+P\left(\mathcal{N}(0,1) \leq-z_0\right) \\
&amp; =2\left(1-\phi\left(z_0\right)\right)
\end{aligned}
\]</span></p>
<ul>
<li>t-test</li>
</ul>
<p>We can use the test statistic <span class="math display">\[
T=\frac{\bar{X}-\mu_0}{S / \sqrt{n}}
\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true then <span class="math inline">\(T \sim t_{n-1}\)</span>. Let <span class="math inline">\(t_{\mathrm{obs}}=t(x)=\frac{\bar{x}-\mu_0}{s / \sqrt{n}}\)</span> and <span class="math inline">\(t_0=\left|t_{\mathrm{obs}}\right|\)</span>. Similarly, we have <span class="math inline">\(\square\)</span> the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(P\left(t_{n-1} \geq t_{\mathrm{obs}}\right)\)</span> - the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(P\left(t_{n-1} \leq t_{\text {obs }}\right)\)</span> the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(2 P\left(t_{n-1} \geq t_0\right)\)</span></p>
<section id="example-of-one-sample-t-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-one-sample-t-test">Example of one-sample t-test</h2>
<p>A marine biologist is studying a species of fish known to have an average length of 20 cm in ocean populations. A new population in a freshwater lake is being analyzed to determine if the environmental differences have altered the fish’s average length. The biologist measures the lengths of 10 randomly selected fish, yielding the following data:</p>
<p>22, 23, 21, 24, 22, 20, 25, 19, 23, 22</p>
<p>Assuming the data satisfy the assumption of normality, please address the following using a significance level of 0.1:</p>
<section id="a" class="level3">
<h3 class="anchored" data-anchor-id="a">a</h3>
<ul>
<li><p>null hypothesis: The mean length of fish is 20 cm (<span class="math inline">\(H_0: \mu = 20\)</span>).</p></li>
<li><p>alternative hypothesis: The mean length of fish is not 20 cm (<span class="math inline">\(H_1: \mu \ne 20\)</span>).</p></li>
</ul>
</section>
<section id="b" class="level3">
<h3 class="anchored" data-anchor-id="b">b</h3>
<p>Since the data is supposed to be normally distributed, the sampling distribution of the sample mean follows t-distribution. The t-test statistic is calculated as follows:</p>
<p><span class="math display">\[t = \frac{\bar x - \mu}{s / \sqrt n}\]</span></p>
<p>The t-test statistic is calculated as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data2_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">22</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(data2_4)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(data2_4)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (x_bar <span class="sc">-</span> <span class="dv">20</span>) <span class="sc">/</span> (s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(data2_4)))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.705882</code></pre>
</div>
</div>
<p>The t-test statistic is 3.705882…</p>
</section>
<section id="c" class="level3">
<h3 class="anchored" data-anchor-id="c">c</h3>
<p>Using pt() function, the p-value is calculated as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span>t, <span class="at">df =</span> <span class="dv">9</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004875954</code></pre>
</div>
</div>
<p>The p-value is approximately 0.1. Since the p-value is less than 0.1, we reject the null hypothesis.</p>
<p>Therefore, there is sufficient evidence to conclude that the population mean is not equal to 20 which means the environmental differences have altered the fish’s average length.</p>
</section>
<section id="d" class="level3">
<h3 class="anchored" data-anchor-id="d">d</h3>
<p>Using qt() function to find the critical value for a two-tailed test with 90% confidence level:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>t_critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="at">df =</span> <span class="dv">9</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>t_critical</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.833113</code></pre>
</div>
</div>
<p>The critical value for a two-tailed test with 90% confidence level is about 1.833113.</p>
<p>Since the t-test statistic 3.705882 is greater than the critical value 1.833113, which is in the critical region. Therefore, we reject the null hypothesis.</p>
<p>Also, we could use confidence interval to verify the result. The 90% confidence interval for the population mean is calculated as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ci_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(x_bar <span class="sc">-</span> t_critical <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>), x_bar <span class="sc">+</span> t_critical <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ci_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.06124 23.13876</code></pre>
</div>
</div>
<p>So the 90% confidence interval for the population mean is about (21.1, 23.2).</p>
<p>The confidence interval does not contain the hypothesized value 20. Therefore, we reject the null hypothesis.</p>
<p>Therefore, there is sufficient evidence to conclude that the population mean is not equal to 20 which means the environmental differences have altered the fish’s average length.</p>
</section>
</section>
<section id="example-of-unpaired-t-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-unpaired-t-test">Example of unpaired t-test</h2>
<p>Suppose <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are unknown but assumed equal. We want to test the null hypothesis <span class="math inline">\(H_0: \mu_1 = \mu_2\)</span> against the alternative hypothesis <span class="math inline">\(H_1: \mu_1 \ne \mu_2\)</span>. The test statistic is given by</p>
<p><span class="math display">\[
t = \frac{\bar x_1 - \bar x_2}{s_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}
\]</span></p>
<p>where <span class="math inline">\(s_p\)</span> is the pooled sample standard deviation, given by</p>
<p><span class="math display">\[
s_p = \sqrt{\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}}
\]</span></p>
<p><img src="images/clipboard-3291557304.png" class="img-fluid"></p>
</section>
<section id="example-of-one-sample-variance-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-one-sample-variance-test">Example of one-sample Variance Test</h2>
<p><span class="math inline">\(\chi^2\)</span>-test for variance. Suppose <span class="math inline">\(X_1, \cdots, X_n\)</span> are i.i.d. normal random variables with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. We want to test the null hypothesis <span class="math inline">\(H_0: \sigma^2 = \sigma_0^2\)</span> against the alternative hypothesis <span class="math inline">\(H_1: \sigma^2 \ne \sigma_0^2\)</span>. The test statistic is given by</p>
<p><span class="math display">\[
\chi^2 = \frac{(n - 1)s^2}{\sigma^2}
\]</span></p>
</section>
<section id="example-of-two-sample-variance-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-two-sample-variance-test">Example of two-sample Variance Test</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\(H_0\)</span></th>
<th style="text-align: left;">Test Statistic</th>
<th style="text-align: left;"><span class="math inline">\(H_1\)</span></th>
<th style="text-align: left;">Rejection Region</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f=\frac{s_1^2}{s_2^2}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2&lt;\sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f&lt;f_\alpha\left(\nu_1, \nu_2\right)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2&gt;\sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f&gt;f_{1-\alpha}\left(\nu_1, \nu_2\right)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2 \neq \sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f&lt;f_{\alpha / 2}\left(\nu_1, \nu_2\right)\)</span> or <span class="math inline">\(f&gt;f_{1-\alpha / 2}\left(\nu_1, \nu_2\right)\)</span></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\nu_1=n_1-1\)</span> and <span class="math inline">\(\nu_2=n_2-1\)</span> are two degree of freedom.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
F=\frac{\frac{\left(n_1-1\right) S_1^2}{\sigma_1^2} /\left(n_1-1\right)}{\frac{\left(n_2-1\right) S_2^2}{\sigma_2^2} /\left(n_2-1\right)}=\frac{\sigma_2^2 S_1^2}{\sigma_1^2 S_2^2}
\]</span></p>
<p>If <span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span>, we have <span class="math display">\[
F=\frac{S_1^2}{S_2^2} \sim F_{n_1-1, n_2-1}
\]</span></p>
</section>
<section id="anova-analysis-of-variance" class="level2">
<h2 class="anchored" data-anchor-id="anova-analysis-of-variance">ANOVA– Analysis of Variance</h2>
<ul>
<li>one-way ANOVA</li>
</ul>
<p>we need to test the null hypothesis that the group population means are all the same against the alternative that at least one group population mean differs from the others. That is,</p>
<p><span class="math inline">\(H_0: \mu_1=\mu_2=\cdots=\mu_k\)</span> against <span class="math inline">\(H_1: \text { at least one } \mu_i \text { differs from the others.}\)</span></p>
<p>ANOVA Table</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Mean Sq</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">p value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: right;">m-1</td>
<td style="text-align: right;">11.84 (SS between)</td>
<td style="text-align: right;">2.9587 (MSB)</td>
<td style="text-align: right;">8.074 (MSB/MSW)</td>
<td style="text-align: right;"><span class="math inline">\(5.38 \mathrm{e}-05\)</span> (p-value)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Error</td>
<td style="text-align: right;">n-m</td>
<td style="text-align: right;">16.49 (SS Within)</td>
<td style="text-align: right;">0.3664 (MSW)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">n-1</td>
<td style="text-align: right;">28.33 (SS Total)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p>Source means “the source of the variation in the data.” the possible sources for a one-factor study are Factor, Residuals, and Total.</p>
<p>Factor means “the variability due to the factor of interest.” In the drug example, the factor was the different drug. In the learning example on the previous page, the factor was the method of learning. Sometimes the row heading is labeled as Between.</p>
<p>Error (or Residuals) means “the variability within the groups” or “unexplained random error.” Sometimes the row heading is labeled as Within.</p>
<p>Total means “the total variation in the data from the grand mean”.</p>
<p>DF means “the degrees of freedom in the source.”</p>
<p>Sum Sq means “the sum of squares due to the source.”</p>
<p>Mean Sq means “the mean sum of squares due to the source.”</p>
<p>F value means “the F-statistic.”</p>
<p>P value means “the P-value.”</p>
<p>SS(Total)=SS(Between)+SS(Within), where</p>
<p>SS(Between) is the sum of squares between the group means and the grand mean. As the name suggests, it quantifies the variability between the groups of interest.</p>
<p>SS(Within) is the sum of squares between the data and the group means. It quantifies the variability within the groups of interest.</p>
<p>SS(Total) is the sum of squares between the n data points and the grand mean. As the name suggests, it quantifies the total variability in the observed data.</p>
<ul>
<li>two-way ANOVA</li>
</ul>
<p>We can extend the idea of a one-way ANOVA, which tests the effects of one factor on a response variable, to a two-way ANOVA which tests the effects of two factors and their interaction on a response variable.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: left;">DF</th>
<th style="text-align: left;">Sum Sq</th>
<th style="text-align: left;">MSW</th>
<th style="text-align: left;">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cells</td>
<td style="text-align: left;"><span class="math inline">\(a b-1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{i=1}^a \sum_{j=1}^b n\left(\bar{X}_{i j}-\bar{X}_{\ldots . .}\right)^2\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: left;">a-1</td>
<td style="text-align: left;">bn <span class="math inline">\(\sum_{i=1}^a\left(\bar{X}_{i . .}-\bar{X}_{\ldots .}\right)^2\)</span></td>
<td style="text-align: left;">SS(A)</td>
<td style="text-align: left;">MS(Error</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: left;">b-1</td>
<td style="text-align: left;">an <span class="math inline">\(\sum_{j=1}^b\left(\bar{X}_{. j .}-\bar{X}_{\ldots .}\right)^2\)</span></td>
<td style="text-align: left;">SS(B)</td>
<td style="text-align: left;">MS(B)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\mathrm{A} \times \mathrm{B}\)</span></td>
<td style="text-align: left;"><span class="math inline">\((a-1)(b-1)\)</span></td>
<td style="text-align: left;">SS(Cells)-SS(A)-SS(B)</td>
<td style="text-align: left;">SS(AB)</td>
<td style="text-align: left;">MS(Error</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">DF(A <span class="math inline">\(\times\)</span> B)</td>
<td style="text-align: left;">MS(Error</td>
</tr>
<tr class="even">
<td style="text-align: left;">Error</td>
<td style="text-align: left;"><span class="math inline">\(a b(n-1)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{i=1}^a \sum_{j=1}^b \sum_{l=1}^n\left(X_{i j l}-\bar{X}_{i j} .\right)^2\)</span></td>
<td style="text-align: left;">SS(Error)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;"><span class="math inline">\(a b n-1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{i=1}^a \sum_{j=1}^b n\left(X_{i j l}-\bar{X}_{\ldots .}\right)^2\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<ul>
<li><p><span class="math inline">\(F=\frac{\mathrm{MS}(\mathrm{A})}{\mathrm{MS}(\text { Error })}\)</span>, for <span class="math inline">\(H_0\)</span> : no effect of factor A on response variable,</p></li>
<li><p><span class="math inline">\(F=\frac{\mathrm{MS}(\mathrm{B})}{\mathrm{MS}(\text { Error) }}\)</span>, for <span class="math inline">\(H_0\)</span> : no effect of factor B on response variable,</p></li>
<li><p><span class="math inline">\(F=\frac{\mathrm{MS}(\mathrm{A} \times \mathrm{B})}{\mathrm{MS}(\text { Error })}\)</span>, for <span class="math inline">\(H_0\)</span> : no effect of interaction on response variable.</p></li>
</ul>
<p>We reject any <span class="math inline">\(H_0\)</span> if <span class="math inline">\(F \geq F_{\text {critical }}\)</span>; otherwise, we do not reject <span class="math inline">\(H_0\)</span>.</p>
<section id="example-of-two-way-anova" class="level3">
<h3 class="anchored" data-anchor-id="example-of-two-way-anova">Example of two-way ANOVA</h3>
<p>Two-way ANOVA. In this question, we will use the built-in R data set ToothGrowth to perform two-way ANOVA test. ToothGrowth includes information from a study on the effects of vitamin C on tooth growth in Guinea pigs. The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC). Assuming the data satisfy the assumptions of normality and equal variance, please address the following using a significance level of 0.05</p>
<section id="a-1" class="level4">
<h4 class="anchored" data-anchor-id="a-1">a</h4>
<ul>
<li><p>The effects of vitamin C on tooth growth in guinea pigs:</p></li>
<li><p>null hypothesis: <span class="math inline">\(H_0\)</span>: mean tooth growth for all doses of vitamin C are equal</p></li>
<li><p>alternative hypothesis: <span class="math inline">\(H_1\)</span>: at least one of the means of all doses of vitamin C is different from the others</p></li>
<li><p>The effects of delivery method on tooth growth in guinea pigs:</p></li>
<li><p>null hypothesis: <span class="math inline">\(H_0\)</span>: mean tooth growth for the delivery method of orange juice and ascorbic acid are equal.</p></li>
<li><p>alternative hypothesis <span class="math inline">\(H_1\)</span>: mean tooth growth for the delivery method of orange juice and ascorbic acid are different.</p></li>
<li><p>The interaction effects of the dose of vitamin C and delivery method on tooth growth in guinea pigs:</p></li>
<li><p>null hypothesis: <span class="math inline">\(H_0:\)</span> there is no interaction between the dose of vitamin C and delivery method on tooth growth in guinea pigs, meaning that the relationship between vitamin C and tooth growth is the same for both delivery methods (similarly, the relationship between delivery method and tooth growth is the same for all doses of vitamin C).</p></li>
<li><p>alternative hypothesis: <span class="math inline">\(H_1\)</span>: there is an interaction between the dose vitamin C and delivery method on tooth growth in guinea pigs, meaning that the relationship between vitamin C and tooth growth is different for both delivery methods (similarly, the relationship between delivery method and tooth growth depends on the dose of vitamin C).</p></li>
</ul>
</section>
<section id="b-1" class="level4">
<h4 class="anchored" data-anchor-id="b-1">b</h4>
<p>We can plot the relationship one by one using two plots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ToothGrowth)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ToothGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   len supp dose
1  4.2   VC  0.5
2 11.5   VC  0.5
3  7.3   VC  0.5
4  5.8   VC  0.5
5  6.4   VC  0.5
6 10.0   VC  0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># potential effects of vitamin C on tooth growth.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(dose), <span class="at">y =</span> len)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dose (mg/day)"</span>, <span class="at">y =</span> <span class="st">"Tooth Growth (len)"</span>, <span class="at">title =</span> <span class="st">"Tooth Growth by Dose of vitamin C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># potential effects of delivery method on tooth growth.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> supp, <span class="at">y =</span> len)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Delivery Method"</span>, <span class="at">y =</span> <span class="st">"Tooth Growth (len)"</span>, <span class="at">title =</span> <span class="st">"Tooth Growth by Delivery Method"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>or just one:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># potential effects of vitamin C and delivery method. </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># OJ represents orange juice and VC represents ascorbic acid.</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(dose), <span class="at">y =</span> len, <span class="at">fill =</span> supp)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dose (mg/day)"</span>, <span class="at">y =</span> <span class="st">"Tooth Growth (len)"</span>, <span class="at">title =</span> <span class="st">"Tooth Growth by Dose and Delivery Method"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="c-1" class="level4">
<h4 class="anchored" data-anchor-id="c-1">c</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform two-way ANOVA</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
supp         1  205.4   205.4  12.317 0.000894 ***
dose         1 2224.3  2224.3 133.415  &lt; 2e-16 ***
supp:dose    1   88.9    88.9   5.333 0.024631 *  
Residuals   56  933.6    16.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Since all p-values are less than 0.05, we reject all null hypotheses. Therefore, there is sufficient evidence to conclude that the dose of vitamin C, delivery method, and their interaction have significant effects on tooth growth in guinea pigs.</p>
</section>
<section id="d-1" class="level4">
<h4 class="anchored" data-anchor-id="d-1">d</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(anova_result<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">"QQ-plot of residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22 50</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="non-parametric-tests" class="level2">
<h2 class="anchored" data-anchor-id="non-parametric-tests">Non-parametric tests</h2>
<section id="application-of-testing-the-goodness-of-fit" class="level3">
<h3 class="anchored" data-anchor-id="application-of-testing-the-goodness-of-fit">Application of testing the goodness of fit</h3>
<p>Testing whether there is a “good fit” between the observed data and the assumed probability model amounts to testing:</p>
<section id="construction-of-test-statistics-with-an-example-of-2-categories" class="level4">
<h4 class="anchored" data-anchor-id="construction-of-test-statistics-with-an-example-of-2-categories">Construction of test statistics with an example of 2 categories</h4>
<p>Population is 60% female and 40% male. Then, if a sample of 100 students yields 53 females and 47 males, can we conclude that the sample is (random and) representative of the population? That is, how “good” do the data “fit” the assumed probability model of 60% female and 40% male?</p>
<p>Here, let <span class="math inline">\(Y_1\)</span> denote the number of females selected, <span class="math inline">\(Y_1 \sim B(n,p_1)\)</span> and let <span class="math inline">\(Y_2\)</span> denote males selected, <span class="math inline">\(Y_2 = (n-Y_1)\sim B(n,p_2)=B(n,1-p_1)\)</span>.</p>
<p>for samples satisfying the general rule of thumb (the expected number of successes must be at least 5 and the expected number of failures must be at least 5), we can use the normal approximation to the binomial distribution. The test statistic is given by</p>
<p><span class="math display">\[
Z = \frac{Y_1 - np_1}{\sqrt{np_1(1-p_1)}}\sim N(0,1)
\]</span></p>
<p>which is at least approximately normally distributed.</p>
<p>and <span class="math display">\[
Z^2 =Q_1= \frac{(Y_1 - np_1)^2}{np_1(1-p_1)}\sim \chi^2(1)
\]</span></p>
<p>which is an approximate chi-square distribution with one degree of freedom.</p>
<p>Now we can multiply <span class="math inline">\(Q_1\)</span> by 1 = <span class="math inline">\((1-p_1)+p_1\)</span> to get</p>
<p><span class="math display">\[
Q_1 = \frac{(Y_1 - np_1)^2(1-p_1)}{np_1(1-p_1)} + \frac{(Y_1 - np_1)^2p_1}{np_1(1-p_1)}\sim \chi^2(1)
\]</span></p>
<p>Since <span class="math inline">\(Y_1=n-Y_2\)</span> and <span class="math inline">\(p_1=1-p_2\)</span>, after simplifying, we have</p>
<p><span class="math display">\[
Q_1 = \frac{(Y_1-np_1)^2}{np_1} + \frac{(-(Y_2-np_2))^2}{np_2}\sim \chi^2(1)
\]</span></p>
<p>which is <span class="math inline">\(Q_1=\sum_{i=1}^2 \frac{\left(Y_i-n p_i\right)^2}{n p_i}=\sum_{i=1}^2 \frac{(\text { Observed }- \text { Expected })^2}{\text { Expected }}\sim \chi^2(1)\)</span></p>
<p>Hence, it is observed that if the observed counts are very different from the expected counts, then the test statistic will be large. So we reject the null hypothesis if <span class="math inline">\(Q_1\)</span> is large and how large is large is determined by the critical value of the chi-square distribution with one degree of freedom.</p>
<p>The statistics <span class="math inline">\(Q_1\)</span> is called the chi-square goodness of fit statistic.</p>
<p>Going back to the example,</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>:<span class="math inline">\(p_F = 0.6\)</span></p></li>
<li><p><span class="math inline">\(H_1\)</span>:<span class="math inline">\(p_F \ne 0.6\)</span></p></li>
</ul>
<p>we can calculate the test statistic using a significant level of <span class="math inline">\(\alpha = 0.05\)</span> (<span class="math inline">\(\chi^2_{0.05,1}=3.84\)</span>)as follows:</p>
<p><span class="math display">\[
Q_1 = \frac{(53-60)^2}{60} + \frac{(47-40)^2}{40} = 2.04
\]</span></p>
<p>Since <span class="math inline">\(Q_1=2.04&lt;3.84\)</span>, we do not reject the null hypothesis. Therefore, we conclude that the sample is (random and) representative of the population.</p>
<p><strong>This can be extended to k categories</strong></p>
</section>
<section id="construction-of-test-statistics-with-an-example-of-k-categories" class="level4">
<h4 class="anchored" data-anchor-id="construction-of-test-statistics-with-an-example-of-k-categories">Construction of test statistics with an example of k categories</h4>
<p>For categories more than 2, i.e.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Categories</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;"><span class="math inline">\(\cdots\)</span></th>
<th style="text-align: left;"><span class="math inline">\(k-1\)</span></th>
<th style="text-align: left;"><span class="math inline">\(k\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed</td>
<td style="text-align: left;"><span class="math inline">\(Y_1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Y_2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\cdots\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Y_{k-1}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n-Y_1-Y_2-\cdots-Y_{k-1}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Expected</td>
<td style="text-align: left;"><span class="math inline">\(n p_1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n p_2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\cdots\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n p_{k-1}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n p_k\)</span></td>
</tr>
</tbody>
</table>
<p>Karl Pearson showed that the chi-square statistic <span class="math inline">\(Q_{k-1}\)</span> defined as: <span class="math display">\[
Q_{k-1}=\sum_{i=1}^k \frac{\left(Y_i-n p_i\right)^2}{n p_i}
\]</span> follows approximately a chi-square random variable with <span class="math inline">\(k-1\)</span> degrees of freedom. Let’s try it out on an example.</p>
<ul>
<li>Example:</li>
</ul>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Categories</th>
<th style="text-align: left;">Brown</th>
<th style="text-align: left;">Yellow</th>
<th style="text-align: left;">Orange</th>
<th style="text-align: left;">Green</th>
<th style="text-align: left;">Coffee</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed <span class="math inline">\(y_i\)</span></td>
<td style="text-align: left;">224</td>
<td style="text-align: left;">119</td>
<td style="text-align: left;">130</td>
<td style="text-align: left;">48</td>
<td style="text-align: left;">59</td>
<td style="text-align: left;">580</td>
</tr>
<tr class="even">
<td style="text-align: left;">Assumed <span class="math inline">\(H_0\left(p_i\right)\)</span></td>
<td style="text-align: left;">0.4</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Expected <span class="math inline">\(n p_i\)</span></td>
<td style="text-align: left;">232</td>
<td style="text-align: left;">116</td>
<td style="text-align: left;">116</td>
<td style="text-align: left;">58</td>
<td style="text-align: left;">58</td>
<td style="text-align: left;">580</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(Q_4=\frac{(224-232)^2}{232}+\frac{(119-116)^2}{116}+\frac{(130-116)^2}{116}+\frac{(48-58)^2}{58}+\frac{(59-58)^2}{58}=3.784\)</span></p>
<p>Because there are <span class="math inline">\(k=5\)</span> categories, we have to compare our chisquare statistic <span class="math inline">\(Q_4\)</span> to a chi-square distribution with <span class="math inline">\(k-1=5-1=4\)</span> degrees of freedom: <span class="math display">\[
Q_4=3.784&lt;\chi_{4,0.05}^2=9.488
\]</span> we fail to reject the null hypothesis.</p>
</section>
</section>
<section id="application-of-testing-for-homogeneity" class="level3">
<h3 class="anchored" data-anchor-id="application-of-testing-for-homogeneity">Application of testing for homogeneity</h3>
<p>This is to look at a method for testing whether two or more multinomial distributions are equal.</p>
<ul>
<li>Example:</li>
</ul>
<p>Test the hypothesis that the acceptances of males and females are ditributed equally among the four schools,</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">(Acceptances)</th>
<th style="text-align: left;">Bus</th>
<th style="text-align: left;">Eng</th>
<th style="text-align: left;">L Arts</th>
<th style="text-align: left;">Sci</th>
<th style="text-align: left;">(FIXED) Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">240 (20%)</td>
<td style="text-align: left;">480 (40%)</td>
<td style="text-align: left;">120 (10%)</td>
<td style="text-align: left;">360 (30%)</td>
<td style="text-align: left;">1200</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">240 (30%)</td>
<td style="text-align: left;">80 (10%)</td>
<td style="text-align: left;">320 (40%)</td>
<td style="text-align: left;">160 (20%)</td>
<td style="text-align: left;">800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">480 (24%)</td>
<td style="text-align: left;">560 (28%)</td>
<td style="text-align: left;">440 (22%)</td>
<td style="text-align: left;">520 (26%)</td>
<td style="text-align: left;">2000</td>
</tr>
</tbody>
</table>
<p>Here,</p>
<p><span class="math inline">\(H_0: p_{M B}=p_{F B}, p_{M E}=p_{F E}, p_{M L}=p_{F L}\)</span>, and <span class="math inline">\(p_{M S}=p_{F S}\)</span></p>
<p><span class="math inline">\(H_1: p_{M B} \neq p_{F B}\)</span> or <span class="math inline">\(p_{M E} \neq p_{F E}\)</span> or <span class="math inline">\(p_{M L} \neq p_{F L}\)</span>, or <span class="math inline">\(p_{M S} \neq p_{F S}\)</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(p_{M j}\)</span> is the proportion of males accepted into school <span class="math inline">\(j=B, E, L, S\)</span>.</p></li>
<li><p><span class="math inline">\(p_{F j}\)</span> is the proportion of females accepted into school <span class="math inline">\(j=B, E, L, S\)</span>.</p></li>
</ul>
<p>In conducting such a hypothesis test, we’re comparing the proportions of two multinomial distributions.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#(Acc)</th>
<th style="text-align: left;">Bus ( <span class="math inline">\(j=1\)</span> )</th>
<th style="text-align: left;">Eng ( <span class="math inline">\(j=2\)</span> )</th>
<th style="text-align: left;">L Arts ( <span class="math inline">\(j=3\)</span> )</th>
<th style="text-align: left;">Sci <span class="math inline">\((j=4)\)</span></th>
<th style="text-align: left;">(FIXED) Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mathrm{M}(i=1)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{11}\left(\hat{p}_{11}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{12}\left(\hat{p}_{12}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{13}\left(\hat{p}_{13}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{14}\left(\hat{p}_{14}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_1=\sum_{j=1}^k y_{1 j}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">F <span class="math inline">\((i=2)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{21}\left(\hat{p}_{21}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{22}\left(\hat{p}_{22}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{23}\left(\hat{p}_{23}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{24}\left(\hat{p}_{24}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_2=\sum_{j=1}^k y_{2 j}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;"><span class="math inline">\(y_{11}+y_{21}\left(\hat{p}_1\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{12}+y_{22}\left(\hat{p}_2\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{13}+y_{23}\left(\hat{p}_3\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{14}+y_{24}\left(\hat{p}_4\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_1+n_2\)</span></td>
</tr>
</tbody>
</table>
<p>The chi-square test statistic for testing the equality of two multinomial distributions: <span class="math display">\[
Q=\sum_{i=1}^2 \sum_{j=1}^k \frac{\left(y_{i j}-n_i \hat{p}_j\right)^2}{n_i \hat{p}_j}
\]</span> follows an approximate chi-square distribution with <span class="math inline">\(k-1\)</span> degrees of freedom. Reject the null hypothesis of equal proportions if <span class="math inline">\(Q\)</span> is large (since if male and female distributed nearly equally, the expected number of each should be <span class="math inline">\(n_i\hat p_j\)</span>): <span class="math display">\[
Q \geq \chi_{\alpha, k-1}^2
\]</span></p>
<p>(omit the derive of the above Q)</p>
<p>Generally,</p>
<p><span class="math display">\[
Q=\sum_{i=1}^h \sum_{j=1}^k \frac{\left(y_{i j}-n_i \hat{p}_j\right)^2}{n_i \hat{p}_j}\sim \chi^2_{(h-1)(k-1)}
\]</span></p>
<section id="further-example" class="level4">
<h4 class="anchored" data-anchor-id="further-example">Further example</h4>
<p>The head of a surgery department at a university medical center was concerned that surgical residents in training applied unnecessary blood transfusions at a different rate than the more experienced attending physicians. Therefore, he ordered a study of the 49 Attending Physicians and 71 Residents in Training with privileges at the hospital. For each of the 120 surgeons, the number of blood transfusions prescribed unnecessarily in a one-year period was recorded. Based on the number recorded, a surgeon was identified as either prescribing unnecessary blood transfusions Frequently, Occasionally, Rarely, or Never. Here’s a summary table (or “contingency table”) of the resulting data:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Physician</th>
<th style="text-align: left;">Frequent</th>
<th style="text-align: left;">Occasionally</th>
<th style="text-align: left;">Rarely</th>
<th style="text-align: left;">Never</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attending</td>
<td style="text-align: left;">6.942</td>
<td style="text-align: left;">12.658</td>
<td style="text-align: left;">22.05</td>
<td style="text-align: left;">7.35</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Resident</td>
<td style="text-align: left;">10.058</td>
<td style="text-align: left;">18.342</td>
<td style="text-align: left;">31.95</td>
<td style="text-align: left;">10.65</td>
<td style="text-align: left;">71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">31</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">120</td>
</tr>
</tbody>
</table>
<p>Here,</p>
<p><span class="math inline">\(H_0: p_{R F}=p_{A F}, p_{R O}=p_{A O}, p_{R R}=p_{A R}\)</span>, and <span class="math inline">\(p_{R N}=p_{A N}\)</span></p>
<p><span class="math inline">\(H_1: p_{R F} \neq p_{A F}\)</span> or <span class="math inline">\(p_{R O} \neq p_{A O}\)</span> or <span class="math inline">\(p_{R R} \neq p_{A R}\)</span>, or <span class="math inline">\(p_{R N} \neq p_{A N}\)</span></p>
<p>We should also calculate the expected counts under the null hypothesis. The expected counts are calculated as follows:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Physician</th>
<th style="text-align: left;">Frequent</th>
<th style="text-align: left;">Occasionally</th>
<th style="text-align: left;">Rarely</th>
<th style="text-align: left;">Never</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attending</td>
<td style="text-align: left;">6.942</td>
<td style="text-align: left;">12.658</td>
<td style="text-align: left;">22.05</td>
<td style="text-align: left;">7.35</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Resident</td>
<td style="text-align: left;">10.058</td>
<td style="text-align: left;">18.342</td>
<td style="text-align: left;">31.95</td>
<td style="text-align: left;">10.65</td>
<td style="text-align: left;">71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">31</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">120</td>
</tr>
</tbody>
</table>
<p>where, for example, <span class="math inline">\(6.942=\frac{17}{120} \times 49\)</span> and <span class="math inline">\(10.058=\frac{17}{120} \times 71\)</span>. Now that we have the observed and expected counts, calculating the chisquare statistic is a straightforward exercise: <span class="math display">\[
Q=\frac{(2-6.942)^2}{6.942}+\cdots+\frac{(5-10.65)^2}{10.65}=31.88
\]</span></p>
<p>The chi-square test tells us to reject the null hypothesis, at the 0.05 level, if <span class="math inline">\(Q\)</span> is greater than a chi-square random variable with 3 degrees of freedom, that is, if <span class="math inline">\(Q=31.88&gt;7.815\)</span>, we reject the null hypothesis.</p>
</section>
</section>
<section id="application-of-testing-for-independence" class="level3">
<h3 class="anchored" data-anchor-id="application-of-testing-for-independence">Application of testing for independence</h3>
<p>This is to look at whether two or more categorical variables are independent.</p>
<p>(previously,the the sampling scheme involves: Taking two random (and therefore independent) samples with n1 and n2 fixed in advance and observing into which of the k categories the first random samples fall, and observing into which of the k categories the second random samples fall. )</p>
<p>lets consider a different example to illustrate an alternative sampling scheme. Suppose 395 people are randomly selected, and are “cross-classified” into one of eight cells, depending into which age category they fall and whether or not they support legalizing marijuana:</p>
<p>(the sampling scheme involves: Taking one random sample of size n, with n fixed in advance, and then “cross-classifying” each subject into one and only one of the mutually exclusive and exhaustive <span class="math inline">\(A_i\cap B_j\)</span> cells.)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Marijuana Support</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable B (Age)</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Variable A</td>
<td style="text-align: left;">OBSERVED</td>
<td style="text-align: left;"><span class="math inline">\((18-24) B_1\)</span></td>
<td style="text-align: left;">(25-34) <span class="math inline">\(B_1 2\)</span></td>
<td style="text-align: left;">(35-49) <span class="math inline">\(B_3\)</span></td>
<td style="text-align: left;"><span class="math inline">\((50-64) B_4\)</span></td>
<td style="text-align: left;">Total</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(YES) <span class="math inline">\(A_1\)</span></td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">46</td>
<td style="text-align: left;">41</td>
<td style="text-align: left;">201</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">(NO) <span class="math inline">\(A_2\)</span></td>
<td style="text-align: left;">40</td>
<td style="text-align: left;">44</td>
<td style="text-align: left;">53</td>
<td style="text-align: left;">57</td>
<td style="text-align: left;">194</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Total</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">99</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;"><span class="math inline">\(n=395\)</span></td>
</tr>
</tbody>
</table>
<p>Here,</p>
<p>H0 : Variable A is independent of variable B, that is <span class="math inline">\(P(A_i\cap B_j)=PA_i \times B_j\)</span> for all i and j</p>
<p>H1: Variable A is not independent of variable B.</p>
<p>Generally,</p>
<p>Suppose we have <span class="math inline">\(k\)</span> (column) levels of Variable B indexed by the letter <span class="math inline">\(j\)</span>, and <span class="math inline">\(h\)</span> (row) levels of Variable <span class="math inline">\(A\)</span> indexed by the letter <span class="math inline">\(i\)</span>. Then, we can summarize the data and probability model in tabular format, as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Variable B</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Variable A</td>
<td style="text-align: center;"><span class="math inline">\(B_1(j=1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B_2(j=2)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B_3(j=3)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B_4(j=4)\)</span></td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(A_1(i=1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{11}\left(p_{11}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{12}\left(p_{12}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{13}\left(p_{13}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{14}\left(p_{14}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{1 .}\right)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(A_2(i=2)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{21}\left(p_{21}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{22}\left(p_{22}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{23}\left(p_{23}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{24}\left(p_{24}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{2 .}\right)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Total</td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.1}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.2}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.3}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.4}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(p_{i j}=Y_{i j} / n, p_i .=\sum_{j=1}^k p_{i j}\)</span>, and <span class="math inline">\(p_{. j}=\sum_{i=1}^h p_{i j}\)</span></p>
<p><span class="math inline">\(Q=\sum_{j=1}^k \sum_{i=1}^h \frac{\left(y_{i j}-\frac{y_i \cdot y_{\cdot j}}{n}\right)^2}{\frac{y_i \cdot y_{\cdot j}}{n}}\sim \chi^2_{(h-1)(k-1)}\)</span></p>
<section id="are-chi-square-statistic-for-homogeneity-and-the-chi-square-statistic-for-independence-equivalent" class="level4">
<h4 class="anchored" data-anchor-id="are-chi-square-statistic-for-homogeneity-and-the-chi-square-statistic-for-independence-equivalent">Are chi-square statistic for homogeneity and the chi-square statistic for independence equivalent?</h4>
<p>Although their chi-square statistics are equivalent, the two tests are not equivalent since their sampling experiment designs are different.</p>
<p>Here’s the table of expected counts:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Bicycle Riding Interest</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable B (Age)</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Variable A</td>
<td style="text-align: left;">EXPECTED</td>
<td style="text-align: left;">18-24</td>
<td style="text-align: left;">25-34</td>
<td style="text-align: left;">35-49</td>
<td style="text-align: left;">50-64</td>
<td style="text-align: left;">Total</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">50.886</td>
<td style="text-align: left;">49.868</td>
<td style="text-align: left;">50.377</td>
<td style="text-align: left;">49.868</td>
<td style="text-align: left;">201</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">49.114</td>
<td style="text-align: left;">48.132</td>
<td style="text-align: left;">48.623</td>
<td style="text-align: left;">48.132</td>
<td style="text-align: left;">194</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Total</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">99</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">395</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
Q=\frac{(60-50.886)^2}{50.886}+\cdots+\frac{(57-48.132)^2}{48.132}=8.006
\]</span></p>
<p>The chi-square test tells us to reject the null hypothesis, at the 0.05 level, since <span class="math inline">\(Q\)</span> is greater than a chi-square random variable with 3 degrees of freedom, that is, <span class="math inline">\(Q=8.006&gt;7.815\)</span>.</p>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">Summary</h4>
<p>Parametric tests make assumptions that aspects of the data follow some sort of theoretical probability distribution. Non-parametric tests or distribution free methods do not, and are used when the distributional assumptions for a parametric test are not met. While this is an advantage, it often comes at a cost of power (in the sense they are less likely to be able to detect a difference when a true difference exists).</p>
<p>Most non-parametric tests are just hypothesis tests; there is no estimation of a confidence interval.</p>
<p>Most non-parametric methods are based on ranking the values of a variable in ascending order and then calculating a test statistic based on the sums of these ranks.</p>
<p>Non-parametric tests include:</p>
<ul>
<li><p>Two-sample independent t-test - Wilcoxon rank-sum test or Mann-Whitney U test</p></li>
<li><p>Paired t-test - Wilcoxon signed-rank test</p></li>
<li><p>One-way ANOVA - Kruskal-Wallace Test</p></li>
<li><p>Normality tests - Shapiro-Wilk test and Kolmogorov-Smirnov test</p></li>
</ul>
</section>
</section>
</section>
</section>
<section id="linear-regression" class="level1">
<h1>Linear Regression</h1>
<section id="simple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="simple-linear-regression">Simple linear regression</h2>
<section id="brief-introduction" class="level3">
<h3 class="anchored" data-anchor-id="brief-introduction">Brief introduction</h3>
<p>Some people think simple methods is bad and like complicated methods , but actually simple is very good–SLR works very well in lots of situations.</p>
<p>SLR is used to answer:</p>
<p>is there a relationship between..</p>
<p>How strong the relationship is</p>
<p>which variable contribute to this relationship</p>
<p>How accurate could we predict the response variable</p>
<p>Is the relationship linear?</p>
<p>Is there a synergy among independent variables?</p>
<p>This is a model with two random variables, X and Y, where we are trying to predict Y from X. Here are the model’s assumptions:</p>
<ul>
<li><p>The distribution of X is arbitrary, possibly is even non-random;</p></li>
<li><p>If X=x, then <span class="math inline">\(Y = \beta_0+\beta_1x+\epsilon\)</span> for some constants <span class="math inline">\(\beta_0, \beta_1\)</span> and some random noise variable <span class="math inline">\(\epsilon\)</span></p></li>
<li><p><span class="math inline">\(\epsilon\)</span> has mean 0, a constant variance <span class="math inline">\(\sigma^2\)</span>, and is uncorrelated with X and uncorrelated across observations Cov<span class="math inline">\((\epsilon_i, \epsilon_j)=0\)</span> for <span class="math inline">\(i \ne j\)</span></p></li>
</ul>
<p>Using Least Squares, we can estimate <span class="math inline">\(\hat \beta_0\)</span> and <span class="math inline">\(\hat \beta_1\)</span>, which are unbiased estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<ul>
<li>Gaussian-Noise Simple Linear Regression Model</li>
</ul>
<p>Now we further assume that the distribution of <span class="math inline">\(\epsilon\)</span> is normal, i.e.&nbsp;<span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span>, independent of X.</p>
<p>They tell us, exactly, the probability distribution for Y given X, and so will let us get exact distributions for predictions and for other inferential statistics.</p>
</section>
<section id="maximum-likelihood-estimation-mle" class="level3">
<h3 class="anchored" data-anchor-id="maximum-likelihood-estimation-mle">Maximum Likelihood Estimation (MLE)</h3>
<section id="introduction-to-mle" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-mle">Introduction to MLE</h4>
<p>Likelihood is a fundamental concept in statistics that measures how well a particular set of parameters (e.g., the mean of a distribution) explains observed data. Think of it as a “score” that tells you which parameter values make your data most plausible.</p>
<p>Compared to probability, which answers: “What’s the chance of seeing this data if we assume specific parameters?” , likelihood answers: “Given this data, how plausible are these parameters?”</p>
<p>If the parameters are <span class="math inline">\(b_0, b_1, s^2\)</span> (reserving the Greek letters for their true values), then <span class="math inline">\(Y \mid X=x \sim N\left(b_0+b_1 x, s^2\right)\)</span>, and <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(Y_j\)</span> are independent given <span class="math inline">\(X_i\)</span> and <span class="math inline">\(X_j\)</span>, so the overall likelihood is <span class="math display">\[
\prod_{i=1}^n \frac{1}{\sqrt{2 \pi s^2}} e^{-\frac{\left(y_i-\left(b_0+b_i x_i\right)\right)^2}{2 s^2}}
\]</span></p>
<p>As usual, we work with the log-likelihood, which gives us the same information but replaces products with sums: <span class="math display">\[
L\left(b_0, b_1, s^2\right)=-\frac{n}{2} \ln \left(2 \pi s^2\right)-\frac{1}{2 s^2} \sum_{i=1}^n\left(y_i-\left(b_0+b_1 x_i\right)\right)^2
\]</span></p>
<p>maximize it:</p>
<p><span class="math inline">\(\begin{aligned} \frac{\partial L}{\partial b_0} &amp; =-\frac{1}{2 s^2} \sum_{i=1}^n 2\left(y_i-\left(b_0+b_1 x_i\right)\right)(-1) \\ \frac{\partial L}{\partial b_1} &amp; =-\frac{1}{2 s^2} \sum_{i=1}^n 2\left(y_i-\left(b_0+b_1 x_i\right)\right)\left(-x_i\right)\end{aligned}\)</span></p>
</section>
<section id="same-result-of-mle-as-least-squares-in-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="same-result-of-mle-as-least-squares-in-linear-regression">Same result of MLE as least squares in linear regression</h4>
<p>Notice that when we set these derivatives to zero, all the multiplicative constants - in particular, the prefactor of <span class="math inline">\(1 / 2 s^2\)</span> - go away. We are left with <span class="math display">\[
\begin{aligned}
\sum_{i=1}^n\left(y_i-\left(\hat{\beta_0}+\hat{\beta_1} x_i\right)\right) &amp; =0 \\
\sum_{i=1}^n\left(y_i-\left(\hat{\beta_0}+\hat{\beta_0} x_i\right)\right) x_i &amp; =0
\end{aligned}
\]</span></p>
<p>These are, up to a factor of <span class="math inline">\(1 / n\)</span>, exactly the equations we got from the method of least squares. That means that the least squares solution is the maximum likelihood estimate under the Gaussian noise model.</p>
<p>Maximum likelihood estimates of the regression curve coincide with least-squares estimates when the noise around the curve is additive, Gaussian, of constant variance, and both independent of <span class="math inline">\(X\)</span> and of other noise terms. If any of those assumptions fail, maximum likelihood and least squares estimates can diverge.</p>
</section>
</section>
<section id="hypothesis-testing-for-estimates-with-unknown-sigma2" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing-for-estimates-with-unknown-sigma2">Hypothesis testing for estimates with unknown <span class="math inline">\(\sigma^2\)</span></h3>
<section id="residual-sum-of-squares-rss-and-t-statistics-construction-in-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="residual-sum-of-squares-rss-and-t-statistics-construction-in-linear-regression">Residual sum of squares (RSS) and t-statistics construction in linear regression</h4>
<p>It can be shown that (the proof is beyond the scope of this course) <span class="math display">\[
\frac{R S S}{\sigma^2}=\frac{(n-2) \hat{\sigma}^2}{\sigma^2} \sim \chi_{n-2}^2
\]</span></p>
<p>This allows us to construct a <span class="math inline">\(t\)</span>-value <span class="math display">\[
t=\frac{\hat{\beta}-\beta}{s_{\hat{\beta}}} \sim t_{n-2}
\]</span></p>
<p>Under the normality assumption of the error terms, the estimator of the slope coefficient will itself be normally distributed with mean <span class="math inline">\(\beta_i\)</span> and variance <span class="math inline">\(\operatorname{Var}\left[\beta_i\right]\)</span> For <span class="math inline">\(\hat{\beta_1}\)</span>, its mean is <span class="math inline">\(\beta_1\)</span> and its variance is <span class="math inline">\(\sigma^2 / \sum\left(x_i-\bar{x}\right)^2\)</span>. When <span class="math inline">\(\sigma^2\)</span> is known, we know <span class="math display">\[
\frac{\hat{\beta}_1-\beta_1}{\frac{\sigma}{\sqrt{\sum_{i=1}^n\left(x_i-\bar{x}\right)^2}}}
\]</span> follows standard normal distribution. However, in practice, <span class="math inline">\(\sigma^2\)</span> is often unknown. We then divide this standard normal distributed term by <span class="math display">\[
\sqrt{\frac{(n-2) \hat{\sigma}^2}{(n-2) \sigma^2}}=\frac{\hat{\sigma}}{\sigma}
\]</span></p>
<p>Therefore, when we write <span class="math display">\[
s_{\hat{\beta_1}}=\frac{\hat{\sigma}}{\sqrt{\sum_{i=1}^n\left(x_i-\bar{x}\right)^2}}
\]</span> we construct a <span class="math inline">\(t\)</span>-statistic for <span class="math inline">\(\hat{\beta_1}\)</span> with degrees of freedom <span class="math inline">\(n-2\)</span>. This then allows us to construct a <span class="math inline">\(100(1-\alpha) \%\)</span> confidence interval for <span class="math inline">\(\beta_1\)</span> : <span class="math display">\[
\hat{\beta_1} \pm t_{n-2, \alpha / 2} \times \boldsymbol{s}_{\hat{\beta_1}}
\]</span></p>
<p>We can also do similar calculation to get the <span class="math inline">\(t\)</span>-statistic and confidence interval for <span class="math inline">\(\beta_0\)</span>.</p>
</section>
<section id="hyphothesis-testing" class="level4">
<h4 class="anchored" data-anchor-id="hyphothesis-testing">Hyphothesis Testing</h4>
<p><span class="math display">\[
t =\hat {\beta}-\beta / s_{\hat{\beta_1}} \sim t_{n-2}
\]</span> <span class="math inline">\(H_0: \beta_i =0\)</span></p>
<p><span class="math inline">\(H_1: \beta_i \ne 0\)</span></p>
</section>
<section id="codes-of-linear-regression-with-ci" class="level4">
<h4 class="anchored" data-anchor-id="codes-of-linear-regression-with-ci">Codes of linear regression with CI</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lmodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Petal.Width, <span class="at">data=</span>iris)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Petal.Length ~ Petal.Width, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.33542 -0.30347 -0.02955  0.25776  1.39453 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.08356    0.07297   14.85   &lt;2e-16 ***
Petal.Width  2.22994    0.05140   43.39   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4782 on 148 degrees of freedom
Multiple R-squared:  0.9271,    Adjusted R-squared:  0.9266 
F-statistic:  1882 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %   97.5 %
(Intercept) 0.9393664 1.227750
Petal.Width 2.1283752 2.331506</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>conf_interval <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmodel, <span class="at">data=</span>iris, <span class="at">interval=</span><span class="st">'confidence'</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width, iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Petal.Width'</span>, <span class="at">ylab=</span><span class="st">'Petal.Length'</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">'Simple Linear Regression'</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lmodel, <span class="at">col=</span><span class="st">'lightblue'</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(iris<span class="sc">$</span>Petal.Width, conf_interval[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using ggplot2</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Petal.Width, <span class="at">y=</span>Petal.Length)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>stats<span class="sc">::</span>lm, <span class="at">se=</span>T, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-regression-and-anova" class="level4">
<h4 class="anchored" data-anchor-id="linear-regression-and-anova">Linear Regression and ANOVA</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fev_dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'fev_dat.txt'</span>, <span class="at">header=</span>T)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fev_dat_subset <span class="ot">&lt;-</span> fev_dat[fev_dat<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> fev_dat<span class="sc">$</span>age <span class="sc">&lt;=</span> <span class="dv">10</span>,]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fev_dat_subset, <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>FEV)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>stats<span class="sc">::</span>lm, <span class="at">se=</span>T, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(FEV <span class="sc">~</span> age, <span class="at">data=</span>fev_dat_subset))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(FEV <span class="sc">~</span> age, <span class="at">data=</span>fev_dat_subset))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(FEV <span class="sc">~</span> age, <span class="at">data=</span>fev_dat_subset))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="r2the-fraction-of-variability-explained-by-the-regression" class="level3">
<h3 class="anchored" data-anchor-id="r2the-fraction-of-variability-explained-by-the-regression"><span class="math inline">\(R^2\)</span>–the fraction of variability explained by the regression</h3>
<p><span class="math display">\[
R^2 =1-\frac{SSR}{SSTO}
\]</span></p>
</section>
</section>
<section id="multiple-linear-regression-mlr" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression-mlr">Multiple linear regression (MLR)</h2>
<p><span class="math inline">\(y=X\beta+\epsilon\)</span>, where y is a n × 1 row vector, X is a n × (k + 1) matrix, and β is a (k + 1) × 1 column vector for all n observations.</p>
<section id="a-potential-problem-in-practice-multicollinearity" class="level3">
<h3 class="anchored" data-anchor-id="a-potential-problem-in-practice-multicollinearity">A potential problem in practice –multicollinearity</h3>
<p>When multicollinearity exists, any of the following pitfalls can be exacerbated:</p>
<ul>
<li><p>The estimated regression coefficient of any one variable depends on which other predictors are included in the model</p></li>
<li><p>The precision of the estimated regression coefficients decreases as more predictors are added to the model</p></li>
<li><p>The marginal contribution of any one predictor variable in reducing the error sum of squares depends on which other predictors are already in the model</p></li>
<li><p>Typothesis tests for βj = 0 may yield different conclusions depending on which predictors are in the model</p></li>
</ul>
<section id="perfect-multicollinearity" class="level4">
<h4 class="anchored" data-anchor-id="perfect-multicollinearity">Perfect multicollinearity</h4>
<p>Perfect multicollinearity refers to a situation where the predictive variables have an exact linear relationship. When there is perfect collinearity, the design matrix X has less than full rank, and therefore the moment matrix X′X cannot be inverted. In this situation, the parameter estimates of the regression are not well-defined, as the system of equations has infinitely many solutions.</p>
</section>
<section id="imperfect-multicollinearity" class="level4">
<h4 class="anchored" data-anchor-id="imperfect-multicollinearity">Imperfect multicollinearity</h4>
<p>Imperfect multicollinearity refers to a situation where the predictive variables have a nearly exact linear relationship.</p>
<p><span class="math inline">\(R^2=r^2\)</span> where r is the Pearson correlation coefficient.</p>
</section>
</section>
<section id="adjusted-r-squared" class="level3">
<h3 class="anchored" data-anchor-id="adjusted-r-squared">Adjusted R-squared</h3>
<p>Adjusted R-squared is a modified version of R-squared that adjusts for the number of predictors in a model. It provides a more accurate measure of the model’s explanatory power, penalizing for the addition of irrelevant predictors. This helps in comparing models with different numbers of predictors.</p>
</section>
</section>
</section>
<section id="logistic-regression" class="level1">
<h1>Logistic Regression</h1>
<p>This is a regression of categorical outcome.</p>
<p>In regression analysis with a categorical outcome, such as predicting a binary variable (yes or no), simple linear regression is not ideal. This is because:</p>
<ul>
<li><p>The predicted values may fall outside the range of 0 to 1, which is not meaningful for probabilities.</p></li>
<li><p>Small changes in the predictors can lead to relatively small fluctuations in the predicted probabilities near the 0.5 mark (natural threshold), which is actually where decision-making is most critical.</p></li>
</ul>
<p>So we need S-curve to satisfy above things.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x)), <span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"f(x)"</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Logistic Function: f(x) = 1 / (1 + exp(-x))"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>An example of a not well-predicted logistic model (since stock is not easy to predict)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Smarket)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>glm.fits <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    Direction <span class="sc">~</span> Lag1 <span class="sc">+</span> Lag2 <span class="sc">+</span> Lag3 <span class="sc">+</span> Lag4 <span class="sc">+</span> Lag5 <span class="sc">+</span> Volume,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Smarket, <span class="at">family =</span> binomial</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.fits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + 
    Volume, family = binomial, data = Smarket)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -0.126000   0.240736  -0.523    0.601
Lag1        -0.073074   0.050167  -1.457    0.145
Lag2        -0.042301   0.050086  -0.845    0.398
Lag3         0.011085   0.049939   0.222    0.824
Lag4         0.009359   0.049974   0.187    0.851
Lag5         0.010313   0.049511   0.208    0.835
Volume       0.135441   0.158360   0.855    0.392

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1731.2  on 1249  degrees of freedom
Residual deviance: 1727.6  on 1243  degrees of freedom
AIC: 1741.6

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>glm.probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.fits, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>glm.probs[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
0.5070841 0.4814679 0.4811388 0.5152224 0.5107812 0.5069565 0.4926509 0.5092292 
        9        10 
0.5176135 0.4888378 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>glm.pred <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Down"</span>, <span class="dv">1250</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>glm.pred[glm.probs <span class="sc">&gt;</span> .<span class="dv">5</span>] <span class="ot">=</span> <span class="st">"Up"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(glm.pred, Direction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Direction
glm.pred Down  Up
    Down  145 141
    Up    457 507</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">507</span> <span class="sc">+</span> <span class="dv">145</span>) <span class="sc">/</span> <span class="dv">1250</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(glm.pred <span class="sc">==</span> Direction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5216</code></pre>
</div>
</div>
<section id="odds" class="level2">
<h2 class="anchored" data-anchor-id="odds">Odds</h2>
<p>Odds are another way of quantifying the probability of an event, commonly used in gambling (and logistic regression).</p>
<p>For some event <span class="math inline">\(E\)</span>, <span class="math display">\[
\operatorname{odds}(E)=\frac{P(E)}{P\left(E^c\right)}=\frac{P(E)}{1-P(E)}
\]</span></p>
<p>The odds ratio (OR) is the ratio of the odds of an event occurring in one group to the odds of it occuring in another group. If the event in each of the groups are <span class="math inline">\(p_1\)</span> (first group) and <span class="math inline">\(p_2\)</span> (second group), then the odds ratio is: <span class="math display">\[
\mathrm{OR}=\frac{p_1 /\left(1-p_1\right)}{p_2 /\left(1-p_2\right)}
\]</span></p>
</section>
</section>
<section id="generalized-linear-models" class="level1">
<h1>Generalized Linear Models</h1>
<p>Under the hood, we’re still using a linear model <span class="math inline">\(\left(\beta_0+\beta_1 x\right)\)</span>, but now it’s embedded in a function that ensures valid probabilities. This is the essence of logistic regression - a generalized linear model (GLM) designed for binary outcomes.</p>
<p>Given predictor <span class="math inline">\(X\)</span> and d an outcom <span class="math inline">\(Y\)</span>, a GLM is defined by three components: - A random component, that specifies a distribution for <span class="math inline">\(Y \mid X\)</span> - A systematic component, that relates a parameter <span class="math inline">\(\eta\)</span> to the predictor <span class="math inline">\(X\)</span> <span class="math display">\[
\eta=\beta_0+\beta_1 X_1+\cdots+\beta_k X_k
\]</span> - A link function, that connects the random and systematic component</p>
<section id="random-component" class="level2">
<h2 class="anchored" data-anchor-id="random-component">Random Component</h2>
<p>The random component specifies a distribution for the outcome variable (conditional on <span class="math inline">\(X\)</span> ). In the case of linear regression, we assume that <span class="math inline">\(Y \mid X \sim \mathcal{N}\left(\mu, \sigma^2\right)\)</span>, for some mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. In the case of logistic regression, we assume that <span class="math inline">\(Y \mid X \sim \operatorname{Bern}(p)\)</span> for some probability <span class="math inline">\(p\)</span>.</p>
<p>In a generalized model, we are allowed to assume that <span class="math inline">\(Y \mid X\)</span> has a probability density function or probability mass function of the form <span class="math display">\[
f(y ; \theta, \phi)=\exp \left(\frac{y \theta-b(\theta)}{a(\phi)}+c(y, \phi)\right)
\]</span></p>
<p>Here <span class="math inline">\(\theta, \phi\)</span> are parameters, and <span class="math inline">\(a, b, c\)</span> are functions. Any density of the above form is called an exponential family density. The parameter <span class="math inline">\(\theta\)</span> is called the natural parameter, and the parameter <span class="math inline">\(\phi\)</span> the dispersion parameter.</p>
</section>
<section id="exponential-family" class="level2">
<h2 class="anchored" data-anchor-id="exponential-family">Exponential Family</h2>
<p>Exponential families include many of the most common distributions. For example: - Exponential <span class="math display">\[
f(y ; \lambda)=\lambda e^{-\lambda y}=\exp (-y \lambda+\ln \lambda)
\]</span> where <span class="math inline">\(\theta=-\lambda, \phi=1, b(\theta)=\ln \lambda, a(\phi)=1\)</span>, and <span class="math inline">\(c(y, \phi)=0\)</span> - Poisson <span class="math display">\[
f(y ; \lambda)=\frac{e^{-\lambda} \lambda^y}{y!}=\exp (y \ln \lambda-\lambda-\ln (y!))
\]</span> where <span class="math inline">\(\theta=\ln \lambda, \phi=1, b(\theta)=e^\theta=\lambda, a(\phi)=1\)</span>, and <span class="math inline">\(c(y, \phi)=-\lambda-\ln (y!)\)</span></p>
</section>
<section id="systematic-component-and-link-component" class="level2">
<h2 class="anchored" data-anchor-id="systematic-component-and-link-component">Systematic Component and Link Component</h2>
<p>The systematic component relates a parameter <span class="math inline">\(\eta\)</span> to the predictors <span class="math inline">\(X\)</span>. In a GLM, this is always done via <span class="math display">\[
\eta=X \beta=\beta_0+\beta_1 X_1+\cdots+\beta_k X_k
\]</span></p>
<p>We will denote the expectation of the distribution in random component as <span class="math inline">\(\mu\)</span>, i.e., <span class="math inline">\(\mathbb{E}[Y \mid X]=\mu\)</span>. It will be our goal to estimate <span class="math inline">\(\mu\)</span>. Finally, the link component connects the random and systematic components, via a link function <span class="math inline">\(g\)</span>. In particular, this link function provides a connection between <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\eta\)</span>, as in <span class="math display">\[
g(\mu)=\eta \quad \text { or } \quad \mu=g^{-1}(\eta)
\]</span></p>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<section id="gaussian-noise-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="gaussian-noise-linear-regression">Gaussian-noise Linear Regression</h3>
<ul>
<li>Random Component: <span class="math inline">\(Y \mid X \sim \mathcal{N}\left(\mu, \sigma^2\right)\)</span> and <span class="math inline">\(\mathbb{E}[Y \mid X]=\mu\)</span></li>
<li>Systematic Component: <span class="math inline">\(\eta=X \beta\)</span></li>
<li>Link Component: <span class="math inline">\(g(\mu)=\mu\)</span>, so that <span class="math inline">\(\mu=\eta=X \beta\)</span></li>
</ul>
</section>
<section id="bernoulli" class="level3">
<h3 class="anchored" data-anchor-id="bernoulli">Bernoulli</h3>
<p>Suppose that <span class="math inline">\(Y \in\{0,1\}\)</span>, and we model the distribution of <span class="math inline">\(Y \mid X\)</span> as Bernoulli with success probability <span class="math inline">\(p\)</span>. Then the probability mass function (not a density, since <span class="math inline">\(Y\)</span> is discrete) is <span class="math display">\[
f(y)=p^y(1-p)^{1-y}
\]</span></p>
<p>We can rewrite to fit the exponential family form as <span class="math display">\[
\begin{aligned}
f(y) &amp; =\exp (y \log p+(1-y) \log (1-p)) \\
&amp; =\exp (y \log (p /(1-p))+\log (1-p))
\end{aligned}
\]</span></p>
<p><span class="math display">\[
f(y ; \theta, \phi)=\exp \left(\frac{y \theta-b(\theta)}{a(\phi)}+c(y, \phi)\right)
\]</span></p>
<p>Here we would identify <span class="math inline">\(\theta=\log (p /(1-p))\)</span> as the natural parameter. Note that the mean here is <span class="math inline">\(\mu=p\)</span>, and using the inverse of the above relationship, we can directly write the mean <span class="math inline">\(p\)</span> as a function of <span class="math inline">\(\theta\)</span>, as in <span class="math inline">\(p=e^\theta /\left(1+e^\theta\right)\)</span>. Hence <span class="math inline">\(b(\theta)=\log (1-p)=-\log \left(1+e^\theta\right)\)</span>. There is no dispersion parameter, so we can set <span class="math inline">\(a(\phi)=1\)</span>. Also, <span class="math inline">\(c(y, \phi)=0\)</span>.</p>
</section>
</section>
</section>
<section id="link-function" class="level1">
<h1>Link Function</h1>
<p><span class="math display">\[
g(\mu)=\Phi^{-1}(\mu)
\]</span> where <span class="math inline">\(\Phi\)</span> is the standard normal CDF.</p>
<section id="logistic" class="level3">
<h3 class="anchored" data-anchor-id="logistic">Logistic</h3>
<p>The three GLM criteria give us: - <span class="math inline">\(y_i \sim \operatorname{Bern}\left(p_i\right)\)</span> - <span class="math inline">\(\eta=\beta_0+\beta_1 X_1+\cdots+\beta_k X_k\)</span> - <span class="math inline">\(\operatorname{logit}(p)=\log \frac{p}{1-p}=\eta\)</span></p>
<p>From which we know, <span class="math display">\[
p_i=\frac{\exp \left(\beta_0+\beta_1 x_{i 1}+\cdots+\beta_k X_{i k}\right)}{1+\exp \left(\beta_0+\beta_1 x_{i 1}+\cdots+\beta_k X_{i k}\right)}
\]</span></p>
</section>
</section>
<section id="survival-analysis" class="level1">
<h1>Survival Analysis</h1>
<p>Survival analysis is used to analyze data in which the time until the event is of interest. The response is often referred to as a failure time, survival time, or event time.</p>
<section id="some-definations" class="level2">
<h2 class="anchored" data-anchor-id="some-definations">Some definations</h2>
<p>Hazard ratios; ratios of hazard functions between different groups (e.g., exposed vs.&nbsp;unexposed) while adjusting for confounders.</p>
<p>censoring - which occurs when the survival time is only partially known</p>
<ul>
<li><p>Fixed type I censoring occurs when a study is designed to end after C years of follow-up. In this case, everyone who does not have an event observed during the course of the study is censored at C years.</p></li>
<li><p>In random type I censoring, the study is designed to end after C years, but censored subjects do not all have the same censoring time. This is the main type of right-censoring we will be concerned with.</p></li>
<li><p>In type II censoring, a study ends when there is a pre-specified number of events.</p></li>
</ul>
</section>
<section id="kaplan-meier-estimate" class="level2">
<h2 class="anchored" data-anchor-id="kaplan-meier-estimate">Kaplan-Meier estimate</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(BrainCancer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sex"       "diagnosis" "loc"       "ki"        "gtv"       "stereo"   
[7] "status"    "time"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(BrainCancer)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>status
 0  1 
53 35 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>fit.surv <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.surv, <span class="at">xlab =</span> <span class="st">"Months"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Estimated Probability of Survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cox-proportional-harzards-model" class="level2">
<h2 class="anchored" data-anchor-id="cox-proportional-harzards-model">Cox-proportional harzards model</h2>
<p>S(t) = P(T&gt;t)=1-F(t)</p>
<p><span class="math inline">\(h(t)=\lim _{\Delta t \rightarrow 0} \frac{P(t&lt;T \leq t+\Delta t \mid T&gt;t)}{\Delta t}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fit.all <span class="ot">&lt;-</span> <span class="fu">coxph</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex <span class="sc">+</span> diagnosis <span class="sc">+</span> loc <span class="sc">+</span> ki <span class="sc">+</span> gtv <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>   stereo)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>fit.all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, status) ~ sex + diagnosis + loc + 
    ki + gtv + stereo)

                       coef exp(coef) se(coef)      z        p
sexMale             0.18375   1.20171  0.36036  0.510  0.61012
diagnosisLG glioma  0.91502   2.49683  0.63816  1.434  0.15161
diagnosisHG glioma  2.15457   8.62414  0.45052  4.782 1.73e-06
diagnosisOther      0.88570   2.42467  0.65787  1.346  0.17821
locSupratentorial   0.44119   1.55456  0.70367  0.627  0.53066
ki                 -0.05496   0.94653  0.01831 -3.001  0.00269
gtv                 0.03429   1.03489  0.02233  1.536  0.12466
stereoSRT           0.17778   1.19456  0.60158  0.296  0.76760

Likelihood ratio test=41.37  on 8 df, p=1.776e-06
n= 87, number of events= 35 
   (1 observation deleted due to missingness)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>modaldata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">diagnosis =</span> <span class="fu">levels</span>(diagnosis),</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">sex =</span> <span class="fu">rep</span>(<span class="st">"Female"</span>, <span class="dv">4</span>),</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">loc =</span> <span class="fu">rep</span>(<span class="st">"Supratentorial"</span>, <span class="dv">4</span>),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ki =</span> <span class="fu">rep</span>(<span class="fu">mean</span>(ki), <span class="dv">4</span>),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">gtv =</span> <span class="fu">rep</span>(<span class="fu">mean</span>(gtv), <span class="dv">4</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">stereo =</span> <span class="fu">rep</span>(<span class="st">"SRT"</span>, <span class="dv">4</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>survplots <span class="ot">&lt;-</span> <span class="fu">survfit</span>(fit.all, <span class="at">newdata =</span> modaldata)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(survplots, <span class="at">xlab =</span> <span class="st">"Months"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="fu">levels</span>(diagnosis), <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="labs-for-r-code" class="level1">
<h1>Labs for R-code</h1>
<section id="basic-calculation" class="level2">
<h2 class="anchored" data-anchor-id="basic-calculation">basic calculation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="dv">1</span>)  <span class="co"># exp() is the exponential function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.718282</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">5</span>)  <span class="co"># unless you specify the base, R will assume base e</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.609438</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="dv">5</span>, <span class="at">base=</span><span class="dv">10</span>)  <span class="co"># base 10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.69897</code></pre>
</div>
</div>
</section>
<section id="vectors" class="level2">
<h2 class="anchored" data-anchor-id="vectors">Vectors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="at">from=</span><span class="dv">1</span>, <span class="at">to=</span><span class="dv">4</span>, <span class="at">by=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>)  <span class="co"># 'by' has a default of 1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>  <span class="co"># a shortcut for seq(1,4)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">by=</span>.<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.0 1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="at">length.out=</span><span class="dv">11</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.0 1.4 1.8 2.2 2.6 3.0 3.4 3.8 4.2 4.6 5.0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>x <span class="sc">*</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  4  9 16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%*%</span> x    <span class="co"># scalar ("inner") product (1 x 1 matrix)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   30</code></pre>
</div>
</div>
</section>
<section id="vector-algebra" class="level2">
<h2 class="anchored" data-anchor-id="vector-algebra">Vector Algebra</h2>
<p>All algebra done with vectors will be done element-wise by default. For matrix and vector multiplication as usually defined by mathematicians, use <code>%*%</code> instead of <code>*</code>. So two vectors added together result in their individual elements being summed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">8</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>x <span class="sc">+</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  6  8 10 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">*</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  5 12 21 32</code></pre>
</div>
</div>
</section>
<section id="matrices" class="level2">
<h2 class="anchored" data-anchor-id="matrices">Matrices</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(a,b)  <span class="co"># Row Bind: a,b are rows in resultant matrix    </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [,1] [,2] [,3]
a    1    2    3
b    4    5    6</code></pre>
</div>
</div>
</section>
<section id="factors" class="level2">
<h2 class="anchored" data-anchor-id="factors">Factors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">factor</span>(iris<span class="sc">$</span>Species,</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'versicolor'</span>,<span class="st">'setosa'</span>,<span class="st">'virginica'</span>),</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Versicolor'</span>,<span class="st">'Setosa'</span>,<span class="st">'Virginica'</span>))</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(Sepal.Length <span class="sc">~</span> Species, <span class="at">data=</span>iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="list" class="level2">
<h2 class="anchored" data-anchor-id="list">List</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">letters=</span><span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>), </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">numbers=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>, <span class="at">ncol=</span><span class="dv">5</span>))</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mylist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "A" "b" "c"

$numbers
[1] 1 2 3

[[3]]
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    6   11   16   21
[2,]    2    7   12   17   22
[3,]    3    8   13   18   23
[4,]    4    9   14   19   24
[5,]    5   10   15   20   25</code></pre>
</div>
</div>
</section>
<section id="ggplot-2" class="level2">
<h2 class="anchored" data-anchor-id="ggplot-2">ggplot 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)  <span class="co"># load the iris dataset that comes with R</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris)   <span class="co"># what columns do we have to play with...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   150 obs. of  5 variables:
 $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width)) <span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Species)) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Iris Sepal Length vs Width"</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Sepal Length (cm)"</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Sepal Width (cm)"</span>) <span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(iris$Sepal.Length, iris$Petal.Length)</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data=</span>iris)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data=</span>iris), <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-manipulation" class="level2">
<h2 class="anchored" data-anchor-id="data-manipulation">Data manipulation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.4     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1
✔ readr     2.1.5     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
✖ dplyr::recode() masks car::recode()
✖ purrr::some()   masks car::some()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
 Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
 1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
 Median :5.800   Median :3.000   Median :4.350   Median :1.300  
 Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
 3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
 Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
       Species  
 setosa    :50  
 versicolor:50  
 virginica :50  
                
                
                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> iris[,<span class="sc">-</span><span class="dv">5</span>]  <span class="co"># Exclude the Species column</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(iris, <span class="at">MARGIN=</span><span class="dv">2</span>, <span class="at">FUN=</span>mean)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Sepal.Length  Sepal.Width Petal.Length  Petal.Width 
    5.843333     3.057333     3.758000     1.199333 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># lappy and sapply</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">beta =</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">logic =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x, quantile, <span class="at">probs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
 25%  50%  75% 
3.25 5.50 7.75 

$beta
      25%       50%       75% 
0.2516074 1.0000000 5.0536690 

$logic
25% 50% 75% 
0.0 0.5 1.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x, quantile, <span class="at">probs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       a      beta logic
25% 3.25 0.2516074   0.0
50% 5.50 1.0000000   0.5
75% 7.75 5.0536690   1.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(hair_color, skin_color, eye_color)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 3
   hair_color    skin_color  eye_color
   &lt;chr&gt;         &lt;chr&gt;       &lt;chr&gt;    
 1 blond         fair        blue     
 2 &lt;NA&gt;          gold        yellow   
 3 &lt;NA&gt;          white, blue red      
 4 none          white       yellow   
 5 brown         light       brown    
 6 brown, grey   light       blue     
 7 brown         light       blue     
 8 &lt;NA&gt;          white, red  red      
 9 black         light       brown    
10 auburn, white fair        blue-gray
# ℹ 77 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filter</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Droid"</span> <span class="sc">&amp;</span> mass <span class="sc">&lt;</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name  height  mass hair_color skin_color  eye_color birth_year sex   gender   
  &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
1 C-3PO    167    75 &lt;NA&gt;       gold        yellow           112 none  masculine
2 R2-D2     96    32 &lt;NA&gt;       white, blue red               33 none  masculine
3 R5-D4     97    32 &lt;NA&gt;       white, red  red               NA none  masculine
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># arrange</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Yarael …    264    NA none       white      yellow          NA   male  mascu…
 2 Tarfful     234   136 brown      brown      blue            NA   male  mascu…
 3 Lama Su     229    88 none       grey       black           NA   male  mascu…
 4 Chewbac…    228   112 brown      unknown    blue           200   male  mascu…
 5 Roos Ta…    224    82 none       grey       orange          NA   male  mascu…
 6 Grievous    216   159 none       brown, wh… green, y…       NA   male  mascu…
 7 Taun We     213    NA none       grey       black           NA   fema… femin…
 8 Rugor N…    206    NA none       green      orange          NA   male  mascu…
 9 Tion Me…    206    80 none       grey       black           NA   male  mascu…
10 Darth V…    202   136 none       white      yellow          41.9 male  mascu…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bmi =</span> mass <span class="sc">/</span> ((height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, bmi) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  name             bmi
  &lt;chr&gt;          &lt;dbl&gt;
1 Luke Skywalker  26.0
2 C-3PO           26.9
3 R2-D2           34.7
4 Darth Vader     33.3
5 Leia Organa     21.8
6 Owen Lars       37.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarise</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(species) <span class="sc">%&gt;%</span> </span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_height =</span> <span class="fu">mean</span>(height, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(mean_height))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 38 × 2
   species  mean_height
   &lt;chr&gt;          &lt;dbl&gt;
 1 Quermian        264 
 2 Wookiee         231 
 3 Kaminoan        221 
 4 Kaleesh         216 
 5 Gungan          209.
 6 Pau'an          206 
 7 Besalisk        198 
 8 Cerean          198 
 9 Chagrian        196 
10 Nautolan        196 
# ℹ 28 more rows</code></pre>
</div>
</div>
</section>
<section id="evaluation-metrics-for-classification" class="level2">
<h2 class="anchored" data-anchor-id="evaluation-metrics-for-classification">Evaluation Metrics for Classification</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the dataset </span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'survey_lung_cancer.csv'</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>LUNG_CANCER <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>LUNG_CANCER<span class="sc">==</span><span class="st">"YES"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    GENDER               AGE           SMOKING      YELLOW_FINGERS
 Length:309         Min.   :21.00   Min.   :1.000   Min.   :1.00  
 Class :character   1st Qu.:57.00   1st Qu.:1.000   1st Qu.:1.00  
 Mode  :character   Median :62.00   Median :2.000   Median :2.00  
                    Mean   :62.67   Mean   :1.563   Mean   :1.57  
                    3rd Qu.:69.00   3rd Qu.:2.000   3rd Qu.:2.00  
                    Max.   :87.00   Max.   :2.000   Max.   :2.00  
    ANXIETY      PEER_PRESSURE   CHRONIC DISEASE    FATIGUE     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
 Median :1.000   Median :2.000   Median :2.000   Median :2.000  
 Mean   :1.498   Mean   :1.502   Mean   :1.505   Mean   :1.673  
 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  
 Max.   :2.000   Max.   :2.000   Max.   :2.000   Max.   :2.000  
    ALLERGY         WHEEZING     ALCOHOL CONSUMING    COUGHING    
 Min.   :1.000   Min.   :1.000   Min.   :1.000     Min.   :1.000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000     1st Qu.:1.000  
 Median :2.000   Median :2.000   Median :2.000     Median :2.000  
 Mean   :1.557   Mean   :1.557   Mean   :1.557     Mean   :1.579  
 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000     3rd Qu.:2.000  
 Max.   :2.000   Max.   :2.000   Max.   :2.000     Max.   :2.000  
 SHORTNESS OF BREATH SWALLOWING DIFFICULTY   CHEST PAIN     LUNG_CANCER    
 Min.   :1.000       Min.   :1.000         Min.   :1.000   Min.   :0.0000  
 1st Qu.:1.000       1st Qu.:1.000         1st Qu.:1.000   1st Qu.:1.0000  
 Median :2.000       Median :1.000         Median :2.000   Median :1.0000  
 Mean   :1.641       Mean   :1.469         Mean   :1.557   Mean   :0.8738  
 3rd Qu.:2.000       3rd Qu.:2.000         3rd Qu.:2.000   3rd Qu.:1.0000  
 Max.   :2.000       Max.   :2.000         Max.   :2.000   Max.   :1.0000  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(SMOKING), <span class="at">fill =</span> <span class="fu">factor</span>(LUNG_CANCER))) <span class="sc">+</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"salmon"</span>)) <span class="sc">+</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Data SAMPLING ####</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    cluster</code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>split <span class="ot">=</span> <span class="fu">createDataPartition</span>(data<span class="sc">$</span>LUNG_CANCER, <span class="at">p =</span> <span class="fl">0.80</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">=</span> data[split,]</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">=</span> data[<span class="sc">-</span>split,]</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 248</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61</code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(train_data)<span class="sc">/</span><span class="fu">nrow</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.802589</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#error metrics -- Confusion Matrix</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>err_metric<span class="ot">=</span><span class="cf">function</span>(CM)</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">=</span>CM[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">=</span>CM[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">=</span>CM[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">=</span>CM[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>  precision <span class="ot">=</span>(TP)<span class="sc">/</span>(TP<span class="sc">+</span>FP)</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>  recall_score <span class="ot">=</span>(TP)<span class="sc">/</span>(TP<span class="sc">+</span>FN)</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>  f1_score<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>((precision<span class="sc">*</span>recall_score)<span class="sc">/</span>(precision<span class="sc">+</span>recall_score))</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>  accuracy_model  <span class="ot">=</span>(TP<span class="sc">+</span>TN)<span class="sc">/</span>(TP<span class="sc">+</span>TN<span class="sc">+</span>FP<span class="sc">+</span>FN)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>  False_positive_rate <span class="ot">=</span>(FP)<span class="sc">/</span>(FP<span class="sc">+</span>TN)</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>  False_negative_rate <span class="ot">=</span>(FN)<span class="sc">/</span>(FN<span class="sc">+</span>TP)</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Precision value of the model: "</span>,<span class="fu">round</span>(precision,<span class="dv">2</span>)))</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy of the model: "</span>,<span class="fu">round</span>(accuracy_model,<span class="dv">2</span>)))</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Recall value of the model: "</span>,<span class="fu">round</span>(recall_score,<span class="dv">2</span>)))</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"False Positive rate of the model: "</span>,<span class="fu">round</span>(False_positive_rate,<span class="dv">2</span>)))</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"False Negative rate of the model: "</span>,<span class="fu">round</span>(False_negative_rate,<span class="dv">2</span>)))</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"F1 score of the model: "</span>,<span class="fu">round</span>(f1_score,<span class="dv">2</span>)))</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>logit_m <span class="ot">=</span><span class="fu">glm</span>(<span class="at">formula =</span> LUNG_CANCER <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = LUNG_CANCER ~ ., family = "binomial", data = train_data)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             -32.13449    6.57393  -4.888 1.02e-06 ***
GENDERM                  -0.84716    0.82793  -1.023 0.306203    
AGE                       0.01537    0.03490   0.440 0.659756    
SMOKING                   1.10495    0.82246   1.343 0.179119    
YELLOW_FINGERS            1.10971    0.82005   1.353 0.175982    
ANXIETY                   2.08645    1.08610   1.921 0.054725 .  
PEER_PRESSURE             1.94159    0.74009   2.623 0.008704 ** 
`CHRONIC DISEASE`         3.91378    1.12190   3.489 0.000486 ***
FATIGUE                   2.62906    0.89032   2.953 0.003148 ** 
ALLERGY                   1.42702    0.83764   1.704 0.088454 .  
WHEEZING                  1.07933    0.90761   1.189 0.234357    
`ALCOHOL CONSUMING`       2.41116    0.98495   2.448 0.014365 *  
COUGHING                  3.14783    1.22386   2.572 0.010110 *  
`SHORTNESS OF BREATH`    -0.22681    0.84245  -0.269 0.787757    
`SWALLOWING DIFFICULTY`   2.24613    1.24347   1.806 0.070865 .  
`CHEST PAIN`              0.89356    0.73930   1.209 0.226791    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 198.230  on 247  degrees of freedom
Residual deviance:  77.353  on 232  degrees of freedom
AIC: 109.35

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>logit_m2 <span class="ot">=</span><span class="fu">glm</span>(<span class="at">formula =</span> LUNG_CANCER <span class="sc">~</span> ANXIETY<span class="sc">+</span>PEER_PRESSURE<span class="sc">+</span><span class="st">`</span><span class="at">CHRONIC DISEASE</span><span class="st">`</span><span class="sc">+</span>FATIGUE<span class="sc">+</span>ALLERGY<span class="sc">+</span><span class="st">`</span><span class="at">ALCOHOL CONSUMING</span><span class="st">`</span><span class="sc">+</span>COUGHING<span class="sc">+</span><span class="st">`</span><span class="at">SWALLOWING DIFFICULTY</span><span class="st">`</span>, <span class="at">data =</span> train_data, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = LUNG_CANCER ~ ANXIETY + PEER_PRESSURE + `CHRONIC DISEASE` + 
    FATIGUE + ALLERGY + `ALCOHOL CONSUMING` + COUGHING + `SWALLOWING DIFFICULTY`, 
    family = "binomial", data = train_data)

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             -27.3830     5.5206  -4.960 7.05e-07 ***
ANXIETY                   2.5514     0.8659   2.947 0.003213 ** 
PEER_PRESSURE             2.1822     0.7245   3.012 0.002593 ** 
`CHRONIC DISEASE`         3.5120     0.9696   3.622 0.000292 ***
FATIGUE                   2.4939     0.6979   3.573 0.000353 ***
ALLERGY                   2.0104     0.7428   2.707 0.006796 ** 
`ALCOHOL CONSUMING`       2.5084     0.8653   2.899 0.003744 ** 
COUGHING                  3.2220     0.9540   3.377 0.000732 ***
`SWALLOWING DIFFICULTY`   2.5273     1.0096   2.503 0.012309 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 198.230  on 247  degrees of freedom
Residual deviance:  83.501  on 239  degrees of freedom
AIC: 101.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>logit_P_prob <span class="ot">=</span> <span class="fu">predict</span>(logit_m, <span class="at">newdata =</span> <span class="fu">select</span>(test_data, <span class="sc">-</span>LUNG_CANCER), <span class="at">type =</span> <span class="st">'response'</span>)</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>logit_P_prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3 
0.9912600 0.9997708 0.9980692 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>logit_P <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(logit_P_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># Probability check</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>logit_P[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 
1 1 1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>CM <span class="ot">=</span> <span class="fu">table</span>(test_data<span class="sc">$</span>LUNG_CANCER, logit_P)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   logit_P
     0  1
  0  3  2
  1  1 55</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">err_metric</span>(CM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Precision value of the model:  0.96"
[1] "Accuracy of the model:  0.95"
[1] "Recall value of the model:  0.98"
[1] "False Positive rate of the model:  0.4"
[1] "False Negative rate of the model:  0.02"
[1] "F1 score of the model:  0.97"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ROC-curve using pROC library</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>roc_score<span class="ot">=</span><span class="fu">roc</span>(test_data<span class="sc">$</span>LUNG_CANCER, logit_P_prob) <span class="co">#AUC score</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_score, <span class="at">main =</span> <span class="st">"ROC curve -- Logistic Regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>