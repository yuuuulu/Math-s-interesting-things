<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Foundation Math Learning - APH101-Biostatistics And R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Foundation Math Learning</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://yuuuulu.github.io/"> 
<span class="menu-text">yuuuulu</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Homepage</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./aph101.html" aria-current="page"> 
<span class="menu-text">Biostat and R</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mth107.html"> 
<span class="menu-text">Advanced Linear Algebra</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Simple_ODEs.html"> 
<span class="menu-text">ODEs and PDEs with codes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mth106.html"> 
<span class="menu-text">ODE, PDE, and Fourier Series</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Mathematical Analysis 1.html"> 
<span class="menu-text">Analysis 1</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./mth1113.html"> 
<span class="menu-text">intro to prob, and stat.</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./Calculus.html"> 
<span class="menu-text">Calculus</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#i-am-deeply-grateful-to-dr.-daiyun-huang-for-his-instruction-in-the-biostatistics-and-r-course.-this-course-has-marked-the-beginning-of-my-formal-journey-into-the-world-of-statistics.-dr.-huangs-comprehensive-lectures-accompanied-by-detailed-pdfs-and-his-well-structured-labs-complete-with-code-and-solutions-have-been-incredibly-valuable.-they-have-not-only-enhanced-my-intuitive-grasp-of-key-statistical-concepts-such-as-hypothesis-testing-but-also-significantly-improved-my-proficiency-in-r-programming." id="toc-i-am-deeply-grateful-to-dr.-daiyun-huang-for-his-instruction-in-the-biostatistics-and-r-course.-this-course-has-marked-the-beginning-of-my-formal-journey-into-the-world-of-statistics.-dr.-huangs-comprehensive-lectures-accompanied-by-detailed-pdfs-and-his-well-structured-labs-complete-with-code-and-solutions-have-been-incredibly-valuable.-they-have-not-only-enhanced-my-intuitive-grasp-of-key-statistical-concepts-such-as-hypothesis-testing-but-also-significantly-improved-my-proficiency-in-r-programming." class="nav-link active" data-scroll-target="#i-am-deeply-grateful-to-dr.-daiyun-huang-for-his-instruction-in-the-biostatistics-and-r-course.-this-course-has-marked-the-beginning-of-my-formal-journey-into-the-world-of-statistics.-dr.-huangs-comprehensive-lectures-accompanied-by-detailed-pdfs-and-his-well-structured-labs-complete-with-code-and-solutions-have-been-incredibly-valuable.-they-have-not-only-enhanced-my-intuitive-grasp-of-key-statistical-concepts-such-as-hypothesis-testing-but-also-significantly-improved-my-proficiency-in-r-programming.">I am deeply grateful to Dr.&nbsp;Daiyun Huang for his instruction in the “Biostatistics and R” course. This course has marked the beginning of my formal journey into the world of statistics. Dr.&nbsp;Huang’s comprehensive lectures, accompanied by detailed PDFs, and his well-structured labs, complete with code and solutions, have been incredibly valuable. They have not only enhanced my intuitive grasp of key statistical concepts, such as hypothesis testing, but also significantly improved my proficiency in R programming.</a></li>
  <li><a href="#also-thanks-to-the-course-of-introduction-to-statistical-learning-by-trevor-hastie-and-robert-tibshirani.-examples-in-their-online-video-lectures-are-abundant-and-easy-to-understand-for-beginners.-their-book-is-also-very-helpful." id="toc-also-thanks-to-the-course-of-introduction-to-statistical-learning-by-trevor-hastie-and-robert-tibshirani.-examples-in-their-online-video-lectures-are-abundant-and-easy-to-understand-for-beginners.-their-book-is-also-very-helpful." class="nav-link" data-scroll-target="#also-thanks-to-the-course-of-introduction-to-statistical-learning-by-trevor-hastie-and-robert-tibshirani.-examples-in-their-online-video-lectures-are-abundant-and-easy-to-understand-for-beginners.-their-book-is-also-very-helpful.">Also, thanks to the course of “Introduction to statistical learning” by Trevor Hastie and Robert Tibshirani. Examples in their online video lectures are abundant and easy to understand for beginners. Their book is also very helpful.</a></li>
  <li><a href="#review-and-introduce-probability" id="toc-review-and-introduce-probability" class="nav-link" data-scroll-target="#review-and-introduce-probability">Review and Introduce Probability</a>
  <ul class="collapse">
  <li><a href="#simple-random-sampling" id="toc-simple-random-sampling" class="nav-link" data-scroll-target="#simple-random-sampling">Simple Random Sampling</a></li>
  <li><a href="#unbiased-estimator" id="toc-unbiased-estimator" class="nav-link" data-scroll-target="#unbiased-estimator">Unbiased estimator</a></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance">Variance</a></li>
  <li><a href="#sampling-distribution" id="toc-sampling-distribution" class="nav-link" data-scroll-target="#sampling-distribution">Sampling distribution</a>
  <ul class="collapse">
  <li><a href="#sample-mean-of-i.i.d.-normals" id="toc-sample-mean-of-i.i.d.-normals" class="nav-link" data-scroll-target="#sample-mean-of-i.i.d.-normals">Sample mean of i.i.d. normals</a></li>
  </ul></li>
  <li><a href="#simulation" id="toc-simulation" class="nav-link" data-scroll-target="#simulation">Simulation</a></li>
  <li><a href="#moment-generating-functions" id="toc-moment-generating-functions" class="nav-link" data-scroll-target="#moment-generating-functions">Moment generating functions</a>
  <ul class="collapse">
  <li><a href="#definition" id="toc-definition" class="nav-link" data-scroll-target="#definition">Definition</a></li>
  <li><a href="#theorems-about-mgf" id="toc-theorems-about-mgf" class="nav-link" data-scroll-target="#theorems-about-mgf">Theorems about MGF</a></li>
  </ul></li>
  <li><a href="#distribution-transformation" id="toc-distribution-transformation" class="nav-link" data-scroll-target="#distribution-transformation">Distribution Transformation</a>
  <ul class="collapse">
  <li><a href="#universality-of-the-uniformfrom-uniform-you-can-get-everything" id="toc-universality-of-the-uniformfrom-uniform-you-can-get-everything" class="nav-link" data-scroll-target="#universality-of-the-uniformfrom-uniform-you-can-get-everything">Universality of the Uniform—From uniform you can get everything</a></li>
  <li><a href="#normal-distribution" id="toc-normal-distribution" class="nav-link" data-scroll-target="#normal-distribution">Normal Distribution</a></li>
  <li><a href="#from.." id="toc-from.." class="nav-link" data-scroll-target="#from..">From…..</a></li>
  </ul></li>
  <li><a href="#pdf-functionss-transformationfrom-books" id="toc-pdf-functionss-transformationfrom-books" class="nav-link" data-scroll-target="#pdf-functionss-transformationfrom-books">PDF functions’s transformation(from books)</a>
  <ul class="collapse">
  <li><a href="#standard-normal-distribution" id="toc-standard-normal-distribution" class="nav-link" data-scroll-target="#standard-normal-distribution">Standard normal distribution</a></li>
  <li><a href="#chi-square-distribution" id="toc-chi-square-distribution" class="nav-link" data-scroll-target="#chi-square-distribution">Chi-square distribution</a></li>
  <li><a href="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2" id="toc-from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2" class="nav-link" data-scroll-target="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Chi-square distribution <span class="math inline">\(f(x; k) = \frac{1}{2^{k/2} \Gamma(k/2)} x^{k/2 - 1} e^{-x/2}\)</span></a></li>
  <li><a href="#student--t-distribution" id="toc-student--t-distribution" class="nav-link" data-scroll-target="#student--t-distribution">Student- t distribution</a></li>
  <li><a href="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom." id="toc-from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom." class="nav-link" data-scroll-target="#from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom.">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Student- t distribution <span class="math inline">\(f(t) = \frac{\Gamma \left(\frac{\nu+1}{2}\right)}{\sqrt{\nu \pi} \, \Gamma \left(\frac{\nu}{2}\right)} \left(1 + \frac{t^2}{\nu}\right)^{-\frac{\nu+1}{2}}\)</span>, where <span class="math inline">\(\Gamma\)</span> is the gamma function and <span class="math inline">\(\nu\)</span> is the degrees of freedom.</a></li>
  <li><a href="#f-distribution" id="toc-f-distribution" class="nav-link" data-scroll-target="#f-distribution">F-distribution</a></li>
  <li><a href="#we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution" id="toc-we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution" class="nav-link" data-scroll-target="#we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution">We will do some trnsformation on chi-square distribution to get F-distribution</a></li>
  <li><a href="#beta-and-gamma" id="toc-beta-and-gamma" class="nav-link" data-scroll-target="#beta-and-gamma">beta and Gamma</a></li>
  <li><a href="#why-is-the-integral-result-as-shown" id="toc-why-is-the-integral-result-as-shown" class="nav-link" data-scroll-target="#why-is-the-integral-result-as-shown">Why is the integral result as shown?</a></li>
  </ul></li>
  <li><a href="#three-main-sampling-distribution" id="toc-three-main-sampling-distribution" class="nav-link" data-scroll-target="#three-main-sampling-distribution">Three Main Sampling distribution</a>
  <ul class="collapse">
  <li><a href="#chi-square-distribution-1" id="toc-chi-square-distribution-1" class="nav-link" data-scroll-target="#chi-square-distribution-1">Chi-square distribution</a></li>
  <li><a href="#students-t-distribution" id="toc-students-t-distribution" class="nav-link" data-scroll-target="#students-t-distribution">Student’s t-distribution</a></li>
  <li><a href="#f-distribution-1" id="toc-f-distribution-1" class="nav-link" data-scroll-target="#f-distribution-1">F-distribution</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#estimation-of-population-characteristic" id="toc-estimation-of-population-characteristic" class="nav-link" data-scroll-target="#estimation-of-population-characteristic">Estimation of Population Characteristic</a>
  <ul class="collapse">
  <li><a href="#point-estimation" id="toc-point-estimation" class="nav-link" data-scroll-target="#point-estimation">Point Estimation</a></li>
  </ul></li>
  <li><a href="#interval-estimationconfidence-intervalci" id="toc-interval-estimationconfidence-intervalci" class="nav-link" data-scroll-target="#interval-estimationconfidence-intervalci">Interval Estimation—Confidence interval(CI)</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#definition-1" id="toc-definition-1" class="nav-link" data-scroll-target="#definition-1">Definition</a></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a>
  <ul class="collapse">
  <li><a href="#eg" id="toc-eg" class="nav-link" data-scroll-target="#eg">eg</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#hypothesis-testing" id="toc-hypothesis-testing" class="nav-link" data-scroll-target="#hypothesis-testing">Hypothesis Testing</a>
  <ul class="collapse">
  <li><a href="#example-of-one-sample-t-test" id="toc-example-of-one-sample-t-test" class="nav-link" data-scroll-target="#example-of-one-sample-t-test">Example of one-sample t-test</a>
  <ul class="collapse">
  <li><a href="#a" id="toc-a" class="nav-link" data-scroll-target="#a">a</a></li>
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">b</a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c">c</a></li>
  <li><a href="#d" id="toc-d" class="nav-link" data-scroll-target="#d">d</a></li>
  </ul></li>
  <li><a href="#example-of-unpaired-t-test" id="toc-example-of-unpaired-t-test" class="nav-link" data-scroll-target="#example-of-unpaired-t-test">Example of unpaired t-test</a></li>
  <li><a href="#example-of-one-sample-variance-test" id="toc-example-of-one-sample-variance-test" class="nav-link" data-scroll-target="#example-of-one-sample-variance-test">Example of one-sample Variance Test</a></li>
  <li><a href="#example-of-two-sample-variance-test" id="toc-example-of-two-sample-variance-test" class="nav-link" data-scroll-target="#example-of-two-sample-variance-test">Example of two-sample Variance Test</a></li>
  <li><a href="#anova-analysis-of-variance" id="toc-anova-analysis-of-variance" class="nav-link" data-scroll-target="#anova-analysis-of-variance">ANOVA– Analysis of Variance</a>
  <ul class="collapse">
  <li><a href="#example-of-two-way-anova" id="toc-example-of-two-way-anova" class="nav-link" data-scroll-target="#example-of-two-way-anova">Example of two-way ANOVA</a></li>
  </ul></li>
  <li><a href="#non-parametric-tests" id="toc-non-parametric-tests" class="nav-link" data-scroll-target="#non-parametric-tests">Non-parametric tests</a>
  <ul class="collapse">
  <li><a href="#application-of-testing-the-goodness-of-fit" id="toc-application-of-testing-the-goodness-of-fit" class="nav-link" data-scroll-target="#application-of-testing-the-goodness-of-fit">Application of testing the goodness of fit</a></li>
  <li><a href="#application-of-testing-for-homogeneity" id="toc-application-of-testing-for-homogeneity" class="nav-link" data-scroll-target="#application-of-testing-for-homogeneity">Application of testing for homogeneity</a></li>
  <li><a href="#application-of-testing-for-independence" id="toc-application-of-testing-for-independence" class="nav-link" data-scroll-target="#application-of-testing-for-independence">Application of testing for independence</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#linear-regression" id="toc-linear-regression" class="nav-link" data-scroll-target="#linear-regression">Linear Regression</a>
  <ul class="collapse">
  <li><a href="#simple-linear-regression" id="toc-simple-linear-regression" class="nav-link" data-scroll-target="#simple-linear-regression">Simple linear regression</a>
  <ul class="collapse">
  <li><a href="#brief-introduction" id="toc-brief-introduction" class="nav-link" data-scroll-target="#brief-introduction">Brief introduction</a></li>
  <li><a href="#maximum-likelihood-estimation-mle" id="toc-maximum-likelihood-estimation-mle" class="nav-link" data-scroll-target="#maximum-likelihood-estimation-mle">Maximum Likelihood Estimation (MLE)</a></li>
  <li><a href="#hypothesis-testing-for-estimates-with-unknown-sigma2" id="toc-hypothesis-testing-for-estimates-with-unknown-sigma2" class="nav-link" data-scroll-target="#hypothesis-testing-for-estimates-with-unknown-sigma2">Hypothesis testing for estimates with unknown <span class="math inline">\(\sigma^2\)</span></a></li>
  <li><a href="#r2the-fraction-of-variability-explained-by-the-regression" id="toc-r2the-fraction-of-variability-explained-by-the-regression" class="nav-link" data-scroll-target="#r2the-fraction-of-variability-explained-by-the-regression"><span class="math inline">\(R^2\)</span>–the fraction of variability explained by the regression</a></li>
  </ul></li>
  <li><a href="#multiple-linear-regression-mlr" id="toc-multiple-linear-regression-mlr" class="nav-link" data-scroll-target="#multiple-linear-regression-mlr">Multiple linear regression (MLR)</a>
  <ul class="collapse">
  <li><a href="#a-potential-problem-in-practice-multicollinearity" id="toc-a-potential-problem-in-practice-multicollinearity" class="nav-link" data-scroll-target="#a-potential-problem-in-practice-multicollinearity">A potential problem in practice –multicollinearity</a></li>
  <li><a href="#adjusted-r-squared" id="toc-adjusted-r-squared" class="nav-link" data-scroll-target="#adjusted-r-squared">Adjusted R-squared</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#logistic-regression" id="toc-logistic-regression" class="nav-link" data-scroll-target="#logistic-regression">Logistic Regression</a>
  <ul class="collapse">
  <li><a href="#odds" id="toc-odds" class="nav-link" data-scroll-target="#odds">Odds</a></li>
  </ul></li>
  <li><a href="#generalized-linear-models" id="toc-generalized-linear-models" class="nav-link" data-scroll-target="#generalized-linear-models">Generalized Linear Models</a>
  <ul class="collapse">
  <li><a href="#random-component" id="toc-random-component" class="nav-link" data-scroll-target="#random-component">Random Component</a></li>
  <li><a href="#exponential-family" id="toc-exponential-family" class="nav-link" data-scroll-target="#exponential-family">Exponential Family</a></li>
  <li><a href="#systematic-component-and-link-component" id="toc-systematic-component-and-link-component" class="nav-link" data-scroll-target="#systematic-component-and-link-component">Systematic Component and Link Component</a></li>
  <li><a href="#example-1" id="toc-example-1" class="nav-link" data-scroll-target="#example-1">Example</a>
  <ul class="collapse">
  <li><a href="#gaussian-noise-linear-regression" id="toc-gaussian-noise-linear-regression" class="nav-link" data-scroll-target="#gaussian-noise-linear-regression">Gaussian-noise Linear Regression</a></li>
  <li><a href="#bernoulli" id="toc-bernoulli" class="nav-link" data-scroll-target="#bernoulli">Bernoulli</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#link-function" id="toc-link-function" class="nav-link" data-scroll-target="#link-function">Link Function</a>
  <ul class="collapse">
  <li><a href="#logistic" id="toc-logistic" class="nav-link" data-scroll-target="#logistic">Logistic</a></li>
  </ul></li>
  <li><a href="#survival-analysis" id="toc-survival-analysis" class="nav-link" data-scroll-target="#survival-analysis">Survival Analysis</a>
  <ul class="collapse">
  <li><a href="#some-definations" id="toc-some-definations" class="nav-link" data-scroll-target="#some-definations">Some definations</a></li>
  <li><a href="#kaplan-meier-estimate" id="toc-kaplan-meier-estimate" class="nav-link" data-scroll-target="#kaplan-meier-estimate">Kaplan-Meier estimate</a></li>
  <li><a href="#cox-proportional-harzards-model" id="toc-cox-proportional-harzards-model" class="nav-link" data-scroll-target="#cox-proportional-harzards-model">Cox-proportional harzards model</a></li>
  </ul></li>
  <li><a href="#final-review-of-r-codes" id="toc-final-review-of-r-codes" class="nav-link" data-scroll-target="#final-review-of-r-codes">Final review of R codes</a>
  <ul class="collapse">
  <li><a href="#calculation" id="toc-calculation" class="nav-link" data-scroll-target="#calculation">Calculation</a></li>
  <li><a href="#vectors--lab-2" id="toc-vectors--lab-2" class="nav-link" data-scroll-target="#vectors--lab-2">Vectors -Lab 2</a></li>
  <li><a href="#rmd-knowledge" id="toc-rmd-knowledge" class="nav-link" data-scroll-target="#rmd-knowledge">Rmd knowledge</a></li>
  </ul></li>
  <li><a href="#probability-in-r" id="toc-probability-in-r" class="nav-link" data-scroll-target="#probability-in-r">Probability in R</a></li>
  <li><a href="#data-class" id="toc-data-class" class="nav-link" data-scroll-target="#data-class">Data class</a></li>
  <li><a href="#lab-5-data-visualization" id="toc-lab-5-data-visualization" class="nav-link" data-scroll-target="#lab-5-data-visualization">LAB 5 –data visualization</a>
  <ul class="collapse">
  <li><a href="#ellipses" id="toc-ellipses" class="nav-link" data-scroll-target="#ellipses">Ellipses</a></li>
  </ul></li>
  <li><a href="#copy-of-x" id="toc-copy-of-x" class="nav-link" data-scroll-target="#copy-of-x">copy of x</a></li>
  <li><a href="#lab-10" id="toc-lab-10" class="nav-link" data-scroll-target="#lab-10">LAB 10</a>
  <ul class="collapse">
  <li><a href="#part-1" id="toc-part-1" class="nav-link" data-scroll-target="#part-1">Part 1</a></li>
  <li><a href="#part-2" id="toc-part-2" class="nav-link" data-scroll-target="#part-2">Part 2</a></li>
  </ul></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix">Confusion Matrix</a>
  <ul class="collapse">
  <li><a href="#example-2" id="toc-example-2" class="nav-link" data-scroll-target="#example-2">example</a>
  <ul class="collapse">
  <li><a href="#lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv" id="toc-lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv" class="nav-link" data-scroll-target="#lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv">Lung Cancer Classification (https://www.kaggle.com/datasets/mysarahmadbhat/lung-cancer?select=survey+lung+cancer.csv)</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">APH101-Biostatistics And R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="i-am-deeply-grateful-to-dr.-daiyun-huang-for-his-instruction-in-the-biostatistics-and-r-course.-this-course-has-marked-the-beginning-of-my-formal-journey-into-the-world-of-statistics.-dr.-huangs-comprehensive-lectures-accompanied-by-detailed-pdfs-and-his-well-structured-labs-complete-with-code-and-solutions-have-been-incredibly-valuable.-they-have-not-only-enhanced-my-intuitive-grasp-of-key-statistical-concepts-such-as-hypothesis-testing-but-also-significantly-improved-my-proficiency-in-r-programming." class="level1">
<h1>I am deeply grateful to Dr.&nbsp;Daiyun Huang for his instruction in the “Biostatistics and R” course. This course has marked the beginning of my formal journey into the world of statistics. Dr.&nbsp;Huang’s comprehensive lectures, accompanied by detailed PDFs, and his well-structured labs, complete with code and solutions, have been incredibly valuable. They have not only enhanced my intuitive grasp of key statistical concepts, such as hypothesis testing, but also significantly improved my proficiency in R programming.</h1>
</section>
<section id="also-thanks-to-the-course-of-introduction-to-statistical-learning-by-trevor-hastie-and-robert-tibshirani.-examples-in-their-online-video-lectures-are-abundant-and-easy-to-understand-for-beginners.-their-book-is-also-very-helpful." class="level1">
<h1>Also, thanks to the course of “Introduction to statistical learning” by Trevor Hastie and Robert Tibshirani. Examples in their online video lectures are abundant and easy to understand for beginners. Their book is also very helpful.</h1>
</section>
<section id="review-and-introduce-probability" class="level1">
<h1>Review and Introduce Probability</h1>
<section id="simple-random-sampling" class="level2">
<h2 class="anchored" data-anchor-id="simple-random-sampling">Simple Random Sampling</h2>
<p>We can get information about the population by taking a sample from it. The sample should be representative of the population.</p>
<p>A simple random sample of size n is a sample selected from a population in such a way that every possible sample of size n has the same chance of being selected and without replacement.</p>
</section>
<section id="unbiased-estimator" class="level2">
<h2 class="anchored" data-anchor-id="unbiased-estimator">Unbiased estimator</h2>
<p>An estimator is a statistic used to estimate a population parameter. An estimator is unbiased if the expected value of the estimator equals the population parameter.</p>
<p><span class="math inline">\(E(\hat \theta) = \theta\)</span></p>
<p>where <span class="math inline">\(\hat \theta\)</span> is the estimator and <span class="math inline">\(\theta\)</span> is the population parameter.</p>
<p>eg.</p>
<p><span class="math display">\[
\mathbb{E}[\hat{p}]=\mathbb{E}\left[\frac{X_1+X_2+\cdots+X_n}{n}\right]=\frac{1}{n}\left(\mathbb{E}\left[X_1\right]+\cdots+\mathbb{E}\left[X_n\right]\right)=p
\]</span></p>
</section>
<section id="variance" class="level2">
<h2 class="anchored" data-anchor-id="variance">Variance</h2>
<p><span class="math display">\[
\operatorname{Var}[X]=\mathbb{E}\left[X^2\right]-(\mathbb{E}[X])^2
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\mathbb{E}\left[\hat{p}^2\right] &amp; =\mathbb{E}\left[\left(\frac{X_1+X_2+\cdots+X_n}{n}\right)^2\right] \\
&amp; =\frac{1}{n^2} \mathbb{E}\left[X_1^2+\cdots+X_n^2+2\left(X_1 X_2+X_1 X_3+\cdots+X_{n-1} X_n\right)\right] \\
&amp; =\frac{1}{n^2}\left(n \mathbb{E}\left[X_1^2\right]+2\binom{n}{2} \mathbb{E}\left[X_1 X_2\right]\right) \\
&amp; =\frac{1}{n} \mathbb{E}\left[X_1^2\right]+\frac{n-1}{n} \mathbb{E}\left[X_1 X_2\right]
\end{aligned}
\]</span></p>
<p><span class="math display">\[
\mathbb{E}\left[\hat{p}^2\right]=\frac{1}{n} \mathbb{E}\left[X_1^2\right]+\frac{n-1}{n} \mathbb{E}\left[X_1 X_2\right]
\]</span></p>
<p>Since <span class="math inline">\(X_1\)</span> is 0 or <span class="math inline">\(1, X_1=X_1^2\)</span>. Then <span class="math inline">\(\mathbb{E}\left[X_1^2\right]=\mathbb{E}\left[X_1\right]=p\)</span>.</p>
<p>Notice: <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are not independent.</p>
<p><span class="math display">\[
\mathbb{E}\left[X_1 X_2\right]=\mathbb{P}\left[X_1=1, X_2=1\right]=\mathbb{P}\left[X_1=1\right] \mathbb{P}\left[X_2=1 \mid X_1=1\right]
\]</span></p>
<p><span class="math display">\[
\mathbb{P}\left[X_1=1\right]=p, \quad \mathbb{P}\left[X_2=1 \mid X_1=1\right]=\frac{N p-1}{N-1}
\]</span></p>
<p><span class="math display">\[
\begin{aligned}
\operatorname{Var}[\hat{p}] &amp; =\mathbb{E}\left[\hat{p}^2\right]-(\mathbb{E}[\hat{p}])^2 \\
&amp; =\frac{1}{n} p+\frac{n-1}{n} p\left(\frac{N p-1}{N-1}\right)-p^2 \\
&amp; =\left(\frac{1}{n}-\frac{n-1}{n} \frac{1}{N-1}\right) p+\left(\frac{n-1}{n} \frac{N}{N-1}-1\right) p^2 \\
&amp; =\frac{N-n}{n(N-1)} p+\frac{n-N}{n(N-1)} p^2 \\
&amp; =\frac{p(1-p)}{n} \frac{N-n}{N-1}=\frac{p(1-p)}{n}\left(1-\frac{n-1}{N-1}\right)
\end{aligned}
\]</span> When N is much bigger than n, it is <span class="math inline">\(\frac{p(1-p)}{n}\)</span>, which is like we sample n things with replacement (independently).</p>
</section>
<section id="sampling-distribution" class="level2">
<h2 class="anchored" data-anchor-id="sampling-distribution">Sampling distribution</h2>
<p>The sampling distribution of a statistic is the probability distribution of that statistic based on a random sample.</p>
<section id="sample-mean-of-i.i.d.-normals" class="level3">
<h3 class="anchored" data-anchor-id="sample-mean-of-i.i.d.-normals">Sample mean of i.i.d. normals</h3>
<p>Sample mean follows a normal distribution with mean <span class="math inline">\(\mu\)</span> and standard deviation <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span>.</p>
</section>
</section>
<section id="simulation" class="level2">
<h2 class="anchored" data-anchor-id="simulation">Simulation</h2>
<p>Below codes explains the central limit theorem (CLT) and the sampling distribution of the sample proportion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>population_size <span class="ot">&lt;-</span> <span class="dv">12141897</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.54</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>sample_size <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>p_hat_values <span class="ot">&lt;-</span> <span class="fu">replicate</span>(num_simulations, {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Simulate sampling from the population</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,population_size <span class="sc">*</span> p), <span class="fu">rep</span>(<span class="dv">0</span>,population_size<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))),sample_size, <span class="at">replace =</span><span class="cn">FALSE</span>) <span class="co"># replicate(num_simulations, {...})：这个函数会重复执行大括号中的代码num_simulations次，并将每次的结果存储在一个向量中； rep创建一个包含population_size * p个1和population_size * (1-p)个0的向量，模拟总体。</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(sample) <span class="co">#calculate the p_hat for each sample</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>histogram <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">p =</span> p_hat_values), <span class="fu">aes</span>(<span class="at">x=</span>p))<span class="sc">+</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">fill =</span><span class="st">"blue"</span>, <span class="at">color =</span> <span class="st">"black"</span>)<span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span><span class="st">" "</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"p_hat"</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span> <span class="st">"Frequency"</span>)<span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(histogram)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="moment-generating-functions" class="level2">
<h2 class="anchored" data-anchor-id="moment-generating-functions">Moment generating functions</h2>
<p>Moment generating function (MGF) and characteristic function are powerful functions that describe the underlying features of a random variable.</p>
<section id="definition" class="level3">
<h3 class="anchored" data-anchor-id="definition">Definition</h3>
<p><span class="math inline">\(M_x(t) = \mathbb E (e^{tx})\)</span></p>
</section>
<section id="theorems-about-mgf" class="level3">
<h3 class="anchored" data-anchor-id="theorems-about-mgf">Theorems about MGF</h3>
<ol type="1">
<li>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are random variables with the same MGF, which is finite on <span class="math inline">\(\left[-t_0, t_0\right]\)</span> for some <span class="math inline">\(t_0&gt;0\)</span>, then <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have the same distribution.</li>
</ol>
<p><strong>MGFs can be used as a tool to determine if two random variables have the identical CDF.</strong></p>
<ol start="2" type="1">
<li>Let <span class="math inline">\(X_1, \cdots, X_n\)</span> be independent random variables, with MGFs <span class="math inline">\(M_{X_1}, \cdots, M_{X_n}\)</span>. Then the MGF of their sum is given by <span class="math display">\[
M_{X_1+\cdots+X_n}(t)=M_{X_1}(t) \cdots M_{X_n}(t)
\]</span></li>
</ol>
<section id="example-of-gamma-and-exponential-mgf" class="level4">
<h4 class="anchored" data-anchor-id="example-of-gamma-and-exponential-mgf">Example of Gamma and Exponential MGF</h4>
<p>A gamma distribution with shape <span class="math inline">\(r=1\)</span> is an exponential distribution. If <span class="math inline">\(X \sim \operatorname{Gamma}\left(r_X, \lambda\right)\)</span> and <span class="math inline">\(Y \sim \operatorname{Gamma}\left(r_Y, \lambda\right)\)</span> are independent, then we have <span class="math inline">\(X+Y \sim \operatorname{Gamma}\left(r_X+r_Y, \lambda\right)\)</span>. As a special case, if <span class="math inline">\(X_1, X_2, \cdots, X_n\)</span> are i.i.d. with <span class="math inline">\(\operatorname{Exp}(\lambda)\)</span> distribution, then <span class="math inline">\(X_1+X_2+\cdots+X_n\)</span> has <span class="math inline">\(\operatorname{Gamma}(n, \lambda)\)</span> distribution.</p>
<p>Suppose <span class="math inline">\(X \sim \operatorname{Exp}(\lambda)\)</span>, for <span class="math inline">\(\lambda&gt;0\)</span>. Then <span class="math display">\[
M_X(t)=\mathbb{E}\left[e^{t X}\right]=\int_0^{\infty} e^{t x} \lambda e^{-\lambda x} d x=\lambda \int_0^{\infty} e^{(t-\lambda) x} d x
\]</span></p>
<p>Similar to Gamma MGF, the integral of Exponential MGF converges only for <span class="math inline">\(t&lt;\lambda\)</span>. For <span class="math inline">\(t&lt;\lambda\)</span>, we can integrate: <span class="math display">\[
M_X(t)=\lambda\left[\frac{e^{(t-\lambda) x}}{t-\lambda}\right]_0^{\infty}=\frac{\lambda}{\lambda-t}
\]</span></p>
<p>Since the Gamma MGF is <span class="math inline">\(M_X(t)=\frac{\lambda^r}{(\lambda-t)^r}\)</span> for any <span class="math inline">\(t&lt;\lambda\)</span> For shape <span class="math inline">\(r=1\)</span>, Exponential MGF = Gamma MGF.</p>
</section>
</section>
</section>
<section id="distribution-transformation" class="level2">
<h2 class="anchored" data-anchor-id="distribution-transformation">Distribution Transformation</h2>
<section id="universality-of-the-uniformfrom-uniform-you-can-get-everything" class="level3">
<h3 class="anchored" data-anchor-id="universality-of-the-uniformfrom-uniform-you-can-get-everything">Universality of the Uniform—From uniform you can get everything</h3>
<p>Let u~unif(0,1), F be a CDF(assume F is strictly increased, continuous). Then there comes a theorem: <span class="math display">\[
x = F^{-1}(u)
\]</span> Then <span class="math display">\[
X \sim F
\]</span> (Proof: <span class="math display">\[
P(X\leq x)=P(F^{-1}(u)\leq x)=P(F(F^{-1}(u))\leq F(x))=P(u\leq F(x))=F(x)
\]</span>)</p>
<p>You can convert from the random uniforms to whatever you want to simulate. One example is the simulation of Logistic distribution: F(X)=<span class="math inline">\(e^x\)</span>/(<span class="math inline">\(1+e^x\)</span>)</p>
<p>u~unif(0,1), <span class="math display">\[
X = F^{-1}(u)=log(u/1-u)
\]</span>&nbsp;and X~F</p>
<p>Another example is that we could try to use uniform to simulate normal distribution:</p>
<p>The Box-Muller transform generates pairs of independent standard normally distributed (zero mean, unit variance) random numbers, given a source of uniformly distributed random numbers.</p>
<p>Given two independent random variables <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> that are uniformly distributed on the interval (0, 1), we can generate two independent standard normal random variables <span class="math inline">\(Z_0\)</span> and <span class="math inline">\(Z_1\)</span> using the following formulas:</p>
<p><span class="math display">\[
Z_0 = \sqrt{-2 \ln U_1} \cos(2 \pi U_2)
\]</span></p>
<p><span class="math display">\[
Z_1 = \sqrt{-2 \ln U_1} \sin(2 \pi U_2)
\]</span></p>
<p>Inversely, the example could be: let <span class="math inline">\(Z_0\)</span> and <span class="math inline">\(Z_1\)</span> be standard normal random variables with the following values: <span class="math inline">\(Z_0\)</span> = 0.5 and <span class="math inline">\(Z_1\)</span> = -1.0.</p>
<ol type="1">
<li><p><strong>Compute CDF values</strong>:</p>
<p>For standard normal distribution, the CDF <span class="math display">\[ \Phi(z) \]</span> is given by:</p>
<p><span class="math display">\[
\Phi(z) = \frac{1}{2} \left[ 1 + \text{erf} \left( \frac{z}{\sqrt{2}} \right) \right]
\]</span></p>
<p>(ps:<span class="math display">\[
\text{erf}(x) = \frac{2}{\sqrt{\pi}} \int_{0}^{x} e^{-t^2} \, dt
\]</span>)</p>
<ul>
<li><p>For <span class="math display">\[ Z_0 = 0.5 \]</span>:</p>
<p><span class="math display">\[
\Phi(0.5) = \frac{1}{2} \left[ 1 + \text{erf} \left( \frac{0.5}{\sqrt{2}} \right) \right]
\]</span></p></li>
<li><p>For <span class="math display">\[ Z_1 = -1.0 \]</span>:</p>
<p><span class="math display">\[
\Phi(-1.0) = \frac{1}{2} \left[ 1 + \text{erf} \left( \frac{-1.0}{\sqrt{2}} \right) \right]
\]</span></p></li>
</ul></li>
<li><p><strong>Compute Uniform values</strong>:</p>
<p>Since the CDF values <span class="math display">\[ \Phi(Z_0) \]</span> and <span class="math display">\[ \Phi(Z_1) \]</span> are in the range [0, 1], we can directly use them as uniform random variables <span class="math inline">\(U_0\)</span> and <span class="math inline">\(U_1\)</span>.</p>
<ul>
<li><span class="math display">\[U_0 = \Phi(0.5)\]</span></li>
<li><span class="math display">\[U_1 = \Phi(-1.0)\]</span></li>
</ul></li>
<li><p><strong>Result</strong>:</p>
<ul>
<li>Using the error function values:
<ul>
<li><span class="math display">\[ \Phi(0.5) \approx 0.6915 \]</span></li>
<li><span class="math display">\[ \Phi(-1.0) \approx 0.1587 \]</span></li>
</ul></li>
</ul>
<p>Thus, the corresponding uniform distribution values are:</p>
<ul>
<li><span class="math display">\[ U_0 \approx 0.6915 \]</span></li>
<li><span class="math display">\[ U_1 \approx 0.1587 \]</span></li>
</ul></li>
</ol>
<p>Another example is that we can create a function that has good quality as F in the theorem, for example, <span class="math display">\[
u=F(x)=1-e^{-x}          (x&gt;0)
\]</span> then we can simulate X~F:X=-ln(1-u)~F</p>
<p>Also, if <span class="math display">\[
X \sim F
\]</span></p>
<p>Then, <span class="math display">\[
F(x) \sim unif(0,1)
\]</span> e.g.&nbsp;let X~F, if<span class="math display">\[
F(x_0)=1/3\]</span> then <span class="math display">\[P(F(X)\leq 1/3)=P(X\leq x_0)=F(x_0)=1/3 \]</span> which follows the uniform distribution(0,1) because 1/3 generates 1/3. (Uniform distribution: Probability(CDF) is proportional to length)</p>
</section>
<section id="normal-distribution" class="level3">
<h3 class="anchored" data-anchor-id="normal-distribution">Normal Distribution</h3>
<section id="from-standard-normal-distribution-to-normal-distribution" class="level4">
<h4 class="anchored" data-anchor-id="from-standard-normal-distribution-to-normal-distribution">From Standard Normal Distribution to Normal Distribution</h4>
<p><span class="math inline">\(f(z)=ce^{-z^2/2}\)</span> is a function with good qualities such as symmetric……..</p>
<p>To generate normalization constant c using CDF=1, instead of using impossible integral methods to compute it we should try to find the area under it. In that case, we transfer the integral shape to the double integral’s multiplication then we get c: <span class="math display">\[
\int_{-\infty}^{\infty}\exp(-z^2/2) dz=\int_{-\infty}^{\infty}\exp(-z^2/2) dz=\int_{-\infty}^{\infty}\exp(-x^2/2)dx\int_{-\infty}^{\infty}\exp(-y^2/2)dy
\]</span> <span class="math display">\[
=\int_{0}^{\infty}\exp(-r^2/2)r dr\int_{0}^{2π} d\theta\ =\sqrt2\pi\
\]</span> So <span class="math display">\[
c=1/\sqrt2\pi\
\]</span> …….</p>
</section>
</section>
<section id="from.." class="level3">
<h3 class="anchored" data-anchor-id="from..">From…..</h3>
<p>111</p>
<section id="exponential-distribution" class="level4">
<h4 class="anchored" data-anchor-id="exponential-distribution">Exponential distribution</h4>
<p>the only one parameter is the rate parameter. The probability density function (pdf) of an exponential distribution with rate parameter (&gt; 0) is given by:</p>
<p><span class="math display">\[
f_X(x) =
\begin{cases}
\lambda e^{-\lambda x} &amp; \text{for } x \geq 0, \\
0 &amp; \text{for } x &lt; 0.
\end{cases}
\]</span> The cumulative distribution function (cdf) of an exponential distribution with rate parameter (&gt; 0) is given by:</p>
<p><span class="math display">\[
F_X(x) =
\begin{cases}
1 - e^{-\lambda x} &amp; \text{for } x \geq 0, \\
0 &amp; \text{for } x &lt; 0.
\end{cases}
\]</span> 2.Let Y~x, then Y ~Expo(1)</p>
<p>proof: since <span class="math display">\[
P(Y\leq y)=P(X\leq y/\lambda)=1-e^{-y}
\]</span> (just plot it into x) and we could check that E[X]=Var[X]=1, so X=Y/<span class="math inline">\(\lambda\)</span> has E[x]=1/<span class="math inline">\(\lambda\)</span>, Var[x]=1/<span class="math inline">\(\lambda^2\)</span></p>
<p>e.g.&nbsp;Memoryless Property(This property implies that the remaining lifetime distribution does not depend on how much time has already elapsed.)(The exponential distribution is the only continuous distribution that has the memoryless property):<span class="math display">\[ P(X\geq s+t|X\geq s)=P(X\geq t)\]</span> which is actually satisfied by the exponential and we could prove it(though it intuitively makes sence): Here <span class="math display">\[
P(X\geq s)=1-P(X\leq s)=e^{-\lambda s}
\]</span> <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{P(X \geq s+t \text { and } X \geq s)}{P(X \geq s)}
\]</span></p>
<p>Since <span class="math inline">\(X \geq s+t\)</span> implies <span class="math inline">\(X \geq s\)</span>, we can simplify the numerator: <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{P(X \geq s+t)}{P(X \geq s)}
\]</span></p>
<p>Now, substitute the survival function for the exponential distribution: <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{e^{-\lambda(s+t)}}{e^{-\lambda s}}
\]</span></p>
<p>Simplify the expression: <span class="math display">\[
P(X \geq s+t \mid X \geq s)=\frac{e^{-\lambda s} \cdot e^{-\lambda t}}{e^{-\lambda s}}=e^{-\lambda t}
\]</span></p>
<p>Notice that <span class="math inline">\(e^{-\lambda t}=P(X \geq t)\)</span> : <span class="math display">\[
P(X \geq s+t \mid X \geq s)=P(X \geq t)
\]</span> usefulness of it: <span class="math display">\[
X\sim Expo(\lambda),E(X|X&gt;a)=a+E(X-a|X&gt;a)=a+1/\lambda
\]</span></p>
<p>e.g.2The hazard rate (or failure rate) for an exponential distribution is constant over time. For an exponential random variable <span class="math inline">\(X\)</span> with rate parameter <span class="math inline">\(\lambda\)</span>, the hazard rate is: <span class="math display">\[
h(t)=\frac{f_X(t)}{1-F_X(t)}=\lambda .
\]</span></p>
<p>A constant hazard rate implies that the event is equally likely to occur at any point in time, which is a reasonable assumption for many processes, such as the lifetime of certain electronic components or the occurrence of certain types of random failures.</p>
<p>e.g.3 The exponential distribution is closely related to the Poisson process, which is a process that models the occurrence of events happening independently at a constant average rate. If the times between consecutive events in a Poisson process are independent and identically distributed, then these interarrival times follow an exponential distribution. This relationship makes the exponential distribution a natural choice in contexts where events occur randomly over time, such as phone calls arriving at a switchboard or buses arriving at a bus stop.</p>
</section>
<section id="ga" class="level4">
<h4 class="anchored" data-anchor-id="ga">Ga</h4>
<p>If r.v.X~N(0,1), then <span class="math inline">\(X^2\)</span>~<span class="math inline">\(Ga\)</span>(1/2,1/2)</p>
<p>Proof: If r.v. (X N(0,1)), then (X^2 (, ))</p>
<p>Let (X) be a random variable such that (X N(0,1)).</p>
<p>The probability density function (pdf) of (X) is: <span class="math display">\[
f_X(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}, \quad -\infty &lt; x &lt; \infty.
\]</span></p>
<p>First, we find the pdf of (Y = X^2).</p>
<p>The cumulative distribution function (CDF) of (Y) is given by: <span class="math display">\[
F_Y(y) = P(Y \leq y) = P(X^2 \leq y).
\]</span></p>
<p>Since (X^2 ), we only consider (y ): <span class="math display">\[
F_Y(y) = P(-\sqrt{y} \leq X \leq \sqrt{y}).
\]</span></p>
<p>Using the CDF of the normal distribution, we have: <span class="math display">\[
F_Y(y) = \int_{-\sqrt{y}}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \, dx.
\]</span></p>
<p>The pdf of (Y) is the derivative of the CDF: <span class="math display">\[
f_Y(y) = \frac{d}{dy} F_Y(y).
\]</span></p>
<p><span class="math display">\[
F_Y(y) = 2 \int_{0}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \, dx.
\]</span></p>
<p><span class="math display">\[
F_Y(y) = 2 \int_{0}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{-u} \frac{du}{\sqrt{2u}} = \frac{2}{\sqrt{2\pi}} \int_{0}^{\sqrt{y}} e^{-u} \frac{du}{\sqrt{2u}}.
\]</span></p>
<p>Thus, <span class="math display">\[
f_Y(y) = \frac{d}{dy} \left( \frac{2}{\sqrt{2\pi}} \int_{0}^{\sqrt{y}} e^{-u} \frac{du}{\sqrt{2u}} \right).
\]</span></p>
<p>Differentiating with respect to y gives: <span class="math display">\[
f_Y(y) = \frac{1}{\sqrt{2\pi}} \cdot e^{-\frac{y}{2}} \cdot y^{-\frac{1}{2}}.
\]</span></p>
<p>Simplifying, we get: <span class="math display">\[
f_Y(y) = \frac{1}{\sqrt{2\pi}} y^{-\frac{1}{2}} e^{-\frac{y}{2}}.
\]</span></p>
<p><span class="math display">\[
Y = X^2 \sim \text{Ga}\left(\frac{1}{2}, \frac{1}{2}\right).
\]</span></p>
</section>
<section id="chi-square" class="level4">
<h4 class="anchored" data-anchor-id="chi-square">Chi-square</h4>
<p>Chi-square is a</p>
<p>1.Let ( <span class="math inline">\(Z_1\)</span>, <span class="math inline">\(Z_2\)</span>, , <span class="math inline">\(Z_i\)</span> ) are independent standard normal random variables(i.e.&nbsp;Z~N(0,1)), then the random variable ( X ) defined by</p>
<p><span class="math display">\[
X = Z_1^2 + Z_2^2 + \cdots + Z_i^2
\]</span> (<span class="math inline">\(Z_j\)</span>~iid.N(0,1))</p>
<p>follows a chi-square distribution with ( i ) degrees of freedom. So chi-square of 1 is the same thing as Gamma of (1/2,1/2) so chi-square of n is Gamma(n/2,1/2)</p>
<p>2.If <span class="math display">\[
Z_i = \frac{x_i - \mu}{\sigma}
\]</span> The sum of squared standardized deviations is:</p>
<p><span class="math display">\[
\sum_{i=1}^n Z_i^2 = \sum_{i=1}^n \left( \frac{x_i - \mu}{\sigma} \right)^2 = \frac{1}{\sigma^2} \sum_{i=1}^n (x_i - \mu)^2
\]</span></p>
<p>Let <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> be samples of <span class="math inline">\(N\left(\mu, \sigma^2\right)\)</span> , <span class="math inline">\(\mu\)</span> is a known constant, find the distribution of statistics: <span class="math display">\[
T=\sum_{i=1}^n\left(x_i-\mu\right)^2
\]</span></p>
<p>sol: <span class="math inline">\(y_i=\left(x_i-\mu\right) / \sigma, i=1,2, \cdots, n\)</span>, 则 <span class="math inline">\(y_1, y_2, \cdots, y_n\)</span> are iid r.v. of <span class="math inline">\(N(0,1)\)</span>,so<span class="math display">\[
\frac{T}{\sigma^2}=\sum_{i=1}^n\left(\frac{x_i-\mu}{\sigma}\right)^2=\sum_{i=1}^n y_i^2 \sim \chi^2(n),
\]</span> (i.e.<span class="math display">\[
\sum_{i=1}^n Z_i^2 {\sigma^2}\sim \chi^2(n)\]</span>)</p>
<p>Besides, <span class="math inline">\(T\)</span>’s PDF is <span class="math display">\[
p(t)=\frac{1}{\left(2 \sigma^2\right)^{n / 2} \Gamma(n / 2)} \mathrm{e}^{-\frac{1}{2 \sigma^2} t^{\frac{n}{2}}-1}, \quad t&gt;0,
\]</span></p>
<p>which is Gamma distribution <span class="math inline">\(G a\left(\frac{n}{2}, \frac{1}{2 \sigma^2}\right) \cdot\)</span></p>
<p>3.chi-square is uesful because of theorems below:let <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> are samples from <span class="math inline">\(N\left(\mu, \sigma^2\right)\)</span> , whose sample mean and sample variance are<span class="math display">\[
\bar{x}=\frac{1}{n} \sum_{i=1}^n x_i \text { and } s^2=\frac{1}{n-1} \sum_{i=1}^n\left(x_i-\bar{x}\right)^2,
\]</span></p>
<p>then we can get: (1) <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(s^2\)</span> are independent; (2) <span class="math inline">\(\bar{x} \sim N\left(\mu, \sigma^2 / n\right)\)</span>; (3) <span class="math inline">\(\frac{(n-1) s^2}{\sigma^2} \sim \chi^2(n-1)\)</span>.</p>
<p>Proof: <span class="math display">\[
p\left(x_1, x_2, \cdots, x_n\right)=\left(2 \pi \sigma^2\right)^{-n / 2} \mathrm{e}^{-\sum_{i=1}^n \frac{\left(x_i-\mu\right)^2}{2 \sigma^2}}=\left(2 \pi \sigma^2\right)^{-n / 2} \exp \left\{-\frac{\sum_{i=1}^n x_i^2-2 n \bar{x} \mu+n \mu^2}{2 \sigma^2}\right\}
\]</span></p>
<p>denote<span class="math inline">\(\boldsymbol{X}=\left(x_1, x_2, \cdots, x_n\right)^{\mathrm{T}}\)</span>, then we create an <span class="math inline">\(n\)</span>-dimension orthogonal <span class="math inline">\(\boldsymbol{A}\)</span> and every element in the first row is <span class="math inline">\(1 / \sqrt{n}\)</span>, such as <span class="math display">\[
A=\left(\begin{array}{ccccc}
\frac{1}{\sqrt{n}} &amp; \frac{1}{\sqrt{n}} &amp; \frac{1}{\sqrt{n}} &amp; \cdots &amp; \frac{1}{\sqrt{n}} \\
\frac{1}{\sqrt{2 \cdot 1}} &amp; -\frac{1}{\sqrt{2 \cdot 1}} &amp; 0 &amp; \cdots &amp; 0 \\
\frac{1}{\sqrt{3 \cdot 2}} &amp; \frac{1}{\sqrt{3 \cdot 2}} &amp; -\frac{2}{\sqrt{3 \cdot 2}} &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; &amp; \vdots \\
\frac{1}{\sqrt{n(n-1)}} &amp; \frac{1}{\sqrt{n(n-1)}} &amp; \frac{1}{\sqrt{n(n-1)}} &amp; \cdots &amp; -\frac{n-1}{\sqrt{n(n-1)}}
\end{array}\right),
\]</span> 令 <span class="math inline">\(\boldsymbol{Y}=\left(y_1, y_2, \cdots, y_n\right)^{\mathrm{T}}=\boldsymbol{A} \boldsymbol{X}\)</span>, <span class="math inline">\(|Jacobi|=1\)</span>, and we can find thatt<span class="math display">\[
\begin{gathered}
\bar{x}=\frac{1}{\sqrt{n}} y_1, \\
\sum_{i=1}^n y_i^2=\boldsymbol{Y}^{\mathrm{T}} \boldsymbol{Y}=\boldsymbol{X}^{\mathrm{T}} \boldsymbol{A}^{\mathrm{T}} \boldsymbol{A} \boldsymbol{X}=\sum_{i=1}^n x_i^2,
\end{gathered}
\]</span></p>
<p>so<span class="math inline">\(y_1, y_2, \cdots, y_n\)</span> ’s joint density function is <span class="math display">\[
\begin{aligned}
p\left(y_1, y_2, \cdots, y_n\right) &amp; =\left(2 \pi \sigma^2\right)^{-n / 2} \exp \left\{-\frac{\sum_{i=1}^n y_i^2-2 \sqrt{n} y_1 \mu+n \mu^2}{2 \sigma^2}\right\} \\
&amp; =\left(2 \pi \sigma^2\right)^{-n / 2} \exp \left\{-\frac{\sum_{i=2}^n y_i^2+\left(y_1-\sqrt{n} \mu\right)^2}{2 \sigma^2}\right\}
\end{aligned}
\]</span></p>
<p>So, <span class="math inline">\(\boldsymbol{Y}=\left(y_1, y_2, \cdots, y_n\right)^{\mathrm{T}}\)</span> independently distributed as normal distribution and their variances are all equal to<span class="math inline">\(\sigma^2\)</span>, but their means are not all the same because <span class="math inline">\(y_2, \cdots, y_n\)</span> ’s means are <span class="math inline">\(0, y_1\)</span>’s is <span class="math inline">\(\sqrt{n} \mu\)</span>, which ends our proof of (2). <span class="math display">\[
(n-1) s^2=\sum_{i=1}^n\left(x_i-\bar{x}\right)^2=\sum_{i=1}^n x_i^2-(\sqrt{n} \bar{x})^2=\sum_{i=1}^n y_i^2-y_1^2=\sum_{i=2}^n y_i^2,
\]</span></p>
<p>This proves conclusion (1). Since <span class="math inline">\(y_2, \cdots, y_n\)</span> are independently and identically distributed as <span class="math inline">\(N\left(0, \sigma^2\right)\)</span>, we have: <span class="math display">\[
\frac{(n-1) s^2}{\sigma^2}=\sum_{i=2}^n\left(\frac{y_i}{\sigma}\right)^2 \sim \chi^2(n-1) .
\]</span></p>
<p>Theorem is proved. (similar to the proof above this maybe easier to understand:<span class="math inline">\(\begin{aligned} &amp; i z\left(Y_1, Y_2, \cdots, Y_2\right)^{\top}=A\left(X_1, \cdots, x_n\right)^{\top} \\ &amp; \text { then } \sum_{i=1}^n Y_i^2=\left(Y_1, \cdots, Y_n\right)\left(Y_1, \cdots, Y_n\right)^{\top} \\ &amp; =\left[A\left(x_1, \cdots, x_n\right)^{\top}\right]^{\top}\left[A\left(x_1, \cdots, X_n\right)^{\top}\right] \\ &amp; =\left(x_1, \cdots, x_n\right) A^{\top} A\left(x_1, \cdots, x_n\right)^{\top} \\ &amp; =\left(x_1, \cdots, x_n\right) E\left(x_1, \cdots, x_n\right)^{\top}=\sum_{i=1}^n x_i^2 \\ &amp; \end{aligned}\)</span>) <span class="math inline">\(\begin{aligned} &amp; \text { besides } Y_1=\frac{1}{\sqrt{n}} x_1+\cdots+\frac{1}{\sqrt{n}} x_n=\frac{1}{\sqrt{n}} \sum_{i=1}^n X_i \\ &amp; \text { and } Y_1=\sqrt{n} \cdot \frac{1}{n} \sum_{i=1}^n X_i=\sqrt{n} \bar{X}, \text { then } \bar{x}=\frac{1}{\sqrt{n}} y_i \\ &amp; B S^2=\frac{1}{n-1} \sum_{i=1}^n\left(x_i-\bar{x}\right)^2=\frac{1}{n-1}\left[\sum_{i=1}^n x_i^2-n \bar{x}^2\right] \\ &amp; =\frac{1}{n-1}\left[\sum_{i=1}^n Y_i^2-Y_1^2\right]=\frac{1}{n-1} \sum_{i=2}^n Y_i^2 \\ &amp; 2 \oplus L=(\sqrt{2 \pi} \sigma)^{-n} \exp \left[-\frac{1}{2 \sigma^2} \sum_{i=1}^n\left(x_i-\mu\right)^2\right] \text {. } \\ &amp; =(\sqrt{2 \pi} \sigma)^{-n} \exp \left[-\frac{1}{2 \sigma^2}\left(\sum_{i=1}^n x_i^2-2 \mu n \bar{x}+\mu^2 n\right]\right. \\ &amp; =(\sqrt{2 \pi} \sigma)^{-n} \exp \left[-\frac{1}{2 \sigma^2}\left(\sum_{1=1}^n y_i{ }^2-2 \mu n \frac{1}{\sqrt{n}} Y_1+n \mu^2\right]\right. \\ &amp; \end{aligned}\)</span> <span class="math display">\[=(\sqrt2\pi\sigma)^{-1}exp[-1/2\sigma^2(Y_1-\sqrt nu)^2]×(\sqrt2\pi\sigma)^{-1}exp[-1/2\sigma^2{Y_2}^2]*...*(\sqrt2\pi\sigma)^{-1}exp[-1/2\sigma^2{Y_n}^2]
\]</span></p>
<p>So L is <span class="math inline">\(Y_1\)</span>…<span class="math inline">\(Y_n\)</span>’s joint density function and so they are independent. Besides, we have proved that its mean is <span class="math inline">\(1/\sqrt n\)</span><span class="math inline">\(Y_1\)</span> and <span class="math inline">\(S^2\)</span>=<span class="math inline">\(1/n-1 \Sigma{i=2}Y_i^2\)</span>, so the normal distribution’s mean and variance are independent.</p>
<p>When the random variable <span class="math inline">\(\chi^2 \sim \chi^2(n)\)</span>, for a given <span class="math inline">\(\alpha\)</span> (where <span class="math inline">\(0&lt;\)</span> <span class="math inline">\(\alpha&lt;1\)</span> ), the value <span class="math inline">\(\chi_{1-\alpha}^2(n)\)</span> satisfying the probability equation <span class="math inline">\(P\left(\chi^2 \leqslant \chi_{1-\alpha}^2(n)\right)=1-\)</span> <span class="math inline">\(\alpha\)</span> is called the <span class="math inline">\(1-\alpha\)</span> quantile of the <span class="math inline">\(\chi^2\)</span> distribution with <span class="math inline">\(n\)</span> degrees of freedom.</p>
<p>Suppose the random variables <span class="math inline">\(X_1 \sim \chi^2(m)\)</span> and <span class="math inline">\(X_2 \sim \chi^2(n)\)</span>, and <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> are independent. Then the distribution of <span class="math inline">\(F=\frac{X_1 / m}{X_2 / n}\)</span> is called the <span class="math inline">\(\mathrm{F}\)</span> distribution with <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> degrees of freedom, denoted as <span class="math inline">\(F \sim F(m, n)\)</span>. Here, <span class="math inline">\(m\)</span> is called the numerator degrees of freedom and <span class="math inline">\(n\)</span> the denominator degrees of freedom. We derive the density function of the <span class="math inline">\(\mathrm{F}\)</span> distribution in two steps. First, we derive the density function of <span class="math inline">\(Z=\frac{X_1}{X_2}\)</span>. Let <span class="math inline">\(p_1(x)\)</span> and <span class="math inline">\(p_2(x)\)</span> be the density functions of <span class="math inline">\(\chi^2(m)\)</span> and <span class="math inline">\(\chi^2(n)\)</span> respectively. According to the formula for the distribution of the quotient of independent random variables, the density function of <span class="math inline">\(Z\)</span> is: <span class="math display">\[
\begin{gathered}
p_Z(z)=\int_0^{\infty} x_2 p_1\left(z x_2\right) p_2\left(x_2\right) \mathrm{d} x_2 \\
=\frac{z^{\frac{m}{2}-1}}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right) 2^{\frac{m+n}{2}}} \int_0^{\infty} x_2^{\frac{n}{2}-1} e^{-\frac{x_2}{2}(1+z)} \mathrm{d} x_2 .
\end{gathered}
\]</span></p>
<p>Using the transformation <span class="math inline">\(u=\frac{x_2}{2}(1+z)\)</span>, we get: <span class="math display">\[
p_Z(z)=\frac{z^{\frac{m}{2}-1}(1+z)^{-\frac{m+n}{2}}}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)} \int_0^{\infty} u^{\frac{n}{2}-1} e^{-u} \mathrm{~d} u
\]</span></p>
<p>The final integral is the gamma function <span class="math inline">\(\Gamma\left(\frac{n}{2}\right)\)</span>, so: <span class="math display">\[
p_Z(z)=\frac{\Gamma\left(\frac{m+n}{2}\right)}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)} z^{\frac{m}{2}-1}(1+z)^{-\frac{m+n}{2}}, \quad z \geq 0 .
\]</span></p>
<p>Second, we derive the density function of <span class="math inline">\(F=\frac{n}{m} Z\)</span>. Let the value of <span class="math inline">\(F\)</span> be <span class="math inline">\(y\)</span>. For <span class="math inline">\(y \geq 0\)</span>, we have: <span class="math display">\[
\begin{aligned}
p_F(y) &amp; =p_Z\left(\frac{m}{n} y\right) \cdot \frac{m}{n}=\frac{\Gamma\left(\frac{m+n}{2}\right)}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)}\left(\frac{m}{n} y\right)^{\frac{m}{2}-1}\left(1+\frac{m}{n} y\right)^{-\frac{m+n}{2}} \cdot \frac{m}{n} \\
&amp; =\frac{\Gamma\left(\frac{m+n}{2}\right)}{\Gamma\left(\frac{m}{2}\right) \Gamma\left(\frac{n}{2}\right)}\left(\frac{m}{n}\right)\left(\frac{m}{n} y\right)^{\downarrow \frac{2}{2}-1}\left(1+\frac{m}{n} y\right)^{-\frac{m+n}{2}}
\end{aligned}
\]</span></p>
<p>When the random variable <span class="math inline">\(F \sim F(m, n)\)</span>, for a given <span class="math inline">\(\alpha\)</span> (where <span class="math inline">\(0&lt;\alpha&lt;1\)</span> ), the value <span class="math inline">\(F_{1-\alpha}(m, n)\)</span> satisfying the probability equation <span class="math inline">\(P\left(F \leqslant F_{1-\alpha}(m, n)\right)=1-\alpha\)</span> is called the <span class="math inline">\(1-\alpha\)</span> quantile of the <span class="math inline">\(\mathrm{F}\)</span> distribution with <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> degrees of freedom. By the construction of the <span class="math inline">\(\mathrm{F}\)</span> distribution, if <span class="math inline">\(F \sim F(m, n)\)</span>, then <span class="math inline">\(1 / F \sim F(n, m)\)</span>. Therefore, for a given <span class="math inline">\(\alpha\)</span> (where <span class="math inline">\(0&lt;\alpha&lt;1\)</span> ), <span class="math display">\[
\alpha=P\left(\frac{1}{F} \leqslant F_\alpha(n, m)\right)=P\left(F \geqslant \frac{1}{F_\alpha(n, m)}\right) .
\]</span></p>
<p>Thus, <span class="math display">\[
P\left(F \leqslant \frac{1}{F_\alpha(n, m)}\right)=1-\alpha
\]</span></p>
<p>This implies <span class="math display">\[
F_\alpha(n, m)=\frac{1}{F_{1-\alpha}(m, n)} .
\]</span></p>
<p>Corollary Suppose <span class="math inline">\(x_1, x_2, \cdots, x_m\)</span> is a sample from <span class="math inline">\(N\left(\mu_1, \sigma_1^2\right)\)</span> and <span class="math inline">\(y_1, y_2, \cdots, y_n\)</span> is a sample from <span class="math inline">\(N\left(\mu_2, \sigma_2^2\right)\)</span>, and these two samples are independent. Let: <span class="math display">\[
s_x^2=\frac{1}{m-1} \sum_{i=1}^m\left(x_i-\bar{x}\right)^2, \quad s_y^2=\frac{1}{n-1} \sum_{i=1}^n\left(y_i-\bar{y}\right)^2,
\]</span> where <span class="math display">\[
\bar{x}=\frac{1}{m} \sum_{i=1}^m x_i, \quad \bar{y}=\frac{1}{n} \sum_{i=1}^n y_i
\]</span> then <span class="math display">\[
F=\frac{s_x^2 / \sigma_1^2}{s_y^2 / \sigma_2^2} \sim F(m-1, n-1) .
\]</span></p>
<p>In particular, if <span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span>, then <span class="math inline">\(F=\frac{s_x}{s_y^2} \sim F(m-1, n-1)\)</span>. Proof: Since the two samples are independent, <span class="math inline">\(s_x^2\)</span> and <span class="math inline">\(s_y^2\)</span> are independent. According to a Theorem , we have <span class="math display">\[
\frac{(m-1) s_x^2}{\sigma_1^2} \sim \chi^2(m-1), \quad \frac{(n-1) s_y^2}{\sigma_2^2} \sim \chi^2(n-1) .
\]</span></p>
<p>By the definition of the <span class="math inline">\(\mathrm{F}\)</span> distribution, <span class="math inline">\(F \sim F(m-1, n-1)\)</span>. Corollary: Suppose <span class="math inline">\(x_1, x_2, \cdots, x_n\)</span> is a sample from a normal distribution <span class="math inline">\(N\left(\mu, \sigma^2\right)\)</span>, and let <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(s^2\)</span> denote the sample mean and sample variance of the sample, respectively. Then <span class="math display">\[
t=\frac{\sqrt{n}(\bar{x}-\mu)}{s} \sim t(n-1) .
\]</span></p>
<p>Proof: From a Theorem we obtain <span class="math display">\[
\frac{\bar{x}-\mu}{\sigma / \sqrt{n}} \sim N(0,1)
\]</span></p>
<p>Then, <span class="math display">\[
\frac{\sqrt{n}(\bar{x}-\mu)}{s}=\frac{\frac{\bar{x}-\mu}{\sigma / \sqrt{n}}}{\sqrt{\frac{(n-1) s^2 / \sigma^2}{n-1}}}
\]</span></p>
<p>Since the numerator is a standard normal variable and the denominator’s square root contains a <span class="math inline">\(\chi^2\)</span> variable with <span class="math inline">\(n-1\)</span> degrees of freedom divided by its degrees of freedom, and they are independent, by the definition of the <span class="math inline">\(t\)</span> distribution, <span class="math inline">\(t \sim t(n-1)\)</span>. The proof is complete.</p>
<p>Corollary: In the notation of Corollary , assume <span class="math inline">\(\sigma_1^2=\sigma_2^2=\sigma^2\)</span>, and let <span class="math display">\[
s_w^2=\frac{(m-1) s_x^2+(n-1) s_y^2}{m+n-2}=\frac{\sum_{i=1}^m\left(x_i-\bar{x}\right)^2+\sum_{i=1}^n\left(y_i-\bar{y}\right)^2}{m+n-2}
\]</span></p>
<p>Then <span class="math display">\[
\frac{(\bar{x}-\bar{y})-\left(\mu_1-\mu_2\right)}{s_w \sqrt{\frac{1}{m}+\frac{1}{n}}} \sim t(m+n-2)
\]</span></p>
<p>Proof: Since <span class="math inline">\(\bar{x} \sim N\left(\mu_1, \frac{\sigma^2}{m}\right), \bar{y} \sim N\left(\mu_2, \frac{\sigma^2}{n}\right)\)</span>, and <span class="math inline">\(\bar{x}\)</span> and <span class="math inline">\(\bar{y}\)</span> are independent, we have</p>
<p><span class="math display">\[
\bar{x}-\bar{y} \sim N\left(\mu_1-\mu_2,\left(\frac{1}{m}+\frac{1}{n}\right) \sigma^2\right) .
\]</span></p>
<p>Thus, <span class="math display">\[
\frac{(\bar{x}-\bar{y})-\left(\mu_1-\mu_2\right)}{\sigma \sqrt{\frac{1}{m}+\frac{1}{n}}} \sim N(0,1) .
\]</span></p>
<p>By a Theorem , we know that <span class="math inline">\(\frac{(m-1) s_x^2}{\sigma^2} \sim \chi^2(m-1)\)</span> and <span class="math inline">\(\frac{(n-1) s_y^2}{\sigma^2} \sim \chi^2(n-1)\)</span>, and they are independent. By additivity, we have <span class="math display">\[
\frac{(m+n-2) s_w^2}{\sigma^2}=\frac{(m-1) s_x^2+(n-1) s_y^2}{\sigma^2} \sim \chi^2(m+n-2) .
\]</span></p>
<p>Since <span class="math inline">\(\bar{x}-\bar{y}\)</span> and <span class="math inline">\(s_w^2\)</span> are independent, by the definition of the <span class="math inline">\(\mathrm{t}\)</span> distribution, we get the desired result. <span class="math inline">\(\square\)</span></p>
<p>One interesting example shows the relationship of above distributions used charismatically to solve problems: r.v.: <span class="math inline">\(X_1 ， X_2 ， X_3 ， X_4\)</span> indpendently identically distribute(iid) as <span class="math inline">\(N\left(0 . \sigma^2\right)\)</span>. <span class="math inline">\(Z=\left(x_1^2+x_2^2\right) /\left(x_1^2+x_2^2+x_3^2+x_4^2\right)\)</span> prove: <span class="math inline">\(Z \sim U(0.1)\)</span>. <span class="math display">\[
\begin{aligned}
&amp; \text { Solution: } Let Y=\frac{X_3^2+X_4^2}{X_1^2+X_2^2}=\frac{\left[\left(\frac{X_3}{\sigma}\right)^2+\left(\frac{X_4}{\sigma}\right)^2\right] / 2}{\left[\left(\frac{X_1}{\sigma}\right)^2+\left(\frac{X_2}{\sigma}\right)^2\right] / 2} \sim F(2,2) . \\
&amp; \text { i.e.  } f_Y(y)=\frac{1}{(1+y)^2},  y&gt;0 \\
&amp; \text { then } P(Z \leq z)=P\left(\frac{1}{1+Y} \leq z\right)=P\left(Y \geqslant \frac{1}{z}-1\right) \\
&amp; =\int_{\frac{1}{z}-1}^{+\infty} \frac{1}{(1+y)^2} d y=z \quad \text { H } 0&lt;z&lt;1 . \\
&amp; \therefore Z \sim U(0.1)
\end{aligned}
\]</span> (ps:$</p>
<span class="math display">\[\begin{aligned} &amp; f(x)=\frac{\Gamma\left(\frac{n_1+n_2}{2}\right)}{\Gamma\left(\frac{n_2}{2}\right) \Gamma\left(\frac{n_1}{2}\right)}\left(\frac{n_1}{n_2}\right)\left(\frac{n_1}{n_2} x\right)^{\frac{n_1}{2}-1}\left(1+\frac{n_1}{n_2} x\right)^{\frac{-1}{2}\left(n_1+n_2\right)} . \\ &amp; \text { of these } x&gt;0 \text {. and } E(x)=\frac{n_2}{n_2-2} \text {, when } n_2&gt;2 \text {. } \\ &amp; \operatorname{Var}(X)=\frac{2 n_2^2\left(n_1+n_2-2\right)}{n_1\left(n_2-2\right)^2\left(n_2-4\right)} \text {when $n_2&gt;4$. } \\ &amp; \end{aligned}\]</span>
<p><br>
</p>
</section>
</section>
</section>
<section id="pdf-functionss-transformationfrom-books" class="level2">
<h2 class="anchored" data-anchor-id="pdf-functionss-transformationfrom-books">PDF functions’s transformation(from books)</h2>
<section id="standard-normal-distribution" class="level3">
<h3 class="anchored" data-anchor-id="standard-normal-distribution">Standard normal distribution</h3>
<p>Pdf : <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span><br>
</p>
</section>
<section id="chi-square-distribution" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-distribution">Chi-square distribution</h3>
</section>
<section id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2" class="level3">
<h3 class="anchored" data-anchor-id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-chi-square-distribution-fx-k-frac12k2-gammak2-xk2---1-e-x2">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Chi-square distribution <span class="math inline">\(f(x; k) = \frac{1}{2^{k/2} \Gamma(k/2)} x^{k/2 - 1} e^{-x/2}\)</span></h3>
<p>Assuming that <span class="math inline">\(Z \sim N(0, 1)\)</span><br>
<span class="math inline">\(W=Z^2\)</span><br>
So we can deduce the pdf for the variable W <span class="math display">\[
\begin{align}
f_W(w)&amp;=Pr(Z^2=w)\\
&amp; =f_Z(\sqrt{w}) \left| \frac{d(\sqrt{w})}{dw} \right| + f_Z(-\sqrt{w}) \left| \frac{d(-\sqrt{w})}{dw} \right|\\
&amp;=2 \cdot \frac{1}{\sqrt{2\pi}} e^{-w / 2} \cdot \frac{1}{2\sqrt{w}} = \frac{1}{\sqrt{2\pi w}} e^{-w / 2}\\
\end{align}
\]</span></p>
<p><span class="math inline">\(\Gamma(z) = \int_0^\infty t^{z-1} e^{-t} \, dt\)</span><br>
<span class="math inline">\(\Gamma(1/2)\)</span>=<span class="math inline">\(\sqrt(\pi)\)</span>,we can know that <span class="math inline">\(W\sim \chi^2(1)\)</span><br>
</p>
<p>Now, we can introduce the variable Y.<br>
<span class="math inline">\(Y=\sum_{i=1}^k Z_i^2\)</span> (<span class="math inline">\(Z_i\)</span> is independent of each other)<br>
We want to get the mgf of Y <span class="math display">\[
\begin{align}
M_Y(t)&amp;=E[e^{tY}]\\
&amp; =E[e^{tZ_1^2}e^{tZ_2^2}...e^{tZ_k^2}]\\
&amp; =E[e^{tZ_1^2}]E[e^{tZ_2^2}]...E[e^{tZ_k^2}] \\
&amp; = \prod_{i=1}^k M_{Z_i^2}(t)\\
&amp;=(1-2t)^{-r1/2}(1-2t)^{-r2/2}...(1-2t)^{-rk/2}\\
&amp; =(1-2t)^{-\sum_{i=1}^kri/2}\\
\end{align}
\]</span> Because the mgf of Chi-square function is <span class="math inline">\((1-2t)^{-r/2}\)</span><br>
r is the degree of freedom of this chi-square function<br>
So <span class="math inline">\(Y\sim \chi^2(r1+r2+...+rk)\)</span><br>
r1,r2…rk represents the degree of freedom of every single sample<br>
Here, df=1 for every sample</p>
</section>
<section id="student--t-distribution" class="level3">
<h3 class="anchored" data-anchor-id="student--t-distribution">Student- t distribution</h3>
</section>
<section id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom." class="level3">
<h3 class="anchored" data-anchor-id="from-standard-normal-distribution-fx-frac1sqrt2pi-e-fracx22-we-want-to-get-student--t-distribution-ft-fracgamma-leftfracnu12rightsqrtnu-pi-gamma-leftfracnu2right-left1-fract2nuright-fracnu12-where-gamma-is-the-gamma-function-and-nu-is-the-degrees-of-freedom.">From standard normal distribution <span class="math inline">\(f(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}\)</span>, we want to get Student- t distribution <span class="math inline">\(f(t) = \frac{\Gamma \left(\frac{\nu+1}{2}\right)}{\sqrt{\nu \pi} \, \Gamma \left(\frac{\nu}{2}\right)} \left(1 + \frac{t^2}{\nu}\right)^{-\frac{\nu+1}{2}}\)</span>, where <span class="math inline">\(\Gamma\)</span> is the gamma function and <span class="math inline">\(\nu\)</span> is the degrees of freedom.</h3>
<p>Given two independent variables Z and V (<span class="math inline">\(Z \sim N(0, 1)\)</span> &amp; <span class="math inline">\(V\sim \chi^2(\nu)\)</span>), then we construct a new variable <span class="math inline">\(T=\frac{Z}{\sqrt(V/\nu)}\)</span>.<br>
The joint pdf is <span class="math display">\[
g(z,v)=\frac{1}{\sqrt{2\pi}} e^{-\frac{z^2}{2}}\frac{1}{2^{\nu/2} \Gamma(\nu/2)} v^{\nu/2 - 1} e^{-v/2}
\]</span> Cdf of T is given by <span class="math display">\[
\begin{align}
F(t) &amp; =Pr(\frac{Z}{\sqrt(V/\nu)}\leq t)\\
&amp; =Pr(Z\leq {\sqrt(V/\nu)}t)\\
&amp; =\int_{0}^{\infty} \int_{-\infty}^{\sqrt(V/\nu)t} g(z,v) \, dz \, dv
\end{align}
\]</span> Simplify F(t) <span class="math display">\[
F(t)=\frac{1}{\sqrt{\pi}\Gamma(\nu/2)}\int_{0}^{\infty}[\int_{-\infty}^{\sqrt(V/\nu)t} \frac{e^{-z^2/2}}{2^\frac{\nu+1}{2}}dz]v^{\frac{\nu}{2}-1}e^{-\frac{v}{2}}dv
\]</span></p>
<p>To get pdf, we will differentiate F(t) <span class="math display">\[
\begin{align}
f(t) &amp;=F'(t)=\frac{1}{\sqrt{\pi}\Gamma(\nu/2)}\int_{0}^{\infty} \frac{e^{-(v/2)(t^2/\nu)}}{2^{\frac{\nu+1}{2}}}\sqrt\frac{v}{\nu}v^{\nu/2-1}e^{-\frac{v}{2}}dv\\
&amp;=\frac{1}{\sqrt{\pi\nu}\Gamma(\nu/2)}\int_{0}^{\infty}\frac{v^{(\nu+1)/2-1}}{2^{(\nu+1)/2}}e^{-(\nu/2)(1+t^2/\nu)}dv
\end{align}
\]</span> We need to make the change of variables: <span class="math inline">\(y=(1+t^2/\nu)v\)</span><br>
And we need to change dv: <span class="math inline">\(\frac{dv}{dy}=\frac{1}{1+t^2/\nu}\)</span></p>
<p><span class="math display">\[
\begin{align}
f(t)&amp;=\frac{\Gamma[(\nu+1)/2]}{\sqrt{\pi\nu}\Gamma(\nu/2)}[\frac{1}{(1+t^2/\nu)^{(\nu+1)/2}}]\int_{0}^{\infty}\frac{y^{(\nu+1)/2-1}}{\Gamma[(\nu+1)/2]2^{(\nu+1)/2}}e^{-y/2}dy
\end{align}
\]</span> This part <span class="math inline">\(\int_{0}^{\infty}\frac{y^{(\nu+1)/2-1}}{\Gamma[(\nu+1)/2]2^{(\nu+1)/2}}e^{-y/2}dy\)</span> is equal to 1, because this part is the whole area under the chi-square distribution with <span class="math inline">\(\nu+1\)</span> degrees of freedom. So, the pdf for T can be written as follows <span class="math display">\[
f(t)=\frac{\Gamma[(\nu+1)/2]}{\sqrt{\pi\nu}\Gamma(\nu/2)}\frac{1}{(1+t^2/\nu)^{(\nu+1)/2}}
\]</span></p>
</section>
<section id="f-distribution" class="level3">
<h3 class="anchored" data-anchor-id="f-distribution">F-distribution</h3>
</section>
<section id="we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution" class="level3">
<h3 class="anchored" data-anchor-id="we-will-do-some-trnsformation-on-chi-square-distribution-to-get-f-distribution">We will do some trnsformation on chi-square distribution to get F-distribution</h3>
<p>Assuming that we have two independent random variables <span class="math display">\[
X \sim \chi^2(n_1) \quad and\quad  Y \sim \chi^2(n_2)\
\]</span> Now,we will define a new variable F <span class="math display">\[
F = \frac{(X / n_1)}{(Y / n_2)}
\]</span> This looks a little complex, so let’s do some simplification. <span class="math display">\[
U = \frac{X}{n_1} \quad \text{and} \quad V = \frac{Y}{n_2}\
\]</span></p>
<p>So, <span class="math inline">\(F = \frac{U}{V}\)</span>.<br>
Because, X and Y are independent of each other. Obviously, U and V are also independent of each other.<br>
</p>
<p><span class="math display">\[
f_{U,V}(u,v) = f_U(u) f_V(v)
\]</span> <span class="math display">\[
f_U(u) = \frac{(n_1 u)^{n_1/2 - 1} e^{-n_1 u/2}}{2^{n_1/2} \Gamma(n_1/2)}
\]</span> <span class="math display">\[
f_V(v) = \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)}
\]</span> To find the joint density function of F &amp; V, we use Jacobian transformation <span class="math display">\[
J =\left| \frac{\partial(U,V)}{\partial(F,V)} \right| = \left| \begin{matrix}
\frac{\partial U}{\partial F} &amp; \frac{\partial U}{\partial V} \\
\frac{\partial V}{\partial F} &amp; \frac{\partial V}{\partial V}
\end{matrix} \right| = \left| \begin{matrix}
V &amp; F \\
0 &amp; 1
\end{matrix} \right| = V
\]</span> <span class="math display">\[
f_{F,V}(f,v) = f_{U,V}(u,v) \left| \frac{\partial(u,v)}{\partial(f,v)} \right|= f_{U,V}(u,v)v
\]</span> Then, we substitute<span class="math inline">\(f_U(u)\)</span> and <span class="math inline">\(f_V(v)\)</span> into <span class="math inline">\(f_{F,V}(f,v)\)</span> <span class="math display">\[
f_{F,V}(f,v) = \frac{(n_1 u)^{n_1/2 - 1} e^{-n_1 u/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v
\]</span> Use the condition u=fv <span class="math display">\[
\begin{align}
f_{F,V}(f,v) &amp;= \frac{(n_1 fv)^{n_1/2 - 1} e^{-n_1 fv/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v\\
&amp; =\frac{(n_1 f v)^{n_1/2 - 1} e^{-n_1 f v/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{(n_2 v)^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v\\
&amp; = \frac{n_1^{n_1/2-1} f^{n_1/2 - 1} v^{n_1/2 - 1} e^{-n_1 f v/2}}{2^{n_1/2} \Gamma(n_1/2)} \cdot \frac{n_2^{n_2/2-1} v^{n_2/2 - 1} e^{-n_2 v/2}}{2^{n_2/2} \Gamma(n_2/2)} \cdot v\\
&amp; = \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1} v^{(n_1 + n_2)/2 - 1} e^{-(n_1 f + n_2) v/2}}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)}
\end{align}
\]</span> We will integrate this density function with respect to V <span class="math display">\[
\begin{align}
f_F(f) &amp;= \int_0^\infty f_{F,V}(f,v) dv\\
&amp;= \int_0^\infty \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1} v^{(n_1 + n_2)/2 - 1} e^{-(n_1 f + n_2) v/2}}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)} dv\\
\end{align}
\]</span> Let’s do some substitutions to make it look simpler <span class="math display">\[
\begin{align}
c = \frac{n_1 f + n_2}{2}
\end{align}
\]</span> This is the definition of Gamma function <span class="math display">\[
\int_0^\infty v^{(n_1 + n_2)/2 - 1} e^{-c v} dv = \frac{\Gamma((n_1 + n_2)/2)}{c^{(n_1 + n_2)/2}}
\]</span></p>
<p>Then <span class="math display">\[
f_F(f) = \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1}}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)} \cdot \frac{\Gamma((n_1 + n_2)/2)}{\left(\frac{n_1 f + n_2}{2}\right)^{(n_1 + n_2)/2}}
\]</span> Let’s rewrite it in an approximate F-distribution pdf form <span class="math display">\[
f_F(f) = \frac{n_1^{n_1/2-1} n_2^{n_2/2-1} f^{n_1/2 - 1} \Gamma((n_1 + n_2)/2)}{2^{(n_1 + n_2)/2} \Gamma(n_1/2) \Gamma(n_2/2)} \cdot \left(\frac{2}{n_1 f + n_2}\right)^{(n_1 + n_2)/2}
\]</span></p>
</section>
<section id="beta-and-gamma" class="level3">
<h3 class="anchored" data-anchor-id="beta-and-gamma">beta and Gamma</h3>
<p>When considering the product of two Gamma functions <span class="math display">\[(\Gamma(a) \Gamma(b))\]</span>, we can write it as two independent integrals:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \left( \int_0^\infty t^{a-1} e^{-t} \, dt \right) \left( \int_0^\infty s^{b-1} e^{-s} \, ds \right)
\]</span></p>
<p>To convert this product into a double integral, we can use a change of variables. Consider using polar coordinates in the two independent integrals, which allows us to use certain integration techniques to simplify them. First, we transform the integration region from Cartesian coordinates to polar coordinates:</p>
<p><span class="math display">\[
t = r \cos \theta, \quad s = r \sin \theta
\]</span></p>
<p>The Jacobian determinant is <span class="math display">\[r\]</span>, so the integral can be rewritten as:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \int_0^\infty \int_0^\infty t^{a-1} e^{-t} s^{b-1} e^{-s} \, dt \, ds
\]</span></p>
<p>Using the polar coordinate transformation, the integral becomes:</p>
<p><span class="math display">\[
= \int_0^\frac{\pi}{2} \int_0^\infty (r \cos \theta)^{a-1} e^{-r \cos \theta} (r \sin \theta)^{b-1} e^{-r \sin \theta} r \, dr \, d\theta
\]</span></p>
<p>Separating all <span class="math display">\[r\]</span> and <span class="math display">\[\theta\]</span> related terms:</p>
<p><span class="math display">\[
= \int_0^\frac{\pi}{2} (\cos \theta)^{a-1} (\sin \theta)^{b-1} \, d\theta \int_0^\infty r^{a+b-1} e^{-r(\cos \theta + \sin \theta)} \, dr
\]</span></p>
<p>First, compute the <span class="math display">\[r\]</span> integral part:</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r(\cos \theta + \sin \theta)} \, dr = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}}
\]</span></p>
<p>Next, compute the <span class="math display">\[\theta\]</span> integral part:</p>
<p><span class="math display">\[
\int_0^\frac{\pi}{2} (\cos \theta)^{a-1} (\sin \theta)^{b-1} \, d\theta = B(a, b)
\]</span></p>
<p>where <span class="math display">\[B(a, b)\]</span> is the Beta function, defined as:</p>
<p><span class="math display">\[
B(a, b) = \int_0^1 t^{a-1} (1-t)^{b-1} \, dt
\]</span></p>
<p>Therefore, we get:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}} \cdot B(a, b)
\]</span></p>
<p>Since <span class="math display">\[\cos \theta + \sin \theta = 1\]</span> (in polar coordinates), we have:</p>
<p><span class="math display">\[
\Gamma(a) \Gamma(b) = \Gamma(a+b) B(a, b)
\]</span></p>
<p>Thus, the double integral form of the Gamma function product directly comes from the polar transformation and the application of the Beta function. This is an important mathematical technique used to simplify complex integrals and functional relationships.</p>
</section>
<section id="why-is-the-integral-result-as-shown" class="level3">
<h3 class="anchored" data-anchor-id="why-is-the-integral-result-as-shown">Why is the integral result as shown?</h3>
<p>The given integral,</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr,
\]</span></p>
<p>can be evaluated using the definition of the Gamma function. The Gamma function <span class="math display">\[\Gamma(z)\]</span> is defined as:</p>
<p><span class="math display">\[
\Gamma(z) = \int_0^\infty t^{z-1} e^{-t} \, dt.
\]</span></p>
<p>To see why the integral can be expressed in terms of the Gamma function, let’s rewrite the integral in a form that matches the Gamma function’s definition. The integral has the form:</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr.
\]</span></p>
<p>Let’s set <span class="math display">\[t = r (\cos \theta + \sin \theta)\]</span>, then <span class="math display">\[r = \frac{t}{\cos \theta + \sin \theta}\]</span> and <span class="math display">\[dr = \frac{dt}{\cos \theta + \sin \theta}\]</span>. Substituting these into the integral gives:</p>
<p><span class="math display">\[
\int_0^\infty \left( \frac{t}{\cos \theta + \sin \theta} \right)^{a+b-1} e^{-t} \cdot \frac{dt}{\cos \theta + \sin \theta}.
\]</span></p>
<p>Simplifying inside the integral:</p>
<p><span class="math display">\[
\int_0^\infty \frac{t^{a+b-1}}{(\cos \theta + \sin \theta)^{a+b}} e^{-t} \, dt.
\]</span></p>
<p>Since <span class="math display">\[(\cos \theta + \sin \theta)^{a+b}\]</span> is a constant with respect to <span class="math display">\[t\]</span>, it can be factored out of the integral:</p>
<p><span class="math display">\[
\frac{1}{(\cos \theta + \sin \theta)^{a+b}} \int_0^\infty t^{a+b-1} e^{-t} \, dt.
\]</span></p>
<p>The integral</p>
<p><span class="math display">\[
\int_0^\infty t^{a+b-1} e^{-t} \, dt
\]</span></p>
<p>is recognized as the Gamma function <span class="math display">\[\Gamma(a+b)\]</span>. Thus, we have:</p>
<p><span class="math display">\[
\frac{1}{(\cos \theta + \sin \theta)^{a+b}} \Gamma(a+b).
\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}}.
\]</span></p>
<p>This demonstrates why the integral is evaluated as shown:</p>
<p><span class="math display">\[
\int_0^\infty r^{a+b-1} e^{-r (\cos \theta + \sin \theta)} \, dr = \frac{\Gamma(a+b)}{(\cos \theta + \sin \theta)^{a+b}}.
\]</span> (method 2 for integral calculation: x=uv,y=u(1-v) J=-u)</p>
</section>
</section>
<section id="three-main-sampling-distribution" class="level2">
<h2 class="anchored" data-anchor-id="three-main-sampling-distribution">Three Main Sampling distribution</h2>
<section id="chi-square-distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="chi-square-distribution-1">Chi-square distribution</h3>
<p>Suppose <span class="math inline">\(X_1, \cdots, X_n \stackrel{\text { i.i.d. }}{\sim} \mathcal{N}(0,1)\)</span>.the distribution of the statistic <span class="math display">\[
X_1^2+\cdots+X_n^2
\]</span> is called a chi-square distribution with <span class="math inline">\(n\)</span> degrees of freedom, denoted by <span class="math inline">\(\chi^2(n)\)</span>.</p>
<p>Besides, random variable <span class="math inline">\(X_i^2 \sim \operatorname{Gamma}\left(\frac{1}{2}, \frac{1}{2}\right)\)</span> corresponds to the chi-squared distribution with 1 degree of freedom, denoted as <span class="math inline">\(\chi_1^2\)</span>.</p>
<p>This is derived by the MGF:</p>
<p>Since <span class="math display">\[
M_{X_1^2+\cdots+X_n^2}(t)=M_{X_1^2}(t) \times \cdots \times M_{X_n^2}(t)= \begin{cases}\infty &amp; t \geq \frac{1}{2} \\ (1-2 t)^{-\frac{n}{2}} &amp; t&lt;\frac{1}{2}\end{cases}
\]</span></p>
<p>This is the MGF of the <span class="math inline">\(\operatorname{Gamma}\left(\frac{n}{2}, \frac{1}{2}\right)\)</span> distribution, so <span class="math inline">\(X_1^2+\cdots+X_n^2 \sim \operatorname{Gamma}\left(\frac{n}{2}, \frac{1}{2}\right)\)</span>. This is called the chi-squared distribution with <span class="math inline">\(\mathbf{n}\)</span> degree of freedom, denoted <span class="math inline">\(\chi_n^2\)</span>.</p>
<section id="properties" class="level4">
<h4 class="anchored" data-anchor-id="properties">Properties</h4>
<ul>
<li><p>If <span class="math inline">\(W_1, \ldots, W_n\)</span> are independent <span class="math inline">\(\chi^2\)</span> random variables with, respectively, <span class="math inline">\(v_1, \cdots, v_n\)</span> degrees of freedom, then the random variable <span class="math inline">\(W_1+\cdots+W_n\)</span> follows a <span class="math inline">\(\chi^2\)</span>-distribution with <span class="math inline">\(v_1+\cdots+v_n\)</span> degree of freedom.</p></li>
<li><p>The random variable <span class="math inline">\(\frac{(\bar{X}-\mu)^2}{\sigma^2 / n}\)</span> follows a <span class="math inline">\(\chi^2\)</span>-distribution with 1 degree of freedom when <span class="math inline">\(X\)</span> follows a normal distribution with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>.</p></li>
</ul>
</section>
<section id="code-to-plot-examples-of-chi-square-distribution" class="level4">
<h4 class="anchored" data-anchor-id="code-to-plot-examples-of-chi-square-distribution">Code to plot examples of Chi-square distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">20</span>, <span class="at">length.out =</span> <span class="dv">200</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the density for different degrees of freedom</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">4</span>)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>df8 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">8</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>df12 <span class="ot">&lt;-</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">12</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>chi_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, df4, df8, df12)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(chi_data, <span class="fu">aes</span>(x)) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df4, <span class="at">color =</span> <span class="st">"df=4"</span>)) <span class="sc">+</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df8, <span class="at">color =</span> <span class="st">"df=8"</span>)) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df12, <span class="at">color =</span> <span class="st">"df=12"</span>)) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Chi-Square Distribution"</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Value"</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Degrees of Freedom"</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"df=4"</span> <span class="ot">=</span> <span class="st">"blue"</span>,<span class="st">"df=8"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"df=12"</span> <span class="ot">=</span> <span class="st">"green"</span>)) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="application" class="level4">
<h4 class="anchored" data-anchor-id="application">Application</h4>
<p>Chi-square distribution is primarily used in testing:</p>
<ul>
<li><p>Goodness-of-fit</p></li>
<li><p>Independence in contingency tables</p></li>
</ul>
</section>
</section>
<section id="students-t-distribution" class="level3">
<h3 class="anchored" data-anchor-id="students-t-distribution">Student’s t-distribution</h3>
<section id="construction" class="level4">
<h4 class="anchored" data-anchor-id="construction">Construction</h4>
<p>The statistic <span class="math inline">\(T=\frac{\bar{X}-\mu}{S / \sqrt{n}}\)</span> follows a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(v=n-1\)</span> degrees of freedom when <span class="math inline">\(X_1, \cdots, X_n\)</span> are i.i.d. normal RVs.</p>
<p><span class="math display">\[
\bar{X} \sim \mathcal{N}\left(\mu, \frac{\sigma^2}{n}\right) \quad \frac{\bar{X}-\mu}{\sigma / \sqrt{n}} \sim \mathcal{N}(0,1) \quad \frac{(n-1) s^2}{\sigma^2} \sim \chi_{n-1}^2
\]</span></p>
<p>If we know the population variance <span class="math inline">\(\sigma^2\)</span>, we can easily do inference using the statistic <span class="math inline">\(\frac{\bar{X}-\mu}{\sigma / \sqrt{n}}\)</span>. However, <span class="math inline">\(\sigma^2\)</span> is usually unknown in practice.</p>
<p><span class="math display">\[
\bar{X} \sim \mathcal{N}\left(\mu, \frac{\sigma^2}{n}\right) \quad \frac{\bar{X}-\mu}{\sigma / \sqrt{n}} \sim \mathcal{N}(0,1) \quad \frac{(n-1) s^2}{\sigma^2} \sim \chi_{n-1}^2
\]</span></p>
<p>We can construct the <span class="math inline">\(t\)</span>-statistic using the sample variance <span class="math inline">\(S^2\)</span> : <span class="math display">\[
T=\frac{\frac{\bar{X}-\mu}{\sigma / \sqrt{n}}}{\sqrt{\frac{(n-1) s^2}{\sigma^2} /(n-1)}}=\frac{\bar{X}-\mu}{S / \sqrt{n}}
\]</span></p>
<p>Notice the sample mean <span class="math inline">\(\bar{X}\)</span> and the sample variance <span class="math inline">\(S^2\)</span> are independent (the proof is beyond the scope of this course). So the <span class="math inline">\(T\)</span> is now a ratio of a standard normal variable and the square root of a <span class="math inline">\(\chi^2 \mathrm{RV}\)</span> divided by its degrees of freedom. This is the definition of a <span class="math inline">\(t\)</span>-distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
</section>
<section id="properties-1" class="level4">
<h4 class="anchored" data-anchor-id="properties-1">Properties</h4>
<p>The <span class="math inline">\(t\)</span>-distribution is primarily used in contexts where the underlying population is assumed to be normally distributed, especially when the sample size is small. Used extensively in problems that deal with inference about population mean <span class="math inline">\(\mu\)</span> when population variance <span class="math inline">\(\sigma^2\)</span> is unknown; problems where one is trying to determine if means from two samples are significantly different when population variances <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are unknown.</p>
</section>
<section id="code-to-plot-examples-of-t-distribution" class="level4">
<h4 class="anchored" data-anchor-id="code-to-plot-examples-of-t-distribution">Code to plot examples of t-distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the density for different degrees of freedom</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">30</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>distributions <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df_values, <span class="cf">function</span>(df) <span class="fu">dt</span>(x, <span class="at">df =</span> df))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the data</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>df_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df_values)) {</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  df_data[<span class="fu">paste0</span>(<span class="st">"df"</span>, df_values[i])] <span class="ot">&lt;-</span> distributions[[i]]</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the densities</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df1, <span class="at">color =</span> <span class="st">"df=1"</span>)) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df2, <span class="at">color =</span> <span class="st">"df=2"</span>)) <span class="sc">+</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df3, <span class="at">color =</span> <span class="st">"df=3"</span>)) <span class="sc">+</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df5, <span class="at">color =</span> <span class="st">"df=5"</span>)) <span class="sc">+</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df10, <span class="at">color =</span> <span class="st">"df=10"</span>)) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df30, <span class="at">color =</span> <span class="st">"df=30"</span>)) <span class="sc">+</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">dnorm</span>(x), <span class="at">color =</span> <span class="st">"Standard Normal"</span>)) <span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">"Distribution"</span>, </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"df=1"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"df=2"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"df=3"</span> <span class="ot">=</span> <span class="st">"red"</span>, </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"df=5"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"df=10"</span> <span class="ot">=</span> <span class="st">"green"</span>, <span class="st">"df=30"</span> <span class="ot">=</span> <span class="st">"green"</span>, </span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"Standard Normal"</span> <span class="ot">=</span> <span class="st">"blue"</span>)) <span class="sc">+</span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density of the t-distribution compared to the standard normal distribution"</span>,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="f-distribution-1" class="level3">
<h3 class="anchored" data-anchor-id="f-distribution-1">F-distribution</h3>
<p>Let <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> be two independent RVs following <span class="math inline">\(\chi^2\)</span> distributions with <span class="math inline">\(\nu_1\)</span> and <span class="math inline">\(\nu_2\)</span> degrees of freedom, respectively. Then the distribution of the random variable <span class="math inline">\(F=\frac{U / \nu_1}{V / \nu_2}\)</span> is known as <span class="math inline">\(F\)</span>-distribution.</p>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example</h4>
<p>If <span class="math inline">\(S_1^2\)</span> and <span class="math inline">\(S_2^2\)</span> are the variances of independent RVs of size <span class="math inline">\(n_1\)</span> and <span class="math inline">\(n_2\)</span> taken from normal populations with variances <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> respectively, then <span class="math display">\[
F=\frac{S_1^2 / \sigma_1^2}{S_2^2 / \sigma_2^2}=\frac{\sigma_2^2 S_1^2}{\sigma_1^2 S_2^2}
\]</span> follows an <span class="math inline">\(F\)</span>-distribution with <span class="math inline">\(\nu_1=n_1-1\)</span> and <span class="math inline">\(\nu_2=n_2-1\)</span> degrees of freedom.</p>
</section>
<section id="code-to-plot-examples-of-f-distribution" class="level4">
<h4 class="anchored" data-anchor-id="code-to-plot-examples-of-f-distribution">Code to plot examples of F-distribution</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a sequence of values</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the density for different degrees of freedom</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>df1_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>df2_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>distributions <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(df1_values), <span class="cf">function</span>(i) <span class="fu">df</span>(x, <span class="at">df1 =</span> df1_values[i], <span class="at">df2 =</span> df2_values[i]))</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data frame to store the data</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>df_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(df1_values)) {</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  df_data[<span class="fu">paste0</span>(<span class="st">"df1"</span>, df1_values[i], <span class="st">"_df2"</span>, df2_values[i])] <span class="ot">&lt;-</span> distributions[[i]]</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the densities</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_data, <span class="fu">aes</span>(<span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df11_df21, <span class="at">color =</span> <span class="st">"d1=1, d2=1"</span>)) <span class="sc">+</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df12_df21, <span class="at">color =</span> <span class="st">"d1=2, d2=1"</span>)) <span class="sc">+</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df15_df22, <span class="at">color =</span> <span class="st">"d1=5, d2=2"</span>)) <span class="sc">+</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df110_df21, <span class="at">color =</span> <span class="st">"d1=10, d2=1"</span>)) <span class="sc">+</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> df1100_df2100, <span class="at">color =</span> <span class="st">"d1=100, d2=100"</span>)) <span class="sc">+</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="st">""</span>, </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>                     <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"d1=1, d2=1"</span> <span class="ot">=</span> <span class="st">"red"</span>, <span class="st">"d1=2, d2=1"</span> <span class="ot">=</span> <span class="st">"black"</span>, </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"d1=5, d2=2"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"d1=10, d2=1"</span> <span class="ot">=</span> <span class="st">"green"</span>, </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>                                <span class="st">"d1=100, d2=100"</span> <span class="ot">=</span> <span class="st">"grey"</span>)) <span class="sc">+</span></span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"F-distribution with different degrees of freedom"</span>,</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"x"</span>,</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"top"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="application-1" class="level4">
<h4 class="anchored" data-anchor-id="application-1">Application</h4>
<p>Analysis of variance (ANOVA)</p>
</section>
</section>
</section>
</section>
<section id="estimation-of-population-characteristic" class="level1">
<h1>Estimation of Population Characteristic</h1>
<section id="point-estimation" class="level2">
<h2 class="anchored" data-anchor-id="point-estimation">Point Estimation</h2>
<p>A point estimate of a population characteristic is a single number that is based on sample data and represents a plausible value of the characteristic.</p>
</section>
</section>
<section id="interval-estimationconfidence-intervalci" class="level1">
<h1>Interval Estimation—Confidence interval(CI)</h1>
<p>An interval estimate of a parameter <span class="math inline">\(\theta\)</span> is an interval of the form <span class="math inline">\(\hat{\theta}_L&lt;\theta&lt;\hat{\theta}_U\)</span>, where <span class="math inline">\(\hat{\theta}_L\)</span> and <span class="math inline">\(\hat{\theta}_U\)</span> depend on the value of <span class="math inline">\(\hat{\theta}\)</span> for a particular sample and also on the sampling distribution of <span class="math inline">\(\hat{\Theta}\)</span>.</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<ul>
<li><p>If we were to construct a 95% confidence interval for some population characteristics (population proportion p or population mean <span class="math inline">\(\mu\)</span>), we would be using a method that is successful 95% of the time.</p></li>
<li><p>This is also about the question relevant to “How to choose a sample size”</p></li>
</ul>
</section>
<section id="definition-1" class="level2">
<h2 class="anchored" data-anchor-id="definition-1">Definition</h2>
<p>A <span class="math inline">\(100(1-\alpha) \%\)</span> confidence interval is an interval of the form <span class="math inline">\(\hat{\theta}_L&lt;\theta&lt;\hat{\theta}_U\)</span>, where <span class="math inline">\(\hat{\theta}_L\)</span> and <span class="math inline">\(\hat{\theta}_U\)</span> are respectively values of <span class="math inline">\(\widehat{\Theta}_L\)</span> and <span class="math inline">\(\widehat{\Theta}_U\)</span> obtained for a particular sample, based on <span class="math display">\[
P\left(\widehat{\Theta}_L&lt;\theta&lt;\widehat{\Theta}_U\right)=1-\alpha \quad ; \quad 0&lt;\alpha&lt;1
\]</span> in the estimation of population parameter <span class="math inline">\(\theta\)</span>.</p>
</section>
<section id="interpretation" class="level2">
<h2 class="anchored" data-anchor-id="interpretation">Interpretation</h2>
<p>For confidence level of 95% CI for any normal distribution: About 95% of the values are within 1.96 standard deviations of the mean. (Recall the concept of Z-scores)</p>
<p>That is, if $± (Z ) $ was used to generate an interval estimate over and over again with different samples, in the long run 95% of the resulting intervals would include the actual value of the characteristic being estimated.</p>
<ul>
<li>The confidence level 95% refers to the method used to construct the interval rather than to any particular interval, such as the one we obtained.</li>
</ul>
<section id="eg" class="level3">
<h3 class="anchored" data-anchor-id="eg">eg</h3>
<section id="proportion" class="level4">
<h4 class="anchored" data-anchor-id="proportion">Proportion</h4>
<ul>
<li>check to make sure that the three necessary conditions are met:</li>
</ul>
<p><span class="math inline">\(n\hat p \ge 10, n(1-\hat p) \ge 10\)</span></p>
<p><span class="math inline">\(\frac {\hat p -p }{\sigma/\sqrt n} = 1.96\)</span>)</p>
<ul>
<li>sample size question</li>
</ul>
<p>Using sample proportion with 95% confidence interval, and we want ME no more than 5%, we may be interested in solving n from the following equation:</p>
<p>0.05=1.96 <span class="math inline">\(\sqrt {\frac {\hat p(1-\hat p) }{ n}}\)</span></p>
</section>
<section id="ci-on-mean" class="level4">
<h4 class="anchored" data-anchor-id="ci-on-mean">CI on Mean</h4>
<p>Here, <span class="math inline">\(\bar x\)</span> is the sample mean from a simple random sample.</p>
<p><span class="math inline">\(\mu\)</span> is the population mean which we are interested in estimating.</p>
<section id="ci-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics" class="level5">
<h5 class="anchored" data-anchor-id="ci-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics">CI on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\sigma\)</span> known n <span class="math inline">\(\ge 30\)</span> or the population is normal — Use z-statistics</h5>
<p>CI: <span class="math inline">\(\bar x \pm z_{\alpha/2} \frac {\sigma}{\sqrt n}\)</span>, for example, 95% CI is <span class="math inline">\(\bar x \pm 1.96 \frac {\sigma}{\sqrt n}\)</span></p>
</section>
<section id="one-side-confidence-bound-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics" class="level5">
<h5 class="anchored" data-anchor-id="one-side-confidence-bound-on-mu-with-sigma-known-n-ge-30-or-the-population-is-normal-use-z-statistics">One-side Confidence Bound on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\sigma\)</span> known n <span class="math inline">\(\ge 30\)</span> or the population is normal — Use z-statistics</h5>
<p>Upper one-side bound: <span class="math inline">\(\mu &lt;\bar x + z_{\alpha} \frac {\sigma}{\sqrt n}\)</span></p>
<p>Lower one-side bound: <span class="math inline">\(\mu &gt;\bar x - z_{\alpha} \frac {\sigma}{\sqrt n}\)</span></p>
<p>For example, 95% Confidence bound on <span class="math inline">\(\mu\)</span> is <span class="math inline">\(\bar x \pm 1.645 \frac {\sigma}{\sqrt n}\)</span></p>
</section>
<section id="ci-on-mu-with-sigma-unknown-and-the-population-is-normal-use-t-statistics-use-s-as-the-estimate-for-σ-t-statistics-with-df-n-1" class="level5">
<h5 class="anchored" data-anchor-id="ci-on-mu-with-sigma-unknown-and-the-population-is-normal-use-t-statistics-use-s-as-the-estimate-for-σ-t-statistics-with-df-n-1">CI on <span class="math inline">\(\mu\)</span> with <span class="math inline">\(\sigma\)</span> unknown and the population is normal — Use t-statistics (use s as the estimate for σ (t-statistics with df = n-1))</h5>
<p>CI: <span class="math inline">\(\bar x \pm t_{\alpha/2} \frac {s}{\sqrt n}\)</span>, for example, 95% CI is <span class="math inline">\(\bar x \pm t_{0.025} \frac {s}{\sqrt n}\)</span> and df = n-1</p>
<p>Remark: The distribution of t is more spread out than the standard normal distribution but when n <span class="math inline">\(\ge 30\)</span>, t and z are very close to each other.</p>
</section>
<section id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-known" class="level5">
<h5 class="anchored" data-anchor-id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-known">CI for <span class="math inline">\(\mu_1 - \mu_2\)</span>, both <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are known</h5>
<p>CI of <span class="math inline">\(\mu_1-\mu_2\)</span>: <span class="math inline">\((\bar x_1 - \bar x_2) \pm z_{\alpha/2} \sqrt {\frac {\sigma_1^2}{n_1} + \frac {\sigma_2^2}{n_2}}\)</span></p>
</section>
<section id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-unknown-but-assumed-equal" class="level5">
<h5 class="anchored" data-anchor-id="ci-for-mu_1---mu_2-both-sigma_12-and-sigma_22-are-unknown-but-assumed-equal">CI for <span class="math inline">\(\mu_1 - \mu_2\)</span>, both <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are unknown but assumed equal</h5>
<p>CI of <span class="math inline">\(\mu_1-\mu_2\)</span>: <span class="math inline">\((\bar x_1 - \bar x_2) \pm t_{\alpha/2} s_p \sqrt {\frac {1}{n_1} + \frac {1}{n_2}}\)</span> with df = <span class="math inline">\(n_1+n_2-2\)</span> where <span class="math inline">\(s_p = \sqrt {\frac {(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1+n_2-2}}\)</span></p>
</section>
<section id="ci-for-paired-observations" class="level5">
<h5 class="anchored" data-anchor-id="ci-for-paired-observations">CI for paired observations</h5>
<p>Previous, we have two independent samples, now we have two dependent samples. We can use the difference between the two samples to construct a confidence interval.</p>
<p>CI of <span class="math inline">\(\mu_d\)</span>: <span class="math inline">\(\bar d \pm t_{\alpha/2} \frac {s_d}{\sqrt n}\)</span> with df = n-1 where <span class="math inline">\(s_d\)</span> is the sample standard deviation of the differences <span class="math inline">\(d_i = x_{1i} - x_{2i}\)</span> and <span class="math inline">\(\bar d\)</span> is the sample mean of the differences.</p>
</section>
<section id="estimating-sigma" class="level5">
<h5 class="anchored" data-anchor-id="estimating-sigma">Estimating <span class="math inline">\(\sigma\)</span></h5>
<p>a <span class="math inline">\(100(1-\alpha)\%\)</span> CI for <span class="math inline">\(\sigma^2\)</span> is <span class="math inline">\(\left(\frac{(n-1) S^2}{\chi_{\alpha / 2, n-1}^2}, \frac{(n-1) S^2}{\chi_{1-\alpha / 2, n-1}^2}\right)\)</span></p>
<p>where <span class="math inline">\(S^2\)</span> is the sample variance and <span class="math inline">\(\chi_{\alpha / 2, n-1}^2\)</span> and <span class="math inline">\(\chi_{1-\alpha / 2, n-1}^2\)</span> are the critical values of the chi-square distribution with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
</section>
<section id="estimating-sigma_12-sigma_22" class="level5">
<h5 class="anchored" data-anchor-id="estimating-sigma_12-sigma_22">Estimating <span class="math inline">\(\sigma_1^2/ \sigma_2^2\)</span></h5>
<p>A <span class="math inline">\(100(1-\alpha)\%\)</span> CI for <span class="math inline">\(\frac{\sigma_1^2}{\sigma_2^2}\)</span> using F-statistics with <span class="math inline">\(f_{1-\alpha/2}(n_1-1,n_2-1)=1/f_{\alpha/2}(n_1-1,n_2-1)\)</span> is <span class="math display">\[
\frac{s_1^2}{s_2^2} \frac{1}{f_{\alpha / 2}\left(n_1-1, n_2-1\right)}&lt;\frac{\sigma_1^2}{\sigma_2^2}&lt;\frac{s_1^2}{s_2^2} f_{\alpha / 2}\left(n_2-1, n_1-1\right)
\]</span> where <span class="math inline">\(f_{\alpha / 2}\left(v_1, v_2\right)\)</span> is an <span class="math inline">\(F\)</span>-value with <span class="math inline">\(v_1\)</span> and <span class="math inline">\(v_2\)</span> degrees of freedom, leaving an area of <span class="math inline">\(\alpha / 2\)</span> to the right, and <span class="math inline">\(f_{\alpha / 2}\left(v_2, v_1\right)\)</span> is a similar <span class="math inline">\(F\)</span>-value with <span class="math inline">\(v_2\)</span> and <span class="math inline">\(v_1\)</span> degrees of freedom.</p>
</section>
</section>
</section>
</section>
</section>
<section id="hypothesis-testing" class="level1">
<h1>Hypothesis Testing</h1>
<p><img src="images/clipboard-2219722049.png" class="img-fluid"></p>
<ul>
<li>z-test</li>
</ul>
<p>Suppose <span class="math inline">\(X_1, \cdots, X_n \xrightarrow[\sim]{\text { iid }} \mathcal{N}\left(\mu, \sigma^2\right)\)</span>, where <span class="math inline">\(\mu\)</span> is unknown and where <span class="math inline">\(\sigma^2=\sigma_0^2\)</span> is known.</p>
<p>Suppose we wish to test <span class="math inline">\(H_0: \mu=\mu_0\)</span> against <span class="math inline">\(H_1: \mu&gt;\mu_0\)</span>. Then we can use the test statistic <span class="math display">\[
Z=\frac{\bar{X}-\mu_0}{\sigma_0 / \sqrt{n}}
\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true then <span class="math inline">\(Z \sim \mathcal{N}(0,1)\)</span>. Let <span class="math display">\[
z_{\mathrm{obs}}=\frac{\bar{x}-\mu_0}{\sigma_0 / \sqrt{n}}
\]</span></p>
<p>A large value of <span class="math inline">\(z_{\text {obs }}\)</span> casts doubt on the validity of <span class="math inline">\(H_0\)</span> and indicates a departure from <span class="math inline">\(H_0\)</span> in the direction of <span class="math inline">\(H_1\)</span>. So the <span class="math inline">\(p\)</span>-value for testing <span class="math inline">\(H_0\)</span> against <span class="math inline">\(H_1\)</span> is <span class="math display">\[
\begin{aligned}
p &amp; =P\left(Z \geq Z_{\mathrm{obs}} \mid H_0\right) \\
&amp; =P\left(\mathcal{N}(0,1) \geq Z_{\mathrm{obs}}\right) \\
&amp; =1-\Phi\left(Z_{\mathrm{obs}}\right)
\end{aligned}
\]</span></p>
<p>The z-test of <span class="math inline">\(H_0: \mu=\mu_0\)</span> against the alternative <span class="math inline">\(H_1: \mu&lt;\mu_0\)</span> is similar but this time a small, i.e.&nbsp;very negative, value of <span class="math inline">\(Z_{\text {obs }}\)</span> casts doubt on <span class="math inline">\(H_0\)</span>. So the <span class="math inline">\(p\)</span>-value is <span class="math display">\[
\begin{aligned}
p &amp; =P\left(Z \leq Z_{\mathrm{obs}} \mid H_0\right) \\
&amp; =P\left(\mathcal{N}(0,1) \leq Z_{\mathrm{obs}}\right) \\
&amp; =\Phi\left(Z_{\mathrm{obs}}\right)
\end{aligned}
\]</span></p>
<p>Finally, consider testing <span class="math inline">\(H_0: \mu=\mu_0\)</span> against the alternative <span class="math inline">\(H_1: \mu \neq\)</span> <span class="math inline">\(\mu_0\)</span>. Let <span class="math inline">\(z_0=\left|z_{\text {obs }}\right|\)</span>. A large value of <span class="math inline">\(z_0\)</span> indicates a departure from <span class="math inline">\(H_0\)</span>, so the <span class="math inline">\(p\)</span>-value is <span class="math display">\[
\begin{aligned}
p &amp; =P\left(|Z| \geq z_0 \mid H_0\right) \\
&amp; =P\left(\mathcal{N}(0,1) \geq z_0\right)+P\left(\mathcal{N}(0,1) \leq-z_0\right) \\
&amp; =2\left(1-\phi\left(z_0\right)\right)
\end{aligned}
\]</span></p>
<ul>
<li>t-test</li>
</ul>
<p>We can use the test statistic <span class="math display">\[
T=\frac{\bar{X}-\mu_0}{S / \sqrt{n}}
\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true then <span class="math inline">\(T \sim t_{n-1}\)</span>. Let <span class="math inline">\(t_{\mathrm{obs}}=t(x)=\frac{\bar{x}-\mu_0}{s / \sqrt{n}}\)</span> and <span class="math inline">\(t_0=\left|t_{\mathrm{obs}}\right|\)</span>. Similarly, we have <span class="math inline">\(\square\)</span> the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(P\left(t_{n-1} \geq t_{\mathrm{obs}}\right)\)</span> - the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(P\left(t_{n-1} \leq t_{\text {obs }}\right)\)</span> the <span class="math inline">\(p\)</span>-value is <span class="math inline">\(2 P\left(t_{n-1} \geq t_0\right)\)</span></p>
<section id="example-of-one-sample-t-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-one-sample-t-test">Example of one-sample t-test</h2>
<p>A marine biologist is studying a species of fish known to have an average length of 20 cm in ocean populations. A new population in a freshwater lake is being analyzed to determine if the environmental differences have altered the fish’s average length. The biologist measures the lengths of 10 randomly selected fish, yielding the following data:</p>
<p>22, 23, 21, 24, 22, 20, 25, 19, 23, 22</p>
<p>Assuming the data satisfy the assumption of normality, please address the following using a significance level of 0.1:</p>
<section id="a" class="level3">
<h3 class="anchored" data-anchor-id="a">a</h3>
<ul>
<li><p>null hypothesis: The mean length of fish is 20 cm (<span class="math inline">\(H_0: \mu = 20\)</span>).</p></li>
<li><p>alternative hypothesis: The mean length of fish is not 20 cm (<span class="math inline">\(H_1: \mu \ne 20\)</span>).</p></li>
</ul>
</section>
<section id="b" class="level3">
<h3 class="anchored" data-anchor-id="b">b</h3>
<p>Since the data is supposed to be normally distributed, the sampling distribution of the sample mean follows t-distribution. The t-test statistic is calculated as follows:</p>
<p><span class="math display">\[t = \frac{\bar x - \mu}{s / \sqrt n}\]</span></p>
<p>The t-test statistic is calculated as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>data2_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">24</span>, <span class="dv">22</span>, <span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">19</span>, <span class="dv">23</span>, <span class="dv">22</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(data2_4)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(data2_4)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> (x_bar <span class="sc">-</span> <span class="dv">20</span>) <span class="sc">/</span> (s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(data2_4)))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>t</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.705882</code></pre>
</div>
</div>
<p>The t-test statistic is 3.705882…</p>
</section>
<section id="c" class="level3">
<h3 class="anchored" data-anchor-id="c">c</h3>
<p>Using pt() function, the p-value is calculated as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">pt</span>(<span class="sc">-</span>t, <span class="at">df =</span> <span class="dv">9</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>p_value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.004875954</code></pre>
</div>
</div>
<p>The p-value is approximately 0.1. Since the p-value is less than 0.1, we reject the null hypothesis.</p>
<p>Therefore, there is sufficient evidence to conclude that the population mean is not equal to 20 which means the environmental differences have altered the fish’s average length.</p>
</section>
<section id="d" class="level3">
<h3 class="anchored" data-anchor-id="d">d</h3>
<p>Using qt() function to find the critical value for a two-tailed test with 90% confidence level:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>t_critical <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.95</span>, <span class="at">df =</span> <span class="dv">9</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>t_critical</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.833113</code></pre>
</div>
</div>
<p>The critical value for a two-tailed test with 90% confidence level is about 1.833113.</p>
<p>Since the t-test statistic 3.705882 is greater than the critical value 1.833113, which is in the critical region. Therefore, we reject the null hypothesis.</p>
<p>Also, we could use confidence interval to verify the result. The 90% confidence interval for the population mean is calculated as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ci_4 <span class="ot">&lt;-</span> <span class="fu">c</span>(x_bar <span class="sc">-</span> t_critical <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>), x_bar <span class="sc">+</span> t_critical <span class="sc">*</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">10</span>))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ci_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.06124 23.13876</code></pre>
</div>
</div>
<p>So the 90% confidence interval for the population mean is about (21.1, 23.2).</p>
<p>The confidence interval does not contain the hypothesized value 20. Therefore, we reject the null hypothesis.</p>
<p>Therefore, there is sufficient evidence to conclude that the population mean is not equal to 20 which means the environmental differences have altered the fish’s average length.</p>
</section>
</section>
<section id="example-of-unpaired-t-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-unpaired-t-test">Example of unpaired t-test</h2>
<p>Suppose <span class="math inline">\(\sigma_1^2\)</span> and <span class="math inline">\(\sigma_2^2\)</span> are unknown but assumed equal. We want to test the null hypothesis <span class="math inline">\(H_0: \mu_1 = \mu_2\)</span> against the alternative hypothesis <span class="math inline">\(H_1: \mu_1 \ne \mu_2\)</span>. The test statistic is given by</p>
<p><span class="math display">\[
t = \frac{\bar x_1 - \bar x_2}{s_p \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}
\]</span></p>
<p>where <span class="math inline">\(s_p\)</span> is the pooled sample standard deviation, given by</p>
<p><span class="math display">\[
s_p = \sqrt{\frac{(n_1 - 1)s_1^2 + (n_2 - 1)s_2^2}{n_1 + n_2 - 2}}
\]</span></p>
<p><img src="images/clipboard-3291557304.png" class="img-fluid"></p>
</section>
<section id="example-of-one-sample-variance-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-one-sample-variance-test">Example of one-sample Variance Test</h2>
<p><span class="math inline">\(\chi^2\)</span>-test for variance. Suppose <span class="math inline">\(X_1, \cdots, X_n\)</span> are i.i.d. normal random variables with mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. We want to test the null hypothesis <span class="math inline">\(H_0: \sigma^2 = \sigma_0^2\)</span> against the alternative hypothesis <span class="math inline">\(H_1: \sigma^2 \ne \sigma_0^2\)</span>. The test statistic is given by</p>
<p><span class="math display">\[
\chi^2 = \frac{(n - 1)s^2}{\sigma^2}
\]</span></p>
</section>
<section id="example-of-two-sample-variance-test" class="level2">
<h2 class="anchored" data-anchor-id="example-of-two-sample-variance-test">Example of two-sample Variance Test</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"><span class="math inline">\(H_0\)</span></th>
<th style="text-align: left;">Test Statistic</th>
<th style="text-align: left;"><span class="math inline">\(H_1\)</span></th>
<th style="text-align: left;">Rejection Region</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f=\frac{s_1^2}{s_2^2}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2&lt;\sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f&lt;f_\alpha\left(\nu_1, \nu_2\right)\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2&gt;\sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f&gt;f_{1-\alpha}\left(\nu_1, \nu_2\right)\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"><span class="math inline">\(\sigma_1^2 \neq \sigma_2^2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(f&lt;f_{\alpha / 2}\left(\nu_1, \nu_2\right)\)</span> or <span class="math inline">\(f&gt;f_{1-\alpha / 2}\left(\nu_1, \nu_2\right)\)</span></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\nu_1=n_1-1\)</span> and <span class="math inline">\(\nu_2=n_2-1\)</span> are two degree of freedom.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
F=\frac{\frac{\left(n_1-1\right) S_1^2}{\sigma_1^2} /\left(n_1-1\right)}{\frac{\left(n_2-1\right) S_2^2}{\sigma_2^2} /\left(n_2-1\right)}=\frac{\sigma_2^2 S_1^2}{\sigma_1^2 S_2^2}
\]</span></p>
<p>If <span class="math inline">\(\sigma_1^2=\sigma_2^2\)</span>, we have <span class="math display">\[
F=\frac{S_1^2}{S_2^2} \sim F_{n_1-1, n_2-1}
\]</span></p>
</section>
<section id="anova-analysis-of-variance" class="level2">
<h2 class="anchored" data-anchor-id="anova-analysis-of-variance">ANOVA– Analysis of Variance</h2>
<ul>
<li>one-way ANOVA</li>
</ul>
<p>we need to test the null hypothesis that the group population means are all the same against the alternative that at least one group population mean differs from the others. That is,</p>
<p><span class="math inline">\(H_0: \mu_1=\mu_2=\cdots=\mu_k\)</span> against <span class="math inline">\(H_1: \text { at least one } \mu_i \text { differs from the others.}\)</span></p>
<p>ANOVA Table</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Mean Sq</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">p value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Factor</td>
<td style="text-align: right;">m-1</td>
<td style="text-align: right;">11.84 (SS between)</td>
<td style="text-align: right;">2.9587 (MSB)</td>
<td style="text-align: right;">8.074 (MSB/MSW)</td>
<td style="text-align: right;"><span class="math inline">\(5.38 \mathrm{e}-05\)</span> (p-value)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Error</td>
<td style="text-align: right;">n-m</td>
<td style="text-align: right;">16.49 (SS Within)</td>
<td style="text-align: right;">0.3664 (MSW)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: right;">n-1</td>
<td style="text-align: right;">28.33 (SS Total)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
<p>Source means “the source of the variation in the data.” the possible sources for a one-factor study are Factor, Residuals, and Total.</p>
<p>Factor means “the variability due to the factor of interest.” In the drug example, the factor was the different drug. In the learning example on the previous page, the factor was the method of learning. Sometimes the row heading is labeled as Between.</p>
<p>Error (or Residuals) means “the variability within the groups” or “unexplained random error.” Sometimes the row heading is labeled as Within.</p>
<p>Total means “the total variation in the data from the grand mean”.</p>
<p>DF means “the degrees of freedom in the source.”</p>
<p>Sum Sq means “the sum of squares due to the source.”</p>
<p>Mean Sq means “the mean sum of squares due to the source.”</p>
<p>F value means “the F-statistic.”</p>
<p>P value means “the P-value.”</p>
<p>SS(Total)=SS(Between)+SS(Within), where</p>
<p>SS(Between) is the sum of squares between the group means and the grand mean. As the name suggests, it quantifies the variability between the groups of interest.</p>
<p>SS(Within) is the sum of squares between the data and the group means. It quantifies the variability within the groups of interest.</p>
<p>SS(Total) is the sum of squares between the n data points and the grand mean. As the name suggests, it quantifies the total variability in the observed data.</p>
<ul>
<li>two-way ANOVA</li>
</ul>
<p>We can extend the idea of a one-way ANOVA, which tests the effects of one factor on a response variable, to a two-way ANOVA which tests the effects of two factors and their interaction on a response variable.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Source</th>
<th style="text-align: left;">DF</th>
<th style="text-align: left;">Sum Sq</th>
<th style="text-align: left;">MSW</th>
<th style="text-align: left;">F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Cells</td>
<td style="text-align: left;"><span class="math inline">\(a b-1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{i=1}^a \sum_{j=1}^b n\left(\bar{X}_{i j}-\bar{X}_{\ldots . .}\right)^2\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">A</td>
<td style="text-align: left;">a-1</td>
<td style="text-align: left;">bn <span class="math inline">\(\sum_{i=1}^a\left(\bar{X}_{i . .}-\bar{X}_{\ldots .}\right)^2\)</span></td>
<td style="text-align: left;">SS(A)</td>
<td style="text-align: left;">MS(Error</td>
</tr>
<tr class="odd">
<td style="text-align: left;">B</td>
<td style="text-align: left;">b-1</td>
<td style="text-align: left;">an <span class="math inline">\(\sum_{j=1}^b\left(\bar{X}_{. j .}-\bar{X}_{\ldots .}\right)^2\)</span></td>
<td style="text-align: left;">SS(B)</td>
<td style="text-align: left;">MS(B)</td>
</tr>
<tr class="even">
<td style="text-align: left;"><span class="math inline">\(\mathrm{A} \times \mathrm{B}\)</span></td>
<td style="text-align: left;"><span class="math inline">\((a-1)(b-1)\)</span></td>
<td style="text-align: left;">SS(Cells)-SS(A)-SS(B)</td>
<td style="text-align: left;">SS(AB)</td>
<td style="text-align: left;">MS(Error</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">DF(A <span class="math inline">\(\times\)</span> B)</td>
<td style="text-align: left;">MS(Error</td>
</tr>
<tr class="even">
<td style="text-align: left;">Error</td>
<td style="text-align: left;"><span class="math inline">\(a b(n-1)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{i=1}^a \sum_{j=1}^b \sum_{l=1}^n\left(X_{i j l}-\bar{X}_{i j} .\right)^2\)</span></td>
<td style="text-align: left;">SS(Error)</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;"><span class="math inline">\(a b n-1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\sum_{i=1}^a \sum_{j=1}^b n\left(X_{i j l}-\bar{X}_{\ldots .}\right)^2\)</span></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<ul>
<li><p><span class="math inline">\(F=\frac{\mathrm{MS}(\mathrm{A})}{\mathrm{MS}(\text { Error })}\)</span>, for <span class="math inline">\(H_0\)</span> : no effect of factor A on response variable,</p></li>
<li><p><span class="math inline">\(F=\frac{\mathrm{MS}(\mathrm{B})}{\mathrm{MS}(\text { Error) }}\)</span>, for <span class="math inline">\(H_0\)</span> : no effect of factor B on response variable,</p></li>
<li><p><span class="math inline">\(F=\frac{\mathrm{MS}(\mathrm{A} \times \mathrm{B})}{\mathrm{MS}(\text { Error })}\)</span>, for <span class="math inline">\(H_0\)</span> : no effect of interaction on response variable.</p></li>
</ul>
<p>We reject any <span class="math inline">\(H_0\)</span> if <span class="math inline">\(F \geq F_{\text {critical }}\)</span>; otherwise, we do not reject <span class="math inline">\(H_0\)</span>.</p>
<section id="example-of-two-way-anova" class="level3">
<h3 class="anchored" data-anchor-id="example-of-two-way-anova">Example of two-way ANOVA</h3>
<p>Two-way ANOVA. In this question, we will use the built-in R data set ToothGrowth to perform two-way ANOVA test. ToothGrowth includes information from a study on the effects of vitamin C on tooth growth in Guinea pigs. The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC). Assuming the data satisfy the assumptions of normality and equal variance, please address the following using a significance level of 0.05</p>
<section id="a-1" class="level4">
<h4 class="anchored" data-anchor-id="a-1">a</h4>
<ul>
<li><p>The effects of vitamin C on tooth growth in guinea pigs:</p></li>
<li><p>null hypothesis: <span class="math inline">\(H_0\)</span>: mean tooth growth for all doses of vitamin C are equal</p></li>
<li><p>alternative hypothesis: <span class="math inline">\(H_1\)</span>: at least one of the means of all doses of vitamin C is different from the others</p></li>
<li><p>The effects of delivery method on tooth growth in guinea pigs:</p></li>
<li><p>null hypothesis: <span class="math inline">\(H_0\)</span>: mean tooth growth for the delivery method of orange juice and ascorbic acid are equal.</p></li>
<li><p>alternative hypothesis <span class="math inline">\(H_1\)</span>: mean tooth growth for the delivery method of orange juice and ascorbic acid are different.</p></li>
<li><p>The interaction effects of the dose of vitamin C and delivery method on tooth growth in guinea pigs:</p></li>
<li><p>null hypothesis: <span class="math inline">\(H_0:\)</span> there is no interaction between the dose of vitamin C and delivery method on tooth growth in guinea pigs, meaning that the relationship between vitamin C and tooth growth is the same for both delivery methods (similarly, the relationship between delivery method and tooth growth is the same for all doses of vitamin C).</p></li>
<li><p>alternative hypothesis: <span class="math inline">\(H_1\)</span>: there is an interaction between the dose vitamin C and delivery method on tooth growth in guinea pigs, meaning that the relationship between vitamin C and tooth growth is different for both delivery methods (similarly, the relationship between delivery method and tooth growth depends on the dose of vitamin C).</p></li>
</ul>
</section>
<section id="b-1" class="level4">
<h4 class="anchored" data-anchor-id="b-1">b</h4>
<p>We can plot the relationship one by one using two plots</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(ToothGrowth)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ToothGrowth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   len supp dose
1  4.2   VC  0.5
2 11.5   VC  0.5
3  7.3   VC  0.5
4  5.8   VC  0.5
5  6.4   VC  0.5
6 10.0   VC  0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># potential effects of vitamin C on tooth growth.</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(dose), <span class="at">y =</span> len)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dose (mg/day)"</span>, <span class="at">y =</span> <span class="st">"Tooth Growth (len)"</span>, <span class="at">title =</span> <span class="st">"Tooth Growth by Dose of vitamin C"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># potential effects of delivery method on tooth growth.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> supp, <span class="at">y =</span> len)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Delivery Method"</span>, <span class="at">y =</span> <span class="st">"Tooth Growth (len)"</span>, <span class="at">title =</span> <span class="st">"Tooth Growth by Delivery Method"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>or just one:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># potential effects of vitamin C and delivery method. </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># OJ represents orange juice and VC represents ascorbic acid.</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ToothGrowth, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(dose), <span class="at">y =</span> len, <span class="at">fill =</span> supp)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Dose (mg/day)"</span>, <span class="at">y =</span> <span class="st">"Tooth Growth (len)"</span>, <span class="at">title =</span> <span class="st">"Tooth Growth by Dose and Delivery Method"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="c-1" class="level4">
<h4 class="anchored" data-anchor-id="c-1">c</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform two-way ANOVA</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>anova_result <span class="ot">&lt;-</span> <span class="fu">aov</span>(len <span class="sc">~</span> supp <span class="sc">*</span> dose, <span class="at">data =</span> ToothGrowth)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(anova_result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
supp         1  205.4   205.4  12.317 0.000894 ***
dose         1 2224.3  2224.3 133.415  &lt; 2e-16 ***
supp:dose    1   88.9    88.9   5.333 0.024631 *  
Residuals   56  933.6    16.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Since all p-values are less than 0.05, we reject all null hypotheses. Therefore, there is sufficient evidence to conclude that the dose of vitamin C, delivery method, and their interaction have significant effects on tooth growth in guinea pigs.</p>
</section>
<section id="d-1" class="level4">
<h4 class="anchored" data-anchor-id="d-1">d</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(anova_result<span class="sc">$</span>residuals, <span class="at">main =</span> <span class="st">"QQ-plot of residuals"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22 50</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="non-parametric-tests" class="level2">
<h2 class="anchored" data-anchor-id="non-parametric-tests">Non-parametric tests</h2>
<section id="application-of-testing-the-goodness-of-fit" class="level3">
<h3 class="anchored" data-anchor-id="application-of-testing-the-goodness-of-fit">Application of testing the goodness of fit</h3>
<p>Testing whether there is a “good fit” between the observed data and the assumed probability model amounts to testing:</p>
<section id="construction-of-test-statistics-with-an-example-of-2-categories" class="level4">
<h4 class="anchored" data-anchor-id="construction-of-test-statistics-with-an-example-of-2-categories">Construction of test statistics with an example of 2 categories</h4>
<p>Population is 60% female and 40% male. Then, if a sample of 100 students yields 53 females and 47 males, can we conclude that the sample is (random and) representative of the population? That is, how “good” do the data “fit” the assumed probability model of 60% female and 40% male?</p>
<p>Here, let <span class="math inline">\(Y_1\)</span> denote the number of females selected, <span class="math inline">\(Y_1 \sim B(n,p_1)\)</span> and let <span class="math inline">\(Y_2\)</span> denote males selected, <span class="math inline">\(Y_2 = (n-Y_1)\sim B(n,p_2)=B(n,1-p_1)\)</span>.</p>
<p>for samples satisfying the general rule of thumb (the expected number of successes must be at least 5 and the expected number of failures must be at least 5), we can use the normal approximation to the binomial distribution. The test statistic is given by</p>
<p><span class="math display">\[
Z = \frac{Y_1 - np_1}{\sqrt{np_1(1-p_1)}}\sim N(0,1)
\]</span></p>
<p>which is at least approximately normally distributed.</p>
<p>and <span class="math display">\[
Z^2 =Q_1= \frac{(Y_1 - np_1)^2}{np_1(1-p_1)}\sim \chi^2(1)
\]</span></p>
<p>which is an approximate chi-square distribution with one degree of freedom.</p>
<p>Now we can multiply <span class="math inline">\(Q_1\)</span> by 1 = <span class="math inline">\((1-p_1)+p_1\)</span> to get</p>
<p><span class="math display">\[
Q_1 = \frac{(Y_1 - np_1)^2(1-p_1)}{np_1(1-p_1)} + \frac{(Y_1 - np_1)^2p_1}{np_1(1-p_1)}\sim \chi^2(1)
\]</span></p>
<p>Since <span class="math inline">\(Y_1=n-Y_2\)</span> and <span class="math inline">\(p_1=1-p_2\)</span>, after simplifying, we have</p>
<p><span class="math display">\[
Q_1 = \frac{(Y_1-np_1)^2}{np_1} + \frac{(-(Y_2-np_2))^2}{np_2}\sim \chi^2(1)
\]</span></p>
<p>which is <span class="math inline">\(Q_1=\sum_{i=1}^2 \frac{\left(Y_i-n p_i\right)^2}{n p_i}=\sum_{i=1}^2 \frac{(\text { Observed }- \text { Expected })^2}{\text { Expected }}\sim \chi^2(1)\)</span></p>
<p>Hence, it is observed that if the observed counts are very different from the expected counts, then the test statistic will be large. So we reject the null hypothesis if <span class="math inline">\(Q_1\)</span> is large and how large is large is determined by the critical value of the chi-square distribution with one degree of freedom.</p>
<p>The statistics <span class="math inline">\(Q_1\)</span> is called the chi-square goodness of fit statistic.</p>
<p>Going back to the example,</p>
<ul>
<li><p><span class="math inline">\(H_0\)</span>:<span class="math inline">\(p_F = 0.6\)</span></p></li>
<li><p><span class="math inline">\(H_1\)</span>:<span class="math inline">\(p_F \ne 0.6\)</span></p></li>
</ul>
<p>we can calculate the test statistic using a significant level of <span class="math inline">\(\alpha = 0.05\)</span> (<span class="math inline">\(\chi^2_{0.05,1}=3.84\)</span>)as follows:</p>
<p><span class="math display">\[
Q_1 = \frac{(53-60)^2}{60} + \frac{(47-40)^2}{40} = 2.04
\]</span></p>
<p>Since <span class="math inline">\(Q_1=2.04&lt;3.84\)</span>, we do not reject the null hypothesis. Therefore, we conclude that the sample is (random and) representative of the population.</p>
<p><strong>This can be extended to k categories</strong></p>
</section>
<section id="construction-of-test-statistics-with-an-example-of-k-categories" class="level4">
<h4 class="anchored" data-anchor-id="construction-of-test-statistics-with-an-example-of-k-categories">Construction of test statistics with an example of k categories</h4>
<p>For categories more than 2, i.e.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Categories</th>
<th style="text-align: left;">1</th>
<th style="text-align: left;">2</th>
<th style="text-align: left;"><span class="math inline">\(\cdots\)</span></th>
<th style="text-align: left;"><span class="math inline">\(k-1\)</span></th>
<th style="text-align: left;"><span class="math inline">\(k\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed</td>
<td style="text-align: left;"><span class="math inline">\(Y_1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Y_2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\cdots\)</span></td>
<td style="text-align: left;"><span class="math inline">\(Y_{k-1}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n-Y_1-Y_2-\cdots-Y_{k-1}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Expected</td>
<td style="text-align: left;"><span class="math inline">\(n p_1\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n p_2\)</span></td>
<td style="text-align: left;"><span class="math inline">\(\cdots\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n p_{k-1}\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n p_k\)</span></td>
</tr>
</tbody>
</table>
<p>Karl Pearson showed that the chi-square statistic <span class="math inline">\(Q_{k-1}\)</span> defined as: <span class="math display">\[
Q_{k-1}=\sum_{i=1}^k \frac{\left(Y_i-n p_i\right)^2}{n p_i}
\]</span> follows approximately a chi-square random variable with <span class="math inline">\(k-1\)</span> degrees of freedom. Let’s try it out on an example.</p>
<ul>
<li>Example:</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 10%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Categories</th>
<th style="text-align: left;">Brown</th>
<th style="text-align: left;">Yellow</th>
<th style="text-align: left;">Orange</th>
<th style="text-align: left;">Green</th>
<th style="text-align: left;">Coffee</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Observed <span class="math inline">\(y_i\)</span></td>
<td style="text-align: left;">224</td>
<td style="text-align: left;">119</td>
<td style="text-align: left;">130</td>
<td style="text-align: left;">48</td>
<td style="text-align: left;">59</td>
<td style="text-align: left;">580</td>
</tr>
<tr class="even">
<td style="text-align: left;">Assumed <span class="math inline">\(H_0\left(p_i\right)\)</span></td>
<td style="text-align: left;">0.4</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.2</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">0.1</td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Expected <span class="math inline">\(n p_i\)</span></td>
<td style="text-align: left;">232</td>
<td style="text-align: left;">116</td>
<td style="text-align: left;">116</td>
<td style="text-align: left;">58</td>
<td style="text-align: left;">58</td>
<td style="text-align: left;">580</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(Q_4=\frac{(224-232)^2}{232}+\frac{(119-116)^2}{116}+\frac{(130-116)^2}{116}+\frac{(48-58)^2}{58}+\frac{(59-58)^2}{58}=3.784\)</span></p>
<p>Because there are <span class="math inline">\(k=5\)</span> categories, we have to compare our chisquare statistic <span class="math inline">\(Q_4\)</span> to a chi-square distribution with <span class="math inline">\(k-1=5-1=4\)</span> degrees of freedom: <span class="math display">\[
Q_4=3.784&lt;\chi_{4,0.05}^2=9.488
\]</span> we fail to reject the null hypothesis.</p>
</section>
</section>
<section id="application-of-testing-for-homogeneity" class="level3">
<h3 class="anchored" data-anchor-id="application-of-testing-for-homogeneity">Application of testing for homogeneity</h3>
<p>This is to look at a method for testing whether two or more multinomial distributions are equal.</p>
<ul>
<li>Example:</li>
</ul>
<p>Test the hypothesis that the acceptances of males and females are ditributed equally among the four schools,</p>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">(Acceptances)</th>
<th style="text-align: left;">Bus</th>
<th style="text-align: left;">Eng</th>
<th style="text-align: left;">L Arts</th>
<th style="text-align: left;">Sci</th>
<th style="text-align: left;">(FIXED) Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Male</td>
<td style="text-align: left;">240 (20%)</td>
<td style="text-align: left;">480 (40%)</td>
<td style="text-align: left;">120 (10%)</td>
<td style="text-align: left;">360 (30%)</td>
<td style="text-align: left;">1200</td>
</tr>
<tr class="even">
<td style="text-align: left;">Female</td>
<td style="text-align: left;">240 (30%)</td>
<td style="text-align: left;">80 (10%)</td>
<td style="text-align: left;">320 (40%)</td>
<td style="text-align: left;">160 (20%)</td>
<td style="text-align: left;">800</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">480 (24%)</td>
<td style="text-align: left;">560 (28%)</td>
<td style="text-align: left;">440 (22%)</td>
<td style="text-align: left;">520 (26%)</td>
<td style="text-align: left;">2000</td>
</tr>
</tbody>
</table>
<p>Here,</p>
<p><span class="math inline">\(H_0: p_{M B}=p_{F B}, p_{M E}=p_{F E}, p_{M L}=p_{F L}\)</span>, and <span class="math inline">\(p_{M S}=p_{F S}\)</span></p>
<p><span class="math inline">\(H_1: p_{M B} \neq p_{F B}\)</span> or <span class="math inline">\(p_{M E} \neq p_{F E}\)</span> or <span class="math inline">\(p_{M L} \neq p_{F L}\)</span>, or <span class="math inline">\(p_{M S} \neq p_{F S}\)</span></p>
<p>where:</p>
<ul>
<li><p><span class="math inline">\(p_{M j}\)</span> is the proportion of males accepted into school <span class="math inline">\(j=B, E, L, S\)</span>.</p></li>
<li><p><span class="math inline">\(p_{F j}\)</span> is the proportion of females accepted into school <span class="math inline">\(j=B, E, L, S\)</span>.</p></li>
</ul>
<p>In conducting such a hypothesis test, we’re comparing the proportions of two multinomial distributions.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">#(Acc)</th>
<th style="text-align: left;">Bus ( <span class="math inline">\(j=1\)</span> )</th>
<th style="text-align: left;">Eng ( <span class="math inline">\(j=2\)</span> )</th>
<th style="text-align: left;">L Arts ( <span class="math inline">\(j=3\)</span> )</th>
<th style="text-align: left;">Sci <span class="math inline">\((j=4)\)</span></th>
<th style="text-align: left;">(FIXED) Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><span class="math inline">\(\mathrm{M}(i=1)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{11}\left(\hat{p}_{11}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{12}\left(\hat{p}_{12}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{13}\left(\hat{p}_{13}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{14}\left(\hat{p}_{14}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_1=\sum_{j=1}^k y_{1 j}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">F <span class="math inline">\((i=2)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{21}\left(\hat{p}_{21}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{22}\left(\hat{p}_{22}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{23}\left(\hat{p}_{23}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{24}\left(\hat{p}_{24}\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_2=\sum_{j=1}^k y_{2 j}\)</span></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;"><span class="math inline">\(y_{11}+y_{21}\left(\hat{p}_1\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{12}+y_{22}\left(\hat{p}_2\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{13}+y_{23}\left(\hat{p}_3\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(y_{14}+y_{24}\left(\hat{p}_4\right)\)</span></td>
<td style="text-align: left;"><span class="math inline">\(n_1+n_2\)</span></td>
</tr>
</tbody>
</table>
<p>The chi-square test statistic for testing the equality of two multinomial distributions: <span class="math display">\[
Q=\sum_{i=1}^2 \sum_{j=1}^k \frac{\left(y_{i j}-n_i \hat{p}_j\right)^2}{n_i \hat{p}_j}
\]</span> follows an approximate chi-square distribution with <span class="math inline">\(k-1\)</span> degrees of freedom. Reject the null hypothesis of equal proportions if <span class="math inline">\(Q\)</span> is large (since if male and female distributed nearly equally, the expected number of each should be <span class="math inline">\(n_i\hat p_j\)</span>): <span class="math display">\[
Q \geq \chi_{\alpha, k-1}^2
\]</span></p>
<p>(omit the derive of the above Q)</p>
<p>Generally,</p>
<p><span class="math display">\[
Q=\sum_{i=1}^h \sum_{j=1}^k \frac{\left(y_{i j}-n_i \hat{p}_j\right)^2}{n_i \hat{p}_j}\sim \chi^2_{(h-1)(k-1)}
\]</span></p>
<section id="further-example" class="level4">
<h4 class="anchored" data-anchor-id="further-example">Further example</h4>
<p>The head of a surgery department at a university medical center was concerned that surgical residents in training applied unnecessary blood transfusions at a different rate than the more experienced attending physicians. Therefore, he ordered a study of the 49 Attending Physicians and 71 Residents in Training with privileges at the hospital. For each of the 120 surgeons, the number of blood transfusions prescribed unnecessarily in a one-year period was recorded. Based on the number recorded, a surgeon was identified as either prescribing unnecessary blood transfusions Frequently, Occasionally, Rarely, or Never. Here’s a summary table (or “contingency table”) of the resulting data:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Physician</th>
<th style="text-align: left;">Frequent</th>
<th style="text-align: left;">Occasionally</th>
<th style="text-align: left;">Rarely</th>
<th style="text-align: left;">Never</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attending</td>
<td style="text-align: left;">6.942</td>
<td style="text-align: left;">12.658</td>
<td style="text-align: left;">22.05</td>
<td style="text-align: left;">7.35</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Resident</td>
<td style="text-align: left;">10.058</td>
<td style="text-align: left;">18.342</td>
<td style="text-align: left;">31.95</td>
<td style="text-align: left;">10.65</td>
<td style="text-align: left;">71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">31</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">120</td>
</tr>
</tbody>
</table>
<p>Here,</p>
<p><span class="math inline">\(H_0: p_{R F}=p_{A F}, p_{R O}=p_{A O}, p_{R R}=p_{A R}\)</span>, and <span class="math inline">\(p_{R N}=p_{A N}\)</span></p>
<p><span class="math inline">\(H_1: p_{R F} \neq p_{A F}\)</span> or <span class="math inline">\(p_{R O} \neq p_{A O}\)</span> or <span class="math inline">\(p_{R R} \neq p_{A R}\)</span>, or <span class="math inline">\(p_{R N} \neq p_{A N}\)</span></p>
<p>We should also calculate the expected counts under the null hypothesis. The expected counts are calculated as follows:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Physician</th>
<th style="text-align: left;">Frequent</th>
<th style="text-align: left;">Occasionally</th>
<th style="text-align: left;">Rarely</th>
<th style="text-align: left;">Never</th>
<th style="text-align: left;">Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Attending</td>
<td style="text-align: left;">6.942</td>
<td style="text-align: left;">12.658</td>
<td style="text-align: left;">22.05</td>
<td style="text-align: left;">7.35</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">Resident</td>
<td style="text-align: left;">10.058</td>
<td style="text-align: left;">18.342</td>
<td style="text-align: left;">31.95</td>
<td style="text-align: left;">10.65</td>
<td style="text-align: left;">71</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Total</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">31</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">18</td>
<td style="text-align: left;">120</td>
</tr>
</tbody>
</table>
<p>where, for example, <span class="math inline">\(6.942=\frac{17}{120} \times 49\)</span> and <span class="math inline">\(10.058=\frac{17}{120} \times 71\)</span>. Now that we have the observed and expected counts, calculating the chisquare statistic is a straightforward exercise: <span class="math display">\[
Q=\frac{(2-6.942)^2}{6.942}+\cdots+\frac{(5-10.65)^2}{10.65}=31.88
\]</span></p>
<p>The chi-square test tells us to reject the null hypothesis, at the 0.05 level, if <span class="math inline">\(Q\)</span> is greater than a chi-square random variable with 3 degrees of freedom, that is, if <span class="math inline">\(Q=31.88&gt;7.815\)</span>, we reject the null hypothesis.</p>
</section>
</section>
<section id="application-of-testing-for-independence" class="level3">
<h3 class="anchored" data-anchor-id="application-of-testing-for-independence">Application of testing for independence</h3>
<p>This is to look at whether two or more categorical variables are independent.</p>
<p>(previously,the the sampling scheme involves: Taking two random (and therefore independent) samples with n1 and n2 fixed in advance and observing into which of the k categories the first random samples fall, and observing into which of the k categories the second random samples fall. )</p>
<p>lets consider a different example to illustrate an alternative sampling scheme. Suppose 395 people are randomly selected, and are “cross-classified” into one of eight cells, depending into which age category they fall and whether or not they support legalizing marijuana:</p>
<p>(the sampling scheme involves: Taking one random sample of size n, with n fixed in advance, and then “cross-classifying” each subject into one and only one of the mutually exclusive and exhaustive <span class="math inline">\(A_i\cap B_j\)</span> cells.)</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Marijuana Support</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable B (Age)</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Variable A</td>
<td style="text-align: left;">OBSERVED</td>
<td style="text-align: left;"><span class="math inline">\((18-24) B_1\)</span></td>
<td style="text-align: left;">(25-34) <span class="math inline">\(B_1 2\)</span></td>
<td style="text-align: left;">(35-49) <span class="math inline">\(B_3\)</span></td>
<td style="text-align: left;"><span class="math inline">\((50-64) B_4\)</span></td>
<td style="text-align: left;">Total</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">(YES) <span class="math inline">\(A_1\)</span></td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">54</td>
<td style="text-align: left;">46</td>
<td style="text-align: left;">41</td>
<td style="text-align: left;">201</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">(NO) <span class="math inline">\(A_2\)</span></td>
<td style="text-align: left;">40</td>
<td style="text-align: left;">44</td>
<td style="text-align: left;">53</td>
<td style="text-align: left;">57</td>
<td style="text-align: left;">194</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Total</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">99</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;"><span class="math inline">\(n=395\)</span></td>
</tr>
</tbody>
</table>
<p>Here,</p>
<p>H0 : Variable A is independent of variable B, that is <span class="math inline">\(P(A_i\cap B_j)=PA_i \times B_j\)</span> for all i and j</p>
<p>H1: Variable A is not independent of variable B.</p>
<p>Generally,</p>
<p>Suppose we have <span class="math inline">\(k\)</span> (column) levels of Variable B indexed by the letter <span class="math inline">\(j\)</span>, and <span class="math inline">\(h\)</span> (row) levels of Variable <span class="math inline">\(A\)</span> indexed by the letter <span class="math inline">\(i\)</span>. Then, we can summarize the data and probability model in tabular format, as follows:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Variable B</th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
<th style="text-align: center;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Variable A</td>
<td style="text-align: center;"><span class="math inline">\(B_1(j=1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B_2(j=2)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B_3(j=3)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(B_4(j=4)\)</span></td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;"><span class="math inline">\(A_1(i=1)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{11}\left(p_{11}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{12}\left(p_{12}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{13}\left(p_{13}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{14}\left(p_{14}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{1 .}\right)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;"><span class="math inline">\(A_2(i=2)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{21}\left(p_{21}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{22}\left(p_{22}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{23}\left(p_{23}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(Y_{24}\left(p_{24}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{2 .}\right)\)</span></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">Total</td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.1}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.2}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.3}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(\left(p_{.4}\right)\)</span></td>
<td style="text-align: center;"><span class="math inline">\(n\)</span></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(p_{i j}=Y_{i j} / n, p_i .=\sum_{j=1}^k p_{i j}\)</span>, and <span class="math inline">\(p_{. j}=\sum_{i=1}^h p_{i j}\)</span></p>
<p><span class="math inline">\(Q=\sum_{j=1}^k \sum_{i=1}^h \frac{\left(y_{i j}-\frac{y_i \cdot y_{\cdot j}}{n}\right)^2}{\frac{y_i \cdot y_{\cdot j}}{n}}\sim \chi^2_{(h-1)(k-1)}\)</span></p>
<section id="are-chi-square-statistic-for-homogeneity-and-the-chi-square-statistic-for-independence-equivalent" class="level4">
<h4 class="anchored" data-anchor-id="are-chi-square-statistic-for-homogeneity-and-the-chi-square-statistic-for-independence-equivalent">Are chi-square statistic for homogeneity and the chi-square statistic for independence equivalent?</h4>
<p>Although their chi-square statistics are equivalent, the two tests are not equivalent since their sampling experiment designs are different.</p>
<p>Here’s the table of expected counts:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Bicycle Riding Interest</th>
<th style="text-align: left;"></th>
<th style="text-align: left;">Variable B (Age)</th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Variable A</td>
<td style="text-align: left;">EXPECTED</td>
<td style="text-align: left;">18-24</td>
<td style="text-align: left;">25-34</td>
<td style="text-align: left;">35-49</td>
<td style="text-align: left;">50-64</td>
<td style="text-align: left;">Total</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">50.886</td>
<td style="text-align: left;">49.868</td>
<td style="text-align: left;">50.377</td>
<td style="text-align: left;">49.868</td>
<td style="text-align: left;">201</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">49.114</td>
<td style="text-align: left;">48.132</td>
<td style="text-align: left;">48.623</td>
<td style="text-align: left;">48.132</td>
<td style="text-align: left;">194</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Total</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">99</td>
<td style="text-align: left;">98</td>
<td style="text-align: left;">395</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[
Q=\frac{(60-50.886)^2}{50.886}+\cdots+\frac{(57-48.132)^2}{48.132}=8.006
\]</span></p>
<p>The chi-square test tells us to reject the null hypothesis, at the 0.05 level, since <span class="math inline">\(Q\)</span> is greater than a chi-square random variable with 3 degrees of freedom, that is, <span class="math inline">\(Q=8.006&gt;7.815\)</span>.</p>
</section>
<section id="summary" class="level4">
<h4 class="anchored" data-anchor-id="summary">Summary</h4>
<p>Parametric tests make assumptions that aspects of the data follow some sort of theoretical probability distribution. Non-parametric tests or distribution free methods do not, and are used when the distributional assumptions for a parametric test are not met. While this is an advantage, it often comes at a cost of power (in the sense they are less likely to be able to detect a difference when a true difference exists).</p>
<p>Most non-parametric tests are just hypothesis tests; there is no estimation of a confidence interval.</p>
<p>Most non-parametric methods are based on ranking the values of a variable in ascending order and then calculating a test statistic based on the sums of these ranks.</p>
<p>Non-parametric tests include:</p>
<ul>
<li><p>Two-sample independent t-test - Wilcoxon rank-sum test or Mann-Whitney U test</p></li>
<li><p>Paired t-test - Wilcoxon signed-rank test</p></li>
<li><p>One-way ANOVA - Kruskal-Wallace Test</p></li>
<li><p>Normality tests - Shapiro-Wilk test and Kolmogorov-Smirnov test</p></li>
</ul>
</section>
</section>
</section>
</section>
<section id="linear-regression" class="level1">
<h1>Linear Regression</h1>
<section id="simple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="simple-linear-regression">Simple linear regression</h2>
<section id="brief-introduction" class="level3">
<h3 class="anchored" data-anchor-id="brief-introduction">Brief introduction</h3>
<p>Some people think simple methods is bad and like complicated methods , but actually simple is very good–SLR works very well in lots of situations.</p>
<p>SLR is used to answer:</p>
<p>is there a relationship between..</p>
<p>How strong the relationship is</p>
<p>which variable contribute to this relationship</p>
<p>How accurate could we predict the response variable</p>
<p>Is the relationship linear?</p>
<p>Is there a synergy among independent variables?</p>
<p>This is a model with two random variables, X and Y, where we are trying to predict Y from X. Here are the model’s assumptions:</p>
<ul>
<li><p>The distribution of X is arbitrary, possibly is even non-random;</p></li>
<li><p>If X=x, then <span class="math inline">\(Y = \beta_0+\beta_1x+\epsilon\)</span> for some constants <span class="math inline">\(\beta_0, \beta_1\)</span> and some random noise variable <span class="math inline">\(\epsilon\)</span></p></li>
<li><p><span class="math inline">\(\epsilon\)</span> has mean 0, a constant variance <span class="math inline">\(\sigma^2\)</span>, and is uncorrelated with X and uncorrelated across observations Cov<span class="math inline">\((\epsilon_i, \epsilon_j)=0\)</span> for <span class="math inline">\(i \ne j\)</span></p></li>
</ul>
<p>Using Least Squares, we can estimate <span class="math inline">\(\hat \beta_0\)</span> and <span class="math inline">\(\hat \beta_1\)</span>, which are unbiased estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
<ul>
<li>Gaussian-Noise Simple Linear Regression Model</li>
</ul>
<p>Now we further assume that the distribution of <span class="math inline">\(\epsilon\)</span> is normal, i.e.&nbsp;<span class="math inline">\(\epsilon \sim N(0, \sigma^2)\)</span>, independent of X.</p>
<p>They tell us, exactly, the probability distribution for Y given X, and so will let us get exact distributions for predictions and for other inferential statistics.</p>
</section>
<section id="maximum-likelihood-estimation-mle" class="level3">
<h3 class="anchored" data-anchor-id="maximum-likelihood-estimation-mle">Maximum Likelihood Estimation (MLE)</h3>
<section id="introduction-to-mle" class="level4">
<h4 class="anchored" data-anchor-id="introduction-to-mle">Introduction to MLE</h4>
<p>Likelihood is a fundamental concept in statistics that measures how well a particular set of parameters (e.g., the mean of a distribution) explains observed data. Think of it as a “score” that tells you which parameter values make your data most plausible.</p>
<p>Compared to probability, which answers: “What’s the chance of seeing this data if we assume specific parameters?” , likelihood answers: “Given this data, how plausible are these parameters?”</p>
<p>If the parameters are <span class="math inline">\(b_0, b_1, s^2\)</span> (reserving the Greek letters for their true values), then <span class="math inline">\(Y \mid X=x \sim N\left(b_0+b_1 x, s^2\right)\)</span>, and <span class="math inline">\(Y_i\)</span> and <span class="math inline">\(Y_j\)</span> are independent given <span class="math inline">\(X_i\)</span> and <span class="math inline">\(X_j\)</span>, so the overall likelihood is <span class="math display">\[
\prod_{i=1}^n \frac{1}{\sqrt{2 \pi s^2}} e^{-\frac{\left(y_i-\left(b_0+b_i x_i\right)\right)^2}{2 s^2}}
\]</span></p>
<p>As usual, we work with the log-likelihood, which gives us the same information but replaces products with sums: <span class="math display">\[
L\left(b_0, b_1, s^2\right)=-\frac{n}{2} \ln \left(2 \pi s^2\right)-\frac{1}{2 s^2} \sum_{i=1}^n\left(y_i-\left(b_0+b_1 x_i\right)\right)^2
\]</span></p>
<p>maximize it:</p>
<p><span class="math inline">\(\begin{aligned} \frac{\partial L}{\partial b_0} &amp; =-\frac{1}{2 s^2} \sum_{i=1}^n 2\left(y_i-\left(b_0+b_1 x_i\right)\right)(-1) \\ \frac{\partial L}{\partial b_1} &amp; =-\frac{1}{2 s^2} \sum_{i=1}^n 2\left(y_i-\left(b_0+b_1 x_i\right)\right)\left(-x_i\right)\end{aligned}\)</span></p>
</section>
<section id="same-result-of-mle-as-least-squares-in-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="same-result-of-mle-as-least-squares-in-linear-regression">Same result of MLE as least squares in linear regression</h4>
<p>Notice that when we set these derivatives to zero, all the multiplicative constants - in particular, the prefactor of <span class="math inline">\(1 / 2 s^2\)</span> - go away. We are left with <span class="math display">\[
\begin{aligned}
\sum_{i=1}^n\left(y_i-\left(\hat{\beta_0}+\hat{\beta_1} x_i\right)\right) &amp; =0 \\
\sum_{i=1}^n\left(y_i-\left(\hat{\beta_0}+\hat{\beta_0} x_i\right)\right) x_i &amp; =0
\end{aligned}
\]</span></p>
<p>These are, up to a factor of <span class="math inline">\(1 / n\)</span>, exactly the equations we got from the method of least squares. That means that the least squares solution is the maximum likelihood estimate under the Gaussian noise model.</p>
<p>Maximum likelihood estimates of the regression curve coincide with least-squares estimates when the noise around the curve is additive, Gaussian, of constant variance, and both independent of <span class="math inline">\(X\)</span> and of other noise terms. If any of those assumptions fail, maximum likelihood and least squares estimates can diverge.</p>
</section>
</section>
<section id="hypothesis-testing-for-estimates-with-unknown-sigma2" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis-testing-for-estimates-with-unknown-sigma2">Hypothesis testing for estimates with unknown <span class="math inline">\(\sigma^2\)</span></h3>
<section id="residual-sum-of-squares-rss-and-t-statistics-construction-in-linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="residual-sum-of-squares-rss-and-t-statistics-construction-in-linear-regression">Residual sum of squares (RSS) and t-statistics construction in linear regression</h4>
<p>It can be shown that (the proof is beyond the scope of this course) <span class="math display">\[
\frac{R S S}{\sigma^2}=\frac{(n-2) \hat{\sigma}^2}{\sigma^2} \sim \chi_{n-2}^2
\]</span></p>
<p>This allows us to construct a <span class="math inline">\(t\)</span>-value <span class="math display">\[
t=\frac{\hat{\beta}-\beta}{s_{\hat{\beta}}} \sim t_{n-2}
\]</span></p>
<p>Under the normality assumption of the error terms, the estimator of the slope coefficient will itself be normally distributed with mean <span class="math inline">\(\beta_i\)</span> and variance <span class="math inline">\(\operatorname{Var}\left[\beta_i\right]\)</span> For <span class="math inline">\(\hat{\beta_1}\)</span>, its mean is <span class="math inline">\(\beta_1\)</span> and its variance is <span class="math inline">\(\sigma^2 / \sum\left(x_i-\bar{x}\right)^2\)</span>. When <span class="math inline">\(\sigma^2\)</span> is known, we know <span class="math display">\[
\frac{\hat{\beta}_1-\beta_1}{\frac{\sigma}{\sqrt{\sum_{i=1}^n\left(x_i-\bar{x}\right)^2}}}
\]</span> follows standard normal distribution. However, in practice, <span class="math inline">\(\sigma^2\)</span> is often unknown. We then divide this standard normal distributed term by <span class="math display">\[
\sqrt{\frac{(n-2) \hat{\sigma}^2}{(n-2) \sigma^2}}=\frac{\hat{\sigma}}{\sigma}
\]</span></p>
<p>Therefore, when we write <span class="math display">\[
s_{\hat{\beta_1}}=\frac{\hat{\sigma}}{\sqrt{\sum_{i=1}^n\left(x_i-\bar{x}\right)^2}}
\]</span> we construct a <span class="math inline">\(t\)</span>-statistic for <span class="math inline">\(\hat{\beta_1}\)</span> with degrees of freedom <span class="math inline">\(n-2\)</span>. This then allows us to construct a <span class="math inline">\(100(1-\alpha) \%\)</span> confidence interval for <span class="math inline">\(\beta_1\)</span> : <span class="math display">\[
\hat{\beta_1} \pm t_{n-2, \alpha / 2} \times \boldsymbol{s}_{\hat{\beta_1}}
\]</span></p>
<p>We can also do similar calculation to get the <span class="math inline">\(t\)</span>-statistic and confidence interval for <span class="math inline">\(\beta_0\)</span>.</p>
</section>
<section id="hyphothesis-testing" class="level4">
<h4 class="anchored" data-anchor-id="hyphothesis-testing">Hyphothesis Testing</h4>
<p><span class="math display">\[
t =\hat {\beta}-\beta / s_{\hat{\beta_1}} \sim t_{n-2}
\]</span> <span class="math inline">\(H_0: \beta_i =0\)</span></p>
<p><span class="math inline">\(H_1: \beta_i \ne 0\)</span></p>
</section>
<section id="codes-of-linear-regression-with-ci" class="level4">
<h4 class="anchored" data-anchor-id="codes-of-linear-regression-with-ci">Codes of linear regression with CI</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>lmodel <span class="ot">&lt;-</span> <span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Petal.Width, <span class="at">data=</span>iris)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Petal.Length ~ Petal.Width, data = iris)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.33542 -0.30347 -0.02955  0.25776  1.39453 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.08356    0.07297   14.85   &lt;2e-16 ***
Petal.Width  2.22994    0.05140   43.39   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4782 on 148 degrees of freedom
Multiple R-squared:  0.9271,    Adjusted R-squared:  0.9266 
F-statistic:  1882 on 1 and 148 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(lmodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                2.5 %   97.5 %
(Intercept) 0.9393664 1.227750
Petal.Width 2.1283752 2.331506</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>conf_interval <span class="ot">&lt;-</span> <span class="fu">predict</span>(lmodel, <span class="at">data=</span>iris, <span class="at">interval=</span><span class="st">'confidence'</span>, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(iris<span class="sc">$</span>Petal.Width, iris<span class="sc">$</span>Petal.Length,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">'Petal.Width'</span>, <span class="at">ylab=</span><span class="st">'Petal.Length'</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">'Simple Linear Regression'</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(lmodel, <span class="at">col=</span><span class="st">'lightblue'</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="fu">matlines</span>(iris<span class="sc">$</span>Petal.Width, conf_interval[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">col=</span><span class="st">'blue'</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using ggplot2</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Petal.Width, <span class="at">y=</span>Petal.Length)) <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>stats<span class="sc">::</span>lm, <span class="at">se=</span>T, <span class="at">level=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="linear-regression-and-anova" class="level4">
<h4 class="anchored" data-anchor-id="linear-regression-and-anova">Linear Regression and ANOVA</h4>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fev_dat <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">'fev_dat.txt'</span>, <span class="at">header=</span>T)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fev_dat_subset <span class="ot">&lt;-</span> fev_dat[fev_dat<span class="sc">$</span>age <span class="sc">&gt;=</span> <span class="dv">6</span> <span class="sc">&amp;</span> fev_dat<span class="sc">$</span>age <span class="sc">&lt;=</span> <span class="dv">10</span>,]</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(fev_dat_subset, <span class="fu">aes</span>(<span class="at">x=</span>age, <span class="at">y=</span>FEV)) <span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>stats<span class="sc">::</span>lm, <span class="at">se=</span>T, <span class="at">level=</span><span class="fl">0.95</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">aov</span>(FEV <span class="sc">~</span> age, <span class="at">data=</span>fev_dat_subset))</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(FEV <span class="sc">~</span> age, <span class="at">data=</span>fev_dat_subset))</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(FEV <span class="sc">~</span> age, <span class="at">data=</span>fev_dat_subset))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="r2the-fraction-of-variability-explained-by-the-regression" class="level3">
<h3 class="anchored" data-anchor-id="r2the-fraction-of-variability-explained-by-the-regression"><span class="math inline">\(R^2\)</span>–the fraction of variability explained by the regression</h3>
<p><span class="math display">\[
R^2 =1-\frac{SSR}{SSTO}
\]</span></p>
</section>
</section>
<section id="multiple-linear-regression-mlr" class="level2">
<h2 class="anchored" data-anchor-id="multiple-linear-regression-mlr">Multiple linear regression (MLR)</h2>
<p><span class="math inline">\(y=X\beta+\epsilon\)</span>, where y is a n × 1 row vector, X is a n × (k + 1) matrix, and β is a (k + 1) × 1 column vector for all n observations.</p>
<section id="a-potential-problem-in-practice-multicollinearity" class="level3">
<h3 class="anchored" data-anchor-id="a-potential-problem-in-practice-multicollinearity">A potential problem in practice –multicollinearity</h3>
<p>When multicollinearity exists, any of the following pitfalls can be exacerbated:</p>
<ul>
<li><p>The estimated regression coefficient of any one variable depends on which other predictors are included in the model</p></li>
<li><p>The precision of the estimated regression coefficients decreases as more predictors are added to the model</p></li>
<li><p>The marginal contribution of any one predictor variable in reducing the error sum of squares depends on which other predictors are already in the model</p></li>
<li><p>Typothesis tests for βj = 0 may yield different conclusions depending on which predictors are in the model</p></li>
</ul>
<section id="perfect-multicollinearity" class="level4">
<h4 class="anchored" data-anchor-id="perfect-multicollinearity">Perfect multicollinearity</h4>
<p>Perfect multicollinearity refers to a situation where the predictive variables have an exact linear relationship. When there is perfect collinearity, the design matrix X has less than full rank, and therefore the moment matrix X′X cannot be inverted. In this situation, the parameter estimates of the regression are not well-defined, as the system of equations has infinitely many solutions.</p>
</section>
<section id="imperfect-multicollinearity" class="level4">
<h4 class="anchored" data-anchor-id="imperfect-multicollinearity">Imperfect multicollinearity</h4>
<p>Imperfect multicollinearity refers to a situation where the predictive variables have a nearly exact linear relationship.</p>
<p><span class="math inline">\(R^2=r^2\)</span> where r is the Pearson correlation coefficient.</p>
</section>
</section>
<section id="adjusted-r-squared" class="level3">
<h3 class="anchored" data-anchor-id="adjusted-r-squared">Adjusted R-squared</h3>
<p>Adjusted R-squared is a modified version of R-squared that adjusts for the number of predictors in a model. It provides a more accurate measure of the model’s explanatory power, penalizing for the addition of irrelevant predictors. This helps in comparing models with different numbers of predictors.</p>
</section>
</section>
</section>
<section id="logistic-regression" class="level1">
<h1>Logistic Regression</h1>
<p>This is a regression of categorical outcome.</p>
<p>In regression analysis with a categorical outcome, such as predicting a binary variable (yes or no), simple linear regression is not ideal. This is because:</p>
<ul>
<li><p>The predicted values may fall outside the range of 0 to 1, which is not meaningful for probabilities.</p></li>
<li><p>Small changes in the predictors can lead to relatively small fluctuations in the predicted probabilities near the 0.5 mark (natural threshold), which is actually where decision-making is most critical.</p></li>
</ul>
<p>So we need S-curve to satisfy above things.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="dv">1</span> <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">exp</span>(<span class="sc">-</span>x)), <span class="at">from =</span> <span class="sc">-</span><span class="dv">6</span>, <span class="at">to =</span> <span class="dv">6</span>, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"f(x)"</span>,</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Logistic Function: f(x) = 1 / (1 + exp(-x))"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>An example of a not well-predicted logistic model (since stock is not easy to predict)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(Smarket)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>glm.fits <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    Direction <span class="sc">~</span> Lag1 <span class="sc">+</span> Lag2 <span class="sc">+</span> Lag3 <span class="sc">+</span> Lag4 <span class="sc">+</span> Lag5 <span class="sc">+</span> Volume,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> Smarket, <span class="at">family =</span> binomial</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm.fits)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = Direction ~ Lag1 + Lag2 + Lag3 + Lag4 + Lag5 + 
    Volume, family = binomial, data = Smarket)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -0.126000   0.240736  -0.523    0.601
Lag1        -0.073074   0.050167  -1.457    0.145
Lag2        -0.042301   0.050086  -0.845    0.398
Lag3         0.011085   0.049939   0.222    0.824
Lag4         0.009359   0.049974   0.187    0.851
Lag5         0.010313   0.049511   0.208    0.835
Volume       0.135441   0.158360   0.855    0.392

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1731.2  on 1249  degrees of freedom
Residual deviance: 1727.6  on 1243  degrees of freedom
AIC: 1741.6

Number of Fisher Scoring iterations: 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>glm.probs <span class="ot">&lt;-</span> <span class="fu">predict</span>(glm.fits, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>glm.probs[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6         7         8 
0.5070841 0.4814679 0.4811388 0.5152224 0.5107812 0.5069565 0.4926509 0.5092292 
        9        10 
0.5176135 0.4888378 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>glm.pred <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="st">"Down"</span>, <span class="dv">1250</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>glm.pred[glm.probs <span class="sc">&gt;</span> .<span class="dv">5</span>] <span class="ot">=</span> <span class="st">"Up"</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(glm.pred, Direction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Direction
glm.pred Down  Up
    Down  145 141
    Up    457 507</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">507</span> <span class="sc">+</span> <span class="dv">145</span>) <span class="sc">/</span> <span class="dv">1250</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5216</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(glm.pred <span class="sc">==</span> Direction)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5216</code></pre>
</div>
</div>
<section id="odds" class="level2">
<h2 class="anchored" data-anchor-id="odds">Odds</h2>
<p>Odds are another way of quantifying the probability of an event, commonly used in gambling (and logistic regression).</p>
<p>For some event <span class="math inline">\(E\)</span>, <span class="math display">\[
\operatorname{odds}(E)=\frac{P(E)}{P\left(E^c\right)}=\frac{P(E)}{1-P(E)}
\]</span></p>
<p>The odds ratio (OR) is the ratio of the odds of an event occurring in one group to the odds of it occuring in another group. If the event in each of the groups are <span class="math inline">\(p_1\)</span> (first group) and <span class="math inline">\(p_2\)</span> (second group), then the odds ratio is: <span class="math display">\[
\mathrm{OR}=\frac{p_1 /\left(1-p_1\right)}{p_2 /\left(1-p_2\right)}
\]</span></p>
</section>
</section>
<section id="generalized-linear-models" class="level1">
<h1>Generalized Linear Models</h1>
<p>Under the hood, we’re still using a linear model <span class="math inline">\(\left(\beta_0+\beta_1 x\right)\)</span>, but now it’s embedded in a function that ensures valid probabilities. This is the essence of logistic regression - a generalized linear model (GLM) designed for binary outcomes.</p>
<p>Given predictor <span class="math inline">\(X\)</span> and d an outcom <span class="math inline">\(Y\)</span>, a GLM is defined by three components: - A random component, that specifies a distribution for <span class="math inline">\(Y \mid X\)</span> - A systematic component, that relates a parameter <span class="math inline">\(\eta\)</span> to the predictor <span class="math inline">\(X\)</span> <span class="math display">\[
\eta=\beta_0+\beta_1 X_1+\cdots+\beta_k X_k
\]</span> - A link function, that connects the random and systematic component</p>
<section id="random-component" class="level2">
<h2 class="anchored" data-anchor-id="random-component">Random Component</h2>
<p>The random component specifies a distribution for the outcome variable (conditional on <span class="math inline">\(X\)</span> ). In the case of linear regression, we assume that <span class="math inline">\(Y \mid X \sim \mathcal{N}\left(\mu, \sigma^2\right)\)</span>, for some mean <span class="math inline">\(\mu\)</span> and variance <span class="math inline">\(\sigma^2\)</span>. In the case of logistic regression, we assume that <span class="math inline">\(Y \mid X \sim \operatorname{Bern}(p)\)</span> for some probability <span class="math inline">\(p\)</span>.</p>
<p>In a generalized model, we are allowed to assume that <span class="math inline">\(Y \mid X\)</span> has a probability density function or probability mass function of the form <span class="math display">\[
f(y ; \theta, \phi)=\exp \left(\frac{y \theta-b(\theta)}{a(\phi)}+c(y, \phi)\right)
\]</span></p>
<p>Here <span class="math inline">\(\theta, \phi\)</span> are parameters, and <span class="math inline">\(a, b, c\)</span> are functions. Any density of the above form is called an exponential family density. The parameter <span class="math inline">\(\theta\)</span> is called the natural parameter, and the parameter <span class="math inline">\(\phi\)</span> the dispersion parameter.</p>
</section>
<section id="exponential-family" class="level2">
<h2 class="anchored" data-anchor-id="exponential-family">Exponential Family</h2>
<p>Exponential families include many of the most common distributions. For example: - Exponential <span class="math display">\[
f(y ; \lambda)=\lambda e^{-\lambda y}=\exp (-y \lambda+\ln \lambda)
\]</span> where <span class="math inline">\(\theta=-\lambda, \phi=1, b(\theta)=\ln \lambda, a(\phi)=1\)</span>, and <span class="math inline">\(c(y, \phi)=0\)</span> - Poisson <span class="math display">\[
f(y ; \lambda)=\frac{e^{-\lambda} \lambda^y}{y!}=\exp (y \ln \lambda-\lambda-\ln (y!))
\]</span> where <span class="math inline">\(\theta=\ln \lambda, \phi=1, b(\theta)=e^\theta=\lambda, a(\phi)=1\)</span>, and <span class="math inline">\(c(y, \phi)=-\lambda-\ln (y!)\)</span></p>
</section>
<section id="systematic-component-and-link-component" class="level2">
<h2 class="anchored" data-anchor-id="systematic-component-and-link-component">Systematic Component and Link Component</h2>
<p>The systematic component relates a parameter <span class="math inline">\(\eta\)</span> to the predictors <span class="math inline">\(X\)</span>. In a GLM, this is always done via <span class="math display">\[
\eta=X \beta=\beta_0+\beta_1 X_1+\cdots+\beta_k X_k
\]</span></p>
<p>We will denote the expectation of the distribution in random component as <span class="math inline">\(\mu\)</span>, i.e., <span class="math inline">\(\mathbb{E}[Y \mid X]=\mu\)</span>. It will be our goal to estimate <span class="math inline">\(\mu\)</span>. Finally, the link component connects the random and systematic components, via a link function <span class="math inline">\(g\)</span>. In particular, this link function provides a connection between <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\eta\)</span>, as in <span class="math display">\[
g(\mu)=\eta \quad \text { or } \quad \mu=g^{-1}(\eta)
\]</span></p>
</section>
<section id="example-1" class="level2">
<h2 class="anchored" data-anchor-id="example-1">Example</h2>
<section id="gaussian-noise-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="gaussian-noise-linear-regression">Gaussian-noise Linear Regression</h3>
<ul>
<li>Random Component: <span class="math inline">\(Y \mid X \sim \mathcal{N}\left(\mu, \sigma^2\right)\)</span> and <span class="math inline">\(\mathbb{E}[Y \mid X]=\mu\)</span></li>
<li>Systematic Component: <span class="math inline">\(\eta=X \beta\)</span></li>
<li>Link Component: <span class="math inline">\(g(\mu)=\mu\)</span>, so that <span class="math inline">\(\mu=\eta=X \beta\)</span></li>
</ul>
</section>
<section id="bernoulli" class="level3">
<h3 class="anchored" data-anchor-id="bernoulli">Bernoulli</h3>
<p>Suppose that <span class="math inline">\(Y \in\{0,1\}\)</span>, and we model the distribution of <span class="math inline">\(Y \mid X\)</span> as Bernoulli with success probability <span class="math inline">\(p\)</span>. Then the probability mass function (not a density, since <span class="math inline">\(Y\)</span> is discrete) is <span class="math display">\[
f(y)=p^y(1-p)^{1-y}
\]</span></p>
<p>We can rewrite to fit the exponential family form as <span class="math display">\[
\begin{aligned}
f(y) &amp; =\exp (y \log p+(1-y) \log (1-p)) \\
&amp; =\exp (y \log (p /(1-p))+\log (1-p))
\end{aligned}
\]</span></p>
<p><span class="math display">\[
f(y ; \theta, \phi)=\exp \left(\frac{y \theta-b(\theta)}{a(\phi)}+c(y, \phi)\right)
\]</span></p>
<p>Here we would identify <span class="math inline">\(\theta=\log (p /(1-p))\)</span> as the natural parameter. Note that the mean here is <span class="math inline">\(\mu=p\)</span>, and using the inverse of the above relationship, we can directly write the mean <span class="math inline">\(p\)</span> as a function of <span class="math inline">\(\theta\)</span>, as in <span class="math inline">\(p=e^\theta /\left(1+e^\theta\right)\)</span>. Hence <span class="math inline">\(b(\theta)=\log (1-p)=-\log \left(1+e^\theta\right)\)</span>. There is no dispersion parameter, so we can set <span class="math inline">\(a(\phi)=1\)</span>. Also, <span class="math inline">\(c(y, \phi)=0\)</span>.</p>
</section>
</section>
</section>
<section id="link-function" class="level1">
<h1>Link Function</h1>
<p><span class="math display">\[
g(\mu)=\Phi^{-1}(\mu)
\]</span> where <span class="math inline">\(\Phi\)</span> is the standard normal CDF.</p>
<section id="logistic" class="level3">
<h3 class="anchored" data-anchor-id="logistic">Logistic</h3>
<p>The three GLM criteria give us: - <span class="math inline">\(y_i \sim \operatorname{Bern}\left(p_i\right)\)</span> - <span class="math inline">\(\eta=\beta_0+\beta_1 X_1+\cdots+\beta_k X_k\)</span> - <span class="math inline">\(\operatorname{logit}(p)=\log \frac{p}{1-p}=\eta\)</span></p>
<p>From which we know, <span class="math display">\[
p_i=\frac{\exp \left(\beta_0+\beta_1 x_{i 1}+\cdots+\beta_k X_{i k}\right)}{1+\exp \left(\beta_0+\beta_1 x_{i 1}+\cdots+\beta_k X_{i k}\right)}
\]</span></p>
</section>
</section>
<section id="survival-analysis" class="level1">
<h1>Survival Analysis</h1>
<p>Survival analysis is used to analyze data in which the time until the event is of interest. The response is often referred to as a failure time, survival time, or event time.</p>
<section id="some-definations" class="level2">
<h2 class="anchored" data-anchor-id="some-definations">Some definations</h2>
<p>Hazard ratios; ratios of hazard functions between different groups (e.g., exposed vs.&nbsp;unexposed) while adjusting for confounders.</p>
<p>censoring - which occurs when the survival time is only partially known</p>
<ul>
<li><p>Fixed type I censoring occurs when a study is designed to end after C years of follow-up. In this case, everyone who does not have an event observed during the course of the study is censored at C years.</p></li>
<li><p>In random type I censoring, the study is designed to end after C years, but censored subjects do not all have the same censoring time. This is the main type of right-censoring we will be concerned with.</p></li>
<li><p>In type II censoring, a study ends when there is a pre-specified number of events.</p></li>
</ul>
</section>
<section id="kaplan-meier-estimate" class="level2">
<h2 class="anchored" data-anchor-id="kaplan-meier-estimate">Kaplan-Meier estimate</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR2)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(BrainCancer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "sex"       "diagnosis" "loc"       "ki"        "gtv"       "stereo"   
[7] "status"    "time"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(BrainCancer)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>status
 0  1 
53 35 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>fit.surv <span class="ot">&lt;-</span> <span class="fu">survfit</span>(<span class="fu">Surv</span>(time, status) <span class="sc">~</span> <span class="dv">1</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit.surv, <span class="at">xlab =</span> <span class="st">"Months"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Estimated Probability of Survival"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cox-proportional-harzards-model" class="level2">
<h2 class="anchored" data-anchor-id="cox-proportional-harzards-model">Cox-proportional harzards model</h2>
<p>S(t) = P(T&gt;t)=1-F(t)</p>
<p><span class="math inline">\(h(t)=\lim _{\Delta t \rightarrow 0} \frac{P(t&lt;T \leq t+\Delta t \mid T&gt;t)}{\Delta t}\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>fit.all <span class="ot">&lt;-</span> <span class="fu">coxph</span>(</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">Surv</span>(time, status) <span class="sc">~</span> sex <span class="sc">+</span> diagnosis <span class="sc">+</span> loc <span class="sc">+</span> ki <span class="sc">+</span> gtv <span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>   stereo)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>fit.all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
coxph(formula = Surv(time, status) ~ sex + diagnosis + loc + 
    ki + gtv + stereo)

                       coef exp(coef) se(coef)      z        p
sexMale             0.18375   1.20171  0.36036  0.510  0.61012
diagnosisLG glioma  0.91502   2.49683  0.63816  1.434  0.15161
diagnosisHG glioma  2.15457   8.62414  0.45052  4.782 1.73e-06
diagnosisOther      0.88570   2.42467  0.65787  1.346  0.17821
locSupratentorial   0.44119   1.55456  0.70367  0.627  0.53066
ki                 -0.05496   0.94653  0.01831 -3.001  0.00269
gtv                 0.03429   1.03489  0.02233  1.536  0.12466
stereoSRT           0.17778   1.19456  0.60158  0.296  0.76760

Likelihood ratio test=41.37  on 8 df, p=1.776e-06
n= 87, number of events= 35 
   (1 observation deleted due to missingness)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>modaldata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">diagnosis =</span> <span class="fu">levels</span>(diagnosis),</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">sex =</span> <span class="fu">rep</span>(<span class="st">"Female"</span>, <span class="dv">4</span>),</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">loc =</span> <span class="fu">rep</span>(<span class="st">"Supratentorial"</span>, <span class="dv">4</span>),</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ki =</span> <span class="fu">rep</span>(<span class="fu">mean</span>(ki), <span class="dv">4</span>),</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">gtv =</span> <span class="fu">rep</span>(<span class="fu">mean</span>(gtv), <span class="dv">4</span>),</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">stereo =</span> <span class="fu">rep</span>(<span class="st">"SRT"</span>, <span class="dv">4</span>)</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>survplots <span class="ot">&lt;-</span> <span class="fu">survfit</span>(fit.all, <span class="at">newdata =</span> modaldata)</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(survplots, <span class="at">xlab =</span> <span class="st">"Months"</span>,</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Survival Probability"</span>, <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomleft"</span>, <span class="fu">levels</span>(diagnosis), <span class="at">col =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="final-review-of-r-codes" class="level1">
<h1>Final review of R codes</h1>
<section id="calculation" class="level2">
<h2 class="anchored" data-anchor-id="calculation">Calculation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">log</span>(<span class="fu">exp</span>(<span class="dv">1</span>)) <span class="co">#  base `e` is the default (log(e) is not defined)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="vectors--lab-2" class="level2">
<h2 class="anchored" data-anchor-id="vectors--lab-2">Vectors -Lab 2</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>x <span class="sc">%*%</span>x <span class="co"># scalar ("inner") product (but default in R as an 1*1 matrix)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]   30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>),<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "a" "b" "a" "b"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">8</span>), <span class="at">each =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 2 2 4 4 4 8 8 8</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>, <span class="at">to =</span> <span class="dv">4</span>, <span class="at">by =</span><span class="dv">1</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">:</span><span class="dv">4</span> <span class="co"># c(1,2,3,4) and 1:4 are all the same in.R</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">5</span>, <span class="at">length.out=</span><span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1.0 1.4 1.8 2.2 2.6 3.0 3.4 3.8 4.2 4.6 5.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vac&lt;-c((1,2,3),(3,4,5)) is wrong, but the below is true</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>vec1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>vec2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>vec3 <span class="ot">&lt;-</span> <span class="fu">c</span>(vec1, vec2)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>vec3[<span class="dv">1</span>] <span class="sc">==</span> vec1[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>vec3[<span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>];vec3[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 4 5</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>vec3[<span class="sc">-</span><span class="dv">1</span>] <span class="co"># everything but the first element</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3 4 5 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>vec3[<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 3 5 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:11] -5 -4 -3 -2 -1 0 1 2 3 4 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> int [1:11] -5 -4 -3 -2 -1 0 1 2 3 4 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abs</span>(<span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 5 4 3 2 1 0 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 6.737947e-03 1.831564e-02 4.978707e-02 1.353353e-01 3.678794e-01
 [6] 1.000000e+00 2.718282e+00 7.389056e+00 2.008554e+01 5.459815e+01
[11] 1.484132e+02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 6.737947e-03 1.831564e-02 4.978707e-02 1.353353e-01 3.678794e-01
 [6] 1.000000e+00 2.718282e+00 7.389056e+00 2.008554e+01 5.459815e+01
[11] 1.484132e+02</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>,<span class="dv">6</span>)</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">11</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11 13 13 15 15 17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sample variance and population variance </span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># x * y  # Element-wise multiplication: 10 40 90 160 250 360</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)<span class="sc">*</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sample variance using R's var() function</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>sample_variance <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sample(var(x)) and population variance</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>sample_variance <span class="ot">&lt;-</span><span class="fu">var</span>(x)</span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>population_variance <span class="ot">&lt;-</span> sample_variance <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n</span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(population_variance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
</section>
<section id="rmd-knowledge" class="level2">
<h2 class="anchored" data-anchor-id="rmd-knowledge">Rmd knowledge</h2>
<p>{r, echo = FALSE} Hidden Code</p>
<p>eval: run or not</p>
<p>message/warning</p>
<p>result</p>
</section>
</section>
<section id="probability-in-r" class="level1">
<h1>Probability in R</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'mosaic':
  method                           from   
  fortify.SpatialPolygonsDataFrame ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
The 'mosaic' package masks several functions from core packages in order to add 
additional features.  The original behavior of these functions should not be affected by this.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'mosaic'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    count, do, tally</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    mean</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:car':

    deltaMethod, logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    stat</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    binom.test, cor, cor.test, cov, fivenum, IQR, median, prop.test,
    quantile, sd, t.test, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    max, mean, min, prod, range, sample, sum</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">'norm'</span>,<span class="at">mean=</span><span class="dv">10</span>,<span class="at">sd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">'binom'</span>,<span class="at">size=</span><span class="dv">10</span>,<span class="at">prob=</span>.<span class="dv">2</span>) <span class="co"># x-axis is the number of success from 1-10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-20-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotDist</span>(<span class="st">"pois"</span>, <span class="at">lambda =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-20-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>)) <span class="co"># the probability it is less than or equal to 3 of Poison(2)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8571235</code></pre>
</div>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8571235</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ppois</span>(<span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>) <span class="sc">==</span> <span class="fu">sum</span>(<span class="fu">dpois</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">lambda =</span> <span class="dv">2</span>)) <span class="co"># this inequivalance is because the floating point precision</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#xpnorm(-1)  # P(Z ≤ -1) = 0.1586553 -package mosaic</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co">#xpnorm(-1, lower.tail = FALSE)  # P(Z ≥ 1.5) = 0.0668072</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1586553</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8413447</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -Inf</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.644854</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
</div>
</section>
<section id="data-class" class="level1">
<h1>Data class</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span>(<span class="st">"R is the statistical analysis language"</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(df, <span class="at">split =</span> <span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "R"           "is"          "the"         "statistical" "analysis"   
[6] "language"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(df, <span class="at">split =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 [1] "R" " " "i" "s" " " "t" "h" "e" " " "s" "t" "a" "t" "i" "s" "t" "i" "c" "a"
[20] "l" " " "a" "n" "a" "l" "y" "s" "i" "s" " " "l" "a" "n" "g" "u" "a" "g" "e"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>df<span class="ot">&lt;-</span><span class="st">"all16i5need6is4a9long8vacation"</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>?strsplit</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="fu">strsplit</span>(df,<span class="at">split =</span> <span class="st">"[0-9]+"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] "all"      "i"        "need"     "is"       "a"        "long"     "vacation"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">"Good"</span>, <span class="st">"afternoon"</span>, <span class="st">"ladies"</span>, <span class="st">"and"</span>, <span class="st">"gentlemen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Good afternoon ladies and gentlemen"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste0</span>(<span class="st">"Good"</span>, <span class="st">"afternoon"</span>, <span class="st">"ladies"</span>, <span class="st">"and"</span>, <span class="st">"gentlemen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Goodafternoonladiesandgentlemen"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="sc">!=</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 12 13 14 15 16 17 18 19 20 21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">which</span>(x<span class="sc">&gt;</span><span class="dv">0</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>vowels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'a'</span>,<span class="st">'e'</span>,<span class="st">'i'</span>,<span class="st">'o'</span>,<span class="st">'u'</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">is.element</span>(letters, vowels))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  1  5  9 15 21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Note that logical elements are NOT in quotes.</span></span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>, <span class="st">"TRUE"</span>, <span class="st">"FALSE"</span>)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "character"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.logical</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  TRUE FALSE  TRUE FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># TRUE = 1 and FALSE = 0. sum() and mean() work on logical vectors</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="co"># remember:</span></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="cn">TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">&amp;</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="cn">TRUE</span> <span class="sc">|</span> <span class="cn">FALSE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Factor</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'B'</span>,<span class="st">'B'</span>,<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'C'</span>)</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">factor</span>(y)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Factor w/ 3 levels "A","B","C": 2 2 1 1 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as.numeric</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 2 1 1 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A" "B" "C"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">factor</span>(z,                       <span class="co"># vector of data levels to convert </span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels=</span><span class="fu">c</span>(<span class="st">'B'</span>,<span class="st">'A'</span>,<span class="st">'C'</span>),   <span class="co"># Order of the levels</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"B Group"</span>, <span class="st">"A Group"</span>, <span class="st">"C Group"</span>)) <span class="co"># Pretty labels to use</span></span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] B Group B Group A Group A Group C Group
Levels: B Group A Group C Group</code></pre>
</div>
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="do">### eg of use in the plot's x-axis name lable</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>iris<span class="sc">$</span>Species <span class="ot">&lt;-</span> <span class="fu">factor</span>(iris<span class="sc">$</span>Species,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">'versicolor'</span>,<span class="st">'setosa'</span>,<span class="st">'virginica'</span>),</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">'Versicolor'</span>,<span class="st">'Setosa'</span>,<span class="st">'Virginica'</span>))</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot(Sepal.Length ~ Species, data=iris)</span></span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-8"><a href="#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="do">### another eg</span></span>
<span id="cb163-9"><a href="#cb163-9" aria-hidden="true" tabindex="-1"></a><span class="co">#age_category &lt;- ifelse(ages &gt;= 18, "Adult", "Minor")</span></span>
<span id="cb163-10"><a href="#cb163-10" aria-hidden="true" tabindex="-1"></a><span class="co">#age_factor &lt;- factor(age_category, levels = c("Minor", "Adult"))</span></span>
<span id="cb163-11"><a href="#cb163-11" aria-hidden="true" tabindex="-1"></a><span class="co">#age_factor</span></span>
<span id="cb163-12"><a href="#cb163-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-13"><a href="#cb163-13" aria-hidden="true" tabindex="-1"></a><span class="co"># transform a conituous numerical vector and transform it into a factor</span></span>
<span id="cb163-14"><a href="#cb163-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-15"><a href="#cb163-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb163-16"><a href="#cb163-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-17"><a href="#cb163-17" aria-hidden="true" tabindex="-1"></a><span class="co"># cut(x,breaks=3)</span></span>
<span id="cb163-18"><a href="#cb163-18" aria-hidden="true" tabindex="-1"></a><span class="fu">cut</span>(x, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">2.5</span>, <span class="fl">5.0</span>, <span class="fl">7.5</span>, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] (0,2.5]  (0,2.5]  (2.5,5]  (2.5,5]  (2.5,5]  (5,7.5]  (5,7.5]  (7.5,10]
 [9] (7.5,10] (7.5,10]
Levels: (0,2.5] (2.5,5] (5,7.5] (7.5,10]</code></pre>
</div>
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cut</span>(x, <span class="at">breaks=</span><span class="dv">3</span>, <span class="at">labels=</span><span class="fu">c</span>(<span class="st">'Low'</span>,<span class="st">'Medium'</span>,<span class="st">'High'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] Low    Low    Low    Low    Medium Medium Medium High   High   High  
Levels: Low Medium High</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dates</span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>mydates <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2023-04-07"</span>, <span class="st">"2023-01-01"</span>))</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>mydates</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2023-04-07" "2023-01-01"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>days <span class="ot">&lt;-</span> mydates[<span class="dv">1</span>] <span class="sc">-</span> mydates[<span class="dv">2</span>]; days</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 96 days</code></pre>
</div>
</div>
<p>The following symbols can be used with the <code>format()</code> function to print dates.</p>
<ul>
<li>%d day as a number (0-31) 01-31</li>
<li>%a abbreviated weekday Mon</li>
<li>%A unabbreviated weekday Monday</li>
<li>%m month (00-12) 00-12</li>
<li>%b abbreviated month Jan</li>
<li>%B unabbreviated month January</li>
<li>%y 2-digit year 07</li>
<li>%Y 4-digit year 2007</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>today <span class="ot">&lt;-</span> <span class="fu">Sys.Date</span>()</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">format</span>(today, <span class="at">format=</span><span class="st">"%B %d %Y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "May 30 2025"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co"># or library(lubridate)</span></span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co">#x = c("2014-02-4 05:02:00","2016/09/24 14:02:00") </span></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co">#ymd_hms(x)</span></span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="co"># POSIXct</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrices</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">9</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">=</span> <span class="fu">matrix</span>(n,<span class="at">nrow=</span><span class="dv">3</span>)</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>mat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">diag</span>(n)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use %*% as the product of matrices</span></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Eigenvalue and Eigenvector</span></span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">13</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">4</span>, <span class="dv">11</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="dv">8</span>), <span class="dv">3</span>, <span class="dv">3</span>, <span class="at">byrow=</span><span class="cn">TRUE</span>)</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(A)</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>(values <span class="ot">&lt;-</span> ev<span class="sc">$</span>values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17  8  7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a>(vectors <span class="ot">&lt;-</span> ev<span class="sc">$</span>vectors)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]       [,2]      [,3]
[1,]  0.7453560  0.6666667 0.0000000
[2,] -0.5962848  0.6666667 0.4472136
[3,]  0.2981424 -0.3333333 0.8944272</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Data selection --row then column</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>mat[<span class="dv">1</span>, <span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a>mat[<span class="dv">1</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 4 7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a>mat[,<span class="dv">1</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mat[<span class="dv">1</span>, ]) <span class="co"># Note that the class of the returned object is no longer a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "integer"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data frames</span></span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a>Data_Frame <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Tr =</span><span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>),</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Pu =</span><span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">21</span>,<span class="dv">32</span>),</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Dur=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">222</span>,<span class="dv">1</span>))</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>Data_Frame</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tr Pu Dur
1  1 11  22
2  2 21 222
3  3 32   1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Data_Frame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Tr                  Pu             Dur        
 Length:3           Min.   :11.00   Min.   :  1.00  
 Class :character   1st Qu.:16.00   1st Qu.: 11.50  
 Mode  :character   Median :21.00   Median : 22.00  
                    Mean   :21.33   Mean   : 81.67  
                    3rd Qu.:26.50   3rd Qu.:122.00  
                    Max.   :32.00   Max.   :222.00  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List ---Can hold vectors, strings, matrices, models, list of other list, lists upon lists!</span></span>
<span id="cb192-2"><a href="#cb192-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-3"><a href="#cb192-3" aria-hidden="true" tabindex="-1"></a>mylist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">letters=</span><span class="fu">c</span>(<span class="st">"a"</span>,<span class="st">"b"</span>,<span class="st">"c"</span>),</span>
<span id="cb192-4"><a href="#cb192-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">numbers=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>,<span class="at">ncol=</span><span class="dv">5</span>))</span>
<span id="cb192-5"><a href="#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mylist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "a" "b" "c"

$numbers
[1] 1 2 3

[[3]]
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    6   11   16   21
[2,]    2    7   12   17   22
[3,]    3    8   13   18   23
[4,]    4    9   14   19   24
[5,]    5   10   15   20   25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Can reference data using $ (if the elements are named), or using [], or [[]]</span></span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>mylist[<span class="dv">1</span>] <span class="co"># list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a>mylist[<span class="st">"letters"</span>] <span class="co"># list</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$letters
[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="dv">1</span>]] <span class="co"># vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "a" "b" "c"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>mylist<span class="sc">$</span>letters <span class="sc">==</span> mylist[[<span class="st">"letters"</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE TRUE TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a>mylist[[<span class="dv">3</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2]
[1,]    1    6
[2,]    2    7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(mylist[[<span class="dv">3</span>]][<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "matrix" "array" </code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>); <span class="dv">2</span> <span class="sc">%in%</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="co"># eg of Matrices data frames</span></span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">5.1</span>, <span class="fl">4.9</span>, <span class="fl">5.6</span>, <span class="fl">4.2</span>, <span class="fl">4.8</span>, <span class="fl">4.5</span>, <span class="fl">5.3</span>, <span class="fl">5.2</span>)   <span class="co"># some toy data</span></span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">t.test</span>(x, <span class="at">alternative=</span><span class="st">'less'</span>, <span class="at">mu=</span><span class="dv">5</span>)   <span class="co"># do a t-test</span></span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(results)    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 10
 $ statistic  : Named num -0.314
  ..- attr(*, "names")= chr "t"
 $ parameter  : Named num 7
  ..- attr(*, "names")= chr "df"
 $ p.value    : num 0.381
 $ conf.int   : num [1:2] -Inf 5.25
  ..- attr(*, "conf.level")= num 0.95
 $ estimate   : Named num 4.95
  ..- attr(*, "names")= chr "mean of x"
 $ null.value : Named num 5
  ..- attr(*, "names")= chr "mean"
 $ stderr     : num 0.159
 $ alternative: chr "less"
 $ method     : chr "One Sample t-test"
 $ data.name  : chr "x"
 - attr(*, "class")= chr "htest"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>results<span class="sc">$</span>p.value</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3813385</code></pre>
</div>
</div>
<p>Practice of Lab 5</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>db_data <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">drugs =</span> <span class="fu">list</span>(</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">general_information =</span> <span class="fu">data.frame</span>(</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">drugbank_id =</span> <span class="fu">c</span>(<span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>),</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"Aspirin"</span>, <span class="st">"Ibuprofen"</span>, <span class="st">"Paracetamol"</span>, <span class="st">"Insulin"</span>, <span class="st">"Morphine"</span>),</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"small molecule"</span>, <span class="st">"small molecule"</span>, <span class="st">"small molecule"</span>, <span class="st">"biotech"</span>, <span class="st">"small molecule"</span>),</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">created =</span> <span class="fu">as.Date</span>(<span class="fu">c</span>(<span class="st">"2020-01-01"</span>, <span class="st">"2020-02-01"</span>, <span class="st">"2020-03-01"</span>, <span class="st">"2020-04-01"</span>, <span class="st">"2020-05-01"</span>)),</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">drug_classification =</span> <span class="fu">data.frame</span>(</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">drugbank_id =</span> <span class="fu">c</span>(<span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>),</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">classification =</span> <span class="fu">c</span>(<span class="st">"Analgesic"</span>, <span class="st">"Anti-inflammatory"</span>, <span class="st">"Analgesic"</span>, <span class="st">"Hormone"</span>, <span class="st">"Analgesic"</span>),</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">experimental_properties =</span> <span class="fu">data.frame</span>(</span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">drugbank_id =</span> <span class="fu">c</span>(<span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>, <span class="st">"DB001"</span>, <span class="st">"DB002"</span>, <span class="st">"DB003"</span>, <span class="st">"DB004"</span>, <span class="st">"DB005"</span>),</span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">kind =</span> <span class="fu">c</span>(<span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"logP"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>, <span class="st">"Molecular Weight"</span>),</span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">value =</span> <span class="fu">c</span>(<span class="st">"1.2"</span>, <span class="st">"1.5"</span>, <span class="st">"0.8"</span>, <span class="st">"2.1"</span>, <span class="st">"1.8"</span>, <span class="st">"180.1"</span>, <span class="st">"206.3"</span>, <span class="st">"151.2"</span>, <span class="st">"5800.0"</span>, <span class="st">"281.5"</span>),</span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a>general_information <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>general_information</span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(general_information)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id        name           type    created
1       DB001     Aspirin small molecule 2020-01-01
2       DB002   Ibuprofen small molecule 2020-02-01
3       DB003 Paracetamol small molecule 2020-03-01
4       DB004     Insulin        biotech 2020-04-01
5       DB005    Morphine small molecule 2020-05-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 20. Number of drugs in the general_information dataframe</span></span>
<span id="cb214-2"><a href="#cb214-2" aria-hidden="true" tabindex="-1"></a>general_information <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>general_information</span>
<span id="cb214-3"><a href="#cb214-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(general_information)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 21. Filter drugs of type "biotech"</span></span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a>general_information[general_information<span class="sc">$</span>type <span class="sc">==</span> <span class="st">'biotech'</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id    name    type    created
4       DB004 Insulin biotech 2020-04-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 22. Sort by the created column and display the first 5 rows</span></span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a>general_information<span class="sc">$</span>created <span class="ot">&lt;-</span> <span class="fu">as.Date</span>(general_information<span class="sc">$</span>created)</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a>sorted_df <span class="ot">&lt;-</span> general_information[<span class="fu">order</span>(general_information<span class="sc">$</span>created), ]</span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sorted_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id        name           type    created
1       DB001     Aspirin small molecule 2020-01-01
2       DB002   Ibuprofen small molecule 2020-02-01
3       DB003 Paracetamol small molecule 2020-03-01
4       DB004     Insulin        biotech 2020-04-01
5       DB005    Morphine small molecule 2020-05-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 23. Subset with specific columns and display the first 5 rows</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>subset_df <span class="ot">&lt;-</span> general_information[, <span class="fu">c</span>(<span class="st">"drugbank_id"</span>, <span class="st">"name"</span>)]</span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(subset_df, <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  drugbank_id        name
1       DB001     Aspirin
2       DB002   Ibuprofen
3       DB003 Paracetamol
4       DB004     Insulin
5       DB005    Morphine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 24. Merge dataframes and count rows</span></span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>drug_classification <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>drug_classification</span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>merged_df <span class="ot">&lt;-</span> <span class="fu">merge</span>(general_information, drug_classification, <span class="at">by =</span> <span class="st">"drugbank_id"</span>)</span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(merged_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 25. Count unique experimental properties (kind)</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>experimental_properties <span class="ot">&lt;-</span> db_data<span class="sc">$</span>drugs<span class="sc">$</span>experimental_properties</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>unique_kinds <span class="ot">&lt;-</span> <span class="fu">unique</span>(experimental_properties<span class="sc">$</span>kind)</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(unique_kinds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 26. Filter for kind "logP" and count rows</span></span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>logP_df <span class="ot">&lt;-</span> experimental_properties[experimental_properties<span class="sc">$</span>kind <span class="sc">==</span> <span class="st">"logP"</span>, ]</span>
<span id="cb226-3"><a href="#cb226-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(logP_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 27. Convert value column to numeric and calculate mean</span></span>
<span id="cb228-2"><a href="#cb228-2" aria-hidden="true" tabindex="-1"></a>logP_df<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(logP_df<span class="sc">$</span>value)</span>
<span id="cb228-3"><a href="#cb228-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(logP_df<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 28. Calculate summary statistics for logP values</span></span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logP_df<span class="sc">$</span>value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   0.80    1.20    1.50    1.48    1.80    2.10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(logP_df<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5069517</code></pre>
</div>
<div class="sourceCode cell-code" id="cb234"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 29. Create a histogram of molecular weight values</span></span>
<span id="cb234-2"><a href="#cb234-2" aria-hidden="true" tabindex="-1"></a>molecular_weight <span class="ot">&lt;-</span> experimental_properties[experimental_properties<span class="sc">$</span>kind <span class="sc">==</span> <span class="st">"Molecular Weight"</span>, ]</span>
<span id="cb234-3"><a href="#cb234-3" aria-hidden="true" tabindex="-1"></a>molecular_weight<span class="sc">$</span>value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(molecular_weight<span class="sc">$</span>value)</span>
<span id="cb234-4"><a href="#cb234-4" aria-hidden="true" tabindex="-1"></a><span class="co"># clean based on 3 sigma rule</span></span>
<span id="cb234-5"><a href="#cb234-5" aria-hidden="true" tabindex="-1"></a>molecular_weight_clean <span class="ot">&lt;-</span> molecular_weight[</span>
<span id="cb234-6"><a href="#cb234-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">abs</span>(molecular_weight<span class="sc">$</span>value <span class="sc">-</span> <span class="fu">mean</span>(molecular_weight<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">&lt;=</span> <span class="dv">3</span> <span class="sc">*</span> <span class="fu">sd</span>(molecular_weight<span class="sc">$</span>value, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb234-7"><a href="#cb234-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(molecular_weight_clean<span class="sc">$</span>value, <span class="at">main =</span> <span class="st">"Histogram of Molecular Weight"</span>, <span class="at">xlab =</span> <span class="st">"Molecular Weight"</span>, <span class="at">ylab =</span> <span class="st">"Frequency"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>,<span class="at">breaks =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 30. Filter for kind "Water Solubility" and count unique values</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>water_solubility_df <span class="ot">&lt;-</span> experimental_properties[experimental_properties<span class="sc">$</span>kind <span class="sc">==</span> <span class="st">"Water Solubility"</span>, ]</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">unique</span>(water_solubility_df<span class="sc">$</span>value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="lab-5-data-visualization" class="level1">
<h1>LAB 5 –data visualization</h1>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Length <span class="sc">~</span> iris<span class="sc">$</span>Species)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb238"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(iris<span class="sc">$</span>Sepal.Length)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data=</span>iris)</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(Petal.Length <span class="sc">~</span> Sepal.Length, <span class="at">data=</span>iris), <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-3.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mpg, <span class="at">package=</span><span class="st">'ggplot2'</span>)</span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>mpg, <span class="fu">aes</span>(<span class="at">x=</span>class)) <span class="sc">+</span></span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-4.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(mpg<span class="sc">$</span>class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   2seater    compact    midsize    minivan     pickup subcompact        suv 
         5         47         41         11         33         35         62 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">table</span>(mpg<span class="sc">$</span>class))</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Var1 Freq
1    2seater    5
2    compact   47
3    midsize   41
4    minivan   11
5     pickup   33
6 subcompact   35
7        suv   62</code></pre>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By default, the geom_bar() just counts the number of cases and displays how many observations were in each factor level. If we have a data frame that we have already summarized, geom_col will allow us to set the height of the bar by a y column.</span></span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(Var1, Freq)) <span class="sc">+</span></span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-5.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg,<span class="fu">aes</span>(<span class="at">x=</span>hwy)) <span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-6.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a><span class="co"># density instead of the count </span></span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>hwy, <span class="at">y=</span><span class="fu">after_stat</span>(density))) <span class="sc">+</span> </span>
<span id="cb247-4"><a href="#cb247-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">8</span>, <span class="at">fill=</span><span class="st">"blue"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb247-5"><a href="#cb247-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Histogram of Highway MPG density"</span>)</span>
<span id="cb247-6"><a href="#cb247-6" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>hwy)) <span class="sc">+</span> </span>
<span id="cb247-7"><a href="#cb247-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">fill=</span><span class="st">'red'</span>, <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb247-8"><a href="#cb247-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Density Plot of Highway MPG"</span>)</span>
<span id="cb247-9"><a href="#cb247-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gridExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="sourceCode cell-code" id="cb250"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1, p2, <span class="at">ncol =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-7.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Scatterplots</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Petal.Length,<span class="at">color=</span>Species))<span class="sc">+</span></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span><span class="co"># Anything set inside an aes() command will be of the form attribute=Column_Name and will change based on the data. Anything set outside an aes() command will be in the form attribute=value and will be fixed.</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-8.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb253"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Petal.Length)) <span class="sc">+</span></span>
<span id="cb253-2"><a href="#cb253-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Species,<span class="at">shape=</span>Species))<span class="sc">+</span></span>
<span id="cb253-3"><a href="#cb253-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-9.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb255"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb255-2"><a href="#cb255-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">color =</span> Species, <span class="at">fill =</span> Species), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb255-3"><a href="#cb255-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot"</span>) <span class="sc">+</span></span>
<span id="cb255-4"><a href="#cb255-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sepal Length"</span>, <span class="at">y =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-10.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x =</span> Sepal.Length)) <span class="sc">+</span></span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Species,<span class="at">color=</span>Species), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb256-3"><a href="#cb256-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Density plot"</span>) <span class="sc">+</span></span>
<span id="cb256-4"><a href="#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Sepal Length"</span>, <span class="at">y =</span> <span class="st">"Density"</span>) <span class="sc">+</span></span>
<span id="cb256-5"><a href="#cb256-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">fill =</span> <span class="st">"Revise the name"</span>,<span class="at">color=</span><span class="st">"Revise the name"</span>)  <span class="co"># fill is the area,color is the line or dot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-11.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb257"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">factor</span>(mtcars<span class="sc">$</span>cyl) </span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>wt, <span class="at">y=</span>mpg, <span class="at">col=</span>cyl)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">'Weight vs Miles per Gallon'</span>) <span class="sc">+</span></span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Weight in tons (2000 lbs)"</span>, <span class="at">y=</span><span class="st">"Miles per Gallon (US)"</span> ) <span class="sc">+</span></span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Cylinders"</span>) <span class="sc">+</span> <span class="co"># color is dot or line</span></span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">'blue'</span>, <span class="st">'darkmagenta'</span>, <span class="st">'aquamarine'</span>)) <span class="co"># diy color</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-12.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rainbow</span>(<span class="dv">3</span>);<span class="fu">rainbow</span>(<span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#FF0000" "#00FF00" "#0000FF"</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#FF0000" "#FFFF00" "#00FF00" "#00FFFF" "#0000FF" "#FF00FF"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(colorspace)   <span class="co"># these two packages have some decent </span></span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grDevices)    <span class="co"># color palettes functions.</span></span>
<span id="cb261-3"><a href="#cb261-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MDplot) <span class="co">#Ramachandran plots is often used to show the sampling of the 𝜙/𝜓protein backbone dihedral angles in order to assign propensities of secondary structure elements to the protein of interest</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: MASS</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'MASS'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ISLR2':

    Boston</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: RColorBrewer</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gplots</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gplots'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    lowess</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: gtools</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'gtools'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mosaic':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    logit</code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>exp_data <span class="ot">&lt;-</span> <span class="fu">load_ramachandran</span>(<span class="fu">system.file</span>( <span class="st">"extdata/ramachandran_example_GROMACS.txt.gz"</span>,<span class="at">package =</span> <span class="st">"MDplot"</span> ), <span class="at">mdEngine =</span> <span class="st">"GROMACS"</span>)</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a>exp_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(exp_data)</span>
<span id="cb274-3"><a href="#cb274-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(exp_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'phi'</span>, <span class="st">'psi'</span>)</span>
<span id="cb274-4"><a href="#cb274-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(exp_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        phi      psi
1 -73.75620 115.6350
2  65.97530 -57.9671
3 -56.51010 130.7000
4 -34.58640 158.7300
5  -3.98544 -79.4994
6 -71.90600 -79.6882</code></pre>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(exp_data, aes(x=phi, y=psi) ) + geom_bin_2d(bins=100)</span></span>
<span id="cb276-2"><a href="#cb276-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exp_data, <span class="fu">aes</span>(<span class="at">x=</span>phi, <span class="at">y=</span>psi) ) <span class="sc">+</span> <span class="fu">geom_hex</span>(<span class="at">bins=</span><span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-13.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb277"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exp_data, <span class="fu">aes</span>(<span class="at">x=</span>phi, <span class="at">y=</span>psi) ) <span class="sc">+</span> <span class="fu">geom_hex</span>(<span class="at">bins=</span><span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb277-2"><a href="#cb277-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_continuous</span>(<span class="at">type =</span> <span class="st">"viridis"</span>) <span class="co"># scale_fill_gradient(low = "blue", high = "red")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-14.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exp_data, <span class="fu">aes</span>(<span class="at">x=</span>phi, <span class="at">y=</span>psi) ) <span class="sc">+</span> <span class="fu">geom_hex</span>(<span class="at">bins=</span><span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"blue"</span>, <span class="at">mid=</span><span class="st">'purple'</span>, <span class="at">high =</span> <span class="st">"red"</span>, <span class="at">midpoint=</span><span class="dv">10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-15.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(exp_data, aes(x=phi, y=psi) ) + geom_hex(bins=100) +</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">#scale_fill_gradientn(colours = terrain.colors(5))</span></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(exp_data, <span class="fu">aes</span>(<span class="at">x=</span>phi, <span class="at">y=</span>psi) ) <span class="sc">+</span> <span class="fu">geom_density_2d_filled</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-16.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusting axes</span></span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb280-3"><a href="#cb280-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mpg, <span class="fu">aes</span>(<span class="at">x=</span>class, <span class="at">y=</span>hwy)) <span class="sc">+</span> </span>
<span id="cb280-4"><a href="#cb280-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb280-5"><a href="#cb280-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">45</span>, <span class="at">by=</span><span class="dv">5</span>))  <span class="co">#---diy scale in y-axis </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-25-17.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb281"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(mpg, aes(x=class, y=hwy)) + geom_boxplot() +scale_y_continuous(breaks = seq(10, 45, by=5), minor_breaks = NULL)</span></span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Zooming in/out--Danger!  This removes the data points first!</span></span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a><span class="co">#ggplot(trees, aes(x=Girth, y=Volume)) + </span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point() +</span></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_smooth(method='lm') +</span></span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#xlim( 8, 19 ) + ylim(0, 60)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Example (https://github.com/jcoliver/learn-r/blob/gh-pages/data/mine-microbe-class-data.csv)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>mine.data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Site =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Depth =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="dv">25</span>, <span class="dv">25</span>),</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sample.name =</span> <span class="fu">c</span>(<span class="st">'1-S'</span>, <span class="st">'2-S'</span>, <span class="st">'3-S'</span>, <span class="st">'1-M'</span>, <span class="st">'2-M'</span>, <span class="st">'3-M'</span>, <span class="st">'2-B'</span>, <span class="st">'3-B'</span>),</span>
<span id="cb282-5"><a href="#cb282-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Actinobacteria =</span> <span class="fu">c</span>(<span class="dv">373871</span>, <span class="dv">332856</span>, <span class="dv">326695</span>, <span class="dv">409809</span>, <span class="dv">319778</span>, <span class="dv">445572</span>, <span class="dv">128251</span>, <span class="dv">96304</span>),</span>
<span id="cb282-6"><a href="#cb282-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cytophagia =</span> <span class="fu">c</span>(<span class="dv">8052</span>, <span class="dv">28561</span>, <span class="dv">10468</span>, <span class="dv">4481</span>, <span class="dv">15885</span>, <span class="dv">7302</span>, <span class="dv">4732</span>, <span class="dv">5566</span>),</span>
<span id="cb282-7"><a href="#cb282-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Flavobacteriia =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">5230</span>, <span class="dv">6218</span>, <span class="dv">5917</span>, <span class="dv">6353</span>),</span>
<span id="cb282-8"><a href="#cb282-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Sphingobacteriia =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10013</span>, <span class="dv">4918</span>, <span class="dv">0</span>, <span class="dv">8274</span>, <span class="dv">8284</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb282-9"><a href="#cb282-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nitrospira =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4609</span>, <span class="dv">0</span>),</span>
<span id="cb282-10"><a href="#cb282-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">Planctomycetia =</span> <span class="fu">c</span>(<span class="dv">4553</span>, <span class="dv">10008</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">56836</span>, <span class="dv">67380</span>),</span>
<span id="cb282-11"><a href="#cb282-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Alphaproteobacteria =</span> <span class="fu">c</span>(<span class="dv">143534</span>, <span class="dv">70575</span>, <span class="dv">105890</span>, <span class="dv">110746</span>, <span class="dv">52504</span>, <span class="dv">45000</span>, <span class="dv">133851</span>, <span class="dv">95580</span>),</span>
<span id="cb282-12"><a href="#cb282-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">Betaproteobacteria =</span> <span class="fu">c</span>(<span class="dv">124454</span>, <span class="dv">170161</span>, <span class="dv">187673</span>, <span class="dv">87245</span>, <span class="dv">146073</span>, <span class="dv">91711</span>, <span class="dv">90204</span>, <span class="dv">85707</span>),</span>
<span id="cb282-13"><a href="#cb282-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Deltaproteobacteria =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">4260</span>, <span class="dv">0</span>),</span>
<span id="cb282-14"><a href="#cb282-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Gammaproteobacteria =</span> <span class="fu">c</span>(<span class="dv">8426</span>, <span class="dv">9005</span>, <span class="dv">12935</span>, <span class="dv">7025</span>, <span class="dv">110825</span>, <span class="dv">69452</span>, <span class="dv">31956</span>, <span class="dv">165572</span>)</span>
<span id="cb282-15"><a href="#cb282-15" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="3" type="1">
<li>Check the structure of the data frame.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb283"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(mine.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   8 obs. of  13 variables:
 $ Site               : num  1 2 3 1 2 3 2 3
 $ Depth              : num  0.5 0.5 0.5 3.5 3.5 3.5 25 25
 $ Sample.name        : chr  "1-S" "2-S" "3-S" "1-M" ...
 $ Actinobacteria     : num  373871 332856 326695 409809 319778 ...
 $ Cytophagia         : num  8052 28561 10468 4481 15885 ...
 $ Flavobacteriia     : num  0 0 0 0 5230 ...
 $ Sphingobacteriia   : num  0 10013 4918 0 8274 ...
 $ Nitrospira         : num  0 0 0 0 0 ...
 $ Planctomycetia     : num  4553 10008 0 0 0 ...
 $ Alphaproteobacteria: num  143534 70575 105890 110746 52504 ...
 $ Betaproteobacteria : num  124454 170161 187673 87245 146073 ...
 $ Deltaproteobacteria: num  0 0 0 0 0 0 4260 0
 $ Gammaproteobacteria: num  8426 9005 12935 7025 110825 ...</code></pre>
</div>
</div>
<p>The data frame has 8 rows (“obs.”) and 13 columns (“variables”). The first three columns have information about the observation (Site, Depth, Sample.name), and the remaining columns have the abundance for each of 10 classes of bacteria.</p>
<p>We ultimately want a heatmap where the different sites are shown along the x-axis, the classes of bacteria are shown along the y-axis, and the shading of the cell reflects the abundance. This latter value, the abundance of a bacteria at specific depths at different site, is really just a third dimension. However, instead of creating a 3-dimensional plot that can be difficult to visualize, we instead use shading for our “z-axis”. To this end, we need our data formatted so we have a column corresponding to each of these three dimensions:</p>
<ul>
<li>X: Sample identity</li>
<li>Y: Bacterial class</li>
<li>Z: Abundance</li>
</ul>
<p>The challenge is that our data are not formatted like this. While the Sample.name column corresponds to what we would like for our x-axis, we do not have columns that correspond to what is needed for the y- and z-axes. All the data are in our data frame, but we need to take a table that looks like this:</p>
<p>Sample.name Actinobacteria Cytophagia 1-S 373871 8052 2-S 332856 28561 … … …</p>
<p>And transform it to one with a column for bacterial class and a column for abundance, like this:</p>
<p>Sample.name Class Abundance 1-S Actinobacteria 373871 1-S Cytophagia 8052 2-S Actinobacteria 332856 … … …</p>
<p>In the later labs, you will learn convenient package and function to achieve this. But for now, we just use some basic function to do so.</p>
<ol start="4" type="1">
<li>Remove the first two columns.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a>mine.data <span class="ot">&lt;-</span> mine.data[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)]</span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a>mine.data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sample.name Actinobacteria Cytophagia Flavobacteriia Sphingobacteriia
1         1-S         373871       8052              0                0
2         2-S         332856      28561              0            10013
3         3-S         326695      10468              0             4918
4         1-M         409809       4481              0                0
5         2-M         319778      15885           5230             8274
6         3-M         445572       7302           6218             8284
7         2-B         128251       4732           5917                0
8         3-B          96304       5566           6353                0
  Nitrospira Planctomycetia Alphaproteobacteria Betaproteobacteria
1          0           4553              143534             124454
2          0          10008               70575             170161
3          0              0              105890             187673
4          0              0              110746              87245
5          0              0               52504             146073
6          0              0               45000              91711
7       4609          56836              133851              90204
8          0          67380               95580              85707
  Deltaproteobacteria Gammaproteobacteria
1                   0                8426
2                   0                9005
3                   0               12935
4                   0                7025
5                   0              110825
6                   0               69452
7                4260               31956
8                   0              165572</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Use “colnames()” to get a vector of class names and assign it to the object named by “class.name”</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a>class.name <span class="ot">&lt;-</span> <span class="fu">colnames</span>(mine.data)[<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>class.name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Actinobacteria"      "Cytophagia"          "Flavobacteriia"     
 [4] "Sphingobacteriia"    "Nitrospira"          "Planctomycetia"     
 [7] "Alphaproteobacteria" "Betaproteobacteria"  "Deltaproteobacteria"
[10] "Gammaproteobacteria"</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>For Sample.name 1-S, use the as.numeric() function to convert its corresponding row to a vector. You should first exclude the 1-S in that row. Store this vector using an object named “abundance”.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb289"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" aria-hidden="true" tabindex="-1"></a>abundance <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'1-S'</span>, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb289-2"><a href="#cb289-2" aria-hidden="true" tabindex="-1"></a>abundance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 373871   8052      0      0      0   4553 143534 124454      0   8426</code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Combine the <code>Sample.name</code> 1-S, <code>class.name</code> vector, and <code>abundance</code> vector into a 10-row, 3-column (Sample.name , Class, Abundance) data.frame as shown in the table above.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb291"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb291-1"><a href="#cb291-1" aria-hidden="true" tabindex="-1"></a>df1s <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'1-S'</span>,</span>
<span id="cb291-2"><a href="#cb291-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb291-3"><a href="#cb291-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span>abundance)</span>
<span id="cb291-4"><a href="#cb291-4" aria-hidden="true" tabindex="-1"></a>df1s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sample.name               Class Abundance
1          1-S      Actinobacteria    373871
2          1-S          Cytophagia      8052
3          1-S      Flavobacteriia         0
4          1-S    Sphingobacteriia         0
5          1-S          Nitrospira         0
6          1-S      Planctomycetia      4553
7          1-S Alphaproteobacteria    143534
8          1-S  Betaproteobacteria    124454
9          1-S Deltaproteobacteria         0
10         1-S Gammaproteobacteria      8426</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Repeat question 6 and 7 for all Sample.name, and <code>rbind()</code> the results into a data frame named “mine.table”.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>df2s <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'2-S'</span>,</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'2-S'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>df3s <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'3-S'</span>,</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'3-S'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>df1m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'1-M'</span>,</span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'1-M'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a>df2m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'2-M'</span>,</span>
<span id="cb293-11"><a href="#cb293-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb293-12"><a href="#cb293-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'2-M'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb293-13"><a href="#cb293-13" aria-hidden="true" tabindex="-1"></a>df3m <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'3-M'</span>,</span>
<span id="cb293-14"><a href="#cb293-14" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb293-15"><a href="#cb293-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'3-M'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb293-16"><a href="#cb293-16" aria-hidden="true" tabindex="-1"></a>df2b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'2-B'</span>,</span>
<span id="cb293-17"><a href="#cb293-17" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb293-18"><a href="#cb293-18" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'2-B'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb293-19"><a href="#cb293-19" aria-hidden="true" tabindex="-1"></a>df3b <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Sample.name =</span> <span class="st">'3-B'</span>,</span>
<span id="cb293-20"><a href="#cb293-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Class=</span>class.name,</span>
<span id="cb293-21"><a href="#cb293-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Abundance=</span><span class="fu">as.numeric</span>(mine.data[mine.data<span class="sc">$</span>Sample.name <span class="sc">==</span> <span class="st">'3-B'</span>, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb293-22"><a href="#cb293-22" aria-hidden="true" tabindex="-1"></a>mine.table <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df1s, df2s, df3s, df1m, df2m, df3m, df2b, df3b)</span>
<span id="cb293-23"><a href="#cb293-23" aria-hidden="true" tabindex="-1"></a>mine.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sample.name               Class Abundance
1          1-S      Actinobacteria    373871
2          1-S          Cytophagia      8052
3          1-S      Flavobacteriia         0
4          1-S    Sphingobacteriia         0
5          1-S          Nitrospira         0
6          1-S      Planctomycetia      4553
7          1-S Alphaproteobacteria    143534
8          1-S  Betaproteobacteria    124454
9          1-S Deltaproteobacteria         0
10         1-S Gammaproteobacteria      8426
11         2-S      Actinobacteria    332856
12         2-S          Cytophagia     28561
13         2-S      Flavobacteriia         0
14         2-S    Sphingobacteriia     10013
15         2-S          Nitrospira         0
16         2-S      Planctomycetia     10008
17         2-S Alphaproteobacteria     70575
18         2-S  Betaproteobacteria    170161
19         2-S Deltaproteobacteria         0
20         2-S Gammaproteobacteria      9005
21         3-S      Actinobacteria    326695
22         3-S          Cytophagia     10468
23         3-S      Flavobacteriia         0
24         3-S    Sphingobacteriia      4918
25         3-S          Nitrospira         0
26         3-S      Planctomycetia         0
27         3-S Alphaproteobacteria    105890
28         3-S  Betaproteobacteria    187673
29         3-S Deltaproteobacteria         0
30         3-S Gammaproteobacteria     12935
31         1-M      Actinobacteria    409809
32         1-M          Cytophagia      4481
33         1-M      Flavobacteriia         0
34         1-M    Sphingobacteriia         0
35         1-M          Nitrospira         0
36         1-M      Planctomycetia         0
37         1-M Alphaproteobacteria    110746
38         1-M  Betaproteobacteria     87245
39         1-M Deltaproteobacteria         0
40         1-M Gammaproteobacteria      7025
41         2-M      Actinobacteria    319778
42         2-M          Cytophagia     15885
43         2-M      Flavobacteriia      5230
44         2-M    Sphingobacteriia      8274
45         2-M          Nitrospira         0
46         2-M      Planctomycetia         0
47         2-M Alphaproteobacteria     52504
48         2-M  Betaproteobacteria    146073
49         2-M Deltaproteobacteria         0
50         2-M Gammaproteobacteria    110825
51         3-M      Actinobacteria    445572
52         3-M          Cytophagia      7302
53         3-M      Flavobacteriia      6218
54         3-M    Sphingobacteriia      8284
55         3-M          Nitrospira         0
56         3-M      Planctomycetia         0
57         3-M Alphaproteobacteria     45000
58         3-M  Betaproteobacteria     91711
59         3-M Deltaproteobacteria         0
60         3-M Gammaproteobacteria     69452
61         2-B      Actinobacteria    128251
62         2-B          Cytophagia      4732
63         2-B      Flavobacteriia      5917
64         2-B    Sphingobacteriia         0
65         2-B          Nitrospira      4609
66         2-B      Planctomycetia     56836
67         2-B Alphaproteobacteria    133851
68         2-B  Betaproteobacteria     90204
69         2-B Deltaproteobacteria      4260
70         2-B Gammaproteobacteria     31956
71         3-B      Actinobacteria     96304
72         3-B          Cytophagia      5566
73         3-B      Flavobacteriia      6353
74         3-B    Sphingobacteriia         0
75         3-B          Nitrospira         0
76         3-B      Planctomycetia     67380
77         3-B Alphaproteobacteria     95580
78         3-B  Betaproteobacteria     85707
79         3-B Deltaproteobacteria         0
80         3-B Gammaproteobacteria    165572</code></pre>
</div>
</div>
<p>This can also be realized by</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>exp.long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(<span class="at">data =</span> exp.data, </span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(subject, treatment),</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a>                         <span class="at">names_to =</span> <span class="st">"gene"</span>, </span>
<span id="cb295-4"><a href="#cb295-4" aria-hidden="true" tabindex="-1"></a>                         <span class="at">values_to =</span> <span class="st">"expression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>better look of lables</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a>exp.heatmap <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.title.y =</span> <span class="fu">element_blank</span>(), <span class="co"># Remove the y-axis title</span></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>)) <span class="co"># Rotate the x-axis labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Now the data are ready - on to the plot!</p>
<ol start="9" type="1">
<li>To plot a heatmap, we are going to use the <code>ggplot2</code> package. Install and library <code>ggplot2</code>.</li>
</ol>
<p>For this plot, we are going to first create the heatmap object with the <code>ggplot</code> function, then print the plot. We create the object by assigning the output of the <code>ggplot</code> call to the variable <code>mine.heatmap</code>, then entering the name of this object to print it to the screen.</p>
<ul>
<li>Plot heatmap with x=Sample.name and y=Class. Fill the heatmap using Abundance value.</li>
<li>Choose right <code>geom_</code> function to perform heatmap</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mine.table, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sample.name,</span>
<span id="cb297-2"><a href="#cb297-2" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">y =</span> Class,</span>
<span id="cb297-3"><a href="#cb297-3" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">fill =</span> Abundance)) <span class="sc">+</span> </span>
<span id="cb297-4"><a href="#cb297-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="co"># use geom_tile to draw the heatmap</span></span>
<span id="cb297-5"><a href="#cb297-5" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="11" type="1">
<li>First let’s deal with a scaling issue. Most values are dark blue, but this is partly caused by the distribution of values - there are a few really high values in the Abundance column. We can transform the data for display by taking the square root of abundance and plotting that. To do this, we need to add another column to our data frame and update our call to ggplot to reference this new column, <code>Sqrt.abundance</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>mine.table<span class="sc">$</span>Sqrt.abundance <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mine.table<span class="sc">$</span>Abundance)</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mine.table, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sample.name,</span>
<span id="cb298-3"><a href="#cb298-3" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">y =</span> Class,</span>
<span id="cb298-4"><a href="#cb298-4" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">fill =</span> Sqrt.abundance)) <span class="sc">+</span></span>
<span id="cb298-5"><a href="#cb298-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb298-6"><a href="#cb298-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="at">label =</span> <span class="st">"Sample"</span>)</span>
<span id="cb298-7"><a href="#cb298-7" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="12" type="1">
<li>Change the shading so low values are light and high values are dark. Use white (#FFFFFF) for the low values and a dark blue (#012345) for high values. You can also pick whatever color you like.</li>
</ol>
<div class="sourceCode" id="cb299"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> mine.heatmap <span class="sc">+</span> <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"#FFFFFF"</span>, <span class="at">high=</span><span class="st">"#012345"</span>)</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="13" type="1">
<li>Add a title “Microbe Class Abundance” to this plot.</li>
</ol>
<div class="sourceCode" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> mine.heatmap <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">"Microbe Class Abundance"</span>)</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="14" type="1">
<li>Reverse the order of the y-axis, so ‘Actinobacteria’ is at the top. Use <code>rev()</code> function to get the reverse of the <code>levels</code> of the Class. Use the obtained character vector as the <code>limits</code> of <code>scale_y_discrete()</code> function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb301"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb301-1"><a href="#cb301-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> mine.heatmap <span class="sc">+</span> <span class="fu">scale_y_discrete</span>(<span class="at">limits=</span><span class="fu">rev</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(mine.table<span class="sc">$</span>Class))))</span>
<span id="cb301-2"><a href="#cb301-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="15" type="1">
<li>Use “geom_text()” to add abundance values on top of the heatmap. Maybe the text is too big to display on top of the heatmap? what can we do? Consider removing decimals and resizing the text.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="sc">+</span> <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Sqrt.abundance, <span class="dv">0</span>)), <span class="at">size=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="16" type="1">
<li>Congratulations on completing the above task, but you may have noticed that the x-axis Sample.name are not in the correct order. In fact, a good idea is to visualize different categories of data, we will learn this function next lab. But if you have some time, you may have a try by looking the help information of <code>facet_grid</code>.</li>
</ol>
<p>This approach, called “faceting” requires one additional layer to the plotting command called facet_grid. With <code>facet_grid</code> we indicate which column contains the categories we want to use for the plot. But before we do that, we need add <code>Depth</code> back to the data frame. For Sample.name %in% c(“1-S”, “2-S”, “3-S”), add Depth=0.5 in a new column named <code>Depth</code>; For Sample.name ends with M, add Depth=3.5; and 25 for those end with B.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb303"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb303-1"><a href="#cb303-1" aria-hidden="true" tabindex="-1"></a>mine.table<span class="sc">$</span>Depth <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb303-2"><a href="#cb303-2" aria-hidden="true" tabindex="-1"></a>mine.table[mine.table<span class="sc">$</span>Sample.name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1-S"</span>, <span class="st">"2-S"</span>, <span class="st">"3-S"</span>), <span class="st">'Depth'</span>] <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb303-3"><a href="#cb303-3" aria-hidden="true" tabindex="-1"></a>mine.table[mine.table<span class="sc">$</span>Sample.name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1-M"</span>, <span class="st">"2-M"</span>, <span class="st">"3-M"</span>), <span class="st">'Depth'</span>] <span class="ot">=</span> <span class="fl">3.5</span></span>
<span id="cb303-4"><a href="#cb303-4" aria-hidden="true" tabindex="-1"></a>mine.table[mine.table<span class="sc">$</span>Sample.name <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"2-B"</span>, <span class="st">"3-B"</span>), <span class="st">'Depth'</span>] <span class="ot">=</span> <span class="dv">25</span></span>
<span id="cb303-5"><a href="#cb303-5" aria-hidden="true" tabindex="-1"></a>mine.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Sample.name               Class Abundance Sqrt.abundance Depth
1          1-S      Actinobacteria    373871      611.44992   0.5
2          1-S          Cytophagia      8052       89.73294   0.5
3          1-S      Flavobacteriia         0        0.00000   0.5
4          1-S    Sphingobacteriia         0        0.00000   0.5
5          1-S          Nitrospira         0        0.00000   0.5
6          1-S      Planctomycetia      4553       67.47592   0.5
7          1-S Alphaproteobacteria    143534      378.85881   0.5
8          1-S  Betaproteobacteria    124454      352.78038   0.5
9          1-S Deltaproteobacteria         0        0.00000   0.5
10         1-S Gammaproteobacteria      8426       91.79325   0.5
11         2-S      Actinobacteria    332856      576.93674   0.5
12         2-S          Cytophagia     28561      169.00000   0.5
13         2-S      Flavobacteriia         0        0.00000   0.5
14         2-S    Sphingobacteriia     10013      100.06498   0.5
15         2-S          Nitrospira         0        0.00000   0.5
16         2-S      Planctomycetia     10008      100.03999   0.5
17         2-S Alphaproteobacteria     70575      265.65956   0.5
18         2-S  Betaproteobacteria    170161      412.50576   0.5
19         2-S Deltaproteobacteria         0        0.00000   0.5
20         2-S Gammaproteobacteria      9005       94.89468   0.5
21         3-S      Actinobacteria    326695      571.57239   0.5
22         3-S          Cytophagia     10468      102.31324   0.5
23         3-S      Flavobacteriia         0        0.00000   0.5
24         3-S    Sphingobacteriia      4918       70.12845   0.5
25         3-S          Nitrospira         0        0.00000   0.5
26         3-S      Planctomycetia         0        0.00000   0.5
27         3-S Alphaproteobacteria    105890      325.40744   0.5
28         3-S  Betaproteobacteria    187673      433.21242   0.5
29         3-S Deltaproteobacteria         0        0.00000   0.5
30         3-S Gammaproteobacteria     12935      113.73214   0.5
31         1-M      Actinobacteria    409809      640.16326   3.5
32         1-M          Cytophagia      4481       66.94027   3.5
33         1-M      Flavobacteriia         0        0.00000   3.5
34         1-M    Sphingobacteriia         0        0.00000   3.5
35         1-M          Nitrospira         0        0.00000   3.5
36         1-M      Planctomycetia         0        0.00000   3.5
37         1-M Alphaproteobacteria    110746      332.78522   3.5
38         1-M  Betaproteobacteria     87245      295.37265   3.5
39         1-M Deltaproteobacteria         0        0.00000   3.5
40         1-M Gammaproteobacteria      7025       83.81527   3.5
41         2-M      Actinobacteria    319778      565.48917   3.5
42         2-M          Cytophagia     15885      126.03571   3.5
43         2-M      Flavobacteriia      5230       72.31874   3.5
44         2-M    Sphingobacteriia      8274       90.96153   3.5
45         2-M          Nitrospira         0        0.00000   3.5
46         2-M      Planctomycetia         0        0.00000   3.5
47         2-M Alphaproteobacteria     52504      229.13751   3.5
48         2-M  Betaproteobacteria    146073      382.19498   3.5
49         2-M Deltaproteobacteria         0        0.00000   3.5
50         2-M Gammaproteobacteria    110825      332.90389   3.5
51         3-M      Actinobacteria    445572      667.51180   3.5
52         3-M          Cytophagia      7302       85.45174   3.5
53         3-M      Flavobacteriia      6218       78.85430   3.5
54         3-M    Sphingobacteriia      8284       91.01648   3.5
55         3-M          Nitrospira         0        0.00000   3.5
56         3-M      Planctomycetia         0        0.00000   3.5
57         3-M Alphaproteobacteria     45000      212.13203   3.5
58         3-M  Betaproteobacteria     91711      302.83824   3.5
59         3-M Deltaproteobacteria         0        0.00000   3.5
60         3-M Gammaproteobacteria     69452      263.53747   3.5
61         2-B      Actinobacteria    128251      358.12149  25.0
62         2-B          Cytophagia      4732       68.78953  25.0
63         2-B      Flavobacteriia      5917       76.92204  25.0
64         2-B    Sphingobacteriia         0        0.00000  25.0
65         2-B          Nitrospira      4609       67.88962  25.0
66         2-B      Planctomycetia     56836      238.40302  25.0
67         2-B Alphaproteobacteria    133851      365.85653  25.0
68         2-B  Betaproteobacteria     90204      300.33981  25.0
69         2-B Deltaproteobacteria      4260       65.26868  25.0
70         2-B Gammaproteobacteria     31956      178.76241  25.0
71         3-B      Actinobacteria     96304      310.32886  25.0
72         3-B          Cytophagia      5566       74.60563  25.0
73         3-B      Flavobacteriia      6353       79.70571  25.0
74         3-B    Sphingobacteriia         0        0.00000  25.0
75         3-B          Nitrospira         0        0.00000  25.0
76         3-B      Planctomycetia     67380      259.57658  25.0
77         3-B Alphaproteobacteria     95580      309.16015  25.0
78         3-B  Betaproteobacteria     85707      292.75758  25.0
79         3-B Deltaproteobacteria         0        0.00000  25.0
80         3-B Gammaproteobacteria    165572      406.90539  25.0</code></pre>
</div>
</div>
<ol start="17" type="1">
<li>Faceting the plot by <code>Depth</code>, set <code>scales</code> and <code>space</code> as <code>free</code> and add <code>x</code> to <code>switch</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb305"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a>mine.table<span class="sc">$</span>Sqrt.abundance <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(mine.table<span class="sc">$</span>Abundance)</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a>mine.heatmap <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> mine.table, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Sample.name,</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">y =</span> Class,</span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a>                                                        <span class="at">fill =</span> Sqrt.abundance)) <span class="sc">+</span></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>Depth, <span class="at">switch =</span> <span class="st">'x'</span>, <span class="at">scales=</span><span class="st">'free'</span>, <span class="at">space=</span><span class="st">'free'</span>) <span class="sc">+</span> </span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="at">label =</span> <span class="st">"Sample"</span>) <span class="sc">+</span> </span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low=</span><span class="st">"#FFFFFF"</span>, <span class="at">high=</span><span class="st">"#012345"</span>) <span class="sc">+</span> </span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="at">label =</span> <span class="st">"Microbe Class Abundance"</span>) <span class="sc">+</span> </span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits=</span><span class="fu">rev</span>(<span class="fu">levels</span>(<span class="fu">as.factor</span>(mine.table<span class="sc">$</span>Class)))) <span class="sc">+</span> </span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Sqrt.abundance, <span class="dv">0</span>)), <span class="at">size=</span><span class="dv">2</span>)</span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a>mine.heatmap</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(penguins, <span class="fu">aes</span>(<span class="at">x=</span>flipper_length_mm, <span class="at">y=</span>body_mass_g)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>bill_depth_mm, <span class="at">shape=</span>species), <span class="at">na.rm=</span>T) <span class="sc">+</span> <span class="fu">geom_smooth</span>(<span class="at">na.rm=</span>T, <span class="at">se=</span>F) <span class="sc">+</span> <span class="fu">scale_color_gradient2</span>(<span class="at">low=</span><span class="st">'yellow'</span>, <span class="at">mid=</span><span class="st">'green'</span>, <span class="at">high=</span><span class="st">'blue'</span>, <span class="at">midpoint =</span> <span class="dv">17</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">'Flipper length (millimeters)'</span>, <span class="at">y=</span><span class="st">'Body mass (grams)'</span>, <span class="at">color=</span><span class="st">'Bill depth (millimeters)'</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Faceting (make many panels of graphics where each panel represents the same relationship between variables, but something changes between each pane)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(iris, <span class="fu">aes</span>(<span class="at">x=</span>Sepal.Length, <span class="at">y=</span>Sepal.Width)) <span class="sc">+</span></span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(.<span class="sc">~</span>Species) <span class="co">#or facet_grid(Species~.)--Categorical variables of species will be vertical</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Another example</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    rename</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:Matrix':

    expand</code></pre>
</div>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(tips, <span class="at">package=</span><span class="st">'reshape'</span>)</span>
<span id="cb313-2"><a href="#cb313-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tips, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  total_bill  tip    sex smoker day   time size
1      16.99 1.01 Female     No Sun Dinner    2
2      10.34 1.66   Male     No Sun Dinner    3
3      21.01 3.50   Male     No Sun Dinner    3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tips, <span class="fu">aes</span>(<span class="at">x =</span> total_bill, <span class="at">y =</span> tip <span class="sc">/</span> total_bill)) <span class="sc">+</span></span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb315-3"><a href="#cb315-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>( smoker <span class="sc">~</span> day )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb316"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb316-1"><a href="#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 'free_y' means the scale of different panels are adjusted by themselves</span></span>
<span id="cb316-2"><a href="#cb316-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tips, <span class="fu">aes</span>(<span class="at">x =</span> total_bill, <span class="at">y =</span> tip <span class="sc">/</span> total_bill)) <span class="sc">+</span></span>
<span id="cb316-3"><a href="#cb316-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb316-4"><a href="#cb316-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> day, <span class="at">scales=</span><span class="st">'free_y'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-41-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log scales ---a wrapper of  scale_y_continuous() function , trans_new() function</span></span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ggplot(ACS, aes(x=Age, y=Income)) + geom_point() +</span></span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a><span class="co"># scale_y_log10(breaks=c(1, 10, 100),</span></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="co">#            minor=c(1:10,</span></span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                 seq(10, 100, by=10 ),</span></span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                seq(100, 1000, by=100))) +</span></span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a><span class="co">#  ylab('Income (1000s of dollars)')</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Multi-plot</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ChickWeight, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>weight, <span class="at">colour=</span>Diet, <span class="at">group=</span>Chick)) <span class="sc">+</span></span>
<span id="cb318-2"><a href="#cb318-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb318-3"><a href="#cb318-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Growth curve for individual chicks"</span>)</span>
<span id="cb318-4"><a href="#cb318-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Second plot</span></span>
<span id="cb318-5"><a href="#cb318-5" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ChickWeight, <span class="fu">aes</span>(<span class="at">x=</span>Time, <span class="at">y=</span>weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb318-6"><a href="#cb318-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha=</span>.<span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb318-7"><a href="#cb318-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_smooth</span>(<span class="at">alpha=</span>.<span class="dv">2</span>, <span class="at">linewidth=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb318-8"><a href="#cb318-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Fitted growth curve per diet"</span>)</span>
<span id="cb318-9"><a href="#cb318-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Third plot </span></span>
<span id="cb318-10"><a href="#cb318-10" aria-hidden="true" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="fu">subset</span>(ChickWeight, Time<span class="sc">==</span><span class="dv">21</span>), <span class="fu">aes</span>(<span class="at">x=</span>weight, <span class="at">colour=</span>Diet)) <span class="sc">+</span></span>
<span id="cb318-11"><a href="#cb318-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb318-12"><a href="#cb318-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggtitle</span>(<span class="st">"Final weight, by diet"</span>)</span>
<span id="cb318-13"><a href="#cb318-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-14"><a href="#cb318-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-15"><a href="#cb318-15" aria-hidden="true" tabindex="-1"></a><span class="co"># to realize:</span></span>
<span id="cb318-16"><a href="#cb318-16" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 plot2 plot2</span></span>
<span id="cb318-17"><a href="#cb318-17" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 plot2 plot2</span></span>
<span id="cb318-18"><a href="#cb318-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot1 plot3 plot3</span></span>
<span id="cb318-19"><a href="#cb318-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb318-20"><a href="#cb318-20" aria-hidden="true" tabindex="-1"></a>my.layout <span class="ot">=</span> <span class="fu">cbind</span>( <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>) ) <span class="co"># each c represents a column in a matrix and 1,2,3 represents p1,p2,p3</span></span>
<span id="cb318-21"><a href="#cb318-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: plyr</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>You have loaded plyr after dplyr - this is likely to cause problems.
If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
library(plyr); library(dplyr)</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>------------------------------------------------------------------------------</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:reshape':

    rename, round_any</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mosaic':

    count</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:dplyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize</code></pre>
</div>
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>Rmisc<span class="sc">::</span><span class="fu">multiplot</span>( p1, p2, p3, <span class="at">layout=</span>my.layout)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using method = 'loess' and formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb329"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OR library(ggpubr) https://rpkgs.datanovia.com/ggpubr/). </span></span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggpubr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:plyr':

    mutate</code></pre>
</div>
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Box plot (bp)</span></span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>bxp <span class="ot">&lt;-</span> <span class="fu">ggboxplot</span>(ToothGrowth, <span class="at">x =</span> <span class="st">"dose"</span>, <span class="at">y =</span> <span class="st">"len"</span>,</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"dose"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>)</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dot plot (dp)</span></span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>dp <span class="ot">&lt;-</span> <span class="fu">ggdotplot</span>(ToothGrowth, <span class="at">x =</span> <span class="st">"dose"</span>, <span class="at">y =</span> <span class="st">"len"</span>,</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"dose"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>, <span class="at">binwidth =</span> <span class="dv">1</span>)</span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>name <span class="ot">&lt;-</span> <span class="fu">rownames</span>(mtcars)</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>mtcars<span class="sc">$</span>cyl <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(mtcars<span class="sc">$</span>cyl)</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">ggbarplot</span>(mtcars, <span class="at">x =</span> <span class="st">"name"</span>, <span class="at">y =</span> <span class="st">"mpg"</span>,</span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">fill =</span> <span class="st">"cyl"</span>,               <span class="co"># change fill color by cyl</span></span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">"white"</span>,            <span class="co"># Set bar border colors to white</span></span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"jco"</span>,            <span class="co"># jco journal color palett. see ?ggpar</span></span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">sort.val =</span> <span class="st">"asc"</span>,           <span class="co"># Sort the value in ascending order</span></span>
<span id="cb332-14"><a href="#cb332-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">sort.by.groups =</span> <span class="cn">TRUE</span>,      <span class="co"># Sort inside each group</span></span>
<span id="cb332-15"><a href="#cb332-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">x.text.angle =</span> <span class="dv">90</span>           <span class="co"># Rotate vertically x axis texts</span></span>
<span id="cb332-16"><a href="#cb332-16" aria-hidden="true" tabindex="-1"></a>          ) <span class="sc">+</span> <span class="fu">font</span>(<span class="st">"x.text"</span>, <span class="at">size =</span> <span class="dv">8</span>)</span>
<span id="cb332-17"><a href="#cb332-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Scatter plots (sp)</span></span>
<span id="cb332-18"><a href="#cb332-18" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">ggscatter</span>(mtcars, <span class="at">x =</span> <span class="st">"wt"</span>, <span class="at">y =</span> <span class="st">"mpg"</span>,</span>
<span id="cb332-19"><a href="#cb332-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">add =</span> <span class="st">"reg.line"</span>,               <span class="co"># Add regression line</span></span>
<span id="cb332-20"><a href="#cb332-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">conf.int =</span> <span class="cn">TRUE</span>,                <span class="co"># Add confidence interval</span></span>
<span id="cb332-21"><a href="#cb332-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">color =</span> <span class="st">"cyl"</span>, <span class="at">palette =</span> <span class="st">"jco"</span>, <span class="co"># Color by groups "cyl"</span></span>
<span id="cb332-22"><a href="#cb332-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">shape =</span> <span class="st">"cyl"</span>                   <span class="co"># Change point shape by groups "cyl"</span></span>
<span id="cb332-23"><a href="#cb332-23" aria-hidden="true" tabindex="-1"></a>                ) <span class="sc">+</span> </span>
<span id="cb332-24"><a href="#cb332-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_cor</span>(<span class="fu">aes</span>(<span class="at">color =</span> cyl), <span class="at">label.x =</span> <span class="dv">3</span>)       <span class="co"># Add correlation coefficient</span></span>
<span id="cb332-25"><a href="#cb332-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-26"><a href="#cb332-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(bxp, dp, bp <span class="sc">+</span> <span class="fu">rremove</span>(<span class="st">"x.text"</span>),</span>
<span id="cb332-27"><a href="#cb332-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb332-28"><a href="#cb332-28" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-42-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Themes</span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Rmisc::multiplot( p1 + theme_bw(),          # Black and white</span></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                   p1 + theme_minimal(),   </span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                   p1 + theme_dark(),        </span></span>
<span id="cb333-5"><a href="#cb333-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                   p1 + theme_light(),</span></span>
<span id="cb333-6"><a href="#cb333-6" aria-hidden="true" tabindex="-1"></a><span class="co">#                   cols=2 )</span></span>
<span id="cb333-7"><a href="#cb333-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb333-8"><a href="#cb333-8" aria-hidden="true" tabindex="-1"></a><span class="co">#ggsave('p1.png', width=6, height=3, dpi=350)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-2348163751.png" class="img-fluid"></p>
<ul>
<li>data manipulation</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ lubridate 1.9.4     ✔ tibble    3.2.1
✔ purrr     1.0.2     ✔ tidyr     1.3.1
✔ readr     2.1.5     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ plyr::arrange()      masks dplyr::arrange()
✖ gridExtra::combine() masks dplyr::combine()
✖ purrr::compact()     masks plyr::compact()
✖ plyr::count()        masks mosaic::count(), dplyr::count()
✖ purrr::cross()       masks mosaic::cross()
✖ plyr::desc()         masks dplyr::desc()
✖ mosaic::do()         masks dplyr::do()
✖ tidyr::expand()      masks reshape::expand(), Matrix::expand()
✖ plyr::failwith()     masks dplyr::failwith()
✖ dplyr::filter()      masks stats::filter()
✖ plyr::id()           masks dplyr::id()
✖ dplyr::lag()         masks stats::lag()
✖ ggpubr::mutate()     masks plyr::mutate(), dplyr::mutate()
✖ tidyr::pack()        masks Matrix::pack()
✖ dplyr::recode()      masks car::recode()
✖ plyr::rename()       masks reshape::rename(), dplyr::rename()
✖ MASS::select()       masks dplyr::select()
✖ purrr::some()        masks car::some()
✖ lubridate::stamp()   masks reshape::stamp()
✖ mosaic::stat()       masks ggplot2::stat()
✖ plyr::summarise()    masks dplyr::summarise()
✖ plyr::summarize()    masks dplyr::summarize()
✖ mosaic::tally()      masks dplyr::tally()
✖ tidyr::unpack()      masks Matrix::unpack()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply</span></span>
<span id="cb336-2"><a href="#cb336-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize each column by calculating the mean.</span></span>
<span id="cb336-3"><a href="#cb336-3" aria-hidden="true" tabindex="-1"></a><span class="fu">apply</span>(iris[,<span class="sc">-</span><span class="dv">5</span>],        <span class="co"># what object do we want to apply the function to</span></span>
<span id="cb336-4"><a href="#cb336-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">MARGIN=</span><span class="dv">1</span>,    <span class="co"># rows = 1, columns = 2, (same order as [rows, cols]</span></span>
<span id="cb336-5"><a href="#cb336-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">FUN=</span>mean     <span class="co"># what function do we want to apply     </span></span>
<span id="cb336-6"><a href="#cb336-6" aria-hidden="true" tabindex="-1"></a>     ) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2.550 2.375 2.350 2.350 2.550 2.850 2.425 2.525 2.225 2.400</code></pre>
</div>
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>average <span class="ot">&lt;-</span> <span class="fu">apply</span>( </span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a>  iris[,<span class="sc">-</span><span class="dv">5</span>],        <span class="co"># what object do we want to apply the function to</span></span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">MARGIN=</span><span class="dv">2</span>,    <span class="co"># rows = 1, columns = 2, (same order as [rows, cols]</span></span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">FUN=</span>mean     <span class="co"># what function do we want to apply</span></span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">rbind</span>(iris[,<span class="sc">-</span><span class="dv">5</span>], average)</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width
1          5.1         3.5          1.4         0.2
2          4.9         3.0          1.4         0.2
3          4.7         3.2          1.3         0.2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are several variants of the apply() function, and the most frequently used ones are lapply() and sapply(). These two functions apply a given function to each element of a list or vector and returns a corresponding list or vector of results.</span></span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a><span class="co">#lapply</span></span>
<span id="cb340-4"><a href="#cb340-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">beta =</span> <span class="fu">exp</span>(<span class="sc">-</span><span class="dv">3</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">logic =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>,<span class="cn">FALSE</span>,<span class="cn">FALSE</span>,<span class="cn">TRUE</span>))</span>
<span id="cb340-5"><a href="#cb340-5" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
 [1]  1  2  3  4  5  6  7  8  9 10

$beta
[1]  0.04978707  0.13533528  0.36787944  1.00000000  2.71828183  7.38905610
[7] 20.08553692

$logic
[1]  TRUE FALSE FALSE  TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lapply</span>(x, quantile, <span class="at">probs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="co"># list </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$a
 25%  50%  75% 
3.25 5.50 7.75 

$beta
      25%       50%       75% 
0.2516074 1.0000000 5.0536690 

$logic
25% 50% 75% 
0.0 0.5 1.0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(x, quantile, <span class="at">probs =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="co"># matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       a      beta logic
25% 3.25 0.2516074   0.0
50% 5.50 1.0000000   0.5
75% 7.75 5.0536690   1.0</code></pre>
</div>
</div>
<p>A tibble, or tbl_df, is a modern reimagining of the data.frame, keeping what time has proven to be effective, and throwing out what is not. Tibbles are data.frames that are lazy and surly: they do less (i.e.&nbsp;they don t change variable names or types, and don t do partial matching) and complain more (e.g.&nbsp;when a variable does not exist). This forces you to confront problems earlier, typically leading to cleaner, more expressive code. Tibbles also have an enhanced print() method which makes them easier to use with large datasets containing complex objects.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">a =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">b =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">c =</span> <span class="fu">Sys.Date</span>() <span class="sc">-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  a b          c
1 1 a 2025-05-29
2 2 b 2025-05-28
3 3 c 2025-05-27</code></pre>
</div>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 3
      a b     c         
  &lt;int&gt; &lt;chr&gt; &lt;date&gt;    
1     1 a     2025-05-29
2     2 b     2025-05-28
3     3 c     2025-05-27</code></pre>
</div>
</div>
<ul>
<li>%&gt;%</li>
</ul>
<p>For example, if we wanted to start with x, and first apply function f(), then g(), and then h(), the usual R command would be h(g(f(x))) which is hard to read because you have to start reading at the innermost set of parentheses. Using the pipe command %&gt;%, this sequence of operations becomes x %&gt;% f() %&gt;% g() %&gt;% h().</p>
<ul>
<li>select</li>
</ul>
<div class="sourceCode" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Correct usage of select() within a pipeline</span></span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">ends_with</span>(<span class="st">'color'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>filter</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where species is "Droid" and mass is greater than or equal to 100</span></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span> <span class="fu">filter</span>(species <span class="sc">==</span> <span class="st">"Droid"</span>, mass <span class="sc">&lt;</span> <span class="dv">100</span>)</span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(filtered_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name  height  mass hair_color skin_color  eye_color birth_year sex   gender   
  &lt;chr&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;       &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    
1 C-3PO    167    75 &lt;NA&gt;       gold        yellow           112 none  masculine
2 R2-D2     96    32 &lt;NA&gt;       white, blue red               33 none  masculine
3 R5-D4     97    32 &lt;NA&gt;       white, red  red               NA none  masculine
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<ul>
<li>slice</li>
</ul>
<p>filter rows based on row number:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb353"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">slice</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 C-3PO        167    75 &lt;NA&gt;       gold       yellow         112   none  mascu…
2 R2-D2         96    32 &lt;NA&gt;       white, bl… red             33   none  mascu…
3 Darth Va…    202   136 none       white      yellow          41.9 male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
</div>
<ul>
<li>arrange</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(name)) <span class="co">#The default sorting is in ascending order</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 14
   name     height  mass hair_color skin_color eye_color birth_year sex   gender
   &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
 1 Zam Wes…    168    55 blonde     fair, gre… yellow            NA fema… femin…
 2 Yoda         66    17 white      green      brown            896 male  mascu…
 3 Yarael …    264    NA none       white      yellow            NA male  mascu…
 4 Wilhuff…    180    NA auburn, g… fair       blue              64 male  mascu…
 5 Wicket …     88    20 brown      brown      brown              8 male  mascu…
 6 Wedge A…    170    77 brown      fair       hazel             21 male  mascu…
 7 Watto       137    NA black      blue, grey yellow            NA male  mascu…
 8 Wat Tam…    193    48 none       green, gr… unknown           NA male  mascu…
 9 Tion Me…    206    80 none       grey       black             NA male  mascu…
10 Taun We     213    NA none       grey       black             NA fema… femin…
# ℹ 77 more rows
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(height)) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 14
  name      height  mass hair_color skin_color eye_color birth_year sex   gender
  &lt;chr&gt;      &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; 
1 Yarael P…    264    NA none       white      yellow            NA male  mascu…
2 Tarfful      234   136 brown      brown      blue              NA male  mascu…
3 Lama Su      229    88 none       grey       black             NA male  mascu…
# ℹ 5 more variables: homeworld &lt;chr&gt;, species &lt;chr&gt;, films &lt;list&gt;,
#   vehicles &lt;list&gt;, starships &lt;list&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Trt =</span> <span class="fu">factor</span>(<span class="fu">c</span>(<span class="st">"High"</span>, <span class="st">"Med"</span>, <span class="st">"High"</span>, <span class="st">"Low"</span>),        </span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Low"</span>, <span class="st">"Med"</span>, <span class="st">"High"</span>)), <span class="co"># level</span></span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">9</span>),      </span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)) </span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>dd <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Trt, <span class="fu">desc</span>(y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Trt y z
1  Low 9 2
2  Med 3 1
3 High 9 1
4 High 8 1</code></pre>
</div>
</div>
<ul>
<li>mutate</li>
</ul>
<div class="sourceCode" id="cb361"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb361-1"><a href="#cb361-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select using the old columns</span></span>
<span id="cb361-2"><a href="#cb361-2" aria-hidden="true" tabindex="-1"></a>starwars<span class="sc">$</span>bmi <span class="ot">=</span> starwars<span class="sc">$</span>mass <span class="sc">/</span> ((starwars<span class="sc">$</span>height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>)</span>
<span id="cb361-3"><a href="#cb361-3" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, bmi) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb361-4"><a href="#cb361-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-5"><a href="#cb361-5" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate avoids all the starwars$</span></span>
<span id="cb361-6"><a href="#cb361-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-7"><a href="#cb361-7" aria-hidden="true" tabindex="-1"></a>starwars<span class="sc">$</span>bmi <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb361-8"><a href="#cb361-8" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> </span>
<span id="cb361-9"><a href="#cb361-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">bmi =</span> mass <span class="sc">/</span> ((height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>)) <span class="sc">%&gt;%</span>  </span>
<span id="cb361-10"><a href="#cb361-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, bmi) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb361-11"><a href="#cb361-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-12"><a href="#cb361-12" aria-hidden="true" tabindex="-1"></a><span class="co"># mutate_at() and mutate_if() allow us to apply a function to a particular column and save the output.</span></span>
<span id="cb361-13"><a href="#cb361-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-14"><a href="#cb361-14" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> starwars <span class="sc">%&gt;%</span> </span>
<span id="cb361-15"><a href="#cb361-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">square_height =</span> (height <span class="sc">/</span> <span class="dv">100</span>) <span class="sc">^</span> <span class="dv">2</span>,</span>
<span id="cb361-16"><a href="#cb361-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">bmi =</span> mass <span class="sc">/</span> square_height) <span class="sc">%&gt;%</span></span>
<span id="cb361-17"><a href="#cb361-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(name, square_height, bmi)</span>
<span id="cb361-18"><a href="#cb361-18" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb361-19"><a href="#cb361-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-20"><a href="#cb361-20" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">mutate_if</span>(is.numeric, round, <span class="at">digits=</span><span class="dv">0</span>) <span class="co"># here, is.numeric is the condition</span></span>
<span id="cb361-21"><a href="#cb361-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-22"><a href="#cb361-22" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">mutate_at</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, round, <span class="at">digits=</span><span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">head</span>() <span class="co"># column 2 3</span></span>
<span id="cb361-23"><a href="#cb361-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-24"><a href="#cb361-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the transformation to columns 2 and 3 for rows 1 to 3</span></span>
<span id="cb361-25"><a href="#cb361-25" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> subset <span class="sc">%&gt;%</span> </span>
<span id="cb361-26"><a href="#cb361-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_at</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="sc">~</span><span class="fu">ifelse</span>(<span class="fu">row_number</span>() <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="fu">round</span>(., <span class="at">digits =</span> <span class="dv">0</span>), .))</span>
<span id="cb361-27"><a href="#cb361-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb361-28"><a href="#cb361-28" aria-hidden="true" tabindex="-1"></a>subset <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">avg.example =</span> <span class="fu">select</span>(., square_height<span class="sc">:</span>bmi) <span class="sc">%&gt;%</span> <span class="fu">rowMeans</span>())</span>
<span id="cb361-29"><a href="#cb361-29" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>summarise</li>
</ul>
<p>This function is used to create a summary table. It reduces the data frame to a single row containing summary statistics.</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">mean.height=</span><span class="fu">mean</span>(height, <span class="at">na.rm=</span>T), <span class="at">sd.height=</span><span class="fu">sd</span>(height, <span class="at">na.rm=</span>T))</span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a><span class="co"># apply the same statistic to each column</span></span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">select</span>(height<span class="sc">:</span>mass) <span class="sc">%&gt;%</span> <span class="fu">summarise_all</span>(<span class="fu">list</span>(<span class="at">min=</span>min, <span class="at">max=</span>max), <span class="at">na.rm=</span>T)</span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a>starwars <span class="sc">%&gt;%</span> <span class="fu">summarise_if</span>(is.numeric, <span class="fu">list</span>(<span class="at">min=</span>min, <span class="at">max=</span>max), <span class="at">na.rm =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>group_by</li>
</ul>
<div class="sourceCode" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(penguins<span class="sc">$</span>sex, penguins<span class="sc">$</span>species)</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb363-6"><a href="#cb363-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb363-7"><a href="#cb363-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span>           </span>
<span id="cb363-8"><a href="#cb363-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), </span>
<span id="cb363-9"><a href="#cb363-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean.flipper =</span> <span class="fu">mean</span>(flipper_length_mm),</span>
<span id="cb363-10"><a href="#cb363-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd.flipper =</span> <span class="fu">sd</span>(flipper_length_mm),</span>
<span id="cb363-11"><a href="#cb363-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups=</span><span class="st">'keep'</span>) <span class="sc">%&gt;%</span></span>
<span id="cb363-12"><a href="#cb363-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb363-13"><a href="#cb363-13" aria-hidden="true" tabindex="-1"></a>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>the comparison between whether to use %&gt;% or not</li>
</ul>
<div class="sourceCode" id="cb364"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb364-1"><a href="#cb364-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %&gt;% </span></span>
<span id="cb364-2"><a href="#cb364-2" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">%&gt;%</span> </span>
<span id="cb364-3"><a href="#cb364-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sex)) <span class="sc">%&gt;%</span></span>
<span id="cb364-4"><a href="#cb364-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sex, species) <span class="sc">%&gt;%</span>           </span>
<span id="cb364-5"><a href="#cb364-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Sum.Sq.Cells =</span> (flipper_length_mm <span class="sc">-</span> <span class="fu">mean</span>(flipper_length_mm))<span class="sc">^</span><span class="dv">2</span>)  <span class="sc">%&gt;%</span>  </span>
<span id="cb364-6"><a href="#cb364-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(sex, species, flipper_length_mm, Sum.Sq.Cells) <span class="sc">%&gt;%</span> <span class="fu">head</span>()</span>
<span id="cb364-7"><a href="#cb364-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb364-8"><a href="#cb364-8" aria-hidden="true" tabindex="-1"></a><span class="co"># not use %&gt;% </span></span>
<span id="cb364-9"><a href="#cb364-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(</span>
<span id="cb364-10"><a href="#cb364-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">mutate</span>(<span class="fu">group_by</span>(<span class="fu">filter</span>(penguins, <span class="sc">!</span><span class="fu">is.na</span>(sex)), sex, species),</span>
<span id="cb364-11"><a href="#cb364-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">Sum.Sq.Cells =</span> (flipper_length_mm <span class="sc">-</span> <span class="fu">mean</span>(flipper_length_mm))<span class="sc">^</span><span class="dv">2</span>),</span>
<span id="cb364-12"><a href="#cb364-12" aria-hidden="true" tabindex="-1"></a>       sex, species, flipper_length_mm, Sum.Sq.Cells))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nycflights13)</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(nycflights13<span class="sc">::</span>flights)</span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the order of group_by and summarize matters</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(carrier) <span class="sc">%&gt;%</span> </span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(avg_dep_delay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="13" type="1">
<li>Find the flight with the longest departure delay among flights from the same origin and destination (use <code>filter()</code>). Relocate the origin, destination, and departure delay to the first three columns and sort by origin and dest.</li>
</ol>
<div class="sourceCode" id="cb366"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb366-1"><a href="#cb366-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb366-2"><a href="#cb366-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb366-3"><a href="#cb366-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin, dest) <span class="sc">%&gt;%</span> </span>
<span id="cb366-4"><a href="#cb366-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(dep_delay <span class="sc">==</span> <span class="fu">max</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb366-5"><a href="#cb366-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(origin, dest, dep_delay) <span class="sc">%&gt;%</span> </span>
<span id="cb366-6"><a href="#cb366-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(origin, dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="14" type="1">
<li>Find the flight with the longest departure delay among flights from the same origin and destination (use <code>top_n()</code> or <code>slice_max()</code>). Relocate the origin, destination, and departure delay to the first three columns and sort by origin and dest.</li>
</ol>
<div class="sourceCode" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb367-2"><a href="#cb367-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dep_delay)) <span class="sc">%&gt;%</span> </span>
<span id="cb367-3"><a href="#cb367-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(origin, dest) <span class="sc">%&gt;%</span> </span>
<span id="cb367-4"><a href="#cb367-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">top_n</span>(<span class="dv">1</span>, dep_delay) <span class="sc">%&gt;%</span>  <span class="co"># or using slice_max(dep_delay) %&gt;% </span></span>
<span id="cb367-5"><a href="#cb367-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">relocate</span>(origin, dest, dep_delay) <span class="sc">%&gt;%</span> </span>
<span id="cb367-6"><a href="#cb367-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(origin, dest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="15" type="1">
<li>How do departure delays vary at different times of the day? Summarize the averaged departure delays by hours and create an new column named as <code>dep_delay_level</code> which <code>cut()</code> the averaged departure delays into three levels (low, median, and high).</li>
</ol>
<div class="sourceCode" id="cb368"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour) <span class="sc">%&gt;%</span> </span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dep_delay_level =</span> <span class="fu">cut</span>(avg_dep_delay, <span class="at">breaks=</span><span class="dv">3</span>, <span class="fu">c</span>(<span class="st">'low'</span>, <span class="st">'median'</span>, <span class="st">'high'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="16" type="1">
<li>How do departure delays vary at different times of the day? Illustrate your answer with a <code>geom_smooth()</code> plot.</li>
</ol>
<div class="sourceCode" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a>flights <span class="sc">%&gt;%</span> </span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(hour) <span class="sc">%&gt;%</span> </span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_dep_delay =</span> <span class="fu">mean</span>(dep_delay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb369-4"><a href="#cb369-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hour, <span class="at">y =</span> avg_dep_delay)) <span class="sc">+</span> <span class="fu">geom_smooth</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ways to deleter the blanks</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a>students <span class="sc">%&gt;%</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">student_id =</span> <span class="st">`</span><span class="at">Student ID</span><span class="st">`</span>,</span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">full_name =</span> <span class="st">`</span><span class="at">Full Name</span><span class="st">`</span></span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">head</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a><span class="fu">read_csv</span>(</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"# A comment I want to skip</span></span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a><span class="st">  x,y,z</span></span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a><span class="st">  1,2,3"</span>,</span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">comment =</span> <span class="st">"#"</span></span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb372"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb372-1"><a href="#cb372-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb372-2"><a href="#cb372-2" aria-hidden="true" tabindex="-1"></a>grade.book <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb372-3"><a href="#cb372-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">name=</span><span class="st">'Alison'</span>,  <span class="at">HW.1=</span><span class="dv">8</span>, <span class="at">HW.2=</span><span class="dv">5</span>, <span class="at">HW.3=</span><span class="dv">8</span>, <span class="at">HW.4=</span><span class="dv">4</span>),</span>
<span id="cb372-4"><a href="#cb372-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">name=</span><span class="st">'Brandon'</span>, <span class="at">HW.1=</span><span class="dv">5</span>, <span class="at">HW.2=</span><span class="dv">3</span>, <span class="at">HW.3=</span><span class="dv">6</span>, <span class="at">HW.4=</span><span class="dv">9</span>),</span>
<span id="cb372-5"><a href="#cb372-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">name=</span><span class="st">'Charles'</span>, <span class="at">HW.1=</span><span class="dv">9</span>, <span class="at">HW.2=</span><span class="dv">7</span>, <span class="at">HW.3=</span><span class="dv">9</span>, <span class="at">HW.4=</span><span class="dv">10</span>))</span>
<span id="cb372-6"><a href="#cb372-6" aria-hidden="true" tabindex="-1"></a>grade.book</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     name HW.1 HW.2 HW.3 HW.4
1  Alison    8    5    8    4
2 Brandon    5    3    6    9
3 Charles    9    7    9   10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a>tidy.scores <span class="ot">&lt;-</span> grade.book <span class="sc">%&gt;%</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"HW"</span>),</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="st">"Homework"</span>,</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"Score"</span></span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>tidy.scores</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 3
   name    Homework Score
   &lt;chr&gt;   &lt;chr&gt;    &lt;dbl&gt;
 1 Alison  HW.1         8
 2 Alison  HW.2         5
 3 Alison  HW.3         8
 4 Alison  HW.4         4
 5 Brandon HW.1         5
 6 Brandon HW.2         3
 7 Brandon HW.3         6
 8 Brandon HW.4         9
 9 Charles HW.1         9
10 Charles HW.2         7
11 Charles HW.3         9
12 Charles HW.4        10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb376"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb376-1"><a href="#cb376-1" aria-hidden="true" tabindex="-1"></a>tidy.scores <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from=</span>Homework, <span class="at">values_from=</span>Score)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  name     HW.1  HW.2  HW.3  HW.4
  &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 Alison      8     5     8     4
2 Brandon     5     3     6     9
3 Charles     9     7     9    10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="co"># table joins</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>Fish.Data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lake_ID =</span> <span class="fu">c</span>(<span class="st">'A'</span>,<span class="st">'A'</span>,<span class="st">'B'</span>,<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'C'</span>), </span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Fish.Weight=</span><span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean=</span><span class="dv">260</span>, <span class="at">sd=</span><span class="dv">25</span>) ) <span class="co"># make up some data</span></span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>Fish.Data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Lake_ID Fish.Weight
  &lt;chr&gt;         &lt;dbl&gt;
1 A              237.
2 A              247.
3 B              262.
4 B              245.
5 C              300.
6 C              278.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a>Lake.Data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb380-2"><a href="#cb380-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lake_ID =</span> <span class="fu">c</span>(<span class="st">'B'</span>,<span class="st">'C'</span>,<span class="st">'D'</span>),   </span>
<span id="cb380-3"><a href="#cb380-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Lake_Name =</span> <span class="fu">c</span>(<span class="st">'Lake Elaine'</span>, <span class="st">'Mormon Lake'</span>, <span class="st">'Lake Mary'</span>),   </span>
<span id="cb380-4"><a href="#cb380-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">pH=</span><span class="fu">c</span>(<span class="fl">6.5</span>, <span class="fl">6.3</span>, <span class="fl">6.1</span>),</span>
<span id="cb380-5"><a href="#cb380-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">area =</span> <span class="fu">c</span>(<span class="dv">40</span>, <span class="dv">210</span>, <span class="dv">240</span>),</span>
<span id="cb380-6"><a href="#cb380-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">avg_depth =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">38</span>))</span>
<span id="cb380-7"><a href="#cb380-7" aria-hidden="true" tabindex="-1"></a>Lake.Data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  Lake_ID Lake_Name      pH  area avg_depth
  &lt;chr&gt;   &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 B       Lake Elaine   6.5    40         8
2 C       Mormon Lake   6.3   210        10
3 D       Lake Mary     6.1   240        38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb382"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb382-1"><a href="#cb382-1" aria-hidden="true" tabindex="-1"></a><span class="fu">full_join</span>(Fish.Data, Lake.Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Lake_ID)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7 × 6
  Lake_ID Fish.Weight Lake_Name      pH  area avg_depth
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 A              237. &lt;NA&gt;         NA      NA        NA
2 A              247. &lt;NA&gt;         NA      NA        NA
3 B              262. Lake Elaine   6.5    40         8
4 B              245. Lake Elaine   6.5    40         8
5 C              300. Mormon Lake   6.3   210        10
6 C              278. Mormon Lake   6.3   210        10
7 D               NA  Lake Mary     6.1   240        38</code></pre>
</div>
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(Fish.Data, Lake.Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Lake_ID)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
  Lake_ID Fish.Weight Lake_Name      pH  area avg_depth
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 A              237. &lt;NA&gt;         NA      NA        NA
2 A              247. &lt;NA&gt;         NA      NA        NA
3 B              262. Lake Elaine   6.5    40         8
4 B              245. Lake Elaine   6.5    40         8
5 C              300. Mormon Lake   6.3   210        10
6 C              278. Mormon Lake   6.3   210        10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(Fish.Data, Lake.Data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(Lake_ID)`</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  Lake_ID Fish.Weight Lake_Name      pH  area avg_depth
  &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
1 B              262. Lake Elaine   6.5    40         8
2 B              245. Lake Elaine   6.5    40         8
3 C              300. Mormon Lake   6.3   210        10
4 C              278. Mormon Lake   6.3   210        10</code></pre>
</div>
</div>
<div class="sourceCode" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(</span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">week =</span> <span class="fu">parse_number</span>(week)</span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>how many data points are in the data set</p>
<div class="sourceCode" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a>gender_year <span class="ot">&lt;-</span> Survey <span class="sc">%&gt;%</span> </span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sex, Year) <span class="sc">%&gt;%</span> </span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb392-5"><a href="#cb392-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">nu=</span>n)</span>
<span id="cb392-6"><a href="#cb392-6" aria-hidden="true" tabindex="-1"></a>gender_year</span>
<span id="cb392-7"><a href="#cb392-7" aria-hidden="true" tabindex="-1"></a>gender_year <span class="sc">%&gt;%</span> <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Year, <span class="at">values_from =</span> nu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb393"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb393-1"><a href="#cb393-1" aria-hidden="true" tabindex="-1"></a>who2 <span class="sc">%&gt;%</span> </span>
<span id="cb393-2"><a href="#cb393-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">3</span>)</span>
<span id="cb393-3"><a href="#cb393-3" aria-hidden="true" tabindex="-1"></a>who2 <span class="ot">&lt;-</span> who2 <span class="sc">%&gt;%</span> </span>
<span id="cb393-4"><a href="#cb393-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(</span>
<span id="cb393-5"><a href="#cb393-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">cols =</span> <span class="sc">!</span>(country<span class="sc">:</span>year), </span>
<span id="cb393-6"><a href="#cb393-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"diagnosis"</span>, <span class="st">"gender"</span>, <span class="st">"age"</span>), </span>
<span id="cb393-7"><a href="#cb393-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_sep =</span> <span class="st">"_"</span>,</span>
<span id="cb393-8"><a href="#cb393-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_to =</span> <span class="st">"count"</span></span>
<span id="cb393-9"><a href="#cb393-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb393-10"><a href="#cb393-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(count))</span>
<span id="cb393-11"><a href="#cb393-11" aria-hidden="true" tabindex="-1"></a>who2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(feb14_VX, airports, <span class="at">by=</span><span class="fu">c</span>(<span class="st">'dest'</span><span class="ot">=</span><span class="st">'faa'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb395"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb395-1"><a href="#cb395-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb395-2"><a href="#cb395-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb395-3"><a href="#cb395-3" aria-hidden="true" tabindex="-1"></a>drug_prop <span class="ot">&lt;-</span> drug_prop <span class="sc">%&gt;%</span> </span>
<span id="cb395-4"><a href="#cb395-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(class <span class="sc">==</span> <span class="st">'Carboxylic acids and derivatives'</span>) </span>
<span id="cb395-5"><a href="#cb395-5" aria-hidden="true" tabindex="-1"></a>drug_prop <span class="sc">%&gt;%</span> </span>
<span id="cb395-6"><a href="#cb395-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(logP, logS, water_solubility) <span class="sc">%&gt;%</span> </span>
<span id="cb395-7"><a href="#cb395-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairs.panels</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>for loop</li>
</ul>
<div class="sourceCode" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a>F <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">10</span>)        </span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a>F[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>             </span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a>F[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span>              </span>
<span id="cb396-4"><a href="#cb396-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">'F = '</span>, F, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>) </span>
<span id="cb396-5"><a href="#cb396-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-6"><a href="#cb396-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>( n <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">10</span> ){</span>
<span id="cb396-7"><a href="#cb396-7" aria-hidden="true" tabindex="-1"></a>  F[n] <span class="ot">&lt;-</span> F[n<span class="dv">-1</span>] <span class="sc">+</span> F[n<span class="dv">-2</span>]</span>
<span id="cb396-8"><a href="#cb396-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">'F = '</span>, F, <span class="st">'</span><span class="sc">\n</span><span class="st">'</span>)    </span>
<span id="cb396-9"><a href="#cb396-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>bootstrap estimate of a sampling distribution</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb397"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb397-1"><a href="#cb397-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb397-2"><a href="#cb397-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb397-3"><a href="#cb397-3" aria-hidden="true" tabindex="-1"></a>SampDist <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb397-4"><a href="#cb397-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb397-5"><a href="#cb397-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>){</span>
<span id="cb397-6"><a href="#cb397-6" aria-hidden="true" tabindex="-1"></a>  SampDist <span class="ot">&lt;-</span> trees <span class="sc">%&gt;%</span> </span>
<span id="cb397-7"><a href="#cb397-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">slice_sample</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">replace =</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb397-8"><a href="#cb397-8" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">xbar=</span><span class="fu">mean</span>(Height)) <span class="sc">%&gt;%</span> </span>
<span id="cb397-9"><a href="#cb397-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rbind</span>(SampDist)</span>
<span id="cb397-10"><a href="#cb397-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb397-11"><a href="#cb397-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(SampDist,<span class="fu">aes</span>(<span class="at">x=</span>xbar)) <span class="sc">+</span></span>
<span id="cb397-12"><a href="#cb397-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="ellipses" class="level2">
<h2 class="anchored" data-anchor-id="ellipses">Ellipses</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb399"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb399-1"><a href="#cb399-1" aria-hidden="true" tabindex="-1"></a><span class="co"># a function that draws the regression line and confidence interval</span></span>
<span id="cb399-2"><a href="#cb399-2" aria-hidden="true" tabindex="-1"></a><span class="co"># notice it doesn't return anything, all it does is draw a plot</span></span>
<span id="cb399-3"><a href="#cb399-3" aria-hidden="true" tabindex="-1"></a>show.lm <span class="ot">&lt;-</span> <span class="cf">function</span>(m, <span class="at">interval.type=</span><span class="st">'confidence'</span>, <span class="at">fill.col=</span><span class="st">'light grey'</span>, ...){</span>
<span id="cb399-4"><a href="#cb399-4" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> m<span class="sc">$</span>model[,<span class="dv">2</span>]       <span class="co"># extract the predictor variable</span></span>
<span id="cb399-5"><a href="#cb399-5" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> m<span class="sc">$</span>model[,<span class="dv">1</span>]       <span class="co"># extract the response</span></span>
<span id="cb399-6"><a href="#cb399-6" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, <span class="at">interval=</span>interval.type)</span>
<span id="cb399-7"><a href="#cb399-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(x, y, ...)</span>
<span id="cb399-8"><a href="#cb399-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>( <span class="fu">c</span>(x,<span class="fu">rev</span>(x)),                         <span class="co"># draw the ribbon defined</span></span>
<span id="cb399-9"><a href="#cb399-9" aria-hidden="true" tabindex="-1"></a>           <span class="fu">c</span>(pred[,<span class="st">'lwr'</span>], <span class="fu">rev</span>(pred[,<span class="st">'upr'</span>])),  <span class="co"># by lwr and upr - polygon</span></span>
<span id="cb399-10"><a href="#cb399-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">col=</span><span class="st">'light grey'</span>)                    <span class="co"># fills in the region defined by            </span></span>
<span id="cb399-11"><a href="#cb399-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, pred[, <span class="st">'fit'</span>])                       <span class="co"># a set of vertices, need to reverse            </span></span>
<span id="cb399-12"><a href="#cb399-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x, y)                                  <span class="co"># the uppers to make a nice figure</span></span>
<span id="cb399-13"><a href="#cb399-13" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="copy-of-x" class="level1">
<h1>copy of x</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a>example.func <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(x)</span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (k <span class="sc">&gt;</span> <span class="dv">1</span>){</span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(x)</span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb400-8"><a href="#cb400-8" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb400-9"><a href="#cb400-9" aria-hidden="true" tabindex="-1"></a><span class="fu">example.func</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3 4 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>x <span class="co"># x is changed inside the function but not outsied the function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 1 5 4 2</code></pre>
</div>
</div>
</section>
<section id="lab-10" class="level1">
<h1>LAB 10</h1>
<section id="part-1" class="level2">
<h2 class="anchored" data-anchor-id="part-1">Part 1</h2>
<ol type="1">
<li>Load the <code>bloodpress.txt</code></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a>bloodpress <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"bloodpress.txt"</span>, <span class="at">header=</span>T)</span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a>bloodpress</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Pt  BP Age Weight  BSA  Dur Pulse Stress
1   1 105  47   85.4 1.75  5.1    63     33
2   2 115  49   94.2 2.10  3.8    70     14
3   3 116  49   95.3 1.98  8.2    72     10
4   4 117  50   94.7 2.01  5.8    73     99
5   5 112  51   89.4 1.89  7.0    72     95
6   6 121  48   99.5 2.25  9.3    71     10
7   7 121  49   99.8 2.25  2.5    69     42
8   8 110  47   90.9 1.90  6.2    66      8
9   9 110  49   89.2 1.83  7.1    69     62
10 10 114  48   92.7 2.07  5.6    64     35
11 11 114  47   94.4 2.07  5.3    74     90
12 12 115  49   94.1 1.98  5.6    71     21
13 13 114  50   91.6 2.05 10.2    68     47
14 14 106  45   87.1 1.92  5.6    67     80
15 15 125  52  101.3 2.19 10.0    76     98
16 16 114  46   94.5 1.98  7.4    69     95
17 17 106  46   87.0 1.87  3.6    62     18
18 18 113  46   94.5 1.90  4.3    70     12
19 19 110  48   90.5 1.88  9.0    71     99
20 20 122  56   95.7 2.09  7.0    75     99</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Use <code>pairs.panels()</code> function from <code>psych</code> pacakge to draw scatterplots, histograms, and calculate correlations between variables.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'psych'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:gtools':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:mosaic':

    logit, rescale</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:car':

    logit</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:ggplot2':

    %+%, alpha</code></pre>
</div>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(bloodpress[, <span class="sc">-</span><span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Fit a simple linear regression model of BP vs Stress. Is Stress significant?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb413"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb413-1"><a href="#cb413-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Stress, <span class="at">data=</span>bloodpress)</span>
<span id="cb413-2"><a href="#cb413-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Stress, data = bloodpress)

Residuals:
    Min      1Q  Median      3Q     Max 
-8.6394 -3.3014  0.0722  2.2181  9.9287 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 112.71997    2.19345  51.389   &lt;2e-16 ***
Stress        0.02399    0.03404   0.705     0.49    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.502 on 18 degrees of freedom
Multiple R-squared:  0.02686,   Adjusted R-squared:  -0.0272 
F-statistic: 0.4969 on 1 and 18 DF,  p-value: 0.4899</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Fit a simple linear regression model of BP vs Weight.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb415"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb415-1"><a href="#cb415-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Weight, <span class="at">data=</span>bloodpress)</span>
<span id="cb415-2"><a href="#cb415-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Weight, data = bloodpress)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.6933 -0.9318 -0.4935  0.7703  4.8656 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  2.20531    8.66333   0.255    0.802    
Weight       1.20093    0.09297  12.917 1.53e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.74 on 18 degrees of freedom
Multiple R-squared:  0.9026,    Adjusted R-squared:  0.8972 
F-statistic: 166.9 on 1 and 18 DF,  p-value: 1.528e-10</code></pre>
</div>
</div>
<ol start="5" type="1">
<li>Fit a simple linear regression model of BP vs BSA.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> BSA, <span class="at">data=</span>bloodpress)</span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ BSA, data = bloodpress)

Residuals:
   Min     1Q Median     3Q    Max 
-5.314 -1.963 -0.197  1.934  4.831 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   45.183      9.392   4.811  0.00014 ***
BSA           34.443      4.690   7.343 8.11e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.79 on 18 degrees of freedom
Multiple R-squared:  0.7497,    Adjusted R-squared:  0.7358 
F-statistic: 53.93 on 1 and 18 DF,  p-value: 8.114e-07</code></pre>
</div>
</div>
<ol start="6" type="1">
<li>Fit a multiple linear regression model of BP vs Weight + BSA. Is BSA still significant? Why?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Weight <span class="sc">+</span> BSA, <span class="at">data=</span>bloodpress)</span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Weight + BSA, data = bloodpress)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.8932 -1.1961 -0.4061  1.0764  4.7524 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   5.6534     9.3925   0.602    0.555    
Weight        1.0387     0.1927   5.392 4.87e-05 ***
BSA           5.8313     6.0627   0.962    0.350    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.744 on 17 degrees of freedom
Multiple R-squared:  0.9077,    Adjusted R-squared:  0.8968 
F-statistic: 83.54 on 2 and 17 DF,  p-value: 1.607e-09</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Predict BP for Weight=92 and BSA=2 for the two simple linear regression models and the multiple linear regression model, by hand and by <code>predict()</code> function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fl">2.20531</span> <span class="sc">+</span> <span class="fl">1.20093</span> <span class="sc">*</span> <span class="dv">92</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 112.6909</code></pre>
</div>
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model<span class="fl">.2</span>,</span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Weight=</span><span class="dv">92</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      1 
112.691 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="fl">45.183</span> <span class="sc">+</span> <span class="fl">34.443</span> <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 114.069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb427"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb427-1"><a href="#cb427-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model<span class="fl">.3</span>,</span>
<span id="cb427-2"><a href="#cb427-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">BSA=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
114.0689 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb429"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb429-1"><a href="#cb429-1" aria-hidden="true" tabindex="-1"></a><span class="fl">5.6534</span> <span class="sc">+</span> <span class="fl">1.0387</span> <span class="sc">*</span> <span class="dv">92</span> <span class="sc">+</span> <span class="fl">5.8313</span> <span class="sc">*</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 112.8764</code></pre>
</div>
<div class="sourceCode cell-code" id="cb431"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb431-1"><a href="#cb431-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model<span class="fl">.4</span>,</span>
<span id="cb431-2"><a href="#cb431-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">Weight=</span><span class="dv">92</span>, <span class="at">BSA=</span><span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
112.8794 </code></pre>
</div>
</div>
<ol start="7" type="1">
<li>Fit a multiple linear regression model of BP vs Age + Weight. Set argument <code>x</code> and <code>y</code> as TRUE. Save the output of <code>lm()</code> as <code>model.5</code>. How do we interpret each estimated coefficients?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Age <span class="sc">+</span> Weight, <span class="at">data=</span>bloodpress, <span class="at">x=</span><span class="cn">TRUE</span>, <span class="at">y=</span><span class="cn">TRUE</span>)</span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Age + Weight, data = bloodpress, x = TRUE, 
    y = TRUE)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.89968 -0.35242  0.06979  0.35528  0.82781 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -16.57937    3.00746  -5.513 3.80e-05 ***
Age           0.70825    0.05351  13.235 2.22e-10 ***
Weight        1.03296    0.03116  33.154  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5327 on 17 degrees of freedom
Multiple R-squared:  0.9914,    Adjusted R-squared:  0.9904 
F-statistic: 978.2 on 2 and 17 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ol start="8" type="1">
<li>Use the <code>plot_ly</code> function in the <code>plotly</code> package to create a 3D scatterplot of the data with the fitted plane for a multiple linear regression model of BP vs Age + Weight.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:plyr':

    arrange, mutate, rename, summarise</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:reshape':

    rename</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:MASS':

    select</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mosaic':

    do</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_ly</span>(<span class="at">x=</span>bloodpress<span class="sc">$</span>Age, <span class="at">y=</span>bloodpress<span class="sc">$</span>Weight, <span class="at">z=</span>bloodpress<span class="sc">$</span>BP, <span class="at">type=</span><span class="st">'scatter3d'</span>, <span class="at">mode=</span><span class="st">'markers'</span>, <span class="at">color=</span>bloodpress<span class="sc">$</span>BP)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-c3cd6d1a77c6a1be2335" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c3cd6d1a77c6a1be2335">{"x":{"visdat":{"4de62c46e705":["function () ","plotlyVisDat"]},"cur_data":"4de62c46e705","attrs":{"4de62c46e705":{"x":[47,49,49,50,51,48,49,47,49,48,47,49,50,45,52,46,46,46,48,56],"y":[85.400000000000006,94.200000000000003,95.299999999999997,94.700000000000003,89.400000000000006,99.5,99.799999999999997,90.900000000000006,89.200000000000003,92.700000000000003,94.400000000000006,94.099999999999994,91.599999999999994,87.099999999999994,101.3,94.5,87,94.5,90.5,95.700000000000003],"z":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122],"mode":"markers","color":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122],"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":[]},"yaxis":{"title":[]},"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[47,49,49,50,51,48,49,47,49,48,47,49,50,45,52,46,46,46,48,56],"y":[85.400000000000006,94.200000000000003,95.299999999999997,94.700000000000003,89.400000000000006,99.5,99.799999999999997,90.900000000000006,89.200000000000003,92.700000000000003,94.400000000000006,94.099999999999994,91.599999999999994,87.099999999999994,101.3,94.5,87,94.5,90.5,95.700000000000003],"z":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122],"mode":"markers","type":"scatter3d","marker":{"colorbar":{"title":"","ticklen":2},"cmin":105,"cmax":125,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666664","rgba(70,19,97,1)"],["0.0833333333333336","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666666","rgba(68,58,128,1)"],["0.208333333333334","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666666","rgba(56,93,140,1)"],["0.333333333333334","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666666","rgba(42,123,142,1)"],["0.458333333333334","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666666","rgba(33,154,138,1)"],["0.583333333333334","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666666","rgba(53,183,121,1)"],["0.708333333333334","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666666","rgba(119,207,85,1)"],["0.833333333333334","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333334","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122],"line":{"colorbar":{"title":"","ticklen":2},"cmin":105,"cmax":125,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666664","rgba(70,19,97,1)"],["0.0833333333333336","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666666","rgba(68,58,128,1)"],["0.208333333333334","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666666","rgba(56,93,140,1)"],["0.333333333333334","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666666","rgba(42,123,142,1)"],["0.458333333333334","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666666","rgba(33,154,138,1)"],["0.583333333333334","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666666","rgba(53,183,121,1)"],["0.708333333333334","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666666","rgba(119,207,85,1)"],["0.833333333333334","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333334","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[105,115,116,117,112,121,121,110,110,114,114,115,114,106,125,114,106,113,110,122]}},"frame":null},{"x":[45,56],"y":[85.400000000000006,101.3],"type":"scatter3d","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":105,"cmax":125,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666664","rgba(70,19,97,1)"],["0.0833333333333336","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666666","rgba(68,58,128,1)"],["0.208333333333334","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666666","rgba(56,93,140,1)"],["0.333333333333334","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666666","rgba(42,123,142,1)"],["0.458333333333334","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666666","rgba(33,154,138,1)"],["0.583333333333334","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666666","rgba(53,183,121,1)"],["0.708333333333334","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666666","rgba(119,207,85,1)"],["0.833333333333334","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333334","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[105,125],"line":{"color":"rgba(255,127,14,1)"}},"z":[105,125],"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<ol start="9" type="1">
<li>Extract the matrix <code>x</code> and <code>y</code> of <code>model.5</code> and assign it to a new object <code>X</code> and <code>y</code>. Remember, if you save the output of <code>lm()</code> as an object, this object contains many elements. After we set <code>x=TRUE</code> and <code>y=TRUE</code> in question 8, we can find <code>x</code> and <code>y</code> in this list.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> model<span class="fl">.5</span><span class="sc">$</span>x</span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> model<span class="fl">.5</span><span class="sc">$</span>y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="10" type="1">
<li>Calculate <span class="math inline">\(X^{T}X\)</span>, <span class="math inline">\(X^{T}y\)</span>, <span class="math inline">\((X^{T}X)^{-1}\)</span>, and <span class="math inline">\((X^{T}X)^{-1}X^{T}y\)</span>. Use <code>t()</code> for transpose, <code>%*%</code> for matrix multiplication, and <code>solve()</code> for inverse of matrix. For the last one, is your result same as the estimated values you obtained in question 7? –Of course!</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb446"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb446-1"><a href="#cb446-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(X) <span class="sc">%*%</span> X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)     Age   Weight
(Intercept)        20.0   972.0   1861.8
Age               972.0 47358.0  90566.6
Weight           1861.8 90566.6 173665.4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb448"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb448-1"><a href="#cb448-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t</span>(X) <span class="sc">%*%</span> y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                [,1]
(Intercept)   2280.0
Age         110978.0
Weight      212666.1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb450"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb450-1"><a href="#cb450-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)          Age       Weight
(Intercept)  31.8748075 -0.267669593 -0.202127676
Age          -0.2676696  0.010092130 -0.002393468
Weight       -0.2021277 -0.002393468  0.003420885</code></pre>
</div>
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="fu">solve</span>(<span class="fu">t</span>(X) <span class="sc">%*%</span> X) <span class="sc">%*%</span> (<span class="fu">t</span>(X) <span class="sc">%*%</span> y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   [,1]
(Intercept) -16.5793694
Age           0.7082515
Weight        1.0329611</code></pre>
</div>
</div>
<ol start="11" type="1">
<li>Use the anova function to display the ANOVA table with sequential (type I) sums of squares for the <code>model.5</code>.</li>
</ol>
<p>$SS_{} = <em>{i=1}^n (</em>{, i} - {y})^2 $</p>
<p><span class="math inline">\(\hat{y}_{\text{Variable}, i}\)</span> is the model including only varible i.</p>
<p>$ F = $</p>
<p>If (F <span class="math inline">\(\approx\)</span> 1) : It indicates that the sizes of MS_Variable and MS_Residuals are approximately the same, suggesting that the explanatory power of the independent variable for the dependent variable is comparable to the random error, and the null hypothesis ((H_0)) cannot be rejected.</p>
<p>If (F <span class="math inline">\(\gg\)</span> 1) : It indicates that MS_Variable is significantly greater than MS_Residuals, suggesting that the independent variable has a significant influence on the dependent variable, and the null hypothesis ((H_0)) can be rejected.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: BP
          Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
Age        1 243.266 243.266  857.29 5.481e-16 ***
Weight     1 311.910 311.910 1099.20 &lt; 2.2e-16 ***
Residuals 17   4.824   0.284                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remark</span></span>
<span id="cb456-2"><a href="#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((model<span class="fl">.5</span><span class="sc">$</span>y<span class="sc">-</span><span class="fu">mean</span>(model<span class="fl">.5</span><span class="sc">$</span>y))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">==</span> <span class="fl">243.266+311.910+4.824</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>$SS_{} = SS_{} + SS_{} + SS_{} $</p>
<ol start="12" type="1">
<li>Use the <code>residuals</code> element in fitted model or <code>residuals()</code> function to extract the fitted residuals. Calculate the sum of square of these residual values. Extract the <code>df.residual</code> element in fitted model and use the above elements to calculate the MSE. Is your result same as the <code>anova()</code> output?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((model<span class="fl">.5</span><span class="sc">$</span>residuals)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>model<span class="fl">.5</span><span class="sc">$</span>df.residual</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2837604</code></pre>
</div>
</div>
<ol start="13" type="1">
<li>Fit a multiple linear regression model of BP vs Age + Weight + Pulse. Save the output of <code>lm()</code> as <code>model.6</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(BP <span class="sc">~</span> Age <span class="sc">+</span> Weight <span class="sc">+</span> Pulse, <span class="at">data=</span>bloodpress)</span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BP ~ Age + Weight + Pulse, data = bloodpress)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.71174 -0.45422 -0.01909  0.41745  0.88743 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -16.69000    2.93761  -5.681 3.40e-05 ***
Age           0.75018    0.06074  12.350 1.36e-09 ***
Weight        1.06135    0.03695  28.722 3.40e-15 ***
Pulse        -0.06566    0.04852  -1.353    0.195    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.5201 on 16 degrees of freedom
Multiple R-squared:  0.9923,    Adjusted R-squared:  0.9908 
F-statistic: 684.7 on 3 and 16 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<ol start="14" type="1">
<li>Use <code>anova()</code> function to obtain the ANOVA table for <code>model.6</code>. We may consider <code>model.6</code> as full model, and <code>model.5</code> as reduced model in this question. Based on the obtained ANOVA table and the output of question 11, calculate the F-statistic for testing the reduced model by hand. You may use the Residuals Sum sq and the corresponding Residuals Df from both tables. Then, calculate the p-value using <span class="math inline">\(pf()\)</span> function, don’t forget about the <code>lower.tail</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb462"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb462-1"><a href="#cb462-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: BP
          Df  Sum Sq Mean Sq   F value    Pr(&gt;F)    
Age        1 243.266 243.266  899.2446 1.726e-15 ***
Weight     1 311.910 311.910 1152.9909 2.433e-16 ***
Pulse      1   0.496   0.496    1.8319    0.1947    
Residuals 16   4.328   0.271                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb464"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb464-1"><a href="#cb464-1" aria-hidden="true" tabindex="-1"></a>Fstat <span class="ot">&lt;-</span> (<span class="fl">4.824-4.328</span>)<span class="sc">/</span>(<span class="dv">17-16</span>) <span class="sc">/</span> (<span class="fl">4.328</span><span class="sc">/</span><span class="dv">16</span>)</span>
<span id="cb464-2"><a href="#cb464-2" aria-hidden="true" tabindex="-1"></a>Fstat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.833641</code></pre>
</div>
<div class="sourceCode cell-code" id="cb466"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb466-1"><a href="#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pf</span>(Fstat, <span class="dv">1</span>, <span class="dv">16</span>, <span class="at">lower.tail =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1945157</code></pre>
</div>
</div>
<ol start="15" type="1">
<li>Use <code>anova()</code> function to do the F-test on <code>model.5</code> and <code>model.6</code>. Compare the output with your answers of question 14. What is the conclustion of the F-test?</li>
</ol>
<p>$ = _{i=1}^n (y_i - _i)^2 $</p>
<p>$ = - $ (It represents the variation in the interpretation of the dependent variable by the newly added variable Pulse.)</p>
<p><span class="math display">\[ F = \frac{\text{Sum of Sq} / \text{Df}}{\text{RSS(Model 2)} / \text{Res.Df(Model 2)}} \\F = \frac{0.49557}{0.270525} \approx 1.8319\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb468"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb468-1"><a href="#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model<span class="fl">.5</span>, model<span class="fl">.6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: BP ~ Age + Weight
Model 2: BP ~ Age + Weight + Pulse
  Res.Df    RSS Df Sum of Sq      F Pr(&gt;F)
1     17 4.8239                           
2     16 4.3284  1   0.49557 1.8319 0.1947</code></pre>
</div>
</div>
<ol start="16" type="1">
<li>Plot the qqPlot for residuals of <code>model.5</code>. What is the x-axis and y-axis of the qqPlot? What can we say about the qqPlot?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb470"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb470-1"><a href="#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb470-2"><a href="#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqPlot</span>(model<span class="fl">.5</span><span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 19 10</code></pre>
</div>
</div>
<ol start="17" type="1">
<li>Plot the residual vs fitted plot of <code>model.5</code>. You may extract <code>fitted.values</code> from <code>model.5</code> and use it as <code>x</code> in <code>plot()</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb472"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb472-1"><a href="#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span>model<span class="fl">.5</span><span class="sc">$</span>fitted.values, <span class="at">y=</span>model<span class="fl">.5</span><span class="sc">$</span>residuals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ol start="18" type="1">
<li>Directly use <code>plot()</code> function on <code>model.5</code>.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb473"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb473-1"><a href="#cb473-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-70-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-70-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-70-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="part-2" class="level2">
<h2 class="anchored" data-anchor-id="part-2">Part 2</h2>
<ol start="19" type="1">
<li>Load the <code>hospital_infct.txt</code> data and select observations with Stay &lt;= 14.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb474"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb474-1"><a href="#cb474-1" aria-hidden="true" tabindex="-1"></a>infectionrisk <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"/Users/luyu/Desktop/NOTEsAPH101/hospital_infct.txt"</span>, <span class="at">header=</span>T)</span>
<span id="cb474-2"><a href="#cb474-2" aria-hidden="true" tabindex="-1"></a>infectionrisk <span class="ot">&lt;-</span> infectionrisk[infectionrisk<span class="sc">$</span>Stay<span class="sc">&lt;=</span><span class="dv">14</span>,]</span>
<span id="cb474-3"><a href="#cb474-3" aria-hidden="true" tabindex="-1"></a>infectionrisk</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     ID  Stay  Age InfctRsk Culture  Xray Beds MedSchool Region Census Nurses
1     1  7.13 55.7      4.1     9.0  39.6  279         2      4    207    241
2     2  8.82 58.2      1.6     3.8  51.7   80         2      2     51     52
3     3  8.34 56.9      2.7     8.1  74.0  107         2      3     82     54
4     4  8.95 53.7      5.6    18.9 122.8  147         2      4     53    148
5     5 11.20 56.5      5.7    34.5  88.9  180         2      1    134    151
6     6  9.76 50.9      5.1    21.9  97.0  150         2      2    147    106
7     7  9.68 57.8      4.6    16.7  79.0  186         2      3    151    129
8     8 11.18 45.7      5.4    60.5  85.8  640         1      2    399    360
9     9  8.67 48.2      4.3    24.4  90.8  182         2      3    130    118
10   10  8.84 56.3      6.3    29.6  82.6   85         2      1     59     66
11   11 11.07 53.2      4.9    28.5 122.0  768         1      1    591    656
12   12  8.30 57.2      4.3     6.8  83.8  167         2      3    105     59
13   13 12.78 56.8      7.7    46.0 116.9  322         1      1    252    349
14   14  7.58 56.7      3.7    20.8  88.0   97         2      2     59     79
15   15  9.00 56.3      4.2    14.6  76.4   72         2      3     61     38
16   16 11.08 50.2      5.5    18.6  63.6  387         2      3    326    405
17   17  8.28 48.1      4.5    26.0 101.8  108         2      4     84     73
18   18 11.62 53.9      6.4    25.5  99.2  133         2      1    113    101
19   19  9.06 52.8      4.2     6.9  75.9  134         2      2    103    125
20   20  9.35 53.8      4.1    15.9  80.9  833         2      3    547    519
21   21  7.53 42.0      4.2    23.1  98.9   95         2      4     47     49
22   22 10.24 49.0      4.8    36.3 112.6  195         2      2    163    170
23   23  9.78 52.3      5.0    17.6  95.9  270         1      1    240    198
24   24  9.84 62.2      4.8    12.0  82.3  600         2      3    468    497
25   25  9.20 52.2      4.0    17.5  71.1  298         1      4    244    236
26   26  8.28 49.5      3.9    12.0 113.1  546         1      2    413    436
27   27  9.31 47.2      4.5    30.2 101.3  170         2      1    124    173
28   28  8.19 52.1      3.2    10.8  59.2  176         2      1    156     88
29   29 11.65 54.5      4.4    18.6  96.1  248         2      1    217    189
30   30  9.89 50.5      4.9    17.7 103.6  167         2      2    113    106
31   31 11.03 49.9      5.0    19.7 102.1  318         2      1    270    335
32   32  9.84 53.0      5.2    17.7  72.6  210         2      2    200    239
33   33 11.77 54.1      5.3    17.3  56.0  196         2      1    164    165
34   34 13.59 54.0      6.1    24.2 111.7  312         2      1    258    169
35   35  9.74 54.4      6.3    11.4  76.1  221         2      2    170    172
36   36 10.33 55.8      5.0    21.2 104.3  266         2      1    181    149
37   37  9.97 58.2      2.8    16.5  76.5   90         2      2     69     42
38   38  7.84 49.1      4.6     7.1  87.9   60         2      3     50     45
39   39 10.47 53.2      4.1     5.7  69.1  196         2      2    168    153
40   40  8.16 60.9      1.3     1.9  58.0   73         2      3     49     21
41   41  8.48 51.1      3.7    12.1  92.8  166         2      3    145    118
42   42 10.72 53.8      4.7    23.2  94.1  113         2      3     90    107
43   43 11.20 45.0      3.0     7.0  78.9  130         2      3     95     56
44   44 10.12 51.7      5.6    14.9  79.1  362         1      3    313    264
45   45  8.37 50.7      5.5    15.1  84.8  115         2      2     96     88
46   46 10.16 54.2      4.6     8.4  51.5  831         1      4    581    629
48   48 10.90 57.2      5.5    10.6  71.9  593         2      2    446    211
49   49  7.67 51.7      1.8     2.5  40.4  106         2      3     93     35
50   50  8.88 51.5      4.2    10.1  86.9  305         2      3    238    197
51   51 11.48 57.6      5.6    20.3  82.0  252         2      1    207    251
52   52  9.23 51.6      4.3    11.6  42.6  620         2      2    413    420
53   53 11.41 61.1      7.6    16.6  97.9  535         2      3    330    273
54   54 12.07 43.7      7.8    52.4 105.3  157         2      2    115     76
55   55  8.63 54.0      3.1     8.4  56.2   76         2      1     39     44
56   56 11.15 56.5      3.9     7.7  73.9  281         2      1    217    199
57   57  7.14 59.0      3.7     2.6  75.8   70         2      4     37     35
58   58  7.65 47.1      4.3    16.4  65.7  318         2      4    265    314
59   59 10.73 50.6      3.9    19.3 101.0  445         1      2    374    345
60   60 11.46 56.9      4.5    15.6  97.7  191         2      3    153    132
61   61 10.42 58.0      3.4     8.0  59.0  119         2      1     67     64
62   62 11.18 51.0      5.7    18.8  55.9  595         1      2    546    392
63   63  7.93 64.1      5.4     7.5  98.1   68         2      4     42     49
64   64  9.66 52.1      4.4     9.9  98.3   83         2      2     66     95
65   65  7.78 45.5      5.0    20.9  71.6  489         2      3    391    329
66   66  9.42 50.6      4.3    24.8  62.8  508         2      1    421    528
67   67 10.02 49.5      4.4     8.3  93.0  265         2      2    191    202
68   68  8.58 55.0      3.7     7.4  95.9  304         2      3    248    218
69   69  9.61 52.4      4.5     6.9  87.2  487         2      3    404    220
70   70  8.03 54.2      3.5    24.3  87.3   97         2      1     65     55
71   71  7.39 51.0      4.2    14.6  88.4   72         2      2     38     67
72   72  7.08 52.0      2.0    12.3  56.4   87         2      3     52     57
73   73  9.53 51.5      5.2    15.0  65.7  298         2      3    241    193
74   74 10.05 52.0      4.5    36.7  87.5  184         1      1    144    151
75   75  8.45 38.8      3.4    12.9  85.0  235         2      2    143    124
76   76  6.70 48.6      4.5    13.0  80.8   76         2      4     51     79
77   77  8.90 49.7      2.9    12.7  86.9   52         2      1     37     35
78   78 10.23 53.2      4.9     9.9  77.9  752         1      2    595    446
79   79  8.88 55.8      4.4    14.1  76.8  237         2      2    165    182
80   80 10.30 59.6      5.1    27.8  88.9  175         2      2    113     73
81   81 10.79 44.2      2.9     2.6  56.6  461         1      2    320    196
82   82  7.94 49.5      3.5     6.2  92.3  195         2      2    139    116
83   83  7.63 52.1      5.5    11.6  61.1  197         2      4    109    110
84   84  8.77 54.5      4.7     5.2  47.0  143         2      4     85     87
85   85  8.09 56.9      1.7     7.6  56.9   92         2      3     61     61
86   86  9.05 51.2      4.1    20.5  79.8  195         2      3    127    112
87   87  7.91 52.8      2.9    11.9  79.5  477         2      3    349    188
88   88 10.39 54.6      4.3    14.0  88.3  353         2      2    223    200
89   89  9.36 54.1      4.8    18.3  90.6  165         2      1    127    158
90   90 11.41 50.4      5.8    23.8  73.0  424         1      3    359    335
91   91  8.86 51.3      2.9     9.5  87.5  100         2      3     65     53
92   92  8.93 56.0      2.0     6.2  72.5   95         2      3     59     56
93   93  8.92 53.9      1.3     2.2  79.5   56         2      2     40     14
94   94  8.15 54.9      5.3    12.3  79.8   99         2      4     55     71
95   95  9.77 50.2      5.3    15.7  89.7  154         2      2    123    148
96   96  8.54 56.1      2.5    27.0  82.5   98         2      1     57     75
97   97  8.66 52.8      3.8     6.8  69.5  246         2      3    178    177
98   98 12.01 52.8      4.8    10.8  96.9  298         2      1    237    115
99   99  7.95 51.8      2.3     4.6  54.9  163         2      3    128     93
100 100 10.15 51.9      6.2    16.4  59.2  568         1      3    452    371
101 101  9.76 53.2      2.6     6.9  80.1   64         2      4     47     55
102 102  9.89 45.2      4.3    11.8 108.7  190         2      1    141    112
103 103  7.14 57.6      2.7    13.1  92.6   92         2      4     40     50
104 104 13.95 65.9      6.6    15.6 133.5  356         2      1    308    182
105 105  9.44 52.5      4.5    10.9  58.5  297         2      3    230    263
106 106 10.80 63.9      2.9     1.6  57.4  130         2      3     69     62
107 107  7.14 51.7      1.4     4.1  45.7  115         2      3     90     19
108 108  8.02 55.0      2.1     3.8  46.5   91         2      2     44     32
109 109 11.80 53.8      5.7     9.1 116.9  571         1      2    441    469
110 110  9.50 49.3      5.8    42.0  70.9   98         2      3     68     46
111 111  7.70 56.9      4.4    12.2  67.9  129         2      4     85    136
113 113  9.41 59.5      3.1    20.6  91.7   29         2      3     20     22
    Facilities
1         60.0
2         40.0
3         20.0
4         40.0
5         40.0
6         40.0
7         40.0
8         60.0
9         40.0
10        40.0
11        80.0
12        40.0
13        57.1
14        37.1
15        17.1
16        57.1
17        37.1
18        37.1
19        37.1
20        77.1
21        17.1
22        37.1
23        57.1
24        57.1
25        57.1
26        57.1
27        37.1
28        37.1
29        37.1
30        37.1
31        57.1
32        54.3
33        34.3
34        54.3
35        54.3
36        54.3
37        34.3
38        34.3
39        54.3
40        14.3
41        34.3
42        34.3
43        34.3
44        54.3
45        34.3
46        74.3
48        51.4
49        11.4
50        51.4
51        51.4
52        71.4
53        51.4
54        31.4
55        31.4
56        51.4
57        31.4
58        51.4
59        51.4
60        31.4
61        31.4
62        68.6
63        28.6
64        28.6
65        48.6
66        48.6
67        48.6
68        48.6
69        48.6
70        28.6
71        28.6
72        28.6
73        48.6
74        68.6
75        48.6
76        28.6
77        28.6
78        68.6
79        48.6
80        45.7
81        65.7
82        45.7
83        45.7
84        25.7
85        45.7
86        45.7
87        65.7
88        65.7
89        45.7
90        45.7
91        25.7
92        25.7
93         5.7
94        25.7
95        25.7
96        45.7
97        45.7
98        45.7
99        42.9
100       62.9
101       22.9
102       42.9
103       22.9
104       62.9
105       42.9
106       22.9
107       22.9
108       22.9
109       62.9
110       22.9
111       62.9
113       22.9</code></pre>
</div>
</div>
<ol start="20" type="1">
<li>Create new dummy/indicator columns (<code>i1</code>, <code>i2</code>, <code>i3</code>, <code>i4</code>) for regions using <code>ifelse()</code> function. For example, i1 = 1 when Region = 1 and i1 = 0 when Region is not equal to 1; i2 = 1 when Region = 2 and i2 = 0 when Region is not equal to 2; …</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb476"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb476-1"><a href="#cb476-1" aria-hidden="true" tabindex="-1"></a>infectionrisk<span class="sc">$</span>i1 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(infectionrisk<span class="sc">$</span>Region <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb476-2"><a href="#cb476-2" aria-hidden="true" tabindex="-1"></a>infectionrisk<span class="sc">$</span>i2 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(infectionrisk<span class="sc">$</span>Region <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb476-3"><a href="#cb476-3" aria-hidden="true" tabindex="-1"></a>infectionrisk<span class="sc">$</span>i3 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(infectionrisk<span class="sc">$</span>Region <span class="sc">==</span> <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb476-4"><a href="#cb476-4" aria-hidden="true" tabindex="-1"></a>infectionrisk<span class="sc">$</span>i4 <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(infectionrisk<span class="sc">$</span>Region <span class="sc">==</span> <span class="dv">4</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="21" type="1">
<li>Fit a multiple linear regression model of InfctRsk on Stay + Xray + i2 + i3 + i4.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb477"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb477-1"><a href="#cb477-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(InfctRsk <span class="sc">~</span> Stay <span class="sc">+</span> Xray <span class="sc">+</span> i2 <span class="sc">+</span> i3 <span class="sc">+</span> i4, <span class="at">data=</span>infectionrisk)</span>
<span id="cb477-2"><a href="#cb477-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = InfctRsk ~ Stay + Xray + i2 + i3 + i4, data = infectionrisk)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.66492 -0.65420  0.04265  0.64034  2.51391 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -2.134259   0.877347  -2.433  0.01668 *  
Stay         0.505394   0.081455   6.205 1.11e-08 ***
Xray         0.017587   0.005649   3.113  0.00238 ** 
i2           0.171284   0.281475   0.609  0.54416    
i3           0.095461   0.288852   0.330  0.74169    
i4           1.057835   0.378077   2.798  0.00612 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.036 on 105 degrees of freedom
Multiple R-squared:  0.4198,    Adjusted R-squared:  0.3922 
F-statistic: 15.19 on 5 and 105 DF,  p-value: 3.243e-11</code></pre>
</div>
</div>
<ol start="23" type="1">
<li>Can we include i1 + i2 + i3 + i4 in this multiple linear regression? Why?</li>
</ol>
<p>No.&nbsp;In the context of using dummy variables for categorical data in regression analysis, it’s essential to designate a reference category. This reference category is represented by a coefficient of zero, while the coefficients for the other categories are interpreted as deviations from this reference point.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb479"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb479-1"><a href="#cb479-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(InfctRsk <span class="sc">~</span> Stay <span class="sc">+</span> Xray <span class="sc">+</span> i1 <span class="sc">+</span> i2 <span class="sc">+</span> i3 <span class="sc">+</span> i4, <span class="at">data=</span>infectionrisk)</span>
<span id="cb479-2"><a href="#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = InfctRsk ~ Stay + Xray + i1 + i2 + i3 + i4, data = infectionrisk)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.66492 -0.65420  0.04265  0.64034  2.51391 

Coefficients: (1 not defined because of singularities)
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -1.076424   0.721361  -1.492  0.13864    
Stay         0.505394   0.081455   6.205 1.11e-08 ***
Xray         0.017587   0.005649   3.113  0.00238 ** 
i1          -1.057835   0.378077  -2.798  0.00612 ** 
i2          -0.886551   0.339887  -2.608  0.01042 *  
i3          -0.962374   0.323365  -2.976  0.00362 ** 
i4                 NA         NA      NA       NA    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.036 on 105 degrees of freedom
Multiple R-squared:  0.4198,    Adjusted R-squared:  0.3922 
F-statistic: 15.19 on 5 and 105 DF,  p-value: 3.243e-11</code></pre>
</div>
</div>
<ol start="24" type="1">
<li>Conduct an F-test (use <code>anova()</code> function) to see if at least one of i2, i3, and i4 are useful.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb481"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb481-1"><a href="#cb481-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(InfctRsk <span class="sc">~</span> Stay <span class="sc">+</span> Xray, <span class="at">data=</span>infectionrisk)</span>
<span id="cb481-2"><a href="#cb481-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(model<span class="fl">.7</span>, model<span class="fl">.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: InfctRsk ~ Stay + Xray + i2 + i3 + i4
Model 2: InfctRsk ~ Stay + Xray
  Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
1    105 112.71                              
2    108 123.56 -3   -10.849 3.3687 0.02135 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
<section id="confusion-matrix" class="level1">
<h1>Confusion Matrix</h1>
<table class="caption-top table">
<colgroup>
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Total population <span class="math inline">\(=\mathrm{P}+\mathrm{N}\)</span></th>
<th style="text-align: left;">Predicted Positive (PP)</th>
<th style="text-align: left;">Predicted Negative (PN)</th>
<th style="text-align: left;">Informedness, bookmaker informedness (BM) <span class="math inline">\(=\mathrm{TPR}+\mathrm{TNR}-1\)</span></th>
<th style="text-align: left;">Prevalence threshold (PT) <span class="math inline">\(=\frac{\sqrt{\mathrm{TPR} \times \mathrm{FPR}}-\mathrm{FPR}}{\mathrm{TPR}-\mathrm{FPR}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Positive (P) <span class="math inline">\({ }^{[\text {a }]}\)</span></td>
<td style="text-align: left;">True positive (TP), hit <span class="math inline">\({ }^{[b]}\)</span></td>
<td style="text-align: left;">False negative (FN), miss, underestimation</td>
<td style="text-align: left;">True positive rate (TPR), recall, sensitivity (SEN), probability of detection, hit rate, power <span class="math inline">\(=\frac{\mathrm{TP}}{\mathrm{P}}=1-\mathrm{FNR}\)</span></td>
<td style="text-align: left;">False negative rate (FNR), miss rate type ll error <span class="math inline">\({ }^{[c]}\)</span> <span class="math inline">\(=\frac{\mathrm{FN}}{\mathrm{P}}=1-\mathrm{TPR}\)</span></td>
</tr>
<tr class="even">
<td style="text-align: left;">Negative ( N ) <span class="math inline">\({ }^{[d]}\)</span></td>
<td style="text-align: left;">False positive (FP), false alarm, overestimation</td>
<td style="text-align: left;">True negative (TN), correct rejection <span class="math inline">\({ }^{[\text {e }]}\)</span></td>
<td style="text-align: left;">False positive rate (FPR), probability of false alarm, fall-out type I error <span class="math inline">\({ }^{[7]}\)</span> <span class="math inline">\(=\frac{\mathrm{FP}}{\mathrm{~N}}=1-\mathrm{TNR}\)</span></td>
<td style="text-align: left;">True negative rate (TNR), specificity (SPC), selectivity <span class="math inline">\(=\frac{\mathrm{TN}}{\mathrm{N}}=1-\mathrm{FPR}\)</span></td>
</tr>
</tbody>
</table>
<section id="example-2" class="level2">
<h2 class="anchored" data-anchor-id="example-2">example</h2>
<section id="lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv" class="level3">
<h3 class="anchored" data-anchor-id="lung-cancer-classification-httpswww.kaggle.comdatasetsmysarahmadbhatlung-cancerselectsurveylungcancer.csv">Lung Cancer Classification (https://www.kaggle.com/datasets/mysarahmadbhat/lung-cancer?select=survey+lung+cancer.csv)</h3>
<p>The effectiveness of cancer prediction system helps the people to know their cancer risk with low cost and it also helps the people to take the appropriate decision based on their cancer risk status. The data is collected from the website online lung cancer prediction system.</p>
<p>Total no. of attributes: 16 No.&nbsp;of instances: 284</p>
<p>Attribute information:</p>
<p>Gender: M(male), F(female) Age: Age of the patient Smoking: YES=2, NO=1. Yellow fingers: YES=2, NO=1. Anxiety: YES=2, NO=1. Peer_pressure: YES=2, NO=1. Chronic Disease: YES=2, NO=1. Fatigue: YES=2, NO=1. Allergy: YES=2, NO=1. Wheezing: YES=2, NO=1. Alcohol: YES=2, NO=1. Coughing: YES=2, NO=1. Shortness of Breath: YES=2, NO=1. Swallowing Difficulty: YES=2, NO=1. Chest pain: YES=2, NO=1. Lung Cancer: YES, NO.</p>
<p>Goal: It is your job to classify Lung Cancer using other variables</p>
<section id="example-code" class="level4">
<h4 class="anchored" data-anchor-id="example-code">Example Code</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb483"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb483-1"><a href="#cb483-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load the dataset </span></span>
<span id="cb483-2"><a href="#cb483-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb483-3"><a href="#cb483-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">'/Users/luyu/Desktop/survey_lung_cancer.csv'</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb483-4"><a href="#cb483-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>LUNG_CANCER <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>LUNG_CANCER<span class="sc">==</span><span class="st">"YES"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb483-5"><a href="#cb483-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    GENDER               AGE           SMOKING      YELLOW_FINGERS
 Length:309         Min.   :21.00   Min.   :1.000   Min.   :1.00  
 Class :character   1st Qu.:57.00   1st Qu.:1.000   1st Qu.:1.00  
 Mode  :character   Median :62.00   Median :2.000   Median :2.00  
                    Mean   :62.67   Mean   :1.563   Mean   :1.57  
                    3rd Qu.:69.00   3rd Qu.:2.000   3rd Qu.:2.00  
                    Max.   :87.00   Max.   :2.000   Max.   :2.00  
    ANXIETY      PEER_PRESSURE   CHRONIC DISEASE    FATIGUE     
 Min.   :1.000   Min.   :1.000   Min.   :1.000   Min.   :1.000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000  
 Median :1.000   Median :2.000   Median :2.000   Median :2.000  
 Mean   :1.498   Mean   :1.502   Mean   :1.505   Mean   :1.673  
 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000  
 Max.   :2.000   Max.   :2.000   Max.   :2.000   Max.   :2.000  
    ALLERGY         WHEEZING     ALCOHOL CONSUMING    COUGHING    
 Min.   :1.000   Min.   :1.000   Min.   :1.000     Min.   :1.000  
 1st Qu.:1.000   1st Qu.:1.000   1st Qu.:1.000     1st Qu.:1.000  
 Median :2.000   Median :2.000   Median :2.000     Median :2.000  
 Mean   :1.557   Mean   :1.557   Mean   :1.557     Mean   :1.579  
 3rd Qu.:2.000   3rd Qu.:2.000   3rd Qu.:2.000     3rd Qu.:2.000  
 Max.   :2.000   Max.   :2.000   Max.   :2.000     Max.   :2.000  
 SHORTNESS OF BREATH SWALLOWING DIFFICULTY   CHEST PAIN     LUNG_CANCER    
 Min.   :1.000       Min.   :1.000         Min.   :1.000   Min.   :0.0000  
 1st Qu.:1.000       1st Qu.:1.000         1st Qu.:1.000   1st Qu.:1.0000  
 Median :2.000       Median :1.000         Median :2.000   Median :1.0000  
 Mean   :1.641       Mean   :1.469         Mean   :1.557   Mean   :0.8738  
 3rd Qu.:2.000       3rd Qu.:2.000         3rd Qu.:2.000   3rd Qu.:1.0000  
 Max.   :2.000       Max.   :2.000         Max.   :2.000   Max.   :1.0000  </code></pre>
</div>
</div>
<div class="sourceCode" id="cb485"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb485-1"><a href="#cb485-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb485-2"><a href="#cb485-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(SMOKING), <span class="at">fill =</span> <span class="fu">factor</span>(LUNG_CANCER))) <span class="sc">+</span></span>
<span id="cb485-3"><a href="#cb485-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">"fill"</span>) <span class="sc">+</span></span>
<span id="cb485-4"><a href="#cb485-4" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"0"</span> <span class="ot">=</span> <span class="st">"lightblue"</span>, <span class="st">"1"</span> <span class="ot">=</span> <span class="st">"salmon"</span>)) <span class="sc">+</span></span>
<span id="cb485-5"><a href="#cb485-5" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb486"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb486-1"><a href="#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Data SAMPLING ####</span></span>
<span id="cb486-2"><a href="#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:mosaic':

    dotPlot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:survival':

    cluster</code></pre>
</div>
<div class="sourceCode cell-code" id="cb491"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb491-1"><a href="#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">101</span>)</span>
<span id="cb491-2"><a href="#cb491-2" aria-hidden="true" tabindex="-1"></a>split <span class="ot">=</span> <span class="fu">createDataPartition</span>(data<span class="sc">$</span>LUNG_CANCER, <span class="at">p =</span> <span class="fl">0.80</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb491-3"><a href="#cb491-3" aria-hidden="true" tabindex="-1"></a>train_data <span class="ot">=</span> data[split,]</span>
<span id="cb491-4"><a href="#cb491-4" aria-hidden="true" tabindex="-1"></a>test_data <span class="ot">=</span> data[<span class="sc">-</span>split,]</span>
<span id="cb491-5"><a href="#cb491-5" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(train_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 248</code></pre>
</div>
<div class="sourceCode cell-code" id="cb493"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb493-1"><a href="#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(test_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb495"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb495-1"><a href="#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co">#error metrics -- Confusion Matrix</span></span>
<span id="cb495-2"><a href="#cb495-2" aria-hidden="true" tabindex="-1"></a>err_metric<span class="ot">=</span><span class="cf">function</span>(CM)</span>
<span id="cb495-3"><a href="#cb495-3" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb495-4"><a href="#cb495-4" aria-hidden="true" tabindex="-1"></a>  TN <span class="ot">=</span>CM[<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb495-5"><a href="#cb495-5" aria-hidden="true" tabindex="-1"></a>  TP <span class="ot">=</span>CM[<span class="dv">2</span>,<span class="dv">2</span>]</span>
<span id="cb495-6"><a href="#cb495-6" aria-hidden="true" tabindex="-1"></a>  FP <span class="ot">=</span>CM[<span class="dv">1</span>,<span class="dv">2</span>]</span>
<span id="cb495-7"><a href="#cb495-7" aria-hidden="true" tabindex="-1"></a>  FN <span class="ot">=</span>CM[<span class="dv">2</span>,<span class="dv">1</span>]</span>
<span id="cb495-8"><a href="#cb495-8" aria-hidden="true" tabindex="-1"></a>  precision <span class="ot">=</span>(TP)<span class="sc">/</span>(TP<span class="sc">+</span>FP)</span>
<span id="cb495-9"><a href="#cb495-9" aria-hidden="true" tabindex="-1"></a>  recall_score <span class="ot">=</span>(TP)<span class="sc">/</span>(TP<span class="sc">+</span>FN)</span>
<span id="cb495-10"><a href="#cb495-10" aria-hidden="true" tabindex="-1"></a>  f1_score<span class="ot">=</span><span class="dv">2</span><span class="sc">*</span>((precision<span class="sc">*</span>recall_score)<span class="sc">/</span>(precision<span class="sc">+</span>recall_score))</span>
<span id="cb495-11"><a href="#cb495-11" aria-hidden="true" tabindex="-1"></a>  accuracy_model  <span class="ot">=</span>(TP<span class="sc">+</span>TN)<span class="sc">/</span>(TP<span class="sc">+</span>TN<span class="sc">+</span>FP<span class="sc">+</span>FN)</span>
<span id="cb495-12"><a href="#cb495-12" aria-hidden="true" tabindex="-1"></a>  False_positive_rate <span class="ot">=</span>(FP)<span class="sc">/</span>(FP<span class="sc">+</span>TN)</span>
<span id="cb495-13"><a href="#cb495-13" aria-hidden="true" tabindex="-1"></a>  False_negative_rate <span class="ot">=</span>(FN)<span class="sc">/</span>(FN<span class="sc">+</span>TP)</span>
<span id="cb495-14"><a href="#cb495-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Precision value of the model: "</span>,<span class="fu">round</span>(precision,<span class="dv">2</span>)))</span>
<span id="cb495-15"><a href="#cb495-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Accuracy of the model: "</span>,<span class="fu">round</span>(accuracy_model,<span class="dv">2</span>)))</span>
<span id="cb495-16"><a href="#cb495-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"Recall value of the model: "</span>,<span class="fu">round</span>(recall_score,<span class="dv">2</span>)))</span>
<span id="cb495-17"><a href="#cb495-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"False Positive rate of the model: "</span>,<span class="fu">round</span>(False_positive_rate,<span class="dv">2</span>)))</span>
<span id="cb495-18"><a href="#cb495-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"False Negative rate of the model: "</span>,<span class="fu">round</span>(False_negative_rate,<span class="dv">2</span>)))</span>
<span id="cb495-19"><a href="#cb495-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">"F1 score of the model: "</span>,<span class="fu">round</span>(f1_score,<span class="dv">2</span>)))</span>
<span id="cb495-20"><a href="#cb495-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb496"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb496-1"><a href="#cb496-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb496-2"><a href="#cb496-2" aria-hidden="true" tabindex="-1"></a>logit_m <span class="ot">=</span><span class="fu">glm</span>(<span class="at">formula =</span> LUNG_CANCER <span class="sc">~</span> ., <span class="at">data =</span> train_data, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb496-3"><a href="#cb496-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_m)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = LUNG_CANCER ~ ., family = "binomial", data = train_data)

Coefficients:
                         Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             -32.13449    6.57393  -4.888 1.02e-06 ***
GENDERM                  -0.84716    0.82793  -1.023 0.306203    
AGE                       0.01537    0.03490   0.440 0.659756    
SMOKING                   1.10495    0.82246   1.343 0.179119    
YELLOW_FINGERS            1.10971    0.82005   1.353 0.175982    
ANXIETY                   2.08645    1.08610   1.921 0.054725 .  
PEER_PRESSURE             1.94159    0.74009   2.623 0.008704 ** 
`CHRONIC DISEASE`         3.91378    1.12190   3.489 0.000486 ***
FATIGUE                   2.62906    0.89032   2.953 0.003148 ** 
ALLERGY                   1.42702    0.83764   1.704 0.088454 .  
WHEEZING                  1.07933    0.90761   1.189 0.234357    
`ALCOHOL CONSUMING`       2.41116    0.98495   2.448 0.014365 *  
COUGHING                  3.14783    1.22386   2.572 0.010110 *  
`SHORTNESS OF BREATH`    -0.22681    0.84245  -0.269 0.787757    
`SWALLOWING DIFFICULTY`   2.24613    1.24347   1.806 0.070865 .  
`CHEST PAIN`              0.89356    0.73930   1.209 0.226791    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 198.230  on 247  degrees of freedom
Residual deviance:  77.353  on 232  degrees of freedom
AIC: 109.35

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb498"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb498-1"><a href="#cb498-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Logistic regression</span></span>
<span id="cb498-2"><a href="#cb498-2" aria-hidden="true" tabindex="-1"></a>logit_m2 <span class="ot">=</span><span class="fu">glm</span>(<span class="at">formula =</span> LUNG_CANCER <span class="sc">~</span> ANXIETY<span class="sc">+</span>PEER_PRESSURE<span class="sc">+</span><span class="st">`</span><span class="at">CHRONIC DISEASE</span><span class="st">`</span><span class="sc">+</span>FATIGUE<span class="sc">+</span>ALLERGY<span class="sc">+</span><span class="st">`</span><span class="at">ALCOHOL CONSUMING</span><span class="st">`</span><span class="sc">+</span>COUGHING<span class="sc">+</span><span class="st">`</span><span class="at">SWALLOWING DIFFICULTY</span><span class="st">`</span>, <span class="at">data =</span> train_data, <span class="at">family =</span> <span class="st">'binomial'</span>)</span>
<span id="cb498-3"><a href="#cb498-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(logit_m2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = LUNG_CANCER ~ ANXIETY + PEER_PRESSURE + `CHRONIC DISEASE` + 
    FATIGUE + ALLERGY + `ALCOHOL CONSUMING` + COUGHING + `SWALLOWING DIFFICULTY`, 
    family = "binomial", data = train_data)

Coefficients:
                        Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)             -27.3830     5.5206  -4.960 7.05e-07 ***
ANXIETY                   2.5514     0.8659   2.947 0.003213 ** 
PEER_PRESSURE             2.1822     0.7245   3.012 0.002593 ** 
`CHRONIC DISEASE`         3.5120     0.9696   3.622 0.000292 ***
FATIGUE                   2.4939     0.6979   3.573 0.000353 ***
ALLERGY                   2.0104     0.7428   2.707 0.006796 ** 
`ALCOHOL CONSUMING`       2.5084     0.8653   2.899 0.003744 ** 
COUGHING                  3.2220     0.9540   3.377 0.000732 ***
`SWALLOWING DIFFICULTY`   2.5273     1.0096   2.503 0.012309 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 198.230  on 247  degrees of freedom
Residual deviance:  83.501  on 239  degrees of freedom
AIC: 101.5

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb500"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb500-1"><a href="#cb500-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb500-2"><a href="#cb500-2" aria-hidden="true" tabindex="-1"></a>logit_P_prob <span class="ot">=</span> <span class="fu">predict</span>(logit_m, <span class="at">newdata =</span> <span class="fu">select</span>(test_data, <span class="sc">-</span>LUNG_CANCER), <span class="at">type =</span> <span class="st">'response'</span>)</span>
<span id="cb500-3"><a href="#cb500-3" aria-hidden="true" tabindex="-1"></a>logit_P_prob[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3 
0.9912600 0.9997708 0.9980692 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb502"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb502-1"><a href="#cb502-1" aria-hidden="true" tabindex="-1"></a>logit_P <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(logit_P_prob <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co"># Probability check</span></span>
<span id="cb502-2"><a href="#cb502-2" aria-hidden="true" tabindex="-1"></a>logit_P[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 
1 1 1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb504"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb504-1"><a href="#cb504-1" aria-hidden="true" tabindex="-1"></a>CM <span class="ot">=</span> <span class="fu">table</span>(test_data<span class="sc">$</span>LUNG_CANCER, logit_P)</span>
<span id="cb504-2"><a href="#cb504-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   logit_P
     0  1
  0  3  2
  1  1 55</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb506"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb506-1"><a href="#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="fu">err_metric</span>(CM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "Precision value of the model:  0.96"
[1] "Accuracy of the model:  0.95"
[1] "Recall value of the model:  0.98"
[1] "False Positive rate of the model:  0.4"
[1] "False Negative rate of the model:  0.02"
[1] "F1 score of the model:  0.97"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb508"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb508-1"><a href="#cb508-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ROC-curve using pROC library</span></span>
<span id="cb508-2"><a href="#cb508-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'pROC'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:colorspace':

    coords</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:mosaic':

    cov, var</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
<div class="sourceCode cell-code" id="cb514"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb514-1"><a href="#cb514-1" aria-hidden="true" tabindex="-1"></a>roc_score<span class="ot">=</span><span class="fu">roc</span>(test_data<span class="sc">$</span>LUNG_CANCER, logit_P_prob) <span class="co">#AUC score</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 0, case = 1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &lt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb517"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb517-1"><a href="#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_score, <span class="at">main =</span> <span class="st">"ROC curve -- Logistic Regression"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="aph101_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


</section>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>